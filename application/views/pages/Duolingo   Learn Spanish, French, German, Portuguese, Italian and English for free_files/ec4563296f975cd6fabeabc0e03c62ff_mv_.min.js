var duo={};duo.templates={"about":"<div id=\"construction-owl\"><video width=\"200\" height=\"220\" class=\"zone_a\" style=\"display:none;\" data-videos=\"3\" data-zone=\"a\" autoplay loop><source src=\"\" type=\"video/mp4\"><source src=\"\" type=\"video/webm\"></video><video width=\"442\" height=\"396\" class=\"zone_b\" style=\"display:none;\" data-videos=\"4\" data-zone=\"b\" autoplay loop><source src=\"\" type=\"video/mp4\"><source src=\"\" type=\"video/webm\"></video><video width=\"200\" height=\"200\" class=\"zone_c\" style=\"display:none;\" data-videos=\"3\" data-zone=\"c\" autoplay loop><source src=\"\" type=\"video/mp4\"><source src=\"\" type=\"video/webm\"></video><video width=\"200\" height=\"220\" class=\"zone_d\" style=\"display:none;\" data-videos=\"3\" data-zone=\"d\" autoplay loop><source src=\"\" type=\"video/mp4\"><source src=\"\" type=\"video/webm\"></video><video width=\"200\" height=\"220\" class=\"zone_e\" style=\"display:none;\" data-videos=\"3\" data-zone=\"e\" autoplay loop><source src=\"\" type=\"video/mp4\"><source src=\"\" type=\"video/webm\"></video><video width=\"300\" height=\"600\" class=\"zone_f\" style=\"display:none;\" data-videos=\"5\" data-zone=\"f\" autoplay loop><source src=\"\" type=\"video/mp4\"><source src=\"\" type=\"video/webm\"></video></div><h1 style=\"line-height: 48px;\">{{#_i}}Duolingo is building a world with <br/>free education and no language barriers.{{/_i}}</h1>","account":"<div id=\"account-content\" class=\"settings-content\"><div class=\"row\"><div class=\"column span11\"><ul class=\"settings\"><li><label class=>{{#_i}}Username{{/_i}}</label><div class=\"input\"><input style=\"width: 260px;\" class=\"large\" id=\"username\" name=\"username\" type=\"text\" value=\"{{username}}\"></div></li><li><label for=\"email\">{{#_i}}Email{{/_i}}</label><div class=\"input\"><input style=\"width: 260px;\" class=\"large\" id=\"email\" name=\"email\" size=\"30\" type=\"text\" value=\"{{email}}\"></div></li><li><label for=\"language_direction\">{{#_i}}Learning Language{{/_i}}</label><div class=\"input\"><select class=\"xlarge\" name=\"language_direction\" id=\"language_direction\">{{#language_directions}}<option value=\"{{value}}\" {{#selected}}selected=\"selected\"{{/selected}}>{{i_want_to_learn}} {{language}} {{from_info}}</option>{{/language_directions}}</select></div></li><li><label for=\"microphone\">{{#_i}}Microphone{{/_i}}</label><div class=\"input\"><ul class=\"inputs-inline\"><li><label><input class=\"\" id=\"microphone_on\" name=\"microphone\" type=\"radio\" value=\"true\" {{#microphone}}checked{{/microphone}}> {{#_i}}on{{/_i}}</label></li><li><label><input class=\"\" id=\"microphone_off\" name=\"microphone\" type=\"radio\" value=\"false\" {{^microphone}}checked{{/microphone}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label for=\"speaker\">{{#_i}}Speaker{{/_i}}</label><div class=\"input\"><ul class=\"inputs-inline\"><li><label><input class=\"\" id=\"speaker_on\" name=\"speaker\" type=\"radio\" value=\"true\" {{#speaker}}checked{{/speaker}}> {{#_i}}on{{/_i}}</label></li><li><label><input class=\"\" id=\"speaker_off\" name=\"speaker\" type=\"radio\" value=\"false\" {{^speaker}}checked{{/speaker}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label>{{#_i}}Voice autoplay{{/_i}}</label><div class=\"input\"><ul class=\"inputs-inline\"><li><label><input id=\"autoplay_on\" name=\"autoplay\" type=\"radio\" value=\"true\" {{#autoplay}}checked{{/autoplay}}> {{#_i}}on{{/_i}}</label></li><li><label><input id=\"autoplay_off\" name=\"autoplay\" type=\"radio\" value=\"false\" {{^autoplay}}checked{{/autoplay}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label for=\"autoplay\">{{#_i}}Profile picture{{/_i}}</label><div class=\"input\"><div class=\"avatar-large left\" style=\"margin-right: 15px;\">{{>avatar_large}}</div><form id=\"avatar-upload\" action=\"http://duolingo.com/avatars\" method=\"post\" enctype=\"multipart/form-data\"><input type=\"hidden\" name=\"user_id\" value=\"{{id}}\"><input id=\"image-file\" type=\"file\" name=\"image\" class=\"\"><br/>{{#_i}}maximum image size is 1 MB{{/_i}}</form></div></li><li><div class=\"input\"><a href=\"#/settings/deactivate\">{{#_i}}Deactivate my account{{/_i}}</a></div></li></ul></div></div></div> ","admin-dashboard":"<div id=\"admin-dashboard\" class=\"admin-dashboard\"><div class=\"icon-search pointer get-summary\"></div><div class=\"search-input-box\"><label for=\"search-user\">enter a username</label><input type=\"text\" id=\"search-user\" name=\"search-user\" /></div><div class=\"ban-icon pointer show-bans\"></div><h1 style=\"padding-top:20px;\">Admin Dashboard</h1><h2 class=\"offset\">Recent Moderator Activity</h2><ul class=\"tabs big\"><li class='show-deletes active'><a href=\"javascript:;\">Deletes</a></li><li class='show-comments'><a href=\"javascript:;\">Comments</a></li></ul><div class=\"panel\" id=\"moderation-log\"></div><div class=\"panel\" id=\"comment-log\"></div><div id=\"banned-modal\"></div></div>","all-comment-list":"<div class=\"standard-head clearfix\"><div class=\"pane-left\"><h2>{{#_i}}Questions and insights in{{/_i}} {{#_ivar}}language_string{{/_ivar}}</h2></div><div class=\"pane-right\"><div class=\"form-row\"><label for=\"search-comments\" class=\"search-comments-label\">{{#_i}}Search all questions and insights{{/_i}}</label><span class=\"search-icon\"></span><input type=\"text\" name=\"search\" value=\"\" class=\"search-comments\" id=\"search-comments\"/></div></div></div><div class=\"row\"><div class=\"span10-5 columns\" style=\"width: 620px; margin-bottom: 40px;\"><div class=\"sort-questions\">{{#_i}}Sorted by{{/_i}} <select id=\"sorted-choice\"><option value=\"date\">{{#_i}}Time posted{{/_i}}</option><option value=\"votes\">{{#_i}}Votes{{/_i}}</option><option value=\"levels\">{{#_i}}Level{{/_i}}</option></select><!-- <h4 class=\"question-insights\">All comments sorted by <a href=\"/#/comments?sort_by=date\" {{#date}}style=\"text-decoration: underline\"{{/date}}>date</a>, <a href=\"/#/comments?sort_by=votes\" {{#votes}}style=\"text-decoration: underline\"{{/votes}}>votes</a></h4> --></div><ul id=\"settings-tab\" class=\"tabs\"><li id=\"show-all-tab\" class=\"active\" data-filter=\"all\"><a href=\"javascript:;\">{{#_i}}Show all{{/_i}}</a></li><li id=\"watched-tab\" data-filter=\"watched\"><a href=\"javascript:;\">{{#_i}}Watched{{/_i}}</a></li></ul><div id=\"comments\" class=\"all-comments\"></div><i id=\"no-results\" class=\"hidden\">{{#_i}}No results found{{/_i}}</i><i id=\"not-watching\" class=\"hidden\">{{#_i}}You're not watching any questions or insights{{/_i}}</i></div><div class=\"span5 columns\" style=\"margin: 0 0 30px 40px;\"><div class=\"gray-box more-padding\"><div class=\"post-new-buttons\"><span id=\"ask-question\" class=\"btn ask-question\">{{#_i}}Ask question{{/_i}}</span><span id=\"write-insight\" class=\"btn post-insight\">{{#_i}}Post insight{{/_i}}</span></div><div id=\"question-fields\" class=\"post-new hidden\"><h5>{{#_i}}Ask a question{{/_i}}</h5><div class=\"form-row\"><label for=\"question-title\">{{#_i}}Title{{/_i}}</label><input type=\"text\" id=\"question-title\" maxlength=\"250\" /></div><div class=\"form-row\"><label for=\"question-post\">{{#_i}}More details about your question (optional){{/_i}}</label><textarea name=\"\" rows=\"\" id=\"question-post\"></textarea></div><p class=\"grayDark\">{{#_i}}Please <strong>choose a skill</strong> where your question will be posted:{{/_i}}</p><select id=\"question-skill-choice\" class=\"left skill-list\"><option value=\"na\">{{#_i}}General{{/_i}}</option>{{#skill_list}}<option value=\"{{id}}\">{{title}}</option>{{/skill_list}}</select><button id=\"post-question\" class=\"btn primary right\">{{#_i}}Post question{{/_i}}</button></div><div id=\"insight-fields\" class=\"post-new hidden\"><h5>{{#_i}}Post an insight{{/_i}}</h5><div class=\"form-row\"><label for=\"insight-title\">{{#_i}}Title{{/_i}}</label><input type=\"text\" id=\"insight-title\" maxlength=\"250\" /></div><div class=\"form-row\"><label for=\"insight-post\">{{#_i}}More details about your insight (optional){{/_i}}</label><textarea name=\"\" rows=\"\" id=\"insight-post\"></textarea></div><p class=\"grayDark\">{{#_i}}Please <strong>choose a skill</strong> where your insight will be posted:{{/_i}}</p><select id=\"insight-skill-choice\" class=\"left skill-list\"><option value=\"na\">{{#_i}}General{{/_i}}</option>{{#skill_list}}<option value=\"{{id}}\">{{title}}</option>{{/skill_list}}</select><button id=\"post-insight\" class=\"btn primary right\">{{#_i}}Post insight{{/_i}}</button></div><div id=\"posted-label\" class=\"hidden\">{{#_i}}Successfully posted!{{/_i}}</div></div></div></div>","avatar_large":"{{^deactivated}}<div class=\"avatar-large\" title=\"{{username}}\"><!--PUPPY-->{{#avatar}}<img src=\"{{avatar}}/large\" style=\"width: 90px; height: 90px;\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{id}}/large\" style=\"width: 90px; height: 90px;\">{{/avatar}}<span class=\"overlay\"></span></div>{{/deactivated}}{{#deactivated}}<div class=\"avatar-large\" title=\"{{#_i}}[deactivated user]{{/_i}}\"><img src=\"http://duolingo.com/avatars/deactivated_user/large\" style=\"width: 90px; height: 90px;\"><span class=\"overlay\"></span></div>{{/deactivated}}","avatar_medium":"{{^deactivated}}<a href=\"#/{{username}}\" title=\"{{username}}\" class=\"medium-circular-avatar {{#show_badges}}{{#user_comment}}{{#admin_user}}self-mod{{/admin_user}}{{^admin_user}}self{{/admin_user}}{{/user_comment}}{{^user_comment}}{{#expert}}expert{{/expert}}{{/user_comment}}{{/show_badges}}\" ><!--PUPPY-->{{#avatar}}<img src=\"{{avatar}}/medium\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{id}}/medium\">{{/avatar}}</a>{{/deactivated}}{{#deactivated}}<span class=\"medium-circular-avatar\" title=\"{{#_i}}[deactivated user]{{/_i}}\"><img src=\"http://duolingo.com/avatars/deactivated_user/medium\"></span>{{/deactivated}} ","avatar_small":"{{^deactivated}}<a href=\"#/{{username}}\" class=\"has-twipsy small-circular-avatar\" title=\"{{username}}\"><!--PUPPY-->{{#avatar}}<img src=\"{{avatar}}/small\" class=\"avatar\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{id}}/small\" class=\"avatar\">{{/avatar}}</a>{{/deactivated}}{{#deactivated}}<span class=\"has-twipsy avatar-small\" title=\"{{#_i}}[deactivated user]{{/_i}}\"><img src=\"http://duolingo.com/avatars/deactivated_user/small\" class=\"avatar\"></span>{{/deactivated}} ","avatar_small_session":"{{^deactivated}}<a href=\"#/{{username}}\" target=\"_blank\" class=\"has-twipsy avatar-small\" title=\"{{username}}\">{{#avatar}}<img src=\"{{avatar}}/small\" class=\"avatar\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{id}}/small\" class=\"avatar\">{{/avatar}}</a>{{/deactivated}}{{#deactivated}}<span target=\"_blank\" class=\"has-twipsy avatar-small\" title=\"{{#_i}}[deactivated user]{{/_i}}\"><img src=\"http://duolingo.com/avatars/deactivated_user/small\" class=\"avatar\"></span>{{/deactivated}} ","awesome-modal":"<div class=\"modal {{^finished_tree}}slide-end-modal{{/finished_tree}}{{#finished_tree}}finish-end-modal{{/finished_tree}}\"><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div><div class=\"modal-body {{#finished_tree}}finish-awesome-modal{{/finished_tree}}\">{{^finished_tree}}{{#level_event}}<h1>{{#_i}}<strong>Great!</strong> You leveled up!{{/_i}}</h1>{{#num_unlocked}}<h2 class=\"offset\">{{#_i}}You also unlocked the {{#pluralize}}skill,skills,{{num_unlocked}}{{/pluralize}}{{/_i}} {{#short_list}}{{#unlocked_skills}}<strong>{{#_ivar}}title{{/_ivar}}</strong>,{{/unlocked_skills}}{{/short_list}}</h2>{{/num_unlocked}}<div class=\"level-up-badge-container\" style=\"{{#learned}}margin: -50px auto 30px auto;{{/learned}}\"><div class=\"level-up-badge-big {{language}}\"><div class=\"language\"></div><div class=\"level\">{{new_level}}</div></div></div>{{/level_event}}{{#learned}}{{^level_event}}<h1>{{#_i}}<strong>Awesome!</strong> You learned {{#short_list}}{{#learned_skills}}{{#_ivar}}title{{/_ivar}},{{/learned_skills}}{{/short_list}}{{/_i}}</h1>{{#num_unlocked}}<h2 class=\"offset\">{{#_i}}You also unlocked the {{#pluralize}}skill,skills,{{num_unlocked}}{{/pluralize}}{{/_i}} {{#short_list}}{{#unlocked_skills}}<strong>{{#_ivar}}title{{/_ivar}}</strong>,{{/unlocked_skills}}{{/short_list}}</h2>{{/num_unlocked}}<div class=\"trophy-container\"><div class=\"trophy-big\"><div class=\"skill-emboss big-gold skill-{{index}}\"></div></div></div>{{/level_event}}{{/learned}}<ul class=\"end-share-buttons\"><li><a href=\"https://twitter.com/share\" class=\"twitter-share-button\" {{#level_event}}data-text=\"{{#_i}}I reached Level {{new_level}} {{#_ivar}}language_string{{/_ivar}}!{{/_i}}\"{{/level_event}}{{^level_event}}data-text=\"{{#_i}}I learned the {{#_ivar}}language_string{{/_ivar}} {{#pluralize}}skill,skills,{{num_learned}}{{/pluralize}} {{#short_list}}{{#learned_skills}}{{#_ivar}}title{{/_ivar}},{{/learned_skills}}{{/short_list}}on{{/_i}}\"{{/level_event}} data-url=\"http://duolingo.com\" data-count=\"none\" size=\"large\" data-size=\"large\"><span class=\"icon-twitter-small\"></span>{{#_i}}Tweet{{/_i}}</a></li><li><a id=\"facebook-post-action\" class=\"btn facebook\" href=\"javascript:;\"><span class=\"icon-facebook-small\"></span>{{#_i}}Share{{/_i}}</a></li><li><label><input id=\"fb-auto-post\" type=\"checkbox\" {{#auto_facebook_post}}checked=\"checked\"{{/auto_facebook_post}}/> {{#_i}}Automatically share on Facebook{{/_i}}</label></li></ul>{{/finished_tree}}{{#finished_tree}}<div class=\"wrapper\"><img src='/images/lesson-end/finish-tree/{{ui_language}}_{{language}}.jpg'><ul class=\"end-share-buttons\"><li><a href=\"https://twitter.com/share\" class=\"twitter-share-button\" data-text=\"{{#_i}}I conquered {{#_ivar}}language_string{{/_ivar}}!{{/_i}}\" data-url=\"http://duolingo.com\" data-count=\"none\" size=\"large\" data-size=\"large\"><span class=\"icon-twitter-small\"></span>{{#_i}}Tweet{{/_i}}</a></li><li><a id=\"facebook-post-action\" class=\"btn facebook\" href=\"javascript:;\"><span class=\"icon-facebook-small\"></span>{{#_i}}Share{{/_i}}</a></li></ul></div><div class=\"finished-text\"><h1><strong>{{#_i}}You conquered the {{#_ivar}}language_string{{/_ivar}} skill tree!{{/_i}}</strong></h1><p>{{#_i}}First of all, you're awesome! You've completed the {{#_ivar}}language_string{{/_ivar}} skill tree! Second, we'd like to take this time to thank you for using Duolingo. So in honor of you, here is a very special trophy that shows our gratitude.{{/_i}}</p><p>{{#_i}}But don't stop now, maintain your knowledge and keep your <strong>word strength full</strong> by practicing and translating.{{/_i}}</p><img style=\"margin: 0px 0px 20px 100px;\" src='/images/lesson-end/finish-tree/blank_skill.png'><img style=\"float:right;\" src='/images/lesson-end/finish-tree/signature.png'></div>{{/finished_tree}}</div><div class=\"modal-footer\"><button class=\"btn primary right continue large\">{{#_i}}Continue{{/_i}}</button></div></div>","awesome-overlay":"<div id=\"awesome-overlay\" class=\"start\"><div class=\"container\"><img src=\"/images/color-burst.png\" class=\"color-burst\" />{{>awesome-stats}}<div class=\"share-panel-big\">{{>session-end-social}}{{^progressed_skill}}<span id=\"dismiss-awesome\" class=\"btn primary right\">{{#_i}}Dismiss{{/_i}}</span>{{/progressed_skill}}{{#progressed_skill}}<a href=\"/#/\" class=\"btn primary right\">{{#_i}}Continue learning{{/_i}}</a>{{/progressed_skill}}<div class=\"fb-auto-post\"><input id=\"fb-auto-post\" type=\"checkbox\" {{#auto_facebook_post}}checked=\"checked\"{{/auto_facebook_post}}/> {{#_i}}Automatically share on Facebook{{/_i}}</div></div><div id=\"trumpet\"></div></div></div>","awesome-stats":"<h1 style=\"{{#unlocked}}top: 235px;{{/unlocked}}\">{{#_i}}You{{/_i}} {{#level_event}}{{#_i}}reached <strong>Level{{/_i}} {{new_level}}</strong>{{#mastered_or_learned}} {{#_i}}&amp;{{/_i}} {{/mastered_or_learned}}{{/level_event}}{{#mastered}}<span class=\"mastered-small\"></span>{{#_i}}mastered <strong>{{/_i}}{{#headline_mastered}}{{#_ivar}}headline_mastered{{/_ivar}}{{/headline_mastered}}{{^headline_mastered}}{{mastered}}{{#pluralize}}{{#_i}}skill{{/_i}},{{#_i}}skills{{/_i}},{{mastered}}{{/pluralize}}{{/headline_mastered}}</strong>{{#learned}} {{#_i}}&amp;{{/_i}} {{/learned}}{{/mastered}}{{#learned}}{{#_i}}learned <strong>{{/_i}}{{#headline_learned}}{{#_ivar}}headline_learned{{/_ivar}}{{/headline_learned}}{{^headline_learned}}{{learned}} {{#pluralize}}{{#_i}}skill{{/_i}},{{#_i}}skills{{/_i}},{{mastered}}{{/pluralize}}{{/headline_learned}}</strong>{{/learned}}</h1>{{#unlocked}}<h2 style=\"top: 285px;\">{{#_i}}You unlocked{{/_i}} {{#short_list}}{{#unlocked_skills}}<strong>{{#_ivar}}title{{/_ivar}}</strong>,{{/unlocked_skills}}{{/short_list}}</h2>{{/unlocked}}{{#level_event}}<div class=\"level-badge-large\">{{new_level}}</div>{{/level_event}}{{^level_event}}{{#mastered}}<div class=\"mastered-large\"></div>{{/mastered}}{{^mastered}}<div class=\"learned-large-new\"></div>{{/mastered}}{{/level_event}}","blame":"{{#wrong_language}}{{#_i}}You typed in English, not {{#_ivar}}language_name{{/_ivar}}.{{/_i}}{{/wrong_language}}{{#missing}}{{#_i}}You missed a word.{{/_i}}{{/missing}}{{#third-person-number}}{{#additional_info}}<i>{{correct_source}}</i> se usa para la tercera persona del {{correct_number_string}}. Para el {{wrong_number_string}}, se usa <i>{{wrong_source}}</i>. {{/additional_info}}{{/third-person-number}}{{#third-person-s}}{{#additional_info}}{{#_i}}\"{{verb}}\" turns into \"{{third}}\" after he/she/it.{{/_i}}{{/additional_info}}{{/third-person-s}}{{#rev-third-person-s}}{{#additional_info}}{{#_i}}\"{{verb}}\" turns into \"{{third}}\" <i>only</i> after he/she/it.{{/_i}}{{/additional_info}}{{/rev-third-person-s}}{{#verb_agr}}{{#additional_info}}{{#_i}}You used the {{wrong_form}} form \"{{wrong_usage}}\" instead of the {{correct_form}} form \"{{correct_usage}}\".{{/_i}}{{/additional_info}}{{/verb_agr}}{{#desadj}}{{#additional_info}}{{#_i}}\"Des\" changes to \"de\" when there is an adjective before the noun.{{/_i}}{{/additional_info}}{{/desadj}}{{#missing_article}}{{#additional_info}}{{#_i}}You need the article \"{{article}}\" here.{{/_i}}{{/additional_info}}{{/missing_article}}{{#possessive_s}}{{#_i}}Pay attention to the apostrophe that means possession here.{{/_i}}{{/possessive_s}}{{#cest}} Use \"c'est\" when the noun has an article before it (une, un, le, la, or l'). {{/cest}}{{#he-il}}{{#_i}}Here, the French \"il\" means \"it\", not \"he\".{{/_i}}{{/he-il}}{{#he-ce}}{{#_i}}Here, the French \"c'est\" means \"it is\", not \"he is\".{{/_i}}{{/he-ce}}{{#il-faut}}{{#_i}}The French \"il faut\" means \"it is necessary\" not \"he must\".{{/_i}}{{/il-faut}}{{#iolo}} The first person pronoun in Italian is \"io\", not \"lo\". {{/iolo}}{{#del}}{{#_i}}In Spanish, \"de\" and \"el\" must always combine to \"del\".{{/_i}}{{/del}}{{#number}}{{#additional_info}}{{#sg_correct}}{{#_i}}You used the plural \"{{wrong_form}}\" here, instead of the singular \"{{correct_form}}\".{{/_i}}{{/sg_correct}}{{^sg_correct}}{{#_i}}You used the singular \"{{wrong_form}}\" here, instead of the plural \"{{correct_form}}\".{{/_i}}{{/sg_correct}}{{/additional_info}}{{/number}}{{#vocab}}{{#additional_info}}{{#_i}}Be careful not to confuse \"{{correct_word}}\" and \"{{wrong_word}}\"!{{/_i}}{{/additional_info}}{{/vocab}}{{#vocab_noun}}{{#additional_info}}{{#_i}}Be careful not to confuse \"{{correct_word}}\" and \"{{wrong_word}}\"!{{/_i}}{{/additional_info}}{{/vocab_noun}}{{#rev_sie}}{{#additional_info}}{{#_i}}\"{{sie_usage}}\" is used as the formal \"you\" here, not as \"{{wrong_usage}}\".{{/_i}}{{/additional_info}}{{/rev_sie}}{{#its_es}}{{#additional_info}}{{^en}}{{#_i}}In English, it is not correct to start a sentence with just \"is\".{{/_i}}{{/en}}{{/additional_info}}{{/its_es}}{{#article_def_indef}}{{#additional_info}}{{#def_correct}}{{#_i}}You used the indefinite \"{{wrong_form}}\" here, instead of the definite \"{{correct_form}}\".{{/_i}}{{/def_correct}}{{^def_correct}}{{#_i}}You used the definite \"{{wrong_form}}\" here, instead of the indefinite \"{{correct_form}}\".{{/_i}}{{/def_correct}}{{/additional_info}}{{/article_def_indef}}{{#gender}}{{^additional_info}}{{#_i}}Pay attention to the gender.{{/_i}}{{/additional_info}}{{#additional_info}}{{#gender_correct}}{{#gender_wrong}}{{#_i}}\"{{noun}}\" is {{gender_correct_string}}, not {{gender_wrong_string}}.{{/_i}}{{/gender_wrong}}{{^gender_wrong}}{{#_i}}Pay attention to the gender.{{/_i}}{{/gender_wrong}}{{/gender_correct}}{{^gender_correct}}{{#gender_wrong}}{{#_i}}Pay attention to the gender.{{/_i}}{{/gender_wrong}}{{^gender_wrong}}{{#_i}}Pay attention to the gender.{{/_i}}{{/gender_wrong}}{{/gender_correct}}{{/additional_info}}{{/gender}}{{#case_gender}}{{#additional_info}}{{#case_correct}}{{#gender_correct}}{{#_i}}In {{case_correct_string}} case, use \"{{article_correct}}\" for {{gender_correct_string}} nouns like \"{{noun}}\"{{/_i}}{{/gender_correct}}{{^gender_correct}}{{#_i}}Pay attention to case and gender.{{/_i}}{{/gender_correct}}{{/case_correct}}{{/additional_info}}{{/case_gender}}{{#nom_gender}}{{#additional_info}}{{#_i}}For {{gender_correct_string}} nouns like \"{{noun}}\", use \"{{article_correct}}\".{{/_i}}{{/additional_info}}{{/nom_gender}}{{#circumflex}}{{#_i}}Pay attention to the circumflex.{{/_i}}{{/circumflex}}{{#accent}}{{#_i}}Pay attention to the accents.{{/_i}}{{/accent}}{{#casing}}{{#_i}}Pay attention to the capitalization.{{/_i}}{{/casing}}{{#casing_sie}}{{#additional_info}}{{#_i}}When used as the formal \"you\", \"{{sie_usage}}\" needs to be capitalized.{{/_i}}{{/additional_info}}{{/casing_sie}}{{#casing_ihr}}{{#additional_info}}{{#_i}}When used as the formal \"your\", \"{{ihr_usage}}\" needs to be capitalized.{{/_i}}{{/additional_info}}{{/casing_ihr}}{{#casing_noun}}{{#_i}}All nouns are capitalized in German.{{/_i}}{{/casing_noun}}{{#enie}}{{#_i}}Pay attention to the \u00f1 character.{{/_i}}{{/enie}}{{#dieresis}}{{#_i}}Pay attention to the \u00fc character.{{/_i}}{{/dieresis}}{{#cedille}}{{#_i}}Pay attention to the \u00e7 character.{{/_i}}{{/cedille}}{{#umlaut}}{{#_i}}Pay attention to the umlauts.{{/_i}}{{/umlaut}}{{#eszett}}{{#_i}}Pay attention to the \u00df character.{{/_i}}{{/eszett}}{{#typo}}{{#additional_info}}{{#_i}}You have {{#pluralize}} a typo,typos,{{num_highlights}}{{/pluralize}} in your answer.{{/_i}}{{/additional_info}}{{/typo}}{{#missing_space}}{{#_i}}You missed a space.{{/_i}}{{/missing_space}}{{#extra_space}}{{#_i}}You have an extra space.{{/_i}}{{/extra_space}}{{#an_a}}{{#_i}}Use \"an\" before words that start with a vowel.{{/_i}}{{/an_a}}{{#apo_space}}{{#_i}}There should be no spaces around apostrophes.{{/_i}}{{/apo_space}}{{#hyphen_space}}{{#_i}}There should be no spaces around hyphens.{{/_i}}{{/hyphen_space}}","blame-popover":"<div id=\"blame-1\" class=\"popover above blame-popover animated fadeInDown\"><div class=\"arrow\"></div><div class=\"inner\"><div class=\"icon-warning\"></div></div></div> ","collapsed-event":"{{#events}}<div id=\"collapsed-event-{{id}}\"></div>{{/events}} ","comment":"<div class=\"community\"><ul class=\"nav-breadcrumb max-depth-1\"><li>{{#root}}<a href=\"#/topic/{{id}}\">{{#_ivar}}name{{/_ivar}}<span class=\"arrow\"></span></a>{{/root}}</li></ul><div class=\"comment-main\"><div class=\"original-post-container\">{{#sentence_comment}}<button class=\"listen-button-small\"></button>{{/sentence_comment}}{{^sentence_comment}}{{#user}}<span style=\"position: relative; z-index: 1000\">{{>avatar_medium}}</span>{{/user}}{{/sentence_comment}}<div class=\"original-post\">{{#sentence_comment}}<h1>\"<span class=\"title translation-source\">{{format_title}}</span>\"</h1>{{/sentence_comment}}{{^sentence_comment}}<h1>{{title}}</h1>{{/sentence_comment}}{{^sentence_comment}}<div class=\"comment-metadata\">{{#user}}{{^deactivated}}<a href=\"#/{{username}}\" class=\"username\">{{username}}</a> {{/deactivated}}{{#deactivated}}{{#_i}}[deactivated user]{{/_i}}{{/deactivated}}{{>user_flair}}{{/user}}</div>{{/sentence_comment}}{{#message}}{{^sentence_comment}}{{^deleted}}{{{processed_message}}}{{/deleted}}{{#deleted}}{{#_i}}[deleted]{{/_i}} {{/deleted}}{{/sentence_comment}}{{/message}}{{#sentence_comment}}<p><strong>Translation:</strong> <span class=\"trans translation-source\">{{translation}}</span></p>{{/sentence_comment}}<div class=\"comment-footer\">{{#logged_in_user}}<div class=\"vote-module-small\"><div class=\"vote-count\">{{votes}}</div><button class=\"vote-up {{#user_upvoted}}active{{/user_upvoted}}\" id=\"comment-{{id}}-upvote\">vote up</button><button class=\"vote-down {{#user_downvoted}}active{{/user_downvoted}}\" id=\"comment-{{id}}-downvote\">vote down</button></div>{{^sentence_comment}}{{^deleted}}{{#editable}}<a href=\"javascript:;\" class=\"edit-comment\">{{#_i}}Edit{{/_i}}</a><a href=\"javascript:;\" class=\"delete-comment\">{{#_i}}Delete{{/_i}}</a>{{/editable}}{{#admin_user}}<a href=\"javascript:;\" class=\"delete-thread\">{{#_i}}Delete Discussion{{/_i}}</a>{{/admin_user}}{{/deleted}}{{/sentence_comment}}{{#sentence_comment}}{{#admin_user}}{{^deleted}}<a href=\"javascript:;\" class=\"edit-comment\">{{#_i}}Edit{{/_i}}</a>{{/deleted}}<a href=\"javascript:;\" class=\"delete-comment\">{{#_i}}Delete{{/_i}}</a><a href=\"javascript:;\" class=\"delete-thread\">{{#_i}}Delete Discussion{{/_i}}</a>{{/admin_user}}{{/sentence_comment}}<span class=\"divider\">\u2022</span>{{/logged_in_user}}{{datetime_string}}</div><div id=\"edit-comment-box\" class=\"hidden\"><div class=\"form-row small\"><textarea class=\"post-edit-box\" style=\"width: 610px;\" id=\"main-post-edit\" name=\"post-edit-box\" rows=\"3\">{{message}}</textarea></div><input id=\"main-comment-update\" type=\"submit\" class=\"btn primary update-comment\" value=\"Save\"> <input id=\"main-comment-cancel\" type=\"reset\" class=\"btn cancel-update-comment\" value=\"{{#_i}}Cancel{{/_i}}\"></div></div></div><div class=\"sub-orig-post\"><div class=\"main-reply-area\">{{#logged_in_user}}<a href=\"#/{{username}}\" title=\"{{username}}\" class=\"medium-circular-avatar self\" >{{#avatar}}<img src=\"{{avatar}}/medium\">{{/avatar}}{{^avatar}}<!-- PUPPY LOCATION <img src=\"http://24.media.tumblr.com/tumblr_lfb73isQh11qc1m1vo1_500.jpg\"> --><img src=\"http://duolingo.com/avatars/{{id}}/medium\">{{/avatar}}</a>{{/logged_in_user}}<div id=\"comment-fields\">{{#logged_in}}<div class=\"form-row\"><label for=\"post-text-box\" class=\"comment-box\" style=\"opacity: 1;\">{{#num_comments}}{{#_i}}Leave a new comment{{/_i}}{{/num_comments}} {{^num_comments}}{{#_i}}Start the discussion{{/_i}}{{/num_comments}}</label><textarea style=\"width: 655px; height:38px; max-width: 655px; min-height: 38px\" class=\"comment-box animated-resizing\" id=\"post-text-box\" name=\"post\" rows=\"3\"></textarea><!-- <div class=\"login-msg\"><a href=\"http://duolingo.com/#/login\">Sign in</a> or <a href=\"http://duolingo.com/#/register\">create an account</a> to contribute.</div> --></div>{{/logged_in}}<span class=\"hidden\" id=\"post-button\"><input id=\"post-comment\" type=\"submit\" class=\"btn primary\" style=\"margin-right: 10px\" value=\"{{#_i}}Post Comment{{/_i}}\"></span><span class=\"hidden\" id=\"post-button\"><input type=\"reset\" class=\"btn cancel-update-comment\" value=\"Cancel\"></span></div></div><h5>{{#num_comments}}{{num_comments}} {{#pluralize}}{{#_i}}Comment{{/_i}},{{#_i}}Comments{{/_i}},{{num_comments}}{{/pluralize}}{{/num_comments}}{{^num_comments}}{{#_i}}No one has commented yet.{{/_i}}{{/num_comments}}</h5><div class=\"comments-container\"><ul id=\"comments\" class=\"list-comments-nested first-reply\">{{#comments}}{{^removed}}<li id=\"comment-{{id}}\" class=\"comment condensed\"></li>{{/removed}}{{#removed}}{{#deleted}}<li id=\"comment-{{id}}\" class=\"comment condensed\"></li>{{/deleted}}{{/removed}}{{#removed}}{{^deleted}}{{#undeletable}}<li id=\"comment-{{id}}\" class=\"comment condensed\"></li>{{/undeletable}}{{/deleted}}{{/removed}}{{/comments}}{{#num_hidden}}<li class=\"show-toggle comment\" id=\"show-toggle\"><a href=\"javascript:;\" class=\"show-bad-comment\">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/num_hidden}}{{#undeletable}}{{^num_hidden}}<li class=\"show-toggle comment\" id=\"show-toggle\"><a href=\"javascript:;\" class=\"show-bad-comment\">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/num_hidden}}{{/undeletable}}</ul></div></div></div>{{#logged_in}}{{#watching}}<span id=\"unwatch\" class=\"btn success follow\">{{#_i}}Following Discussion{{/_i}}</span>{{/watching}}{{^watching}}<span id=\"watch\" class=\"btn follow\">{{#_i}}Follow Discussion{{/_i}}</span>{{/watching}}{{/logged_in}}<div class=\"modal hidden post-comment\" id=\"edit-modal\"></div></div> ","comment-event":"{{#user}}{{>avatar_medium}}{{/user}}<h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}} </a>{{^translation}}{{#terminal}}{{#_i}}commented on{{/_i}} {{/terminal}}{{^terminal}}{{#_i}}posted{{/_i}} {{/terminal}}{{#_i}}a discussion{{/_i}}{{/translation}}{{#translation}}{{#_i}}commented on{{/_i}} <a href=\"#/translation/{{translation}}\">{{#_i}}a translation{{/_i}}</a>{{/translation}}</h5>{{#comment_thread_id}}<strong><a href=\"#/comment/{{comment_thread_id}}\">{{comment_title}}</a></strong>{{/comment_thread_id}}<p>{{blurb}}</p><ul class=\"footer\"><li>{{datetime_string}}</li></ul>{{#channel}}{{>event-context-menu}}{{/channel}}","comment-list":"<ul id=\"comments\" class=\"list-comments-better\">{{#comments}}<li id=\"comment-{{id}}\" class=\"comment\" style=\"padding-right: 0; min-height: 0\"></li>{{/comments}}{{^comments}}<li style=\"padding: 0; padding: 20px 0; min-height: 0; background: #f5f5f5; padding: 12px 10px; border-bottom: none;\">{{#_i}}There are no discussions here yet. Be the first to post something!{{/_i}}</li>{{/comments}}</ul>{{#more}}{{#infinite_scrolling}}<img src=\"/images/medium-loader.gif\" style=\"left: 30%; margin-top: 20px; position: absolute\" />{{/infinite_scrolling}}{{^infinite_scrolling}}<button id=\"load-more-comments\" class=\"btn\" style=\"margin-top: 20px\">{{#_i}}load more{{/_i}}</button>{{/infinite_scrolling}}{{/more}} ","community-search":"<h5 style=\"margin-top: 20px\">{{#results_count}}{{results_count}}{{/results_count}}{{^results_count}}0{{/results_count}} results</h5><ul style=\"border-top: 1px solid #E6E6E6\" class=\"search-results\">{{#comments}}<li><a href=\"/#/comment/{{parent_id}}\">{{topic_name}}: {{parent_title}}</a><div>\"...{{{extract}}}...\"</div></li>{{/comments}}</ul>{{#has_more}}<button id=\"load-more-comments\" class=\"btn\" style=\"margin-top: 20px\">{{#_i}}load more{{/_i}}</button>{{/has_more}} ","compact-comment":"<div class=\"topic-container\"><h6 class=\"head\"><a href=\"#/comment/{{id}}{{#from_skill}}?from_skill={{from_skill}}{{/from_skill}}\">{{title}}</a></h6><div class=\"forum-discussion\"><div class=\"metadata {{#skill}}with-skill{{/skill}}\">{{#logged_in}}<div class=\"vote-module-small\"><div class=\"vote-count\">{{votes}}</div><button class=\"vote-up {{#user_upvoted}}active{{/user_upvoted}}\" id=\"comment-{{id}}-upvote\">vote up</button><button class=\"vote-down {{#user_downvoted}}active{{/user_downvoted}}\" id=\"comment-{{id}}-downvote\">vote down</button></div>{{/logged_in}}<span class=\"topic-metadata\">{{datetime_string}} {{#_i}}by{{/_i}} {{#user}}{{^deactivated}}<a href=\"#/{{username}}\" class=\"username\">{{username}}</a> {{/deactivated}}{{#deactivated}}{{#_i}}[deactivated user]{{/_i}}{{/deactivated}}{{#mod}}<span class=\"moderator\"></span>{{/mod}}{{/user}}</span></div>{{#user}}{{>avatar_medium}}{{/user}}</div></div>{{^from_skill}}<div class=\"discussion-icon {{#num_comments}}answered{{/num_comments}}\"><div class=\"num-comments\">{{num_comments}}</div></div>{{/from_skill}}","correct-solutions":"<div class=\"correct-solution-box\">{{#correct}}{{#blame}}{{#closest_translation}}<h5>{{#_i}}Correct solution{{/_i}}:</h5><div class=\"input-meta\"><div class=\"another-correct-solution\"><div class=\"solution-item translation-source translation_source\">{{closest_translation}}</div></div></div>{{/closest_translation}}{{^closest_translation}}{{#correct_solutions}}<h5>{{#_i}}Correct solution{{/_i}}:</h5><div class=\"input-meta\"><div class=\"another-correct-solution\"><div class=\"solution-item translation-source translation_source\">{{.}}</div></div></div>{{/correct_solutions}}{{/closest_translation}}{{/blame}}{{^blame}}{{#solution_translation}}<h5>{{#_i}}Translation{{/_i}}:</h5><div class=\"input-meta\"><div class=\"another-correct-solution\"><div class=\"solution-item translation-source translation_source\">{{solution_translation}}</div></div></div>{{/solution_translation}}{{/blame}}{{/correct}}{{#incorrect}}{{#has_solutions}}{{^closest_translation}}<h5>{{^wrong_language}}{{#solution_translation}}<div class=\"translation-headline\">{{#_i}}Translation{{/_i}}:</div>{{/solution_translation}}{{/wrong_language}}{{#_i}}Correct {{#pluralize}} solution, solutions,{{num_solutions}}{{/pluralize}}{{/_i}}: </h5><div class=\"input-meta\"><div class=\"correct-solution\">{{#correct_solutions}}<div class=\"solution-item translation_source\">{{.}}</div>{{/correct_solutions}}</div>{{^wrong_language}}{{#solution_translation}}<div class=\"translation\">{{solution_translation}}</div>{{/solution_translation}}{{/wrong_language}}</div>{{/closest_translation}}{{#closest_translation}}{{^display_translation}}<h5>{{#_i}}Correct solution{{/_i}}:</h5><div class=\"input-meta\"><div class=\"correct-solution\"><div class=\"solution-item translation-source translation_source\">{{closest_translation}}</div></div></div>{{/display_translation}}{{#display_translation}}<h5>{{#_i}}Correct solutions{{/_i}}:</h5><div class=\"input-meta\"><div class=\"correct-solution\"><div class=\"solution-item translation-source translation_source\">{{closest_translation}}</div><div class=\"solution-item translation-source translation_source\">{{display_translation}}</div></div></div>{{/display_translation}}{{/closest_translation}}{{/has_solutions}}{{/incorrect}}</div> ","current-best-translation":"{{#is_first}}<h5>{{#_i}}Computer translation{{/_i}}:</h5>{{/is_first}}{{^is_first}}<h5>{{#_i}}Current best translation{{/_i}}:</h5>{{/is_first}}{{#best_translation}}{{#submitted_by}}{{>avatar_small_session}}{{/submitted_by}}{{text}}{{/best_translation}}","current-wiki-translation":"{{^logged_in}}<div class=\"pane-top\"><a href=\"/#\" target=\"_blank\" class=\"btn right primary\" style=\"margin: 5px 0 0 0;\"><b>{{#_i}}Join Duolingo{{/_i}}</b></a><div class=\"description\"><div class=\"arrows\"></div>{{#_i}}This {{#_ivar}}source_language_name{{/_ivar}} article was translated to {{#_ivar}}target_language_name{{/_ivar}} by Duolingo, a community of language learners.{{/_i}}</div></div>{{/logged_in}}<div class=\"main {{#logged_in}}more-top-padding{{/logged_in}}\">{{#logged_in}}<div class=\"back-to-translate\"><a href=\"/#/translation/{{id}}\">{{#_i}}\u2190 View translate interface{{/_i}}</a></div>{{/logged_in}}<div class=\"share-translation\">{{#_i}}Share this translation{{/_i}}<ul class=\"share-sites\"><li><a href=\"https://www.facebook.com/sharer/sharer.php?u=http://duolingo.com/translated/{{translation_id}}\" class=\"facebook has-twipsy\" title=\"Facebook\"></a></li><li><a href=\"https://twitter.com/share?text={{escaped_translated_tweet_text}}&url=/\" class=\"twitter has-twipsy\" title=\"Twitter\"></a></li><!-- <li><a href=\"http://www.reddit.com/submit\" class=\"reddit has-twipsy\" title=\"Reddit\" onclick=\"window.location = 'http://www.reddit.com/submit?url=' + encodeURIComponent(window.location) + '&title={{escaped_translated_reddit_title}}'; return false\"></a></li> --></ul></div>{{#document_paragraphs}}<div class=\"wiki-paragraph\" style=\"display:block\" id=\"paragraph-{{paragraph_index}}\">{{#sentences}}{{#second}}<span class=\"rounded-image-wrapper\">{{#has_images}}<a class=\"fbox fancybox.image\" rel=\"group\" href=\"{{first_image_url}}\" style=\"display: inline; height: 100%;\"><img src=\"{{first_image_url}}\" class=\"image-thumb\"></a>{{#hidden_images}}<a class=\"fbox fancybox.image\" rel=\"group\" href=\"{{.}}\" style=\"display: none;\"></a>{{/hidden_images}}{{/has_images}}{{^has_images}}<img src=\"/images/owl-waving-gray.png\" class=\"image-thumb\"/>{{/has_images}}</span>{{/second}}{{^index}}<div class=\"document-header\"><h1 class=\"wiki-document-title\">{{#cur_translation}}{{cur_translation}}{{/cur_translation}}{{^cur_translation}}<span class=\"sentence non-translated\">{{#sentence_tokens}}{{token}}{{/sentence_tokens}}</span>{{/cur_translation}}</h1><div class=\"meta\">{{#document_url}}<div class=\"source-website\" style=\"margin: 0;\">{{#_i}}from{{/_i}} <a href=\"{{document_url}}\" target=\"_blank\">{{display_url}}</a></div>{{/document_url}}</div></div>{{/index}}{{#index}}{{#cur_translation}}{{cur_translation}}{{/cur_translation}}{{^cur_translation}}<span class=\"sentence non-translated\">{{#sentence_tokens}}{{token}}{{/sentence_tokens}}</span>{{/cur_translation}} &nbsp; {{/index}}{{/sentences}}</div>{{/document_paragraphs}}<p class=\"estimated-quality\">{{#_i}}Estimated quality of translation:{{/_i}}&nbsp; {{#quality_low}}{{#_i}}Poor{{/_i}}{{/quality_low}}{{#quality_medium}}{{#_i}}Medium{{/_i}}{{/quality_medium}}{{#quality_high}}{{#_i}}Good{{/_i}}{{/quality_high}}</p></div> ","current-wiki-translation-minimal":"<html><title>Duolingo: {{title}}</title><body><meta http-equiv=\"refresh\" content=\"0; url=/#/translated/{{translation_id}}\">{{#document_paragraphs}}<p>{{#sentences}}{{^index}}<h1>{{#cur_translation}}{{cur_translation}}{{/cur_translation}}{{^cur_translation}}{{#sentence_tokens}}{{token}}{{/sentence_tokens}}{{/cur_translation}}</h1>{{#has_images}}<img src=\"{{first_image_url}}\" class=\"image-thumb\">{{/has_images}}{{^has_images}}<img src=\"/images/owl-waving-gray.png\" class=\"image-thumb\"/>{{/has_images}}{{/index}}{{#index}}{{#cur_translation}}{{cur_translation}}{{/cur_translation}}{{^cur_translation}}{{#sentence_tokens}}{{token}}{{/sentence_tokens}}{{/cur_translation}}{{/index}}{{/sentences}}</p>{{/document_paragraphs}}</body></html>","dashboard-statistics":"<ul class=\"even-context-menu statistics\"><p class=\"stats-header\">Reports per 100 users</p>{{#statistics}}<li><span class=\"flag mini {{to_lang}}\" style=\"float:left;\"></span> <span style=\"padding-left:5px;\">{{uppercase_to}} from {{uppercase_from}}:</span><span style=\"float:right;\"><strong>{{ratio}}</strong></span></li>{{/statistics}}<p class=\"stats-footer\">updated: {{datetime}}</p></ul>","data-list":"<div id=\"datarows\">{{#search}}<h4>Showing results for \"{{search_query}}\"</h4>{{/search}}<table class=\"database-table table table-striped\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><thead><tr><th>Sentence</th><th>Translation</th><!--<th class=\"sortable\" data-sort=\"\">Failure<span class=\"sorting-icon\"></span></th>--><th class=\"sortable\" data-sort=\"\">Reports<span class=\"sorting-icon\"></span></th></tr></thead><tbody id=\"rows\">{{#datarows}}<tr class=\"sentence-toggle\" data-sentence=\"{{id}}\" id=\"compact-{{id}}\"><td class>{{text}}</td><td>{{compact_translation}}</td><!--<td class=\"pass-rate-{{pass_rounded}}\">{{pass_rate}}% </td>--><td><span class=\"report-num\" style=\"color: rgb({{report_scaled}}, 0, 0)\">{{num_reports}}</span></td></tr><tr class=\"expanded-cell\" style=\"display:none\" data-sentence=\"{{id}}\" id=\"expanded-{{id}}\"></tr><tr class=\"expanded-cell-bottom-bar\" style=\"display:none\" id=\"expanded-footer-{{id}}\" data-sentence=\"{{id}}\"><td colspan=\"4\"><span class=\"btn right show-delete\" style=\"float:left\">Delete sentence</span><span class=\"btn right done-btn primary\">Done and Reset</span><span class=\"btn right cancel-btn\" style=\"margin-right: 8px\">Close</span></td></tr>{{/datarows}}</tbody></table></div>{{^skill}}{{#more}}<button style=\"width: 100%; height:40px\" class='btn load-more'>Load more {{^search}}sentences, {{more}} remaining{{/search}}</button>{{/more}}{{/skill}} ","data-row":"{{#all_reports}}<td class=\"table-data\"><div class=\"animate-me\"><div class=\"container-header\"> ORIGINAL SENTENCE {{#original}}{{^hints}}<span data-toggle=\"popover\" data-placement=\"above\" data-popover=\"#report-original-{{id}}\" class=\"gray-warning\"><span class=\"warning-number\">{{original}}</span></span>{{/hints}}{{/original}}{{^original}}{{#hints}}<span data-toggle=\"popover\" data-placement=\"above\" data-popover=\"#report-hints-{{id}}\" class=\"gray-warning\"><span class=\"warning-number\">{{hints}}</span></span>{{/hints}}{{/original}}{{#original}}{{#hints}}<span data-toggle=\"popover\" data-placement=\"above\" data-popover=\"#report-original-hints-{{id}}\" class=\"gray-warning\"><span class=\"warning-number\">{{orig_sentence}}</span></span>{{/hints}}{{/original}}<div id=\"report-original-{{id}}\" class=\"popover black top above\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><p>Check sentence ({{original}})</p></div></div></div><div id=\"report-hints-{{id}}\" class=\"popover black top above\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><p>Check hints ({{hints}})</p></div></div></div><div id=\"report-original-hints-{{id}}\" class=\"popover black top above\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><p>Check sentence ({{original}}) and hints ({{hints}})</p></div></div></div><div id=\"report-audio-hints-{{id}}\" class=\"popover black top above\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><p>Check audio ({{audio}})</p></div></div></div></div><div class=\"data-container\"><ul class=\"data-cells\"><li class=\"original-sentence editable-cell\"><button class=\"icon_speaker\"></button><div class=\"base-sentence translation-source editable\" style=\"cursor: text;\" contentEditable='true'>{{text}}</div></li></ul></div></div><span class=\"wrap\"><ul id=\"delete-pop-{{id}}\" class=\"even-context-menu delete-direction\" style=\"display:none;\"><!--<div class=\"popover-arrow\"></div>-->{{#languages}}<li class=\"delete-option\"><input type=\"checkbox\" class=\"lang-checkbox\" data-to=\"{{.}}\" data-from=\"{{language}}\">learning {{.}} from {{language}}</input></li>{{/languages}}{{#reverse_languages}}<li class=\"delete-option\"><input type=\"checkbox\" class=\"lang-checkbox\" data-to=\"{{language}}\" data-from=\"{{.}}\">learning {{language}} from {{.}}</input></li>{{/reverse_languages}}<li><btn class=\"btn cancel-delete\" style=\"float:left;\">Cancel</btn><btn class=\"btn primary delete-sentence\" style=\"float:right;\">Delete</btn></li></ul></span></td><td class=\"table-data\"><div class=\"animate-me\"><div class=\"container-header accepted-header\"> ACCEPTED TRANSLATIONS {{#translation}}<span data-toggle=\"popover\" data-placement=\"above\" data-popover=\"#report-display-{{id}}\" class=\"gray-warning\"><span class=\"warning-number\">{{translation}}</span></span>{{/translation}}<div id=\"report-display-{{id}}\" class=\"popover black top above\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><p>Check display sentences ({{translation}})</p></div></div></div><button id=\"add-sentence-{{id}}\" class=\"add-accepted\">+</button></div><div class=\"data-container\"><ul class=\"data-cells accepted-translations\">{{#correct_translations}}<li id=\"accepted-{{id}}\" class=\"editable-cell\" data-id={{id}}><span class=\"star-display {{#displayed}}star-active{{/displayed}}{{^displayed}}star-inactive{{/displayed}}\"></span><span class=\"accepted-translation editable\" data-text=\"{{text}}\" data-id=\"{{id}}\" data-display=\"{{displayed}}\" contentEditable='true' style=\"cursor: text; width:340px\">{{text}}</span><button class=\"btn remove-translation remove-button\">-</button></li>{{/correct_translations}}</ul><span class=\"additional-row hidden\"><span class=\"star-display star-inactive\"></span><span class=\"accepted-translation editable\" contentEditable=\"true\" style=\"cursor: text; width:340px\"></span><button class=\"btn remove-translation remove-button\">-</button></span></div><div class=\"container-header suggested-header {{^suggested}}hidden{{/suggested}}\" style=\"margin-top: 8px\"> USER-SUGGESTED TRANSLATIONS <div id=\"reports-accepted-{{id}}\" class=\"popover black top above\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><p>Reject or Accept ({{accepted}})</p></div></div></div></div><div class=\"data-container {{^suggested}}hidden{{/suggested}}\"><ul class=\"data-cells\">{{#suggested}}<li class=\"suggested-translation\" data-sentence=\"{{id}}\" data-index=\"{{index}}\" data-text=\"{{text}}\"><span class=\"gray-warning\"><span class=\"warning-number\">{{num}}</span></span><div class=\"suggested-container\">{{text}}</div><button class=\"btn accept-btn\" style=\"float:right\">\u2714</button><button class=\"btn reject-btn\" style=\"float:right\"> \u2718 </button></li>{{/suggested}}</ul></div></div></td><td class=\"table-data\"><span class=\"report-num\" style=\"color: rgb({{report_scaled}}, 0, 0);\">{{num_reports}}</span></td>{{/all_reports}}","database-dashboard":"<div id=\"stats-button\" class=\"get-statistics stats-btn\" style=\"position: relative\"><span id=\"stats-view\" style=\"display:none;\"></span></div><h1>{{#to_language}}{{title}}{{/to_language}} from {{#from_language}}{{title}}{{/from_language}} Dashboard</h1><h2 class=\"offset\">View, edit, and add sentences</h2><div class=\"data-top-bar\"><span class=\"dropdown-label\">Language:</span><button id=\"dropdown-language-button\" class=\"btn\" style=\"position: relative\">{{curr_to_language}} from {{curr_from_language}} <span style=\"position: relative; top: -2px\">\u25be</span><ul id=\"dropdown-menu-languages\" class=\"even-context-menu\" style=\"display:none; width: 140px\"><li class=\"language-option\" data-direction=\"es/en\">EN from ES</li><li class=\"language-option\" data-direction=\"en/es\">ES from EN</li><li class=\"language-option\" data-direction=\"en/it\">IT from EN</li><li class=\"language-option\" data-direction=\"it/en\">EN from IT</li><li class=\"language-option\" data-direction=\"en/pt\">PT from EN</li><li class=\"language-option\" data-direction=\"pt/en\">EN from PT</li><li class=\"language-option\" data-direction=\"en/de\">DE from EN</li><li class=\"language-option\" data-direction=\"en/fr\">FR from EN</li><li class=\"language-option\" data-direction=\"fr/en\">EN from FR</li></ul></button><span class=\"dropdown-label\" style=\"margin-left: 30px\">Skill:</span><button id=\"dropdown-skill-button\" class=\"btn\" style=\"position: relative\">{{^current_skill}}All Reported{{/current_skill}}{{#current_skill}}{{title}}: v.{{version}}{{/current_skill}} <span style=\"position: relative; top: -2px\">\u25be</span><ul id=\"dropdown-menu-skills\" class=\"even-context-menu\" style=\"display:none; overflow-y: scroll\"><li class=\"skill-option\">All Reported</li>{{#skills}}<li class=\"skill-option\" id=\"{{id}}\">{{title}}: v.{{version}}</li>{{/skills}}</ul></button><div class=\"form-row\" style=\"float:right;\"><span style=\"left: -21px;\" class=\"search-icon\"></span><label style=\"left: 4px; top: 7px; font-size: 14px\" for=\"search-sentences\">Search</label><input style=\"left: -4px; width: 150px;\" type=\"text\" name=\"search\" value=\"\" class=\"search-box\" id=\"search-sentences\" maxlength=\"200\"/></div><div class=\"clear-button btn search-close\" style=\"display : none;\">x</div></div><div id=\"data-list\"></div><div id=\"search-results\" style=\"display:none;\"></div> ","deactivate":"<h2 style=\"text-align: center;font-size: 32px;margin: 50px 0 40px 0;\">{{#_i}}Deactivate my account{{/_i}}</h2><div id='tab-container'><div class=\"deactivate-container\"><img class=\"floating-owl\" src=\"/images/owl-standing-crying.png\" style=\"margin-right: 30px;\"/><div class=\"deactivate-text\"><p>{{#_i}}Hooooold up\u2014 are you sure you want to do this?{{/_i}}</p><p>{{#_i}}Duolingo teaches you how to live, love, and speak another language. If you leave, you might just never be able to reach your full potential in life.{{/_i}}</p></div></div></div><div class=\"player-action\"><form action=\"/deactivate\" method=\"POST\"><button id=\"submit_button\" type=\"submit\" class=\"btn danger large right button-space\">{{#_i}}Deactivate my account{{/_i}}</button><button id=\"cancel_button\" type=\"reset\" class=\"btn large right\">{{#_i}}Cancel{{/_i}}</button></form></div><button id=\"do-not-push\" class=\"hidden\"></button> ","diagnose-reading-room":"<html><body><h1>Reading room for {{source_language}}->{{target_language}}</h1><h2>Draft documents</h2>{{#draft_translation_ids}}<br><a href=\"/#/translation/{{translation_id}}\">{{document_title}}</a> (<a href=\"/diagnostics/wiki_translation/{{translation_id}}\">diagnostics</a>) {{/draft_translation_ids}}<h2>Partially-seeded docs</h2>{{#seeded_translation_ids}}<br><a href=\"/#/translation/{{translation_id}}\">{{document_title}}</a> (<a href=\"/diagnostics/wiki_translation/{{translation_id}}\">diagnostics</a>) {{/seeded_translation_ids}}</body></html> ","diagnose-user-translations":"<form> View all translations for user: <input type=\"text\" name=\"user\" value=\"{{username}}\"> <input type=\"submit\" name=\"submit\" value=\"Submit\"></form>{{#username}}<b>{{username}}</b> has contributed {{num_translations}} translation(s) since {{wiki_translation_launch_date}}, the date when wiki translations were launched to all users. <br><br><form action=\"/wiki_translations/revert_all/{{user_id}}\" method=\"post\"><input type=\"submit\" name=\"submit\" value=\"Revert all edits from this user\"> (NOTE: this will not delete the user's translation in cases where there is no previous translation.) </form><br>{{#user_translations}}{{> table}}{{/user_translations}}{{/username}} ","diagnose-wiki-document-sentence":"<html><body><h1>Details for translation <a href=\"/diagnostics/wiki_translation/{{translation_id}}\">{{translation_id}}</a>, DocumentSentence {{document_sentence_id}}</h1><br>Source sentence: <i>{{source_sent_text}}</i><h2>Revision history</h2>{{#revisions_table}}{{> table}}{{/revisions_table}}<h2>Comments</h2>{{#comments_table}}{{> table}}{{/comments_table}}<br><b>Watchers:</b> {{#watchers}}{{name}} {{/watchers}}<form action=\"/add_wiki_translation_revision/{{translation_id}}/{{document_sentence_id}}\" method=\"post\"><br>Add revision: <input type=\"text\" name=\"translation\" size=100><input type=\"submit\" name=\"submit\" value=\"Submit\"></form><form action=\"/translations/{{translation_id}}/{{document_sentence_id}}/comments\" method=\"post\"><br>Add comment: <input type=\"text\" name=\"message\" size=100><input type=\"submit\" name=\"submit\" value=\"Submit\"></form></body></html> ","diagnose-wiki-translation":"<html><body><h1>Details for translation of <i>{{document_title}}</i> from {{document_language}} into {{target_language}}. </h1><form action=\"/wiki_translations/{{translation_id}}/seed_from_db\" method=\"post\"><input type=\"submit\" name=\"submit\" value=\"Seed from DB\"></form><h2>Document sentences</h2>{{#document_sentence_table}}{{> table}}{{/document_sentence_table}}<h2>Watchers</h2>{{#watchers}}<br>{{name}}{{/watchers}}</body></html> ","discussion-page":"<div id=\"discussion-modal\" class=\"discussion-modal-wrapper hidden\"><div class=\"modal player-discussion\"><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div><div class=\"modal-body\">{{#logged_in}}{{#comment}}{{#num_comments}}<input id=\"watch\" type=\"button\" class=\"btn\" value=\"Follow Discussion\" style=\"float:right; position: relative; top: -2px\"></input>{{/num_comments}}{{/comment}}{{/logged_in}}<button class=\"listen-button-small\"></button><div class=\"original-post\"><h1>\"<span class=\"title translation-source\">{{text}}</span>\"</h1><p><strong>{{#_i}}Translation:{{/_i}}</strong> <span class=\"trans translation-source\">{{translation}}</span></p></div><div class=\"main-reply-area\">{{#logged_in_user}}<a href=\"#/{{username}}\" title=\"{{username}}\" class=\"medium-circular-avatar self\" ><!--PUPPY LOCATION-->{{#avatar}}<img src=\"{{avatar}}/medium\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{id}}/medium\">{{/avatar}}</a>{{/logged_in_user}}<div id=\"comment-fields\" style=\"margin-bottom: 20px\"><div class=\"form-row\"><label for=\"post-text-box\" class=\"comment-box\" style=\"opacity: 1;\">{{#_i}}Discuss this sentence with others{{/_i}}</label><textarea style=\"width: 505px; height:38px; max-width: 570px; min-height: 38px\" class=\"comment-box animated-resizing\" id=\"post-text-box\" name=\"post\" rows=\"3\"></textarea><!-- <div class=\"login-msg\"><a href=\"http://duolingo.com/#/login\">Sign in</a> or <a href=\"http://duolingo.com/#/register\">create an account</a> to contribute.</div> --></div><div class=\"player-discuss-guide hidden\"><p>{{#_i}}Please <b>do not</b> report mistakes here. This discussion should be about language issues only.{{/_i}}</p></div><span class=\"hidden\" id=\"post-button\"><input id=\"post-comment\" type=\"submit\" class=\"btn primary\" style=\"margin-right: 10px\" value=\"{{#_i}}Post Comment{{/_i}}\"></span><span class=\"hidden\" id=\"post-button\"><input type=\"reset\" class=\"btn cancel-update-comment\" value=\"Cancel\"></span></div></div><div class=\"community\"><h5>{{#comment}}{{num_comments}} {{#pluralize}}{{#_i}}Comment{{/_i}},{{#_i}}Comments{{/_i}},{{num_comments}}{{/pluralize}}{{/comment}}{{^comment}}{{#_i}}No one has commented yet.{{/_i}}{{/comment}}</h5></div><div class=\"comments-container community\"><ul id=\"comments\" class=\"list-comments-nested first-reply\">{{#comments}}<li id=\"comment-{{id}}\" class=\"comment condensed\">{{message}}</li>{{/comments}}{{#comment}}<li class=\"show-toggle comment\" id=\"show-toggle\"><a href=\"javascript:;\" class=\"show-bad-comment\">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/comment}}</ul></div></div></div></div> ","element-feedback":"<div id=\"suggestion-modal\" class=\"modal submit-solution hidden\" style=\"margin-top: -200px;\"><div class=\"modal-body\"><h4>{{#_i}}Duh. Did we make a mistake?{{/_i}}</h4><h5>{{#_i}}Tell us what the right answer should be:{{/_i}}</h5><div class=\"form-row\"><textarea id=\"user-solution\" disabled=\"disabled\">{{user_solution}}</textarea></div><div class=\"form-row\" style=\"margin: 0;\"><label for=\"optional-message\">{{#_i}}Optional message{{/_i}}</label><textarea id=\"optional-message\"></textarea></div></div><div class=\"modal-footer\"><button id=\"submit-suggestion\" class=\"btn primary\">{{#_i}}Submit feedback{{/_i}}</button><button id=\"cancel-suggestion\" class=\"btn secondary\">{{#_i}}Cancel{{/_i}}</button></div></div>","event":"<li>{{datetime}}: {{username}}</li>","event-comments":"{{#has_comments}}<ul class=\"list-stream-comments\">{{#comments}}<li>{{#user}}{{>avatar_small}}<a href=\"/#/{{username}}\" class=\"username\">{{username}}</a>{{/user}} {{{processed_message}}}</li>{{/comments}}</ul>{{/has_comments}}{{#logged_in}}<div class=\"form-row post-row\"><textarea id=\"comment-box-{{id}}\" class=\"post\"></textarea><div class=\"button-vkeyboard\" id=\"toggle_vkeyboard\" style=\"right: 5px; top: 6px;\"></div><label for=\"comment-box-{{id}}\" class=\"stream-post-label\">{{#_i}}Write a comment{{/_i}}</label></div><div class=\"post-footer hidden\"><div class=\"form-row\"><button class=\"btn primary right post-event-comment\">{{#_i}}Comment{{/_i}}</button><div id=\"search-box-{{id}}\" class=\"search-box\"><span class=\"search-icon\"></span><label for=\"lookup-word-{{id}}\">{{#_i}}Translate an English word{{/_i}}</label><input type=\"text\" id=\"lookup-word-{{id}}\" class=\"left\"/><button id=\"translate-lookup\" class=\"btn left\" style=\"margin: 0 0 0 5px; display: none;\">{{#_i}}Translate{{/_i}}</button><div id=\"lookup-hints\" class=\"translation-source\"></div></div></div></div><div id=\"vkeyboard-placeholder\"></div>{{/logged_in}} ","event-context-menu":"<span class=\"btn event-context\"><span class=\"icon\"></span></span><ul class=\"even-context-menu hidden\"><li><span>You are following {{channel_display}}</span></li><li class=\"seperator\"></li><li><a class=\"unfollow-channel\" href=\"javascript:;\">Unfollow {{channel_display}}</a></li></ul>","event-footer":"<ul class=\"footer\"><li>{{datetime_string}}</li>{{^merged}}{{#logged_in}}{{^has_comments}}<li class=\"show-comments\"><a href=\"javascript:;\">{{#_i}}Comment{{/_i}}</a></li>{{/has_comments}}{{/logged_in}}{{^disable_upvotes}}<li class=\"upvotes\">{{#logged_in}}<a href=\"javascript:;\" class=\"vote {{#user_liked}}upvoted{{/user_liked}}\">{{#_i}}Awesome{{/_i}}</a>{{/logged_in}}<span style=\"display: inline-block;\" {{#likes}}class=\"has-twipsy\" data-original-title=\"{{#short_list}}{{#liked_users}}{{.}},{{/liked_users}}{{/short_list}}\"{{/likes}}><span class=\"icon-upvotes {{#likes}}green{{/likes}}\"></span>{{#likes}}<strong class=\"upvotes-count\">{{likes}}</strong>{{/likes}}</span></li>{{/disable_upvotes}}{{#deletable}}<li><a href=\"javascript:;\" class=\"delete-stream-post\">{{#_i}}Delete{{/_i}}</a></li>{{/deletable}}{{/merged}}</ul>{{#channel}}{{>event-context-menu}}{{/channel}}","events":"<ul class=\"activity-stream\">{{#error}}<li>There is an error retrieving your stream.</li>{{/error}}</ul>{{#more_events}}<a id=\"more-stream\" class=\"btn\" href=\"javascript:;\">{{#_i}}load more{{/_i}}</a>{{/more_events}} ","example-name-element":"<h1>{{#_i}}<strong>Remember</strong> this word{{/_i}}</h1><span id=\"big-speaker\"></span><h3>{{phrase}} {{#hint}} = {{hint}}{{/hint}}</h3>{{>name-images}}","facebook-description":"{{#_i}}With Duolingo you learn a language for free, while helping to translate the web.{{/_i}} ","facebook_redirect":"<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /><title>Duolingo</title>{{#css}}<link rel=\"stylesheet\" href=\"{{.}}\" />{{/css}}{{#js}}<script src=\"{{.}}\"></script>{{/js}}<script type=\"text/javascript\">{{^error}} window.opener.location = '/#/?fb_verifier={{verifier}}'; window.close(); {{/error}}</script></head><body>{{#error}}<h1 style=\"text-align: center; margin-top: 50px;\">{{#_i}}There seems to be a problem<br/>connecting to Facebook{{/_i}}</h1><h2 style=\"text-align: center;\">{{#_i}}Please try again later{{/_i}}</h2>{{/error}}</body></html>","fake-textarea":"<div class=\"fake-input-area\"><div id=\"graded-text-input\" class=\"translation-textarea fake-textarea\">{{#user_avatar}}{{>avatar_small}}{{/user_avatar}}{{text}}{{#unknown}}<a href=\"javascript:;\" class=\"suggest-edit edit-icon immediate-edit\">{{#_i}}Edit{{/_i}}</a>{{/unknown}}</div>{{#unknown}}<span class=\"edit-final-panel\">{{#completed_translation}}<a href=\"javascript:;\" style=\"margin: 0 15px 0 0;\" class=\"show-final-translation switch-final-icon\">{{#_i}}Show final translation{{/_i}}</a>{{/completed_translation}}<a href=\"javascript:;\" class=\"suggest-edit edit-icon\" style=\"display: none\">{{#_i}}Edit{{/_i}}</a></span>{{/unknown}}{{#unknown}}<a href=\"javascript:;\" class=\"save-edit btn right primary\" style=\"display: none; margin: 5px 0 0 5px;\">{{#_i}}Save{{/_i}}</a> <a href=\"javascript:;\" class=\"cancel-edit btn right\" style=\"display: none; margin: 5px 0 0 0\">{{#_i}}Cancel{{/_i}}</a>{{/unknown}}</div>","feedback_response":"<html><head>{{#css}}<link rel=\"stylesheet\" href=\"{{.}}\" type=\"text/css\" media=\"screen\" />{{/css}}<style type=\"text/css\"> body { background: white; font-size: 13px; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; color: #404040; padding: 10px 10px 10px 20px; }</style></head><body><div id=\"success\" style=\"background-color:white\"><strong>{{#_i}}Thanks for your feedback!{{/_i}}</strong><br/>{{#logged_in}}{{#_i}}Our team will look into your suggestions and we will get back to you if we have further questions.{{/_i}}</div>{{/logged_in}}{{^logged_in}}{{#_i}}Our team will look into your suggestions.{{/_i}}</div>{{/logged_in}}</body></html>","find-element":" {{type}}","flagged-translations":"<h1>Translations flagged as abusive by users, but not disabled ({{num_flagged_non_disabled}})</h1><ul>{{#flagged_non_disabled}}<li><a href=\"/#/translation/{{translation_id}}\">{{document_title}}</a>{{/flagged_non_disabled}}</ul><h1>Disabled translations ({{num_disabled}})</h1><ul>{{#disabled}}<li><a href=\"/#/translation/{{translation_id}}\">{{document_title}}</a>{{/disabled}}</ul> ","follow-event":"{{#user}}{{>avatar_medium}}{{/user}}<h5 style=\"margin: 0;\"><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#_i}}started following{{/_i}} {{#short_list}}{{#followings}}<a href=\"#/{{username}}\">{{username}}</a>,{{/followings}}{{/short_list}}</h5>","footer":"<div class=\"inner\">{{^logged_in}}<p class=\"\">\u00a9 {{cr_year}} Duolingo</p>{{/logged_in}}<ul><!--<li><a href=\"#/translate_jobs\" tabindex=\"200\">{{#_i}}Translate{{/_i}}</a></li>--><li><a href=\"#/info\" tabindex=\"100\">{{#_i}}About{{/_i}}</a></li><li><a href=\"#/terms\" tabindex=\"100\">{{#_i}}Terms{{/_i}}</a></li><li><a href=\"#/guidelines\" tabindex=\"100\">{{#_i}}Guidelines{{/_i}}</a></li><li><a href=\"#/privacy\" tabindex=\"100\">{{#_i}}Privacy{{/_i}}</a></li>{{#logged_in}}<li><a href=\"#/help\" tabindex=\"110\">{{#_i}}Help{{/_i}}</a></li>{{/logged_in}}<li><a href=\"#/jobs\" tabindex=\"110\">{{#_i}}Jobs{{/_i}}</a></li><li><a href=\"http://blog.duolingo.com\" tabindex=\"120\">{{#_i}}Blog{{/_i}}</a></li><li><a href=\"http://twitter.com/duolingo\" tabindex=\"130\"><span class=\"icon-twitter\"></span>{{#_i}}Twitter{{/_i}}</a></li><li><a href=\"http://facebook.com/duolingo\" tabindex=\"140\"><span class=\"icon-facebook\"></span>{{#_i}}Facebook{{/_i}}</a></li></ul></div>","forgot":"<div class=\"center-pane\"><form action=\"\" method=\"post\" id=\"forgot-form\"><input type=\"hidden\" name=\"came_from\" value=\"{{came_from}}\"/><fieldset class=\"clearfix\"><h1 style=\"font-size: 34px;\">{{#_i}}Forgot password{{/_i}}</h1><h3>{{#_i}}We will send you instructions on how to reset your password by email.{{/_i}}</h3><ul class=\"login-signup-list\"><li><label for=\"email\">{{#_i}}Email{{/_i}}</label><input class=\"large\" id=\"email\" name=\"email\" size=\"30\" type=\"text\" value=\"{{email}}\"><div class=\"error-flag\" id='email-error'>{{#_i}}Enter a correct email address{{/_i}}</div></li><li><input type=\"submit\" class=\"btn large primary\" style=\"width: 288px;\" value=\"{{#_i}}Submit{{/_i}}\"/></li></ul></fieldset></form><div id=\"form_txt_good\" class=\"form_msg hidden\"><h1 style=\"font-size: 42px;\">{{#_i}}Thank you!{{/_i}}</h1><h3>{{#_i}}Please check your email.{{/_i}}</h3></div></div><style type=\"text/css\" media=\"screen\"> .forgot-password { display: none; }</style> ","form-element":"<h1>{{#_i}}<strong>Select</strong> the missing word that best matches{{/_i}}</h1><h3>{{#tokens}}{{#word}}{{display_value}}{{/word}}{{^word}}<select class=\"medium\" name=\"mediumSelect\" id=\"options_{{i}}\"><option class=\"placeholder\" value=\"\">{{#_i}}Select word{{/_i}}</option>{{#options}}<option value=\"{{value}}\">{{display_value}}</option>{{/options}}</select>{{/word}}{{/tokens}}</h3>{{#new_player_blame_experiment_true}}<div id=\"correct-solutions\" class=\"correct-solution-box\" style=\"width: 500px;\"></div>{{/new_player_blame_experiment_true}}","friend-find":"<h1>Search results</h1><div class=\"form-row\" style=\"margin-bottom: 40px;\"><span class=\"search-icon\"></span><label class=\"search-label\" for=\"search-learners\">{{#_i}}Search learners{{/_i}}</label><input type=\"text\" class=\"search-input\" id=\"search-learners\" value=\"{{q}}\"/></div><div class=\"\"><ul id=\"search-learners-results\" class=\"small-list-users\">{{>user-search-results}}</ul></div> ","friend_passed_you":"{{username}} {{#_i}}just passed you on Duolingo{{/_i}}.","friends":"<h1 id=\"title\" style=\"margin: 40px 0 40px 0; font-size: 26px;\">{{#_i}}Follow people to make learning more fun{{/_i}}</h1><div class=\"row\"><div class=\"span10-5 columns\"><ul id=\"settings-tab\" class=\"tabs\"><li class=\"active\" data-tab=\"recommended-panel\"><a href=\"javascript:;\">{{#_i}}Recommended{{/_i}}</a></li><li data-tab=\"search-panel\"><a href=\"javascript:;\">{{#_i}}Search{{/_i}}</a></li><li data-tab=\"connect-panel\"><a href=\"javascript:;\">{{#_i}}Connect{{/_i}}</a></li></ul></div></div><div class=\"row\"><div class=\"span10-5 columns\"><div id=\"recommended-panel\" class=\"panel\"><h4>{{#_i}}{{#_ivar}}learning_language_string{{/_ivar}} learners similar to you{{/_i}}</h4><div id=\"suggested-friends-list\"></div></div><div id=\"search-panel\" class=\"panel hidden\"><h4>{{#_i}}Search for people on Duolingo{{/_i}}</h4><div class=\"search-friends-box\"><div class=\"form-row\"><label for=\"search-friends\" class=\"search-friends-label\">{{#_i}}Search by name or email address{{/_i}}</label><span class=\"search-icon\"></span><button id=\"search-button\" class=\"right btn\">{{#_i}}Search{{/_i}}</button><input type=\"text\" name=\"search\" value=\"\" class=\"search-friends\" id=\"search-friends\"/></div></div><div id=\"search-friends-list\"></div></div><div id=\"connect-panel\" class=\"panel hidden\"><h4>{{#_i}}Import contacts{{/_i}}</h4><div class=\"gray-box find-friends\"><ul class=\"list-find-friends\"><li>{{#facebook_id}}<button id=\"find-fb-friends\" class=\"btn facebook left\"><span class=\"icon-facebook\"></span> {{#_i}}Search again on{{/_i}} <strong>Facebook</strong></button><div class=\"connected\">{{#_i}}Connected as{{/_i}} <a id=\"facebook-profile-link\" href=\"http://www.facebook.com/{{facebook_id}}\" target=\"_blank\">{{facebook_name}}</a>. </div>{{/facebook_id}}{{^facebook_id}}<button id=\"find-fb-friends\" class=\"btn facebook left\"><span class=\"icon-facebook\"></span> {{#_i}}Connect to{{/_i}} <strong>Facebook</strong></button>{{/facebook_id}}</li><li>{{#twitter_id}}<button class=\"btn twitter left\" id=\"find-twttr-friends\"><span class=\"icon-twitter\"></span> {{#_i}}Search again on{{/_i}} <strong>Twitter</strong></button><div class=\"connected\">{{#_i}}Connected as{{/_i}} <a id=\"twitter-profile-link\" href=\"http://www.twitter.com/{{twitter_name}}\" target=\"_blank\">@{{twitter_name}}</a>. </div>{{/twitter_id}}{{^twitter_id}}<button class=\"btn twitter left\" id=\"twttr-connect\"><span class=\"icon-twitter\"></span> {{#_i}}Connect to{{/_i}} <strong>Twitter</strong></button>{{/twitter_id}}</li></ul></div><div id=\"fb-panel\" class=\"\" style=\"display: none\"><h4>{{#_i}}Friends on Facebook{{/_i}}</h4><div id=\"fb-friends-list\"></div></div><div id=\"twttr-panel\" class=\"\" style=\"display: none\"><h4>{{#_i}}People you follow on Twitter{{/_i}}</h4><div id=\"twttr-friends-list\"></div></div></div></div></div> ","friends_list":"<ul class=\"{{^is_empty}}follow-user-list{{/is_empty}}{{#is_empty}}no-users{{/is_empty}}\">{{#friends}}<li class=\"user\"><div class=\"follow-area\"><button class=\"follow-button btn {{#is_following}}success{{/is_following}} right\" data-toggle=\"follow\" data-user=\"{{id}}\" data-follow-text=\"{{#_i}}Follow{{/_i}}\" data-unfollow-text=\"{{#_i}}Unfollow{{/_i}}\">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</button></div><a href=\"#/{{username}}\"><!--PUPPY-->{{#avatar}}<img src=\"{{avatar}}/medium\" class=\"avatar\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{username}}/medium\" class=\"avatar\"/>{{/avatar}}</a><h4 class=\"username\"><a href=\"#/{{username}}\">{{username}}</a><span class=\"realname\">{{fullname}}</span></h4><p class=\"bio\">{{bio}}</p><ul class=\"meta\"><li class=\"skillpoints\">{{#_ivar}}learning_language_string{{/_ivar}}:<span class=\"icon-star-small\"></span>{{learning_language_points}}</li><li class=\"signed-up\"><span class=\"icon-clock-small\"></span>{{#_i}}Signed up{{/_i}} {{created}}</li>{{#location}}<li class=\"location\"><span class=\"icon-location-small\"></span>{{location}}</li>{{/location}}</ul></li>{{/friends}}{{^friends}}<li class=\"none\"><i>{{#is_friends_list}}{{#_i}}Sorry, none of your friends are using Duolingo yet.{{/_i}}{{/is_friends_list}}{{#is_search_list}}{{#_i}}No users found.{{/_i}}{{/is_search_list}}{{#is_recommended_list}}{{#_i}}Try connecting to Facebook or Twitter to find your friends.{{/_i}}{{/is_recommended_list}}</i></li>{{/friends}}</ul>{{#more}}<a href=\"javascript:;\" class=\"btn load-more\">{{#_i}}load more{{/_i}}</a>{{/more}} ","friendship-item":"<li>{{>avatar_small}}<a href=\"#/{{username}}\" class=\"user\">{{username}}</a>{{#logged_in}}{{^is_user}}<a class=\"follow-button btn right {{#is_following}}success{{/is_following}}\" data-user=\"{{id}}\">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</a>{{/is_user}}{{/logged_in}}</li>","friendship-list":"<ul class=\"list-users-small\">{{#shown_friends}}{{>friendship-item}}{{/shown_friends}}</ul>","grade":"{{#session_element}}{{#attributes}}{{^new_player_blame_experiment_true}}{{#correct}}{{#mic_off}}{{#message}}<p class=\"grayDark\" style=\"margin: 0 0 0 -60px;\">{{#_i}}Microphone is off</strong><br/>You can always turn it back on in the settings page.{{/_i}}</p>{{/message}}{{/mic_off}}{{^mic_off}}{{^points_per_correct}}<span class=\"icon_correct_big_2\"></span>{{/points_per_correct}}{{#points_per_correct}}<span class=\"trinkit-container\"><span class=\"coin-big\">+1</span><span class=\"stopwatch-big\"><strong>+{{extra_time}}</strong>s</span></span>{{/points_per_correct}}{{#greeting}}<h3>{{greeting}}</h3>{{/greeting}}{{^greeting}}{{#hover_trial}}<h3>{{#_i}}Good job!{{/_i}}</h3>{{/hover_trial}}{{^hover_trial}}{{^blame}}<h3 {{#name}}class=\"special-correct\"{{/name}}>{{#_i}}You are correct{{/_i}}</h3>{{#points_per_correct}}<p class=\"points-msg\">{{#_i}}You got extra time and points. <strong>Hurry!</strong>{{/_i}}</p>{{/points_per_correct}}{{#display_translation}}<div class=\"grade-feedback-new correct-border\" {{#solution_translation}}{{#closest_translation}} style=\"width: auto\" {{/closest_translation}}{{/solution_translation}}><div class=\"correct-solution\" {{#solution_translation}}style=\"width: 260px\"{{/solution_translation}}><strong>{{#_i}}Another correct solution{{/_i}}:</strong><ul><li>{{display_translation}}</li></ul></div></div>{{/display_translation}}{{/blame}}{{#blame}}<h3>{{#_i}}Woot, you are almost correct.{{/_i}}</h3>{{/blame}}<div class=\"{{#blame}} grade-feedback-new {{/blame}}{{#solution_translation}} grade-feedback-new {{/solution_translation}}{{^blame}}{{^solution_translation}} hidden {{/solution_translation}}{{/blame}}\" {{#solution_translation}}{{#blame}} style=\"width: auto\" {{/blame}}{{/solution_translation}}>{{#has_solutions}}{{#blame}}<div class=\"correct-solution\" {{#solution_translation}}style=\"width: 260px\"{{/solution_translation}}>{{^closest_translation}}<strong>{{#_i}}Correct {{#pluralize}} solution, solutions,{{num_solutions}}{{/pluralize}}{{/_i}}:</strong><ul>{{#correct_solutions}}<li class=\"translation_source translation-source\">{{.}}</li>{{/correct_solutions}}</ul>{{/closest_translation}}{{#closest_translation}}{{^display_translation}}<strong>{{#_i}}Correct solution{{/_i}}:</strong><ul><li class=\"translation_source translation-source\">{{closest_translation}}</li></ul>{{/display_translation}}{{#display_translation}}<strong>{{#_i}}Correct solutions{{/_i}}:</strong><ul><li class=\"translation_source translation-source\">{{closest_translation}}</li><li class=\"translation_source translation-source\">{{display_translation}}</li></ul>{{/display_translation}}{{/closest_translation}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#circumflex}}{{#_i}}Pay attention to the circumflex.{{/_i}}{{/circumflex}}{{#accent}}{{#_i}}Pay attention to the accents.{{/_i}}{{/accent}}{{#casing}}{{#_i}}Pay attention to the capitalization.{{/_i}}{{/casing}}{{#casing_sie}}{{#additional_info}}{{#_i}}When used as the formal \"you\", \"{{sie_usage}}\" needs to be capitalized.{{/_i}}{{/additional_info}}{{/casing_sie}}{{#casing_ihr}}{{#additional_info}}{{#_i}}When used as the formal \"your\", \"{{ihr_usage}}\" needs to be capitalized.{{/_i}}{{/additional_info}}{{/casing_ihr}}{{#casing_noun}}{{#_i}}All nouns are capitalized in German.{{/_i}}{{/casing_noun}}{{#enie}}{{#_i}}Pay attention to the \u00f1 character.{{/_i}}{{/enie}}{{#dieresis}}{{#_i}}Pay attention to the \u00fc character.{{/_i}}{{/dieresis}}{{#cedille}}{{#_i}}Pay attention to the \u00e7 character.{{/_i}}{{/cedille}}{{#umlaut}}{{#_i}}Pay attention to the umlauts.{{/_i}}{{/umlaut}}{{#eszett}}{{#_i}}Pay attention to the \u00df character.{{/_i}}{{/eszett}}{{#typo}}{{#_i}}You have {{#pluralize}} a typo,typos,{{num_highlights}}{{/pluralize}} in your answer.{{/_i}}{{/typo}}{{#missing_space}}{{#_i}}You missed a space.{{/_i}}{{/missing_space}}{{#extra_space}}{{#_i}}You have an extra space.{{/_i}}{{/extra_space}}{{#an_a}}{{#_i}}Use \"an\" before words that start with a vowel.{{/_i}}{{/an_a}}{{#apo_space}}{{#_i}}There should be no spaces around apostrophes.{{/_i}}{{/apo_space}}{{#hyphen_space}}{{#_i}}There should be no spaces around hyphens.{{/_i}}{{/hyphen_space}}</div></div>{{/blame}}{{/has_solutions}}{{#solution_translation}}{{^homophone}}<div id=\"element-translation\" class=\"translation\"><strong>{{#_i}}Translation{{/_i}}:</strong><ul><li>{{solution_translation}}</li></ul></div>{{/homophone}}{{/solution_translation}}</div>{{/hover_trial}}{{/greeting}}{{/mic_off}}{{>grade-discuss}}{{/correct}}{{#incorrect}}{{#try_again}}{{#listen}}<h5>{{#_i}}Oops, it doesn't seem to be in {{#_ivar}}language_name{{/_ivar}}.{{/_i}}</h5><p>{{#_i}}Please try again.{{/_i}}</p>{{/listen}}{{#speak}}{{#odd}}<h5>{{#_i}}Oops, I couldn\u2019t understand what you said{{/_i}}</h5><p>{{#_i}}Please record again (try speaking slower), or skip this.{{/_i}}</p>{{/odd}}{{^odd}}<h5>{{#_i}}I can't hear you very well{{/_i}}</h5><p>{{#_i}}Please record again (try speaking slower), or skip this.{{/_i}}</p>{{/odd}}{{/speak}}{{/try_again}}{{^try_again}}{{#next_time}}<div class=\"grade-message\"><h3>{{#_i}}Try again next time!{{/_i}}</h3></div>{{>grade-discuss}}{{/next_time}}{{^next_time}}<span class=\"icon_wrong_big_2 left\"></span><div class=\"\"><h3>{{#_i}}Oops, that\u2019s wrong{{/_i}}</h3>{{#has_solutions}}<div class=\"grade-feedback-new\" {{#solution_translation}} style=\"width: auto\" {{/solution_translation}}><div class=\"correct-solution\" {{#solution_translation}}style=\"width: 260px\"{{/solution_translation}}>{{#judge}}<strong>{{#_i}}Correct {{#pluralize}} translation, translations,{{num_solutions}}{{/pluralize}}{{/_i}}:</strong><ul>{{#correct_solutions}}<li class=\"translation-source translation_source\">{{.}}</li>{{/correct_solutions}}</ul>{{/judge}}{{^judge}}{{^closest_translation}}<strong>{{#_i}}Correct {{#pluralize}} solution, solutions,{{num_solutions}}{{/pluralize}}{{/_i}}:</strong><ul>{{#correct_solutions}}<li class=\"translation-source translation_source\">{{.}}</li>{{/correct_solutions}}</ul>{{/closest_translation}}{{#closest_translation}}{{^display_translation}}<strong>{{#_i}}Correct solution{{/_i}}:</strong><ul><li class=\"translation-source translation_source\">{{closest_translation}}</li></ul>{{/display_translation}}{{#display_translation}}<strong>{{#_i}}Correct solutions{{/_i}}:</strong><ul><li class=\"translation-source translation_source\">{{closest_translation}}</li><li class=\"translation-source translation_source\">{{display_translation}}</li></ul>{{/display_translation}}{{/closest_translation}}{{/judge}}{{#judge}}{{#missed}}<div class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}You missed {{missed}} correct {{#pluralize}} translation, translations, {{missed}}{{/pluralize}}!{{/_i}}</div>{{/missed}}{{/judge}}{{#apo_it}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}Don't forget the apostrophe.{{/_i}}</div>{{/apo_it}}{{#wrong_language}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}You typed in English, not {{#_ivar}}language_name{{/_ivar}}.{{/_i}}</div>{{/wrong_language}}{{#missing}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}You missed a word.{{/_i}}</div>{{/missing}}{{#third-person-number}}{{#additional_info}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span><i>{{correct_source}}</i> se usa para la tercera persona del {{#numberize}}{{correct_number}}{{/numberize}}. Para el {{#numberize}}{{wrong_number}}{{/numberize}}, se usa <i>{{wrong_source}}</i>. </div>{{/additional_info}}{{/third-person-number}}{{#third-person-s}}{{#additional_info}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}\"{{verb}}\" turns into \"{{third}}\" after he/she/it.{{/_i}}</div>{{/additional_info}}{{/third-person-s}}{{#rev-third-person-s}}{{#additional_info}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}\"{{verb}}\" turns into \"{{third}}\" <i>only</i> after he/she/it.{{/_i}}</div>{{/additional_info}}{{/rev-third-person-s}}{{#verb_agr}}{{#additional_info}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}You used the {{wrong_form}} form \"{{wrong_usage}}\" instead of the {{correct_form}} form \"{{correct_usage}}\".{{/_i}}</div>{{/additional_info}}{{/verb_agr}}{{#desadj}}{{#additional_info}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}\"Des\" changes to \"de\" when there is an adjective before the noun.{{/_i}}</div>{{/additional_info}}{{/desadj}}{{#missing_article}}{{#additional_info}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}You need the article \"{{article}}\" here.{{/_i}}</div>{{/additional_info}}{{/missing_article}}{{#possessive_s}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}Pay attention to the apostrophe that means possession here.{{/_i}}</div>{{/possessive_s}}{{#cest}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span> Use \"c'est\" when the noun has an article before it (une, un, le, la, or l'). </div>{{/cest}}{{#he-il}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}Here, the French \"il\" means \"it\", not \"he\".{{/_i}}</div>{{/he-il}}{{#he-ce}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}Here, the French \"c'est\" means \"it is\", not \"he is\".{{/_i}}</div>{{/he-ce}}{{#il-faut}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}The French \"il faut\" means \"it is necessary\" not \"he must\".{{/_i}}</div>{{/il-faut}}{{#iolo}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span> The first person pronoun in Italian is \"io\", not \"lo\". </div>{{/iolo}}{{#del}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#_i}}In Spanish, \"de\" and \"el\" must always combine to \"del\".{{/_i}}</div>{{/del}}{{#tense}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#additional_info}}{{#present_correct}}{{#_i}}You used the past tense \"{{wrong_form}}\" instead of the present tense \"{{correct_form}}\".{{/_i}}{{/present_correct}}{{^present_correct}}{{#_i}}You used the present tense \"{{wrong_form}}\" instead of the past tense \"{{correct_form}}\".{{/_i}}{{/present_correct}}{{/additional_info}}</div>{{/tense}}{{#number}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#additional_info}}{{#sg_correct}}{{#_i}}You used the plural \"{{wrong_form}}\" here, instead of the singular \"{{correct_form}}\".{{/_i}}{{/sg_correct}}{{^sg_correct}}{{#_i}}You used the singular \"{{wrong_form}}\" here, instead of the plural \"{{correct_form}}\".{{/_i}}{{/sg_correct}}{{/additional_info}}</div>{{/number}}{{#vocab}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#additional_info}}{{#_i}}Be careful not to confuse \"{{correct_word}}\" and \"{{wrong_word}}\"!{{/_i}}{{/additional_info}}</div>{{/vocab}}{{#vocab_noun}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#additional_info}}{{#_i}}Be careful not to confuse \"{{correct_word}}\" and \"{{wrong_word}}\"!{{/_i}}{{/additional_info}}</div>{{/vocab_noun}}{{#rev_sie}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#additional_info}}{{#_i}}\"{{sie_usage}}\" is used as the formal \"you\" here, not as \"{{wrong_usage}}\".{{/_i}}{{/additional_info}}</div>{{/rev_sie}}{{#its_es}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#additional_info}}{{^en}}{{#_i}}In English, it is not correct to start a sentence with just \"is\".{{/_i}}{{/en}}{{/additional_info}}</div>{{/its_es}}{{#article_def_indef}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#additional_info}}{{#def_correct}}{{#_i}}You used the indefinite \"{{wrong_form}}\" here, instead of the definite \"{{correct_form}}\".{{/_i}}{{/def_correct}}{{^def_correct}}{{#_i}}You used the definite \"{{wrong_form}}\" here, instead of the indefinite \"{{correct_form}}\".{{/_i}}{{/def_correct}}{{/additional_info}}</div>{{/article_def_indef}}{{#gender}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{^additional_info}}{{#_i}}Pay attention to the gender.{{/_i}}{{/additional_info}}{{#additional_info}}{{#gender_correct}}{{#gender_wrong}}{{#_i}}{{noun}} is {{#genderize}}{{gender_correct}}{{/genderize}}, not {{#genderize}}{{gender_wrong}}{{/genderize}}.{{/_i}}{{/gender_wrong}}{{^gender_wrong}}{{#_i}}Pay attention to the gender.{{/_i}}{{/gender_wrong}}{{/gender_correct}}{{^gender_correct}}{{#gender_wrong}}{{#_i}}Pay attention to the gender.{{/_i}}{{/gender_wrong}}{{^gender_wrong}}{{#_i}}Pay attention to the gender.{{/_i}}{{/gender_wrong}}{{/gender_correct}}{{/additional_info}}</div>{{/gender}}{{#case_gender}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#additional_info}}{{#case_correct}}{{#gender_correct}}{{#_i}}In {{#caserize}}{{case_correct}}{{/caserize}} case, use \"{{article_correct}}\" for {{#genderize}}{{gender_correct}}{{/genderize}} nouns like \"{{noun}}\"{{/_i}}{{/gender_correct}}{{^gender_correct}}{{#_i}}Pay attention to case and gender.{{/_i}}{{/gender_correct}}{{/case_correct}}{{/additional_info}}</div>{{/case_gender}}{{#nom_gender}}<div id=\"blame\" class=\"blame-message\"><span class=\"icon-warning\"></span>{{#additional_info}}{{#_i}}For {{#genderize}}{{gender_correct}}{{/genderize}} nouns like \"{{noun}}\", use \"{{article_correct}}\".{{/_i}}{{/additional_info}}</div>{{/nom_gender}}</div>{{^wrong_language}}{{#solution_translation}}<div id=\"translation\" class=\"translation\"><strong>{{#_i}}Translation{{/_i}}:</strong><ul><li>{{solution_translation}}</li></ul></div>{{/solution_translation}}{{/wrong_language}}</div>{{/has_solutions}}</div>{{>grade-discuss}}{{/next_time}}{{/try_again}}{{/incorrect}}{{/new_player_blame_experiment_true}}{{#new_player_blame_experiment_true}}{{#correct}}{{#mic_off}}{{#message}}<div class=\"big-icon-right\"></div><h3>{{#_i}}Microphone is off{{/_i}}</h3><div class=\"additional-msg\">You can always turn it back on in the settings page.</div>{{/message}}{{/mic_off}}{{^mic_off}}{{#points_per_correct}}<span class=\"trinkit-container\"><span class=\"coin-big\">+1</span><span class=\"stopwatch-big\"><strong>+{{extra_time}}</strong>s</span></span>{{/points_per_correct}}{{^points_per_correct}}<div class=\"big-icon-right\"></div>{{/points_per_correct}}{{^blame}}{{#hover_trial}}<h3>{{#_i}}Good job!{{/_i}}</h3>{{/hover_trial}}{{^hover_trial}}<h3>{{#_i}}You are correct{{/_i}}</h3>{{/hover_trial}}{{/blame}}{{#blame}}<h3>{{#_i}}Woot, you are almost correct.{{/_i}}</h3>{{/blame}}{{#points_per_correct}}<div class=\"additional-msg\">{{#_i}}You got extra time and points. <strong>Hurry!</strong>{{/_i}}</div>{{/points_per_correct}}{{>grade-discuss}}{{/mic_off}}{{/correct}}{{#incorrect}}{{#try_again}}{{#listen}}<div class=\"big-icon-wrong\"></div><h3>{{#_i}}Oops, it doesn't seem to be in {{#_ivar}}language_name{{/_ivar}}.{{/_i}}</h3><div class=\"additional-msg left\">{{#_i}}Please try again.{{/_i}}</div>{{/listen}}{{#speak}}{{#odd}}<h3>{{#_i}}Oops, I couldn\u2019t understand what you said{{/_i}}</h3><div class=\"additional-msg left\">{{#_i}}Please record again (try speaking slower){{/_i}}</div>{{/odd}}{{^odd}}<h3>{{#_i}}I can't hear you very well{{/_i}}</h3><div class=\"additional-msg left\">{{#_i}}Please record again (try speaking slower){{/_i}}</div>{{/odd}}{{/speak}}{{/try_again}}{{^try_again}}{{#next_time}}<h3>{{#_i}}Try again next time!{{/_i}}</h3>{{>grade-discuss}}{{/next_time}}{{^next_time}}<div class=\"big-icon-wrong\"></div>{{#translate}}<h3>{{#_i}}Oops, that\u2019s wrong{{/_i}}</h3>{{/translate}}{{#listen}}<h3>{{#_i}}Oops, that\u2019s wrong{{/_i}}</h3>{{/listen}}{{#form}}<h3>{{#_i}}Oops, that\u2019s wrong{{/_i}}</h3>{{/form}}{{#name}}<h3>{{#_i}}Oops, that\u2019s wrong{{/_i}}</h3>{{/name}}{{#select}}<h3>{{#_i}}Oops, you selected the wrong image{{/_i}}</h3>{{/select}}{{#judge}}{{#judge_one_correct}}{{#judge_one_wrong}}<h3>{{#_i}}Oops you marked 1 wrong translation{{/_i}}</h3>{{/judge_one_wrong}}{{#judge_more_wrong}}<h3>{{#_i}}Oops you marked 2 wrong translations{{/_i}}</h3>{{/judge_more_wrong}}{{/judge_one_correct}}{{^judge_one_correct}}{{#judge_one_wrong}}<h3>{{#_i}}Oops you marked the wrong translation{{/_i}}</h3>{{/judge_one_wrong}}{{#judge_more_wrong}}<h3>{{#_i}}Oops you marked 2 wrong translations{{/_i}}</h3>{{/judge_more_wrong}}{{/judge_one_correct}}{{#judge_missed}}<h3>{{#_i}}Oops you missed 1 correct translation{{/_i}}</h3>{{/judge_missed}}{{/judge}}{{>grade-discuss}}{{/next_time}}{{/try_again}}{{/incorrect}}{{/new_player_blame_experiment_true}}{{/attributes}}{{/session_element}} ","grade-discuss":"{{^session_welcome}}{{^mic_off}}{{^try_again}}<span id=\"show-report-options\" class=\"{{#correct}}{{#has_discussion}}correct-btn-left{{/has_discussion}}{{^has_discussion}}correct-btn-single{{/has_discussion}}{{/correct}}{{#incorrect}}{{#has_discussion}}wrong-btn-left{{/has_discussion}} {{^has_discussion}}wrong-btn-single{{/has_discussion}}{{/incorrect}}\">{{#_i}}Report a Problem{{/_i}}<span class=\"{{#correct}}report-problem-green{{/correct}}{{#incorrect}}report-problem-red{{/incorrect}}\"></span><ul class=\"even-context-menu report-options hidden\" id=\"report-options\">{{#translate}}{{#incorrect}}{{#user_solution}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"accepted\" value=\"My answer should be accepted.\"><label class=\"report-label\" for=\"accepted\">{{#_i}}<b>My answer</b> should be accepted.{{/_i}}</label></li>{{/user_solution}}{{/incorrect}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li>{{#incorrect}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The given answer has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Correct solution\"</b> is unnatural or has an error.{{/_i}}</label></li>{{/incorrect}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"hints\" value=\"The dictionary hints are misleading/incomplete.\"><label class=\"report-label\" for=\"hints\">{{#_i}}<b>The dictionary hints</b> on hover are wrong or missing.{{/_i}}</label></li>{{#has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}{{/translate}}{{#judge}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li>{{#incorrect}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The given answer has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Correct translation\"</b> is unnatural or has an error.{{/_i}}</label></li>{{/incorrect}}{{#has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}{{/judge}}{{#form}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}language_name{{/_ivar}} sentence</b> is unnatural or has an error{{/_i}}</label></li><li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The given answer has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Translation\"</b> is unnatural or has an error.{{/_i}}</label></li>{{#has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}{{/form}}{{#listen}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li><li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}language_name{{/_ivar}} sentence</b> is unnatural or has an error{{/_i}}</label></li><li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The Translation has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Translation\"</b> is unnatural or has an error.{{/_i}}</label></li>{{/listen}}{{#speak}}{{#has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li><li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The Translation has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Translation\"</b> is unnatural or has an error.{{/_i}}</label>{{/speak}}{{#name}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"pictures\" value=\"The pictures do not match the given word.\"><label class=\"report-label\" for=\"pictures\">{{#_i}}<b>The pictures</b> do not match the given word.{{/_i}}</label></li>{{/name}}{{#select}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"pictures\" value=\"The pictures do not match the given word.\"><label class=\"report-label\" for=\"pictures\">{{#_i}}<b>The picture</b> does not match the given word.{{/_i}}</label></li>{{/select}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"free-write\" style=\"position: relative; top: 2px\"><textarea class=\"free-write-box animated-resizing\" type=\"text\" style=\"text-transform: none\" placeholder=\"{{#_i}}Have a different problem? Explain it here.{{/_i}}\"></textarea></li><li><div class=\"clear-fix\" style=\"margin: 9px 0\"><input id=\"submit-problem\" type=\"submit\" class=\"btn primary update-comment\" value=\"{{#_i}}Submit{{/_i}}\" style=\"float: right; margin: 0 23px 0 10px; width: auto\"><input id=\"cancel-report\" type=\"submit\" class=\"btn update-comment\" data-dismiss=\"modal\" value=\"{{#_i}}Cancel{{/_i}}\" style=\"float: right; width: auto\"></div></li></ul></span>{{#has_discussion}}<span id=\"discussion-toggle\" style=\"float:left;\"><a href=\"javascript:;\" {{#correct}}class=\"correct-btn-right\"{{/correct}}{{^correct}}class=\"wrong-btn-right\"{{/correct}}><span class=\"sentence-comments-icon-{{#correct}}green{{/correct}}{{^correct}}red{{/correct}}\"></span>{{#_i}}Discuss sentence{{/_i}} {{#num_comments}}({{num_comments}}){{/num_comments}}</a></span><div id=\"solution-suggested\" class=\"save-message-new solution-submitted\">{{#_i}}Thanks!{{/_i}}</div><span id=\"discussion-modal-container\"></span>{{/has_discussion}}{{/try_again}}{{/mic_off}}{{/session_welcome}}","guidelines":"<h1>{{#_i}}Community Guidelines{{/_i}}</h1><ul class=\"guidelines\"><li><h3>{{#_i}}Duolingo is a global community of language learners{{/_i}}</h3><p>{{#_i}}We believe that everyone should have access to free language education. Our guidelines are meant to build a mutual understanding of what being a part of this community is all about. We will take action if any of these guidelines are not upheld, so please read carefully.{{/_i}}</p></li><li><h3>{{#_i}}Always be Respectful{{/_i}}</h3><p>{{#_i}}We come together from across the world at varying language levels with the same goal in mind - to learn. Curiosity, questioning, and cultural understanding are something we celebrate. Be respectful of others and where they\u2019re coming from.{{/_i}}</p></li><li><h3>{{#_i}}Help and support across all skill levels{{/_i}}</h3> <p>{{#_i}}We are all in this together. Learning a language is hard and takes a lot of courage and dedication. If someone uses incorrect grammar or has a question you think has an obvious answer, kindly and calmly help them out. Heckling and being straight up mean doesn\u2019t help anyone learn. Can\u2019t say it nicely? Don\u2019t weigh in.{{/_i}}</p></li><li><h3>{{#_i}}Embrace and share regional language differences{{/_i}}</h3> <p>{{#_i}}A language can have many words, accents and ways to say the same thing. We think that\u2019s one of the wonders of languages. Approach these conversations with an open mind and attitude.{{/_i}}</p></li><li><h3>{{#_i}}Think before you share{{/_i}}</h3> <p>{{#_i}}We care about your safety. Speaking another language is inherently social, but please don\u2019t swap or post any private information that could be misused. Don\u2019t share your skype name, email, phone number, address or what time you\u2019ll be at home with anyone. Simply put: don\u2019t overshare.{{/_i}}</p></li></ul><h2>{{#_i}}Please don\u2019t use Duolingo to...{{/_i}}</h2><ul class=\"guidelines\"><li><h3>{{#_i}}Make people uncomfortable with your words and actions{{/_i}}</h3> <p>{{#_i}}Duolingo is a safe place to learn a language. Unwanted attention of any kind will not be tolerated, that includes harassment, abuse, stalking, and making sexual remarks. Rule of thumb- if you are making someone feel uncomfortable then you shouldn\u2019t be doing it. We take these reports seriously and will delete your account if such activity is verified by our team.{{/_i}}</p></li><li><h3>{{#_i}}Spam the forum or people\u2019s streams{{/_i}}</h3> <p>{{#_i}}Leaving a trail of irrelevant links in forums or on people\u2019s streams will get your account deleted. We promise.{{/_i}}</p></li><li><h3>{{#_i}}Write inflammatory comments{{/_i}}</h3> <p>{{#_i}}Hateful, obscene and off-topic comments don\u2019t contribute to learning. Cursing doesn\u2019t either (let people discover those words in the wild). Leave them out of the language discussions.{{/_i}}</p></li><li><h3>{{#_i}}To Summarize{{/_i}}</h3> <p>{{#_i}}By following these guidelines we\u2019ll all contribute to building an interesting and helpful language conversation and community. What happens if you can\u2019t follow these guidelines or our <a href=\"#/terms\">terms of service</a>? You might get a notice from us or find your account deleted.{{/_i}}</p><p>{{#_i}}Get in touch with us <a href=\"#/contact\">here</a> with your feedback or questions.{{/_i}}</p></li></ul>","help":"<h1>{{#_i}}Help{{/_i}}</h1><ul class=\"issues\"><li><h3>{{#_i}}How can I navigate lessons with the keyboard?{{/_i}}</h3><table class=\"table table-striped table-test\"><tr><td style=\"width:190px\"><span class=\"key-button\">enter</span></td><td>{{#_i}}Submit your answer, continue onto next screen{{/_i}}</td></tr><tr><td><span class=\"key-button-number\">1</span><span class=\"key-button-number\">2</span><span class=\"key-button-number\">3</span></td><td>{{#_i}}Select multiple choice answers with corresponding numbers{{/_i}}</td></tr><tr><td><span class=\"key-button-arrow\">\u25bc</span><span class=\"key-button-arrow\">\u25b2</span><td>{{#_i}}Move through choices in dropdown list{{/_i}}</td></tr><tr><td><span class=\"key-button\">ctrl</span><span class=\"plus\">+</span><span class=\"key-button\">space</span><td>{{#_i}}Replay audio{{/_i}}</td></tr><tr><td><span class=\"key-button\">ctrl</span><span class=\"plus\">+</span><span class=\"key-button\">shift</span><span class=\"plus\">+</span><span class=\"key-button\">space</span><td>{{#_i}}Replay audio slower{{/_i}}</td></tr></table></li><li><h3>{{#_i}}I have previous experience with a language. How can I skip the basics?</h3> <p>If you have previous experience with a language and feel that lessons are too easy, there are several ways to advance more quickly. To test out of individual skills (e.g. Basics 1), press the button in the top right corner of any skill page that says \u201cTest out of this skill.\u201d If you can pass this test, you will instantly learn the skill.{{/_i}}</p>{{#ui_language_en}}<img class=\"help-image\" src=\"images/help/test-out.jpg\">{{/ui_language_en}}{{#ui_language_es}}<img class=\"help-image\" src=\"images/help/test-out-es.jpg\">{{/ui_language_es}}{{#ui_language_pt}}<img class=\"help-image\" src=\"images/help/test-out-pt.jpg\">{{/ui_language_pt}}<p>{{#_i}}If you would rather test out of many skills at once, you can click on the padlocks found throughout your skill tree on the Home page. Passing this test will unlock all skills in the tree up to that point.{{/_i}}</p><img class=\"help-image\" src=\"images/help/padlock.jpg\"></li>{{^learning_language_en}}<li><h3>How can I add new languages?</h3> <p>Feeling adventurous enough to learn more than one language at a time? Click the flag icon you see in the top left corner of Duolingo and choose an additional language that you would like to learn from the drop down. Adding additional languages will not make you lose progress in existing languages.</p><p>Use this dropdown whenever you want to switch between the languages that you are learning.</p><img class=\"help-image\" src=\"images/help/switch-langs.jpg\"></li>{{/learning_language_en}}<li><h3>{{#_i}}What are skill points and levels?{{/_i}}</h3> <p>{{#_i}}You earn skill points any time you perform a task that improves your language skills. These tasks include finishing a lesson, translating sentences, and rating others\u2019 translations.{{/_i}}</p><p>{{#_i}}You reach new levels once you accumulate the necessary number of skill points for each level. There are currently 25 levels, and you can always see how close you are to reaching the next level on your Home page.{{/_i}}</p>{{#ui_language_en}}<img class=\"help-image\" src=\"images/help/skill-points.jpg\">{{/ui_language_en}}{{#ui_language_es}}<img class=\"help-image\" src=\"images/help/skill-points-es.jpg\">{{/ui_language_es}}{{#ui_language_pt}}<img class=\"help-image\" src=\"images/help/skill-points-pt.jpg\">{{/ui_language_pt}}</li><img class=\"right-float\" src=\"/images/help/confused-owl.jpg\"><li><h3>{{#_i}}My speech input is not working. What can I do?</h3> <p>Duolingo requires the Adobe Flash plugin to accept speech input, so first ensure that you have Flash installed. If Flash is installed but speech input is still not working, try refreshing the web page in your browser. If this does not fix the problem, try closing and reopening the browser. If none of these solutions work, make sure you do not have any browser extensions installed that would block the Flash plugin. Some extensions known to interfere with Flash include Ghostery, Adblock, Flashblock, and DNT.{{/_i}}</p></li><li><h3>{{#_i}}My sound is not working. What can I do?</h3> <p>First, ensure that your volume is turned up and that sound is working properly elsewhere on your computer. If the sound only appears to be broken in Duolingo's lessons, try refreshing the web page in the browser. If this does not fix the problem, try closing and reopening the browser.{{/_i}}<!-- <a href=\"/sm2_diagnostics/sm2-troubleshooting-tool.html\">diagnostic page</a> !--></p></li><div class=\"button-pretext\">{{#_i}}Still unsure about something?{{/_i}}</div><div class=\"centered-button-container\"><button><a href=\"{{#_i}}/#/topic/647{{/_i}}\" id=\"more-padding\" class=\"btn large primary\">{{#_i}}Ask the <strong>Community</strong>{{/_i}}</a></button><div class=\"centered-text\">{{#_i}}<span>or</span>{{/_i}}</div><button onClick=\"Zenbox.show(); return false;\" id=\"more-padding\" class=\"btn large primary\">{{#_i}}Contact Us{{/_i}}</button></div></ol>","hint-verb-table-content":"<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"table table-bordered green-head table-striped verb-table {{language}}\"><thead><tr><th>{{#_i}}Person{{/_i}}</th>{{#tenses}}<th>{{#_ivar}}tense_string{{/_ivar}}</th>{{/tenses}}</tr></thead><tbody>{{#table}}<tr><td class=\"person\"><span>{{pronoun}}</span></td>{{#row}}<td><span>{{{word}}}</span></td>{{/row}}</tr>{{/table}}</tbody></table>{{#more_tables}}<a class=\"more-tenses\" href=\"javascript:;\">{{#_i}}Show more tenses{{/_i}} \u2192</a>{{/more_tables}}","hints-link":"<span class=\"hints-link\"></span>","hints-sentence":"<span class=\"hints-sentence popover-well\"></span>","hints-table":"{{#hint_table}}<span class=\"hint-table popover {{position}} {{#explanation}}animated fadeInUp{{/explanation}}\"><div class=\"arrow\"></div><div class=\"inner\">{{#explanation}}<div class=\"explanation hidden\" style=\"width: 250px; white-space: normal;\"><h4>{{{title}}}</h4><p>{{{details}}}</p><span class=\"btn right dismiss\">{{#_i}}Dismiss{{/_i}}</span></div>{{/explanation}}<div class=\"content\"><table><thead>{{^separable}}<tr>{{#headers}}{{^selected}}<th>{{token}}</th>{{/selected}}{{#selected}}<th class=\"selected\">{{token}}</th>{{/selected}}{{/headers}}</tr>{{/separable}}{{#separable}}<tr><th colspan=\"3\">{{#headers}}{{^selected}}<span>{{token}}</span>{{/selected}}{{#selected}}<span class=\"selected\">{{token}}</span>{{/selected}}{{/headers}}</th></tr>{{/separable}}</thead><tbody>{{#rows}}<tr {{#hide}}class=\"hidden\"{{/hide}}>{{#cells}}<td {{#colspan}}colspan=\"{{colspan}}\"{{/colspan}}>{{#prettify_hint}}{{hint}}{{/prettify_hint}} </td>{{#show_reverse_verb_table}}{{#has_infinitives}}<td class=\"conjugate\"><span class=\"btn primary conjugate-small\" data-infinitives=\"{{infinitives_string}}\">{{#_i}}C{{/_i}}</span></td>{{/has_infinitives}}{{/show_reverse_verb_table}}{{/cells}}</tr>{{/rows}}{{#gender}}<tr><td class=\"gender\" colspan=\"{{max_colspan}}\">{{#_i}}Gender{{/_i}}: <strong>{{#_ivar}}gender{{/_ivar}}</strong></td></tr>{{/gender}}</tbody></table>{{#show_verb_table}}<div class=\"hint-footer\"><div class=\"footer-container\">{{#explanation}}<span class=\"btn conjugate small\">{{#_i}}Conjugate{{/_i}}</span><span class=\"btn primary explain small\">{{#_i}}Explain{{/_i}}</span>{{/explanation}}{{^explanation}}<span class=\"btn primary conjugate small\">{{#_i}}Conjugate{{/_i}}</span>{{/explanation}}</div></div>{{/show_verb_table}}{{^show_verb_table}}{{#explanation}}<div class=\"hint-footer\"><div class=\"footer-container\"><span class=\"btn primary explain small\">{{#_i}}Explain{{/_i}}</span></div></div>{{/explanation}}{{/show_verb_table}}{{#more_hints}}<div class=\"more-hints\"><span class=\"icon-show-more\"></span></div>{{/more_hints}}</div></div></span>{{#render_verb_table_div}}<div class=\"modal verb-table-modal\" style=\"margin-top: -170px; display: none\"><div class=\"close\" data-dismiss=\"modal\"></div><div class=\"modal-body\"></div></div>{{/render_verb_table_div}}{{/hint_table}}","hints-token":"<span class=\"token-wrapper popover-wrapper\">{{^in_link}}<span class=\"{{#is_space}}space{{/is_space}} {{^is_space}}non-space{{/is_space}} token {{class_name}} {{style_classes}}\" id=\"token_{{index}}\" data-token-index=\"{{index}}\">{{#highlighted}}<strong>{{value}}</strong>{{/highlighted}}{{^highlighted}}{{#bold}}<b>{{/bold}}{{value}}{{#bold}}</b>{{/bold}}{{/highlighted}}</span>{{/in_link}}{{#in_link}}<a target=\"_blank\" href=\"{{url}}\"><span class=\"token\" id=\"token_{{index}}\">{{value}}</span></a>{{/in_link}}{{>hints-table}}</span>","hints-token-test":"<span class=\"token-wrapper popover-wrapper\">{{^in_link}}<span class=\"token {{class_name}}\" id=\"token_{{index}}\">{{value}}</span>{{/in_link}}{{#in_link}}<a target=\"_blank\" href=\"{{url}}\"><span class=\"token\" id=\"token_{{index}}\">{{value}}</span></a>{{/in_link}}<span class=\"hint-table popover below\"><div class=\"arrow\"></div><div class=\"inner\"><div class=\"content\"><table border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><td>{{#_i}}You can\u2019t peek in a test!{{/_i}}</td></tr></table></div></div></span></span>","hints-verb-table":"{{#title}}<h2>{{#_i}}Verb{{/_i}}: {{#pre_infinitives}}<a data-infinitive=\"{{.}}\" href=\"javascript:;\">{{.}}</a> / {{/pre_infinitives}}<strong class=\"infinitive-selected\">{{current_infinitive}}</strong>{{#post_infinitives}} / <a data-infinitive=\"{{.}}\" href=\"javascript:;\">{{.}}</a>{{/post_infinitives}}</h2>{{/title}}{{#current_infinitive_data}}<div class=\"infinitive-tab\" data-infinitive=\"{{infinitive}}\"><ul id=\"settings-tab\" class=\"tabs\"><li class=\"active\" data-table=\"indicative\"><a href=\"javascript:;\">{{#_i}}Indicative{{/_i}}</a></li>{{#has_subjunctive}}<li data-table=\"subjunctive\"><a href=\"javascript:;\">{{#_i}}Subjunctive{{/_i}}</a></li>{{/has_subjunctive}}{{#has_conditional}}<li data-table=\"subjunctive\"><a href=\"javascript:;\">{{#_i}}Conditional{{/_i}}</a></li>{{/has_conditional}}{{#has_others}}<li data-table=\"others\"><a href=\"javascript:;\">{{#_i}}Others{{/_i}}</a></li>{{/has_others}}</ul>{{#tables}}<div id=\"indicative-tables\" class=\"verb-tables\">{{#indicative}}{{>hint-verb-table-content}}{{/indicative}}</div><div id=\"subjunctive-tables\" class=\"verb-tables\" style=\"display: none;\">{{#subjunctive}}{{>hint-verb-table-content}}{{/subjunctive}}{{#conditional}}{{>hint-verb-table-content}}{{/conditional}}</div><div id=\"others-tables\" class=\"verb-tables\" style=\"display: none;\">{{#others}}<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"table table-bordered green-head table-striped verb-table others-table {{language}}\"><thead><tr>{{#tenses}}<th><span>{{#_ivar}}tense_string{{/_ivar}}</span></th>{{/tenses}}</tr></thead><tbody>{{#table}}<tr>{{#row}}<td><span>{{{word}}}</span></td>{{/row}}</tr>{{/table}}</tbody></table>{{#more_tables}}<a class=\"more-tenses\" href=\"javascript:;\">{{#_i}}Show more tenses{{/_i}} \u2192</a>{{/more_tables}}{{/others}}</div>{{/tables}}</div>{{/current_infinitive_data}} ","home":"{{#notifications}}{{#reactivated}}<div class=\"embedded-badge home-notification hidden\"><strong class=\"message2\">{{#_i}}Welcome Back!{{/_i}} </strong><span class=\"title\">{{#_i}}Your account has been reactivated.{{/_i}} <span class=\"btn dismiss right\">{{#_i}}Dismiss{{/_i}}</span></span></div>{{/reactivated}}{{^reactivated}}{{#new_tree_change}}<div class=\"embedded-badge home-notification hidden\"><span class=\"added-lessons-badge\">+1</span><strong class=\"message2\">{{#_i}}Notice something different?{{/_i}} </strong><span class=\"title\">{{#_i}}We\u2019ve added new lessons to teach you {{#_ivar}}language_string{{/_ivar}} more effectively.{{/_i}}</span><div data-message=\"new_tree_change\" class=\"close\"></div></div>{{/new_tree_change}}{{#dynamic_trees}}<div class=\"embedded-badge home-notification hidden\"><strong class=\"message\">{{#_i}}Notice something different?{{/_i}} </strong><span class=\"title\">{{#_i}}We\u2019ve upgraded to a more accurate way of tracking your progress.{{/_i}} {{#_i}}<a href=\"http://duolingo.com/#comment/293767\">Learn more</a>.{{/_i}}</span><div data-message=\"dynamic_trees\" class=\"close\"></div></div>{{/dynamic_trees}}{{^dynamic_trees}}{{#chrome_app_ad}}{{#chrome_web_app_notification}}<div class=\"embedded-badge home-notification hidden\"><span class=\"chrome-logo-small\"></span><strong class=\"message2\">{{#_i}}Using Chrome?{{/_i}} </strong><span class=\"title\">{{#_i}}Add Duolingo to your home screen for easy access.{{/_i}} <span class=\"btn dismiss right\" data-message=\"chrome_app_ad\">{{#_i}}Dismiss{{/_i}}</span><span onclick=\"chrome.webstore.install();\" class=\"btn primary right add\" id=\"chrome-install-button\">{{#_i}}Add Duolingo to Chrome{{/_i}}</span></span></div>{{/chrome_web_app_notification}}{{/chrome_app_ad}}{{/dynamic_trees}}{{/reactivated}}{{/notifications}}<div class=\"row\"><div class=\"span10 columns home-left\">{{>skill-tree}}</div><div class=\"span5-5 columns home-right\">{{>profile-side-bar}}</div></div><div id=\"skill-rank-modal\" class=\"modal hide hidden\" style=\"margin-top: -200px;\"></div><div id=\"sentences-rank-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"></div><div id=\"karma-rank-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"></div><div id=\"followers-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"><div class=\"modal-header\"><h4>{{#_i}}Your Followers{{/_i}}</h4><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"></div></div><div id=\"following-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"><div class=\"modal-header\"><h4>{{#_i}}You are following{{/_i}}</h4><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"></div></div> ","hover-element":"<h1>{{#_i}}<strong>Click or hover over the words</strong> to see their translation to {{#_ivar}}target_language_name{{/_ivar}}{{/_i}}</h1><span id=\"session-context\"></span><div class=\"challenge row\"><div class=\"span8 columns\"><span id=\"big-speaker\" class=\"\"></span><h3 class=\" hover-arrow\"><span class=\"big-arrow\"></span><div class=\"hints translation-source\">{{text}}</div></h3></div></div> ","hover-reminder":"<div class=\"intro hover-reminder\"><div class=\"speech-bubble arrow-left hidden\" id=\"bubble-hover-reminder\">{{#_i}}Remember that you can always hover over words to see their translation.{{/_i}}</div><div class=\"owl-peeking-medium\"></div></div> ","info":"{{>about}}<ul class=\"tabs big\"><li class=\"active\" data-tab=\"info\"><a href=\"javascript:;\">{{#_i}}Info{{/_i}}</a></li><li data-tab=\"contacts\"><a href=\"javascript:;\">{{#_i}}Contact{{/_i}}</a></li><li data-tab=\"resources\"><a href=\"javascript:;\">{{#_i}}Resources{{/_i}}</a></li></ul><ul id=\"info-panel\" class=\"about-list panel hidden\"><li><div class=\"inner\"><h3>{{#_i}}How can Duolingo be free?{{/_i}}</h3><p>{{#_i}}Learning languages in Duolingo is completely free \u2013 now and forever \u2013 with no ads or hidden fees. Wondering how that can be? It\u2019s because you create value by translating real-world documents while you\u2019re learning.{{/_i}}</p><p>{{#_i}}Here\u2019s how it works: Somebody who needs a webpage translated uploads it to Duolingo. That document then gets presented to Duolingo students who can translate it in order to practice the language they are learning. When the document is fully translated, Duolingo returns it to the original content owner who, depending on the type of document they uploaded, pays for the translation.{{/_i}}</p></div></li><li><div class=\"inner\"><h3>{{#_i}}Who is building Duolingo?{{/_i}}</h3><h4 class=\"group\">{{#_i}}Animals{{/_i}}</h4><p class=\"group\"><a href=\"/#/omicron\">Omicron,</a> <a href=\"/#/codythepuppy\">Cody</a></p><h4 class=\"group\">{{#_i}}CEO{{/_i}}</h4><p class=\"group\"><a href=\"/#/luis\">Luis von Ahn</a></p><h4 class=\"group\">{{#_i}}CTO{{/_i}}</h4><p class=\"group\"><a href=\"/#/severin\">Severin Hacker</a></p><h4 class=\"group\">{{#_i}}Community{{/_i}}</h4><p class=\"group\"><a href=\"/#/kristinemc\">Kristine Michelsen-Correa</a></p><h4 class=\"group\">{{#_i}}Design{{/_i}}</h4><p class=\"group\"><a href=\"/#/naut\">Marcel Uekermann,</a> <a href=\"/#/rstaake\">Ryan Staake,</a> <a href=\"/#/tylrmurphy\">Tyler Murphy,</a> <a href=\"/#/GregoryHartman\">Gregory Hartman</a></p><h4 class=\"group\">{{#_i}}Engineering{{/_i}}</h4><p class=\"group\"><a href=\"/#/tony\">Tony Navas,</a> <a href=\"/#/vicki\">Vicki Cheung,</a> <a href=\"/#/bren\">Brendan Meeder,</a> <a href=\"/#/hector\">Hector Villafuerte,</a> <a href=\"/#/DavidK\">David Klionsky,</a> <a href=\"/#/karint\">Karin Tsai,</a> <a href=\"/#/bchan\">Brooke Chan,</a> <a href=\"/#/mstreeter\">Matt Streeter,</a> <a href=\"/#/tatou\">Burr Settles,</a> <a href=\"/#/erdnuss\">Antonia Scheidel</a></p><h4 class=\"group\">{{#_i}}Finance{{/_i}}</h4><p class=\"group\"><a href=\"/#/jose\">Jose Fuentes</a></p><h4 class=\"group\">{{#_i}}Language Experts{{/_i}}</h4><p class=\"group\"><a href=\"/#/julika\">Julika Lomas,</a> <a href=\"/#/remy\">R\u00e9my Marechal,</a> <a href=\"/#/myra\">Myra Awodey,</a> <a href=\"/#/Ker\">Kerley Tolpolar,</a> <a href=\"/#/pamec\">Pamela Cardona,</a> <a href=\"/#/mukkapazza\">Monica Raffaelli</a></p><h4 class=\"group\">{{#_i}}Marketing{{/_i}}</h4><p class=\"group\"><a href=\"/#/tarasuan\">Tara Suan</a></p><h4 class=\"group\">{{#_i}}Operations{{/_i}}</h4><p class=\"group\"><a href=\"/#/annchop\">Anna Victoria</a></p></div></li><li><div class=\"inner\"><h3>{{#_i}}Are we hiring?{{/_i}}</h3><p>{{#_i}}Absolutely! We're always looking to hire amazing computer scientists, designers and language specialists.{{/_i}}</p><p>{{#_i}}A full list of open positions, is available at <a href=\"/#/jobs\">duolingo.com/#/jobs</a>.{{/_i}}</p><h3 style=\"margin-top: 40px;\">{{#_i}}Who has invested in us?{{/_i}}</h3><div class=\"investor-imgs\"><a href=\"http://www.usv.com\"><img class=\"investor-img\" style=\"height: 50px;\" src=\"/images/about/usv.jpg\"></a><a href=\"http://twitter.com/aplusk\"><img style=\"position:relative; top:3px\" class=\"investor-img\" src=\"/images/about/ashton.jpg\"></a><a href=\"http://twitter.com/tferriss\"><img style=\"position:relative; top:3px\" class=\"investor-img\" src=\"/images/about/tim.jpg\"></a><a href=\"http://www.nea.com\"><img class=\"investor-img\" src=\"/images/about/nea.jpg\"style=\"position:relative; left: -6px\"></a></div></div></li></ul><ul id=\"contacts-panel\" class=\"about-list panel hidden\"><li><div class=\"inner\"><h3>{{#_i}}Help!{{/_i}}</h3><p>{{#_i}}If you have problems related to navigation or using the site check out <a href=\"/#/help\">duolingo.com/#/help</a>. You can also browse other users' questions and ask for help at <a href=\"/#/discussion\">duolingo.com/#/discussion</a>.{{/_i}}</p><img class=\"about-duo\" src=\"/images/about/help-duo.jpg\"><div class=\"about-email-cluster\">{{#_i}}Email our support team:{{/_i}}<br /><a class=\"about-email\" href=\"mailto:support@duolingo.com\">support@duolingo.com</a></div></div></li><li><div class=\"inner\"><h3>{{#_i}}Media inquiries{{/_i}}</h3><p>{{#_i}}The info tab above has information about who we are, and the resources tab has images of our logo, mascot, and screenshots that you can use for press articles.{{/_i}}</p><img class=\"about-duo\" src=\"/images/about/press-duo.jpg\"><div class=\"about-email-cluster\">{{#_i}}Email our press team:{{/_i}}<br /><a class=\"about-email\" href=\"mailto:press@duolingo.com\">press@duolingo.com</a></div></div></li></ul><div id=\"resources-panel\" class=\"resources-wrapper panel hidden\"><h3>{{#_i}}Branding{{/_i}}</h3><a class=\"resource-cluster\" href=\"/images/about/resources/duolingo-logo.pdf\"><img class=\"resource-thumb\" src=\"/images/about/duolingo-logotype-thumb.jpg\"><strong>{{#_i}}Duolingo Logotype{{/_i}}</strong><div class=\"resource-subtext\">PDF</div></a><a class=\"resource-cluster\" href=\"/images/about/resources/duolingo-owl.png\"><img class=\"resource-thumb\" src=\"/images/about/duolingo-owl-thumb.jpg\"><strong>{{#_i}}Duolingo Owl{{/_i}}</strong><div class=\"resource-subtext\">PNG</div></a><a class=\"resource-cluster\" href=\"/images/about/resources/duolingo-banner.png\"><img class=\"resource-thumb\" src=\"/images/about/duolingo-banner-thumb.jpg\"><strong>{{#_i}}Duolingo Banner{{/_i}}</strong><div class=\"resource-subtext\">PNG</div></a><h3 style=\"margin-top:50px\">{{#_i}}Screenshots{{/_i}}</h3><a class=\"resource-cluster\" href=\"/images/about/resources/skill-tree.png\"><img class=\"resource-thumb\" src=\"/images/about/skill-tree-thumb.jpg\"><strong>{{#_i}}Duolingo Skill Tree{{/_i}}</strong><div class=\"resource-subtext\">PNG</div></a><a class=\"resource-cluster\" href=\"/images/about/resources/player-1.png\"><img class=\"resource-thumb\" src=\"/images/about/player-1-thumb.jpg\"><strong>{{#_i}}Translation Session{{/_i}}</strong><div class=\"resource-subtext\">PNG</div></a><a class=\"resource-cluster\" href=\"/images/about/resources/player-2.png\"><img class=\"resource-thumb\" src=\"/images/about/player-2-thumb.jpg\"><strong>{{#_i}}Photo Challenge{{/_i}}</strong><div class=\"resource-subtext\">PNG</div></a></div>","info-element":"<h1>{{#_i}}<strong>Tell us</strong> your {{variable_list}}{{/_i}}</h1><div class=\"challenge row\">{{#fields}}<div class=\"column span4\" style=\"position: relative;\"><label class=\"welcome-info-label\" for=\"{{.}}-input\">{{#_ivar}}.{{/_ivar}}</label><input style=\"width: 200px\" class=\"xlarge one-line-input\" id=\"{{.}}-input\" name=\"{{.}}\" size=\"30\" type=\"text\"></div>{{/fields}}</div><div class=\"row\" style=\"margin: 20px 0 0 -20px;\"><div class=\"column span8\"><p>{{#_i}}We use this information to teach you basic greetings.<br/>We will also save it on your profile.{{/_i}}</p></div></div>","intro-1":"<div class=\"intro screen-1\">{{^choose_language}}<h1>{{#_i}}Welcome to Duolingo!{{/_i}}</h1><h2>{{#_i}}Let's get started.{{/_i}}</h2><div class=\"owl-flying\"></div>{{/choose_language}}{{#choose_language}}<div class=\"bottom select-language\"><div class=\"owl-cutoff-standard-big\"></div><h1>{{#_i}}Welcome to <strong>Duolingo!</strong>{{/_i}}</h1><h2>{{#_i}}Which language do you want to learn first?{{/_i}}<select class=\"medium\" name=\"learning_language\" id=\"learning-language\" style=\"width: 230px;\"><option disabled=\"disabled\" selected>{{#_i}}Choose language{{/_i}}</option>{{#available_languages}}<option value=\"{{key}}\" data-language=\"{{learning_language_name}}\">{{i_want_to_learn}} {{learning_language_name}} {{^from_ui}}{{from_info}}{{/from_ui}}</option>{{/available_languages}}</select></h2></div>{{/choose_language}}</div> ","intro-2":"<div class=\"intro screen-1\"><div class=\"top\"><div class=\"sky-with-sun\"></div><div class=\"cloud small\" style=\"left: 40px; top: 40px\"></div><div class=\"cloud medium\" style=\"right: 40px; top: 40px\"></div></div><div class=\"bottom\"><h1>Well done so far</h1><h2>Now learn how to introduce yourself.</h2><div class=\"owl-standing-big\"></div><div class=\"ground-full-width\"></div></div></div>","intro-hover":"<div class=\"intro screen-2\"><div class=\"top\"><div class=\"speech-bubble arrow-right hidden\" id=\"bubble-hover\">{{#_i}}You can always hover over words to see their translation.{{/_i}}</div><div class=\"owl-standing-big pointing\" style=\"right: 50px; top: 130px;\"></div></div></div>","intro-speak":"<div class=\"intro screen-2\"><div class=\"top\"><div id=\"speak-instruction\" class=\"speech-bubble hidden arrow-right\">{{#_i}}<strong>Fancy!</strong><br/>You have configured your microphone.{{/_i}}</div><div id=\"speak-mic-off\" class=\"speech-bubble hidden arrow-right\">{{#_i}}You have turned off your microphone. You can always turn it back on in settings.{{/_i}}</div><div class=\"owl-standing-big pointing\" style=\"right: 50px; top: 130px;\"></div></div></div>","intro-speak-2":"<div class=\"intro screen-2\"><div class=\"top\"><div class=\"record-arrow\"></div><div class=\"owl-standing-big\" style=\"right: 50px; top: 130px;\"></div></div></div>","intro-translate":"<div class=\"intro screen-3\"><div class=\"top\"><div class=\"speech-bubble arrow-right hidden\" id=\"bubble-translate\">{{#_i}}At Duolingo you learn by translating snippets of text.{{/_i}}</div><div class=\"speech-bubble arrow-right hidden\" id=\"bubble-hover-reminder\">{{#_i}}Remember that you can always hover over words to see their translation.{{/_i}}</div><div class=\"speech-bubble arrow-right hidden\" id=\"bubble-enter-reminder\">{{#_i}}You can use the keyboard for most things. Try hitting Enter instead of clicking check.{{/_i}}</div><div class=\"owl-standing-big\" style=\"right: 50px; top: 130px;\"></div></div></div>","invite-friend":"<h4>{{#_i}}Invite friends{{/_i}}</h4>{{#invites}}<div id=\"invite-box\" class=\"gray-box\"><p class=\"left grayDark\">{{#_i}}Give Duolingo to:{{/_i}}</p><p class=\"invites-left\"><span class=\"icon-heart-small\"></span>{{#_i}}<span id=\"invites-left\">{{invites_left}}</span> {{#pluralize}}invite,invites,{{invites_left}}{{/pluralize}} left{{/_i}}</p><div class=\"form-row\"><label for=\"invite-email\">{{#_i}}Email address{{/_i}}</label><input class=\"large left\" id=\"invite-email\" name=\"invite_email\" size=\"30\" type=\"text\" {{^invites_left}}disabled=\"disabled\"{{/invites_left}}><input id=\"send-invite\" type=\"submit\" class=\"btn primary\" value=\"{{#_i}}Send invite{{/_i}}\" {{^invites_left}}disabled=\"disabled\"{{/invites_left}}></div>{{#extra_invites}}<p>{{#_i}}You received {{extra_invites}} additional {{#pluralize}}invite,invites,{{extra_invites}}{{/pluralize}} because {{#short_list}}{{#invited}}<a href=\"#/{{username}}\">{{username}}</a>,{{/invited}}{{/short_list}} signed up.{{/_i}}</p>{{/extra_invites}}<p class=\"send-notification hidden\"><strong>{{#_i}}Invite sent to:{{/_i}}</strong> <span id=\"invited-email\"></span></p><p id=\"already-joined\" class=\"error hidden\">{{#_i}}This user has already signed up to Duolingo.{{/_i}}</p><p id=\"not-email\" class=\"error hidden\">{{#_i}}Please enter one valid email address at a time.{{/_i}}</p></div>{{/invites}} ","jobs":" <div class=\"row\"><div class=\"span12 columns\"><div class=\"owl-exalted\"></div><h1>We are hiring</h1><h2>Help us build a world with free <br/>education and no language barriers.</h2></div></div><div class=\"row\"><div class=\"span6 columns\"><div class=\"list-jobs-box\"><h3>Open positions</h3><ul class=\"list-jobs\">{{#jobs}}<li><a href=\"{{url}}\"><h4>{{title}}</h4><p>{{{short}}}</p></a></li>{{/jobs}}</ul></div></div><div class=\"span6 columns benefits\"><hr class=\"puzzle\"/><h3>Some of our benefits</h3><ul><li>Competitive salaries and generous equity</li><li>Complete health, dental, and vision insurance <br/> (100% for employee, 50% for dependents)</li><li>20 days of paid time off \u2013 we don\u2019t actually count</li><li>Are you a night owl? We have flexible hours</li><li>Daily catered lunch, snacks and drinks</li><li>Gym membership reimbursement</li></ul><hr class=\"puzzle\"/></div></div> ","judge-element":"<h1>{{#_i}}<strong>Mark <i>all</i></strong> correct translations{{/_i}}</h1><h3 class=\"clearfix\"><div id=\"big-speaker\"></div><span onclick=\"jQuery(this).prev().click();\">{{text}}</span></h3><ul class=\"judge-items {{#new_player_blame_experiment_true}}new{{/new_player_blame_experiment_true}}\">{{#sentences}}<li class=\"item clearfix\"><label for=\"sentence-{{i}}\" class=\"judge-sentence\"><span class=\"cb-container-long\"><span class=\"cb-number\">{{#from_index}}{{i}}{{/from_index}}</span><span class=\"cb\"><input id=\"sentence-{{i}}\" name=\"sentence-{{i}}\" type=\"checkbox\" class=\"judge\" tabindex=\"{{tabindex}}\"/></span></span>{{sentence}}</label></li>{{/sentences}}</ul>","karma-rank-modal":"<div class=\"modal-header\"><h4 style=\"margin: 0 0 10px 0;\">{{#_i}}Karma rank{{/_i}}</h4><p style=\"margin: 0 0 -5px 0;\" class=\"grayDark\">{{#_i}}{{#current_user}}You follow {{/current_user}}{{^current_user}}{{username}} follows {{/current_user}} {{num_following}} {{#pluralize}}person,people,{{num_following}}{{/pluralize}} and {{#current_user}}are{{/current_user}}{{^current_user}}is{{/current_user}} ranked {{#ranked_number}}{{karma_rank}}{{/ranked_number}} compared to them.{{/_i}}</p><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"><div class=\"list-users-small-legend\"><span class=\"karma-icon-small\"></span></div><ul class=\"list-users-small\">{{#karma_ranking_data}}<li {{#self}}class=\"self\"{{/self}}><span class=\"position\">{{rank}}.</span>{{>avatar_small}}<a href=\"#/{{username}}\" class=\"user\">{{username}}</a><span class=\"sentences-translated\">{{karma}}</span></li>{{/karma_ranking_data}}</ul></div>","language_og":"<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\" ><html><head prefix=\"og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# {{facebook_app_ns}}: http://ogp.me/ns/fb/{{facebook_app_ns}}#\"><meta property=\"fb:app_id\" content=\"{{facebook_app_id}}\" /><meta property=\"og:type\" content=\"{{facebook_app_ns}}:language\" /><meta property=\"og:url\" content=\"http://duolingo.com/og{{#facebook_debug}}_debug{{/facebook_debug}}/{{language}}\" /><meta property=\"og:title\" content=\"{{#_ivar}}language_string_title{{/_ivar}}\" /><meta property=\"og:description\" content=\"{{language_description}} {{#_i}}With Duolingo you learn {{#_ivar}}language_string{{/_ivar}} for free while helping to translate the Web.{{/_i}}\" /><meta property=\"og:image\" content=\"http://static.duolingo.com/images/facebook/languages/{{language}}_owl.png\" /><meta property=\"og:locale\" content=\"{{locale}}\" />{{#available_locales}}<meta property=\"og:locale:alternate\" content=\"{{.}}\" />{{/available_locales}}<script type=\"text/javascript\"> window.location = \"//www.duolingo.com\" </script></head></html> ","leaderboard":"<div class=\"header\"><strong>{{^invite_fb_friends}}{{^search_friends}}{{^invite_friends}}{{^num_following}}{{#_i}}Compete with your friends{{/_i}}{{/num_following}}{{#num_following}}{{#_i}}Leaderboard{{/_i}}{{/num_following}}{{/invite_friends}}{{/search_friends}}{{/invite_fb_friends}}{{#invite_fb_friends}}{{#_i}}Invite friends from Facebook{{/_i}}{{/invite_fb_friends}}{{#search_friends}}{{#_i}}Search for other learners{{/_i}}{{/search_friends}}{{#invite_friends}}{{#_i}}Invite friends by email{{/_i}}{{/invite_friends}}</strong><!-- <a href=\"javascript:;\" class=\"toggle-search\"><span class=\"icon-search\"></span></a> --></div><div class=\"white-inset-box\"><div id=\"search-friends\" class=\"board hidden\"><div class=\"search-users global-search\"><div class=\"form-row no-margin\"><button class=\"btn primary right search-user-button\">{{#_i}}Search{{/_i}}</button><input id=\"search-input\" type=\"text\" class=\"search search-user\"/><label for=\"search-input\">{{#_i}}Name or Email{{/_i}}</label><span class=\"magnify\"></span></div></div><ul class=\"list-users global-search-list\"></ul></div><div id=\"fb-friends\" class=\"hidden board\"><div class=\"search-users\"><div class=\"form-row no-margin\"><input id=\"filter-fb-input\" type=\"text\" class=\"search\"/><label for=\"filter-fb-input\">{{#_i}}Search friends{{/_i}}</label><span class=\"magnify\"></span></div></div><ul class=\"list-users fake\">{{#fb_friends}}<li><div class=\"medium-circular-avatar\"><img src=\"{{#picture}}{{#data}}{{url}}{{/data}}{{/picture}}\"></div><div class=\"action\">{{#installed}}<button class=\"follow-button btn {{#is_following}}success{{/is_following}}\" data-toggle=\"follow\" data-user=\"{{user_id}}\" data-follow-text=\"{{#_i}}Follow{{/_i}}\" data-unfollow-text=\"{{#_i}}Unfollow{{/_i}}\" data-silent=\"true\">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</button>{{/installed}}{{^installed}}<button class=\"btn primary invite-fb-friend\" data-user=\"{{id}}\" data-toggle=\"facebook-invite\" data-track-from=\"home leaderboard\" data-name=\"{{#_i}}You're Invited to Join Duolingo!{{/_i}}\" data-description=\"{{#_i}}With Duolingo you learn a language for free, while helping to translate the web.{{/_i}}\" data-sent=\"{{#_i}}Invite sent{{/_i}}\">{{#_i}}Invite{{/_i}}</button>{{/installed}}</div><strong class=\"user grayDark\">{{name}}</strong></li>{{/fb_friends}}</ul></div><div id=\"points-ranking\" class=\"board\"></div><ul class=\"invite-action\"><li class=\"facebook friend-via\"><a href=\"javascript:;\" class=\"btn {{^invite_fb_friends}}{{^search_friends}}{{^invite_friends}}{{^num_following}}primary{{/num_following}}{{/invite_friends}}{{/search_friends}}{{/invite_fb_friends}} large fb-connect\">{{#_i}}Find {{#num_following}}more{{/num_following}} friends on Facebook{{/_i}}</a></li><li class=\"email friend-via\"><a href=\"javascript:;\" class=\"btn large email-icon\">{{#_i}}Invite friends to learn together{{/_i}}</a></li></ul><div class=\"go-back hidden\"><a href=\"javascript:;\">\u2190 {{#_i}}Show leaderboard{{/_i}}</a></div><div id=\"invite-box\" class=\"board hidden\"><div class=\"invite-users form-row\" style=\"margin-bottom: 0;\"><div class=\"close\"></div><h5>{{#_i}}Send a personal invite email{{/_i}}</h5><div class=\"form-row\"><button class=\"btn primary right send-invite\">{{#_i}}Send invite{{/_i}}</button><input id=\"invite-email\" type=\"text\" class=\"invite\"/><label for=\"invite-email\">{{#_i}}Email address{{/_i}}</label></div><p class=\"send-notification grayDark hidden\"><strong>{{#_i}}Invite sent to:{{/_i}}</strong> <span id=\"invited-email\"></span></p><p id=\"already-joined\" class=\"error hidden\">{{#_i}}This user has already signed up to Duolingo as <a class=\"user-link\"></a>.{{/_i}}</p><p id=\"not-email\" class=\"error hidden\">{{#_i}}Please enter one valid email address at a time.{{/_i}}</p>{{#num_invited}}{{#invites}}<p>{{#_i}}Out of the people you invited, {{#short_list}}{{#invited}}<a href=\"#/{{username}}\">{{username}}</a>,{{/invited}}{{/short_list}} signed up.{{/_i}}</p>{{/invites}}{{/num_invited}}{{^num_invited}}<p>{{#_i}}Fill in your friends\u2019 email addresses and we\u2019ll send them a personal invite.{{/_i}}</p>{{/num_invited}}</div></div></div> ","leaderboard-list":"{{#friends}}<li>{{>avatar_medium}}<!-- <span class=\"skill-points\"><span class=\"small-coin\"></span>{{learning_language_points}}</span> --><div class=\"action\"><button class=\"follow-button btn {{#is_following}}success{{/is_following}}\" data-toggle=\"follow\" data-user=\"{{id}}\" data-follow-text=\"{{#_i}}Follow{{/_i}}\" data-unfollow-text=\"{{#_i}}Unfollow{{/_i}}\">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</button></div><a href=\"#/{{username}}\" class=\"user\">{{username}}</a></li>{{/friends}}{{^friends}}<li class=\"none\" style=\"padding: 0; text-align: center;\"><i>{{#_i}}No users found.{{/_i}}</i></li>{{/friends}}{{#more}}<li style=\"text-align: center; padding: 0; background: #f5f5f5;\"><a href=\"javascript:;\" class=\"btn load-more\">load more</a></li>{{/more}}","leaderboard-ranking":"{{^num_following}}<ul class=\"list-users fake\"><li class=\"self\"><span class=\"position\">1</span>{{>avatar_medium}} <strong class=\"grayDark\">{{username}}</strong><span class=\"skill-points\"><span class=\"small-coin\"></span>{{points}}</span></li><li><span class=\"default-avatar\"><img src=\"/images/avatars/avatar_medium.png\"/></span><span class=\"overlay\"></span> <strong class=\"grayDark user\">{{#_i}}Learner{{/_i}} 2 <span class=\"sub\">{{#_i}}Add your friends here{{/_i}}</span></strong></li><li><span class=\"default-avatar\"><img src=\"/images/avatars/avatar_medium.png\"/></span><span class=\"overlay\"></span> <strong class=\"grayDark user\">{{#_i}}Learner{{/_i}} 3 <span class=\"sub\">{{#_i}}It\u2019s more fun!{{/_i}}</span></strong></li></ul>{{/num_following}}{{#num_following}}<ul class=\"list-users\">{{#points_ranking_data}}<li class=\"{{#self}}self{{/self}}\"><span class=\"position\">{{rank}}</span>{{>avatar_medium}}<span class=\"skill-points\" data-user=\"{{id}}\"><span class=\"small-coin\"></span>{{#points_data}}{{total}}{{/points_data}}</span>{{#self}}<strong class=\"grayDark user\">{{username}}</strong>{{/self}}{{^self}}<a href=\"#/{{username}}\" class=\"user\">{{username}}</a>{{/self}}</li>{{/points_ranking_data}}</ul>{{#points_ranking_data}}<div id=\"points-breakdown-{{id}}\" class=\"popover lesspadding points-breakdown black top right\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><ul class=\"\">{{#points_data}}{{#languages}}{{#points}}<li><span class=\"gold-coin\"></span><strong class=\"points\">{{points}}</strong><span class=\"text\">{{language_string}}</span></li>{{/points}}{{/languages}}<li class=\"weekly-progress\"><span class=\"activity\"></span><strong class=\"points\">{{#weekly}}+{{weekly}}{{/weekly}}{{^weekly}}+0{{/weekly}}</strong><span class=\"text\">{{#_i}}Points this week{{/_i}}</span></li>{{/points_data}}</ul></div></div></div>{{/points_ranking_data}}<!-- <div class=\"add-more-friends\"><span class=\"default-avatar\"><img src=\"/images/avatars/avatar_medium.png\"/></span><strong class=\"grayDark\">{{#_i}}Add more friends here{{/_i}}!</strong><br/>{{#_i}}Learning is more effective together{{/_i}}</div> -->{{/num_following}}","lemma-row":"{{#forms_data}}<tr {{#first}}class=\"first-lemma-row\"{{/first}}>{{#first}}<td rowspan=\"{{num_forms}}\" style=\"background: white;\" class=\"col-lemma\"><a href=\"/#/word/{{language}}/{{lemma_value}}/{{pos_key}}\" class=\"lemma\">{{lemma_surface_form}}</a></td>{{/first}}<td class=\"lexeme\"><span class=\"lexeme-form\">{{surface_form}}</span> {{#gender}}<span class=\"gender\">({{gender}})</span>{{/gender}}</td><td><span id=\"{{lexeme_id}}-skill\"></span></td><td>{{last_practiced}}</td><td><ul class=\"word-strength small\"><li class=\"filled\"></li><li {{#strength_s}}class=\"filled\"{{/strength_s}}></li><li {{#strength_m}}class=\"filled\"{{/strength_m}}></li><li {{#strength_l}}class=\"filled\"{{/strength_l}}></li></ul></td></tr>{{/forms_data}}","lesson-event":"{{#user}}{{>avatar_medium}}{{/user}}<ul class=\"point-gain-box\"><li><span class=\"icon-star-small\"></span><span class=\"skill-points-small\">+{{total_improvement}}</span></li></ul><h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#just_one}}{{#_i}}did {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} lesson{{/_i}}{{/just_one}}{{^just_one}}{{#_i}}did {{count}} {{#_ivar}}language_string{{/_ivar}} lessons{{/_i}}{{/just_one}}</h5> ","level-event":"{{#user}}{{>avatar_medium}}{{/user}}<span class=\"level-badge right\"><span class=\"level\">{{#_ivar}}language_string{{/_ivar}} <strong>{{#_i}}Level{{/_i}}</strong></span> <span class=\"star\">{{new_level}}</span></span><h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#_i}}leveled up in{{/_i}} {{#_ivar}}language_string{{/_ivar}}</h5><div class=\"stream-comments {{^has_comments}}hidden{{/has_comments}}\"></div>{{>event-footer}}","level_og":"<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\" ><html><head prefix=\"og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# {{facebook_app_ns}}: http://ogp.me/ns/fb/{{facebook_app_ns}}#\"><meta property=\"fb:app_id\" content=\"{{facebook_app_id}}\" /><meta property=\"og:type\" content=\"{{facebook_app_ns}}:level\" /><meta property=\"og:url\" content=\"http://duolingo.com/og{{#facebook_debug}}_debug{{/facebook_debug}}/{{language}}/{{level}}\" /><meta property=\"og:title\" content=\"{{#_ivar}}language_string_title{{/_ivar}} \u2014 {{#_i}}Level {{level}}{{/_i}}\" /><meta property=\"og:description\" content=\"{{#_i}}With Duolingo you learn a language for free while helping to translate the Web.{{/_i}}\" /><meta property=\"og:image\" content=\"http://static.duolingo.com/images/facebook/levels/{{level}}.png\" /><meta property=\"{{facebook_app_ns}}:level\" content=\"{{level}}\" /><meta property=\"{{facebook_app_ns}}:language\" content=\"http://duolingo.com/og{{#facebook_debug}}_debug{{/facebook_debug}}/{{language}}\" /><meta property=\"og:locale\" content=\"{{locale}}\" />{{#available_locales}}<meta property=\"og:locale:alternate\" content=\"{{.}}\" />{{/available_locales}}<script type=\"text/javascript\"> window.location = \"//www.duolingo.com\" </script></head></html>","listen-element":"<h1>{{#_i}}Listen and <strong>type in {{#_ivar}}language_name{{/_ivar}}</strong>{{/_i}}</h1>{{#need_flash}}<div class=\"alert-message warning\"><a class=\"close\" href=\"javascript:;\">\u00d7</a><p>{{#_i}}You need Flash version 10+ to hear the words.{{/_i}} <a href=\"http://www.adobe.com/go/getflashplayer\" target=\"_blank\">{{#_i}}Download the latest version here.{{/_i}}</a></p></div>{{/need_flash}}<div class=\"row\"><div class=\"span2 columns\"><div id=\"big-speaker\"></div></div><div class=\"span8 columns relative\">{{>blame-popover}}<input class=\"one-line-input\" id=\"word-input\" name=\"word-input\" size=\"30\" type=\"text\" lang=\"{{language}}\" value=\"\" tabindex=\"1\" /><div id=\"vkeyboard-placeholder\"></div><div class=\"button-vkeyboard\" id=\"toggle_vkeyboard\"></div>{{#new_player_blame_experiment_true}}<div id=\"correct-solutions\" class=\"correct-solution-box\"></div>{{/new_player_blame_experiment_true}}</div></div>","logged-out-message":"<div class=\"owl\"></div><div class=\"message\"><a href=\"/#\" class=\"btn primary right\" id=\"join\">{{#_i}}Join Duolingo{{/_i}}</a>{{#username}}<p>{{#_i}}Hey! {{username}} is using <strong>Duolingo</strong> to learn languages for free while helping to translate the web.{{/_i}}</p>{{/username}}{{^username}}{{#language}}<p>{{#_i}}With <strong>Duolingo</strong> you can learn {{#_ivar}}language{{/_ivar}} for free! It's fun and effective.{{/_i}}</p>{{/language}}{{^language}}<p>{{#_i}}With <strong>Duolingo</strong> you can learn languages for free! It's fun and effective.{{/_i}}</p>{{/language}}{{/username}}</div>","login":" <div class=\"center-pane\"><form action=\"/login\" method=\"post\" id=\"login-form\"><input type=\"hidden\" name=\"came_from\" value=\"{{came_from}}\"/><fieldset class=\"clearfix\"><h1>{{#_i}}<span>Login</span>{{/_i}}</h1><h3>{{#_i}}You need to log in to view this page.{{/_i}}</h3><ul class=\"login-signup-list\"><li><label for=\"login\">{{#_i}}Username or email{{/_i}}</label><input class=\"large\" id=\"login\" name=\"login\" size=\"30\" type=\"text\"><div id='message' class=\"error-flag\"></div></li><li><label for=\"password\">{{#_i}}Password{{/_i}}</label><input class=\"large\" id=\"password\" name=\"password\" size=\"30\" type=\"password\"></li><li><input id=\"login-button\" type=\"submit\" class=\"btn large primary\" style=\"width: 288px;\" value=\"{{#_i}}Login{{/_i}}\"/></li><li><a href=\"/#/forgot_password\" class=\"forgot-password\">{{#_i}}forgot password?{{/_i}}</a></li></ul></fieldset></form></div> ","master-event":"{{#user}}{{>avatar_medium}}{{/user}}<ul class=\"skill-grid-small\">{{#skills}}<li id=\"event-skills-{{id}}\"></li>{{/skills}}</ul><h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#_i}}mastered {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} skill{{/_i}}</h5><div class=\"stream-comments {{^has_comments}}hidden{{/has_comments}}\"></div>{{>event-footer}}","menu":"<div class=\"topbar taller\"><div class=\"fill\"><div id=\"header\" class=\"container-full-width\"><h3><a href=\"#\" class=\"track-click\" id=\"duolingo_menu_logo\">Duolingo</a></h3><div id=\"global-loading-indicator\" class=\"loading-indicator\" style=\"display: none;\"></div><div id=\"topbar-menu\">{{#logged_in}}<ul class=\"user-nav language-switcher\"><li class=\"with-dropdown\"><div class=\"dropdown\"><span id=\"pick-language\" class=\"flag mini {{language}}\"></span><span class=\"arrow\"></span><ul class=\"dropdown-menu languages\">{{#any_other_learning}}<li class=\"head\">{{#_i}}Learning{{/_i}}</li>{{#languages}}{{#learning}}<li class=\"language-choice {{#current_learning}}active{{/current_learning}}\" data-value=\"{{language}}\"><a href=\"javascript:;\"><span class=\"flag mini {{language}}\"></span><strong data-value=\"{{language}}\">{{#_ivar}}language_string{{/_ivar}}</strong> {{#_i}}level{{/_i}} {{level}}</a></li>{{/learning}}{{/languages}}{{/any_other_learning}}{{#any_other_not_learning}}<li class=\"head\">{{#_i}}Start learning{{/_i}}</li>{{#languages}}{{^learning}}<li class=\"language-choice\" data-value=\"{{language}}\"><a href=\"javascript:;\"><span class=\"flag mini {{language}}\"></span><strong data-value=\"{{language}}\">{{#_ivar}}language_string{{/_ivar}}</strong></a></li>{{/learning}}{{/languages}}{{/any_other_not_learning}}<li data-value=\"more\"><a href=\"/#/settings/account\"><span class=\"flag mini more\"></span>{{#_i}}more{{/_i}}...</a></li></ul></div></li></ul><ul class=\"nav\" style=\"margin-left: 0;\"><li id=\"home-nav\"><a href=\"#\">{{#_i}}Home{{/_i}}</a></li><li id=\"translations-nav\"><a href=\"/#/translations\">{{#_i}}Immersion{{/_i}}</a></li><li id=\"questions-nav\"><a href=\"/#/discussion\">{{#_i}}Discussion{{/_i}}</a></li><li id=\"vocab-nav\"><a href=\"/#/vocab\">{{#_i}}Vocabulary{{/_i}}</a></li><li id=\"mobile-nav\"><a href=\"/#/mobile\">{{#_i}}iPhone{{/_i}}</a></li>{{#admin}}<li id=\"admin-nav\"><a href='/#/admin_tools'>{{#_i}}Admin{{/_i}}</a></li>{{/admin}}</ul><div class=\"top-search\"><div class=\"form-row\"><span class=\"mag\"></span><label class=\"search-label\" for=\"menu-search-learners\" data-focus-text=\"{{#_i}}Name or Email{{/_i}}\">{{#_i}}Search learners{{/_i}}</label><input type=\"text\" class=\"search-input\" id=\"menu-search-learners\"/><div class=\"loading-indicator hidden\"></div></div><div class=\"hybrid-modal hidden\"></div></div><ul class=\"user-nav\"><li class=\"user\"><a href=\"/#/{{username}}\"><span class=\"user-icon\"></span></a></li><!-- <li class=\"notifications\"><a href=\"javascript:;\"><span class=\"icon\"></span></a></li> --><li class=\"with-dropdown\"><div class=\"dropdown\"><span class=\"gear-icon\"></span><ul class=\"dropdown-menu\"><li><a href=\"#/help\" class=\"track-click\">{{#_i}}Help{{/_i}}</a></li><li><a href=\"#/settings/account\" class=\"track-click\" id=\"header_userdrop_settings\">{{#_i}}Settings{{/_i}}</a></li><li><a href=\"/logout\" class=\"track-click\" id=\"header_userdrop_logout\">{{#_i}}Logout{{/_i}}</a></li></ul></div></li></ul>{{/logged_in}}{{^logged_in}}<ul class=\"nav\"><li id=\"questions-nav\"><a href=\"/#/discussion\">{{#_i}}Discussion{{/_i}}</a></li></ul>{{#one_click_signup_experiment_true}}<ul class=\"user-nav\"><li class=\"with-dropdown\"><div class=\"dropdown click-trigger\" ><div class=\"current-language\" id=\"site-language-btn\">{{#_i}}Site language{{/_i}}: <strong>{{#_ivar}}ui_language_name{{/_ivar}}</strong><span class=\"down-arrow\"></span></div><ul id=\"site-language-modal\" class=\"dropdown-menu\" style=\"min-width: 200px; left: 0; right: auto;\">{{#ui_languages_list}}<li class='ui-language-option' data-value='{{language}}'><a href=\"{{language}}\">{{language_name}}</a></li>{{/ui_languages_list}}</ul></div></li><li class=\"no-border sign-in\" style=\"margin-left: 20px;\"><span class=\"btn primary sign-in-btn\" id=\"sign-in-btn\">{{#_i}}Login{{/_i}}</span><div class=\"hybrid-modal hidden\" id=\"login-modal\"><div class=\"caret\"><div class=\"outer\"></div><div class=\"inner\"></div></div><form id='login-form' action=\"\" method=\"post\" accept-charset=\"utf-8\" style=\"margin: 0;\"><ul class=\"sign-in-list\"><li><span class=\"signup-facebook btn small\" id=\"facebook-login\"><span class=\"icon\"></span>{{#_i}}Facebook login{{/_i}}</span></li><li class=\"or-divider\"><hr/><span>{{#_i}}or{{/_i}}</span></li><li><div class=\"form-row\"><label for=\"top_login\">{{#_i}}Username or email{{/_i}}</label><input type=\"text\" id=\"top_login\" name=\"login\" value=\"\" autocomplete=\"on\"/></div></li><li><div class=\"form-row\"><label for=\"top_password\">{{#_i}}Password{{/_i}}</label><input type=\"password\" id=\"top_password\" name=\"password\" value=\"\" autocomplete=\"on\"/></div></li><li id=\"message\" class=\"login-fail\"></li><li><input id=\"login-button\" class=\"btn sign-in\" type=\"submit\" value=\"{{#_i}}Login{{/_i}}\"></li><li class=\"forgot-pwd\"><a href=\"/#/forgot_password\">{{#_i}}Forgot password{{/_i}}</a></li></ul></form></div></li></ul>{{/one_click_signup_experiment_true}}{{^one_click_signup_experiment_true}}<form id='login-form' action=\"\" method=\"post\" accept-charset=\"utf-8\"><ul class=\"inline-login\"><li><label for=\"top_login\">{{#_i}}Username or email{{/_i}}</label><input type=\"text\" id=\"top_login\" name=\"login\" value=\"\" autocomplete=\"on\"/></li><li><label for=\"top_password\">{{#_i}}Password{{/_i}}</label><input type=\"password\" id=\"top_password\" name=\"password\" value=\"\" autocomplete=\"on\"/></li><li><input id=\"login-button\" class=\"btn primary sign-in-btn\" type=\"submit\" value=\"{{#_i}}Login{{/_i}}\"></li></ul><div id=\"message\" class=\"login-failed\"></div><div class=\"forgot-password\"><a href=\"/#/forgot_password\">{{#_i}}forgot password?{{/_i}}</a></div></form>{{/one_click_signup_experiment_true}}{{/logged_in}}</div></div></div></div> ","menu-search-popup":"<div class=\"caret\"><div class=\"outer\"></div><div class=\"inner\"></div></div><ul class=\"small-list-users\">{{>user-search-results}}</ul>{{#more}}<a href=\"/#/find_friends?q={{q}}\" class=\"see-all-results\">{{#_i}}See all results{{/_i}} \u2192</a>{{/more}}","microphone-activation-element":"<h1>{{#_i}}<strong>Activate</strong> your microphone to practice speaking{{/_i}}</h1><div class=\"row\"><div class=\"column span10 offset4 activate-container\"><div class=\"activate-flash\"><div id=\"activate-flash\"><p><a href=\"http://www.adobe.com/go/getflashplayer\"><img src=\"http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif\" alt=\"Get Adobe Flash player\" /></a></p></div></div><div class=\"flash-help step-1\" id=\"flash-help-1\"><span class=\"number\">1</span>{{#_i}}Click Allow in<br/>the box{{/_i}}</div><div class=\"flash-help step-2\" id=\"flash-help-2\"><span class=\"number\">2</span>{{#_i}}Check<br/>Remember{{/_i}}</div><div class=\"flash-help step-3\" id=\"flash-help-3\"><span class=\"number\">3</span>{{#_i}}Click Close{{/_i}}</div></div></div> ","mini-lemma-row":"{{#forms_data}}<tr {{#first}}class=\"first-lemma-row\"{{/first}}>{{#first}}<td rowspan=\"{{num_forms}}\" style=\"background: white;\"><a href=\"/#/word/{{language}}/{{lemma_value}}/{{pos_key}}\" class=\"lemma\">{{lemma_surface_form}}</a></td>{{/first}}<td class=\"lexeme\">{{#new_form}}<span class=\"icon-present-small left\" title=\"{{#_i}}New word{{/_i}}\"></span>{{/new_form}}<span class=\"lexeme-form\">{{surface_form}}</span></td><td><ul class=\"word-strength small\"><li class=\"filled\"></li><li {{#strength_s}}class=\"filled\"{{/strength_s}}></li><li {{#strength_m}}class=\"filled\"{{/strength_m}}></li><li {{#strength_l}}class=\"filled\"{{/strength_l}}></li></ul></td></tr>{{/forms_data}}","mini-vocab-overview":"{{#has_vocab}}<div class=\"skill-practice-box\"><a href=\"javascript:;\" class=\"btn primary large practice right\">{{#_i}}Practice skill{{/_i}}<span class=\"coin-medium\">+10</span><ul class=\"word-strength medium blue\"><li class=\"filled\"></li><li {{#avg_strength_s}}class=\"filled\"{{/avg_strength_s}}></li><li {{#avg_strength_m}}class=\"filled\"{{/avg_strength_m}}></li><li {{#avg_strength_l}}class=\"filled\"{{/avg_strength_l}}></li></ul><div class=\"popover black below skill\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><strong>{{#_i}}Increase your word strength{{/_i}}</strong><br/><p style=\"margin: 10px 0 0 0; color: #BBB\">{{#_i}}Get all vocabulary from {{#_ivar}}skill_title{{/_ivar}} into your long-term memory.{{/_i}}</p></div></div></div></a><h4>{{#_i}}You have learned<br/><strong>{{vocab_count}} {{#pluralize}}word,words,{{vocab_count}}{{/pluralize}}</strong>{{/_i}}</h4></div>{{/has_vocab}}{{^has_vocab}}<h3>{{#_i}}You have learned <strong>{{vocab_count}} {{#pluralize}}word,words,{{vocab_count}}{{/pluralize}}</strong>{{/_i}}</h3>{{/has_vocab}}<table class=\"vocabulary table table-striped\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><thead><tr><th class=\"sortable\" data-sort=\"word\" style=\"\">{{#_i}}Word{{/_i}} <span class=\"sorting-icon\"></span></th><th style=\"\">{{#_i}}Forms{{/_i}}</th><th style=\"width: 25%\">{{#_i}}Strength{{/_i}}</th></tr></thead><tbody>{{^has_vocab}}<tr><td colspan=\"3\">{{#_i}}You haven't learned any words in this skill yet. Try doing some lessons.{{/_i}}</td></tr>{{/has_vocab}}{{#vocab}}{{>mini-lemma-row}}{{/vocab}}</tbody></table>{{#more_vocab}}<a href=\"/#/vocab/{{skill_id}}\">\u2192 {{#_i}}View full vocabulary from{{/_i}} {{#_ivar}}skill_title{{/_ivar}}</a>{{/more_vocab}} ","mobile":"<h1 class=\"{{#with_counter}}hidden{{/with_counter}} app-link\">{{#_i}}Duolingo for iPhone{{/_i}}</h1>{{#with_counter}}<h1 class=\"with-counter\">{{#_i}}Duolingo on the go{{/_i}}</h1>{{/with_counter}}<h2 class=\"offset\">{{#_i}}Your breaks and commutes are about to get a lot more productive.{{/_i}}</h2><div class=\"{{#with_counter}}hidden{{/with_counter}} app-link\" style=\"text-align:center; margin-top: -20px;\"><a href=\"https://itunes.apple.com/app/duolingo-learn-spanish-french/id570060128?mt=8\" class=\"btn xlarge primary\"><span class=\"mobile-icon-white\"></span>{{#_i}}Free in the App Store{{/_i}}</a><a id=\"email-link\" href=\"javascript:;\" class=\"btn xlarge\" data-target=\"#app-link-modal\" data-toggle=\"modal\"><span class=\"email-icon\"></span>{{#_i}}Email me a link{{/_i}}</a><div id=\"app-link-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"><div class=\"close\"></div><div class=\"modal-header\"><h3>{{#_i}}Email app link to:{{/_i}}</h3></div><div class=\"modal-body\"><input type=\"text\" class=\"textarea\" placeholder=\"Email address\" id=\"email\" name=\"email\" value=\"{{email}}\" autocomplete=\"on\" style=\"height:28px; position: relative; top: -2px\"/><input id=\"get-app-link\" class=\"btn primary large\" type=\"submit\" style=\"width: auto\" value=\"{{#_i}}Send{{/_i}}\"><div id=\"message\" class=\"login-failed\">{{#_i}}You entered an invalid email address.{{/_i}}</div></div></div></div><img class=\"screenshot\" src=\"http://static.duolingo.com/images/mobile/app-in-its-glory.jpg\">{{#with_counter}}<h2 class=\"with-counter\">{{#_i}}Available for iPhone November 13.{{/_i}}</h2><div class=\"app-countdown with-counter\"><div class=\"counter\"><div class=\"counter-bg\"><div><span id=\"days\" class=\"counter-text\">{{days}}</span></div></div><div class=\"counter-label\">{{#_i}}DAYS{{/_i}}</div></div><div class=\"counter\"><div class=\"counter-bg\"><div><span id=\"hours\" class=\"counter-text\">{{hours}}</span></div></div><div class=\"counter-label\">{{#_i}}HOURS{{/_i}}</div></div><div class=\"counter\"><div class=\"counter-bg\"><div><span id=\"minutes\" class=\"counter-text\">{{minutes}}</span></div></div><div class=\"counter-label\">{{#_i}}MINS{{/_i}}</div></div><div class=\"counter\"><div class=\"counter-bg\"><div><span id=\"seconds\" class=\"counter-text\">{{seconds}}</span></div></div><div class=\"counter-label\">{{#_i}}SECS{{/_i}}</div></div></div>{{/with_counter}}","moderation-log":"<ul class=\"activity-stream moderation-log\">{{#events}}{{#delete_log}}<li class=\"log-item\"><span style=\"float:left\">{{#user}}{{>avatar_medium}}{{/user}}</span><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> deleted a comment by <a href=\"#/{{#author}}{{username}}{{/author}}\" class=\"user\">{{#author}}{{username}}{{/author}}</a> from {{#parent_thread_id}}<strong><a href=\"#/comment/{{parent_thread_id}}\">{{parent_title}}</a></strong>{{/parent_thread_id}}<p>{{text}}</p><span class=\"footer\">{{datetime}}<a href=\"javascript:;\" class=\"undelete\" data-id=\"{{comment_id}}\" data-index=\"{{index}}\">{{#_i}}Undelete{{/_i}}</a></span></li>{{/delete_log}}{{#comment_log}}<li class=\"log-item\"><span style=\"float:left\">{{#user}}{{>avatar_medium}}{{/user}}</span><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a>{{^new_discussion}} commented on {{/new_discussion}}{{#new_discussion}} created the thread {{/new_discussion}}{{#parent_thread_id}}<strong><a href=\"#/comment/{{parent_thread_id}}\">{{parent_title}}</a></strong>{{/parent_thread_id}}<p>{{text}}</p><span class=\"footer\">{{datetime}}</span></li>{{/comment_log}}{{/events}}</ul>{{#more}}<button style=\"width: 100%; height:40px\" class=\"btn load-more\">Load More</button>{{/more}} ","name-element":"<h1>{{#_i}}<strong>Enter {{#determiner}}{{#_ivar}}language_name{{/_ivar}}{{/determiner}} {{#_ivar}}language_name{{/_ivar}} word</strong> that describes these images{{/_i}}</h1>{{#hint}}{{^new_player_blame_experiment_true}}<div class=\"alert-message hint-message left \">{{#_i}}<strong>Hint:</strong> It's the translation of <i>{{hint}}</i>{{/_i}}</div>{{/new_player_blame_experiment_true}}{{/hint}}{{>name-images}}{{#hint}}{{#new_player_blame_experiment_true}}<div class=\"row\"><div class=\"span18 columns relative\"><h4 style=\"font-size: 15px; font-weight: normal; margin: 5px 0 5px 0;\">{{#_i}}<strong>Hint:</strong> It's the translation of <i>{{hint}}</i>{{/_i}}</h4></div></div>{{/new_player_blame_experiment_true}}{{/hint}}<div class=\"row\" style=\"margin-bottom: 0;\"><div class=\"span18 columns relative\">{{#has_article}}<select class=\"medium\" id=\"article-input\" name=\"article-input\"><option value=\"\">{{#_i}}Choose article{{/_i}}</option>{{#articles}}<option value=\"{{.}}\">{{.}}</option>{{/articles}}</select>{{/has_article}}{{>blame-popover}}<input class=\"one-line-input\" id=\"word-input\" name=\"word-input\" size=\"30\" type=\"text\" value=\"\"><div id=\"vkeyboard-placeholder\"></div><div class=\"button-vkeyboard\" id=\"toggle_vkeyboard\"></div>{{#new_player_blame_experiment_true}}<div id=\"correct-solutions\"></div>{{/new_player_blame_experiment_true}}</div></div> ","name-images":"<div class=\"row\"><div class=\"span16 columns name-images\">{{#images}}<img src=\"{{.}}\"/>{{/images}}</div></div> ","nested-comment":"<div id=\"nested-comment-{{id}}\" class=\"nested-comment {{#removed}}{{^deleted}}faded-comment{{/deleted}}{{/removed}}\"><span id=\"self-comment\">{{#user}}{{>avatar_medium}}{{/user}}<div class=\"comment-metadata\">{{#user}}{{^deactivated}}<a href=\"#/{{username}}\" class=\"username\">{{username}}</a> {{/deactivated}}{{#deactivated}}{{#_i}}[deactivated user]{{/_i}}{{/deactivated}}{{>user_flair}}{{/user}}</div><div class=\"body\" id=\"body-{{id}}\">{{^deleted}}{{{processed_message}}}{{/deleted}}{{#deleted}}<p><i>{{#_i}}[deleted]{{/_i}}</i></p>{{/deleted}}</div><div class=\"edit-post-box hidden\" id=\"edit-box-{{id}}\"><div class=\"form-row small\"><textarea class=\"post-edit-box comment-box\" style=\"width: 96%; height: 80px;\" name=\"post-edit-box\">{{message}}</textarea></div><input type=\"submit\" class=\"btn primary update-comment\" value=\"Save\"> <input type=\"reset\" class=\"btn cancel-update-comment\" value=\"Cancel\"></div><div class=\"comment-footer\">{{#logged_in}}{{^removed}}<span class=\"vote-module-small\"><div class=\"vote-count\">{{votes}}</div><button class=\"vote-up {{#user_upvoted}}active{{/user_upvoted}}\" id=\"comment-{{id}}-upvote\">vote up</button><button class=\"vote-down {{#user_downvoted}}active{{/user_downvoted}}\" id=\"comment-{{id}}-downvote\">vote down</button></span>{{/removed}}<span class=\"comment-reply\">{{^removed}}{{#depth}}{{^deleted}}<a href=\"javascript:;\" class=\"add-reply\">{{#_i}}Reply{{/_i}}</a>{{/deleted}}{{/depth}}{{^deleted}}{{#editable}}<a href=\"javascript:;\" class=\"edit-comment\">{{#_i}}Edit{{/_i}}</a>{{/editable}}{{/deleted}}{{#deletable}}<a href=\"javascript:;\" class=\"delete-comment\">{{#_i}}Delete{{/_i}}</a>{{/deletable}}{{/removed}}{{#removed}}{{^deleted}}{{#undeletable}}<a href=\"javascript:;\" class=\"undelete-comment\">{{#_i}}Undelete{{/_i}}</a>{{/undeletable}}{{/deleted}}{{/removed}}{{#deleted}}{{#undeletable}}<a href=\"javascript:;\" class=\"undelete-comment\">{{#_i}}Undelete{{/_i}}</a>{{/undeletable}}{{/deleted}}</span><span class=\"divider post-reply\">\u2022</span>{{/logged_in}}{{datetime_string}}<div id=\"reply-box-{{id}}\" class=\"hidden clear-fix\"><textarea style=\"width: 98%; height: 40px\" class=\"reply-box animated-resizing\" id=\"postreply-{{id}}\" name=\"postreply\" rows=\"3\"></textarea><input id=\"post-reply\" type=\"submit\" class=\"btn primary post-reply\" style=\"float:left; margin-right: 10px\" value=\"{{#_i}}Post Reply{{/_i}}\"><input type=\"submit\" class=\"btn cancel-reply\" style=\"float:left\" value=\"{{#_i}}Cancel{{/_i}}\"></div></div></span><ul id=\"comments\" class=\"list-comments-nested\">{{#comments}}{{^removed}}<li id=\"comment-{{id}}\" class=\"comment condensed\"></li>{{/removed}}{{#removed}}{{^deleted}}{{#undeletable}}<li id=\"comment-{{id}}\" class=\"comment condensed\"></li>{{/undeletable}}{{/deleted}}{{/removed}}{{#removed}}{{#deleted}}<li id=\"comment-{{id}}\" class=\"comment condensed\"></li>{{/deleted}}{{/removed}}{{/comments}}{{#num_hidden}}<li class=\"show-toggle comment\" id=\"show-toggle-{{id}}\"><a href=\"javascript:;\" class=\"show-bad-comment\">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/num_hidden}}{{^num_hidden}}{{#undeletable}}<li class=\"show-toggle comment\" id=\"show-toggle-{{id}}\"><a href=\"javascript:;\" class=\"show-bad-comment\">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/undeletable}}{{/num_hidden}}</ul></div> ","new-speller-menu":"<div id=\"speller_menu\" class=\"speller-menu\" style=\"position:absolute;\"><div class=\"speller-item\"><i>{{original}}</i><span class=\"revert-spelling\"></span></div>{{#has_items}}<div class=\"speller-divider\"></div>{{#speller_items}}<div class=\"speller-item\">{{item}}</div>{{/speller_items}}{{/has_items}}</div> ","new_friend":"{{username}} {{#_i}}is following you on Duolingo{{/_i}}.","no-sound-modal":"{{#version_too_low}}<p>{{#_i}}Your Flash version is too old. You need Flash version 8 or higher. Go <a href=\"http://www.adobe.com/support/flashplayer/downloads.html\">here</a> to download a more recent version.{{/_i}}</p>{{/version_too_low}}{{^version_too_low}}<p>{{#_i}}It's possible that you have browser extensions that block Flash or that Flash crashed.{{/_i}}</p><p>{{#_i}}Let's fix this! If you have a Flash blocker add 'duolingo.com' to its whitelist. If Flash crashed try <a href=\"javascript:;\" onclick=\"window.location.reload();\">reloading</a> the page.{{/_i}}</p>{{/version_too_low}}<p>{{#_i}}Sound still not working? Go to the <a href=\"/#/settings\">settings page</a> in the top right corner to disable the speaker.{{/_i}}</p>","notifications":"<div id=\"notifications-content\" class=\"settings-content\"><h3>{{#_i}}General{{/_i}}</h3><ul class=\"settings\" style=\"margin-bottom: 40px; padding-bottom: 10px; border-bottom: 1px solid #dfdfdf;\"><li><label for=\"notify_follow\">{{#_i}}Email me when{{/_i}}</label><div class=\"input\"><ul class=\"inputs-inline left\"><li><label><input class=\"\" id=\"notify_announcement\" name=\"notify_announcement\" type=\"checkbox\" {{#notify_announcement}}checked=\"checked\"{{/notify_announcement}}/></label></li></ul><p style=\"padding-top: 5px;\">{{#_i}}There is an announcement{{/_i}}</p><ul class=\"inputs-inline left\"><li><label><input class=\"\" id=\"notify_follow\" name=\"notify_follow\" type=\"checkbox\" {{#notify_follow}}checked=\"checked\"{{/notify_follow}}/></label></li></ul><p style=\"padding-top: 5px;\">{{#_i}}Somebody friends me{{/_i}}</p><ul class=\"inputs-inline left\"><li><label><input class=\"\" id=\"notify_pass\" name=\"notify_pass\" type=\"checkbox\" {{#notify_pass}}checked=\"checked\"{{/notify_pass}}/></label></li></ul><p style=\"padding-top: 5px;\">{{#_i}}Somebody passes me{{/_i}}</p><ul class=\"inputs-inline left\"><li><label><input class=\"\" id=\"notify_comment\" name=\"notify_comment\" type=\"checkbox\" {{#notify_comment}}checked=\"checked\"{{/notify_comment}}/></label></li></ul><p style=\"padding-top: 5px;\">{{#_i}}Somebody responds to a discussion I'm following{{/_i}}</p><ul class=\"inputs-inline left\"><li><label><input class=\"\" id=\"notify_stream_post\" name=\"notify_stream_post\" type=\"checkbox\" {{#notify_stream_post}}checked=\"checked\"{{/notify_stream_post}}/></label></li></ul><p style=\"padding-top: 5px;\">{{#_i}}Someone posts on my stream{{/_i}}</p><ul class=\"inputs-inline left\"><li><label><input class=\"\" id=\"notify_edit_suggested\" name=\"notify_edit_suggested\" type=\"checkbox\" {{#notify_edit_suggested}}checked=\"checked\"{{/notify_edit_suggested}}/></label></li></ul><p style=\"padding-top: 5px;\">{{#_i}}Someone suggests an edit to my sentence{{/_i}}</p><ul class=\"inputs-inline left\"><li><label><input class=\"\" id=\"notify_grade_report\" name=\"notify_grade_report\" type=\"checkbox\" {{#notify_grade_report}}checked=\"checked\"{{/notify_grade_report}}/></label></li></ul><p style=\"padding-top: 5px;\">{{#_i}}There is a new grade report for my translations{{/_i}}</p></div></li></ul><h3>{{#_i}}Daily reminders{{/_i}}</h3><ul class=\"settings\" style=\"margin-bottom: 50px;\"><li><label for=\"notify_follow\">{{#_i}}Email me when{{/_i}}</label><div class=\"input\">{{#languages_data}}<ul class=\"inputs-inline left\"><li><label><input name=\"language_settings.{{language}}.notify_practice\" type=\"checkbox\" {{#notify_practice}}checked=\"checked\"{{/notify_practice}}/></label></li></ul><p style=\"padding-top: 5px;\">{{#_i}}I forget to practice {{#_ivar}}language_string{{/_ivar}}{{/_i}} {{#_i}}<!-- time -->by{{/_i}}<select class=\"small right\" name=\"language_settings.{{language}}.notify_time\">{{#practice_times}}<option {{#selected}}selected=\"selected\"{{/selected}} value=\"{{offset}}\">{{time}}</option>{{/practice_times}}</select></p>{{/languages_data}}</div></li></ul></div> ","notify_me":"<div class=\"center-pane\"><form action=\"\" method=\"post\" id=\"subscribe-form\"><input type=\"hidden\" name=\"came_from\" value=\"{{came_from}}\"/><fieldset class=\"clearfix\">{{#_i}}<h1>Notify me</h1>{{/_i}}<h3>{{#_i}}We are starting with Spanish,<br/>German and English.<br/>Let us know if you want to learn another<br/>language and we will keep you posted.{{/_i}}</h3><ul class=\"login-signup-list\"><li><select class=\"medium\" name=\"learning_language\" id=\"learning_language\"><option disabled=\"disabled\">{{#_i}}Notify me about...{{/_i}}</option><option value=\"fr\">{{#_i}}French{{/_i}}</option><option value=\"it\">{{#_i}}Italian{{/_i}}</option><option value=\"zh\">{{#_i}}Chinese{{/_i}}</option><option value=\"ja\">{{#_i}}Japanese{{/_i}}</option><option value=\"ru\">{{#_i}}Russian{{/_i}}</option><option value=\"ar\">{{#_i}}Arabic{{/_i}}</option><option value=\"**\">{{#_i}}Klingon{{/_i}}</option></select></li><li><label for=\"email\">{{#_i}}Email{{/_i}}</label><input class=\"large\" id=\"email\" name=\"email\" size=\"30\" type=\"text\" value=\"{{email}}\"><div class=\"error-flag\" id='email-error'>{{#_i}}Enter a correct email address{{/_i}}</div></li><li><input type=\"submit\" id=\"subscribe-button\" class=\"btn large primary\" style=\"width: 220px;\" value=\"{{#_i}}Notify me{{/_i}}\"/></li></ul></fieldset></form><div id=\"form_txt_good\" class=\"hidden\"><h1>{{#_i}}Thanks!{{/_i}}</h1><h3>{{#_i}}We'll keep you posted.{{/_i}}</h3></div><div id=\"form_txt_bad\" class=\"hidden\"><h1>{{#_i}}Oops!{{/_i}}<h1><h3>{{#_i}}You were already subscribed.{{/_i}}</h3></div></div> ","other-fb-friends":"{{#other_friends}}<li><span class=\"avatar-small\"><img src=\"{{#picture}}{{#data}}{{url}}{{/data}}{{/picture}}\" class=\"avatar\"></span><strong class=\"name\">{{name}}</strong><a class=\"invite-friend btn right primary\" data-user=\"{{id}}\">{{#_i}}Invite{{/_i}}</a></li>{{/other_friends}}","pass-event":"{{#user}}{{>avatar_medium}}{{/user}}<h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#_i}}passed <a href=\"#/{{#passed}}{{username}}{{/passed}}\">{{#passed}}{{username}}{{/passed}}</a> in skill points{{/_i}}</h5>{{#show_time}}<span class=\"time\">{{datetime_string}}</span>{{/show_time}}<div class=\"stream-comments {{^has_comments}}hidden{{/has_comments}}\"></div>{{>event-footer}}","password":"<div id=\"password-content\" class=\"settings-content\"><div class=\"row\"><div class=\"column span11\"><ul class=\"settings\">{{^no_password}}<li><label for=\"current-password\">{{#_i}}Current Password{{/_i}}</label><div class=\"input\"><input class=\"large\" id=\"current-password\" name=\"current-password\" size=\"30\" type=\"password\"></div></li>{{/no_password}}<li><label for=\"new-password\">{{#_i}}New Password{{/_i}}</label><div class=\"input\"><input class=\"large\" id=\"new-password\" name=\"new-password\" size=\"30\" type=\"password\"></div></li><li><label for=\"confirm-new-password\">{{#_i}}Confirm New Password{{/_i}}</label><div class=\"input\"><input class=\"large\" id=\"confirm-new-password\" name=\"confirm-new-password\" size=\"30\" type=\"password\"></div></li></ul></div></div></div> ","player-header":"<div id=\"context-view\"></div><div class=\"player-header\"><div id='progress-bar'></div><ul class=\"player-stats\">{{^path_node_index}}{{^points_per_correct}}{{#explanation}}<li id=\"explanation\"></li>{{/explanation}}{{/points_per_correct}}{{/path_node_index}}{{^points_per_correct}}<li id=\"hearts\"></li>{{/points_per_correct}}{{#points_per_correct}}<li id=\"point-count\"></li>{{/points_per_correct}}{{#timed}}<li class=\"timer\" id=\"timer\"></li>{{/timed}}</ul></div>","player-nav-secondary":"{{^session_welcome}}<ul class=\"player-nav-secondary {{#translate}}horizontal{{/translate}}{{#listen}}vertical{{/listen}}{{#form}}vertical{{/form}}{{#judge}}vertical{{/judge}}{{#name}}vertical{{/name}}{{#select}}vertical{{/select}} \">{{#has_discussion}}<li class=\"comment\" id=\"discussion-toggle\"><span class=\"icon\"></span>{{#_i}}Discuss sentence{{/_i}} {{#num_comments}}({{num_comments}}){{/num_comments}}<div id=\"solution-suggested\" class=\"save-message-new solution-submitted\">{{#_i}}Thanks!{{/_i}}</div></li>{{/has_discussion}}<li class=\"report\" id=\"show-report-options\"><span class=\"icon\"></span>{{#_i}}Report error{{/_i}}<span class=\"arrow\"></span></li><!-- <li class=\"redo\" id=\"redo-challenge\"><span class=\"icon\"></span>{{#_i}}Redo challenge{{/_i}}</li> --><ul class=\"even-context-menu report-options hidden\" id=\"report-options\">{{#translate}}{{#incorrect}}{{#user_solution}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"accepted\" value=\"My answer should be accepted.\"><label class=\"report-label\" for=\"accepted\">{{#_i}}<b>My answer</b> should be accepted.{{/_i}}</label></li>{{/user_solution}}{{/incorrect}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li>{{#incorrect}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The given answer has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Correct solution\"</b> is unnatural or has an error.{{/_i}}</label></li>{{/incorrect}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"hints\" value=\"The dictionary hints are misleading/incomplete.\"><label class=\"report-label\" for=\"hints\">{{#_i}}<b>The dictionary hints</b> on hover are wrong or missing.{{/_i}}</label></li>{{#has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}{{/translate}}{{#judge}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li>{{#incorrect}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The given answer has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Correct translation\"</b> is unnatural or has an error.{{/_i}}</label></li>{{/incorrect}}{{#has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}{{/judge}}{{#form}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}language_name{{/_ivar}} sentence</b> is unnatural or has an error{{/_i}}</label></li><li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The given answer has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Translation\"</b> is unnatural or has an error.{{/_i}}</label></li>{{#has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}{{/form}}{{#listen}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li><li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}language_name{{/_ivar}} sentence</b> is unnatural or has an error{{/_i}}</label></li><li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The Translation has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Translation\"</b> is unnatural or has an error.{{/_i}}</label></li>{{/listen}}{{#speak}}{{#has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"audio\" value=\"The audio is not clear.\"><label class=\"report-label\" for=\"audio\">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"original\" value=\"The sentence is not grammatically correct.\"><label class=\"report-label\" for=\"original\">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li><li><input type=\"checkbox\" class=\"report-checkbox\" id=\"translate\" value=\"The Translation has a mistake.\"><label class=\"report-label\" for=\"translate\">{{#_i}}<b>The \"Translation\"</b> is unnatural or has an error.{{/_i}}</label>{{/speak}}{{#name}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"pictures\" value=\"The pictures do not match the given word.\"><label class=\"report-label\" for=\"pictures\">{{#_i}}<b>The pictures</b> do not match the given word.{{/_i}}</label></li>{{/name}}{{#select}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"pictures\" value=\"The pictures do not match the given word.\"><label class=\"report-label\" for=\"pictures\">{{#_i}}<b>The picture</b> does not match the given word.{{/_i}}</label></li>{{/select}}<li><input type=\"checkbox\" class=\"report-checkbox\" id=\"free-write\" style=\"position: relative; top: 2px\"><textarea class=\"free-write-box animated-resizing\" type=\"text\" style=\"text-transform: none\" placeholder=\"{{#_i}}Have a different problem? Explain it here.{{/_i}}\"></textarea></li><li><div class=\"clear-fix\" style=\"margin: 9px 0\"><input id=\"submit-problem\" type=\"submit\" class=\"btn primary update-comment\" value=\"{{#_i}}Submit{{/_i}}\" style=\"float: right; margin: 0 23px 0 10px; width: auto\"><input id=\"cancel-report\" type=\"submit\" class=\"btn update-comment\" data-dismiss=\"modal\" value=\"{{#_i}}Cancel{{/_i}}\" style=\"float: right; width: auto\"></div></li></ul></ul><div id=\"discussion-modal-container\"></div>{{/session_welcome}}","point-count":"<div class=\"inner\"><span class=\"coin-medium\">{{points}}</span></div> ","post-modal":"<div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div><div style=\"padding: 30px 30px 0px 30px\" class=\"modal-body\"><h7>{{^edit}}{{#_i}}New Discussion{{/_i}}{{/edit}}{{#edit}}{{#_i}}Editing{{/_i}}{{/edit}}</h7><p class=\"grayDark\">{{^edit}}{{#_i}}Post to:{{/_i}}{{/edit}}{{#edit}}{{#_i}}Posted to:{{/_i}}{{/edit}}</p><select class=\"skill-list\">{{#edit}}<option><i>({{#_i}}Do not move my discussion{{/_i}})</i></option>{{/edit}}{{#all_topics}}<option value=\"{{#skill_id}}skill-{{skill_id}}{{/skill_id}}{{^skill_id}}{{id}}{{/skill_id}}\" data-topic=\"{{id}}\" data-name=\"{{name}}\">{{#_ivar}}name{{/_ivar}}</option>{{/all_topics}}</select><div class=\"form-row bigger\"><label for=\"{{#edit}}edit{{/edit}}{{^edit}}{{type}}{{/edit}}-title\">{{#_i}}Title{{/_i}}</label><input type=\"text\" class=\"title-field\" id=\"{{#edit}}edit{{/edit}}{{^edit}}{{type}}{{/edit}}-title\" maxlength=\"250\" {{#edit}}value=\"{{title}}\"{{/edit}} /></div><div class=\"form-row bigger\"><label for=\"{{#edit}}edit{{/edit}}{{^edit}}{{type}}{{/edit}}-post\">{{#_i}}Body{{/_i}}</label><textarea name=\"\" rows=\"\" class=\"post-field\" id=\"{{#edit}}edit{{/edit}}{{^edit}}{{type}}{{/edit}}-post\">{{#edit}}{{message}}{{/edit}}</textarea></div></div><div class=\"modal-footer\" {{#edit}}style=\"margin-top: 20px;\"{{/edit}}><button class=\"btn primary right submit-post\">{{#edit}}{{#_i}}Save{{/_i}}{{/edit}}{{^edit}}{{#_i}}Post Discussion{{/_i}}{{/edit}}</button></div>","practice-event":"{{#user}}{{>avatar_medium}}{{/user}}{{#total_improvement}}<ul class=\"point-gain-box\"><li><span class=\"icon-star-small\"></span><span class=\"skill-points-small\">+{{total_improvement}}</span></li></ul>{{/total_improvement}}{{^refresh}}<h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#_i}}did {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} practice lesson{{/_i}}</h5>{{/refresh}}{{#refresh}}<h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#_i}}refreshed {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} skill{{/_i}}</h5>{{/refresh}}","practice-list":"{{#list_length}}<span class=\"practice-words-counter\">{{list_length}}</span>{{/list_length}}<span class=\"icon\"></span><div class=\"popover below\"><div class=\"arrow\"></div><div class=\"inner\"><div class=\"content\"><h4>Practice list</h4><p class=\"center\">{{list_length}} {{#pluralize}}word,words,{{list_length}}{{/pluralize}} added to daily practice</p><ul class=\"words-added\">{{#shown_words}}<li>{{word}}: {{hint}}</li>{{/shown_words}}{{#hidden_words}}<li class=\"hidden\">{{word}}: {{hint}}</li>{{/hidden_words}}</ul>{{#more}}<div class=\"more-hints\"><span class=\"icon-show-more\"></span></div>{{/more}}</div></div></div>","practice_reminder":"{{#streak}}{{#day_streak}}{{#_i}}Learning a language requires a little practice every day. Practice your {{#_ivar}}language{{/_ivar}} on Duolingo{{/_i}}. {{/day_streak}}{{#short_streak}}{{#_i}}You\u2019re heating up. Continue your {{days}} day {{#_ivar}}language{{/_ivar}} streak on Duolingo{{/_i}}. {{/short_streak}}{{#long_streak}}{{#_i}}You\u2019re on fire. Continue your {{days}} day {{#_ivar}}language{{/_ivar}} streak on Duolingo{{/_i}}. {{/long_streak}}{{/streak}}{{^streak}}{{#_i}}Oh no, you lost your streak on Duolingo. Get back on track!{{/_i}}{{/streak}}","pretty_date":"{{#just}}{{#_i}}just now{{/_i}}{{/just}}{{#minute}}{{#_i}}a minute ago{{/_i}}{{/minute}}{{#minutes}}{{#_i}}{{n}} minutes ago{{/_i}}{{/minutes}}{{#hour}}{{#_i}}an hour ago{{/_i}}{{/hour}}{{#hours}}{{#_i}}{{n}} hours ago{{/_i}}{{/hours}}{{#yesterday}}{{#_i}}yesterday{{/_i}}{{/yesterday}}{{#days}}{{#_i}}{{n}} days ago{{/_i}}{{/days}}{{#weeks}}{{#_i}}{{n}} {{#pluralize}}week,weeks,{{n}}{{/pluralize}} ago{{/_i}}{{/weeks}}{{#months}}{{#_i}}{{n}} {{#pluralize}}month,months,{{n}}{{/pluralize}} ago{{/_i}}{{/months}}{{#years}}{{#_i}}{{n}} {{#pluralize}}year,years,{{n}}{{/pluralize}} ago{{/_i}}{{/years}}{{#date}}{{#_ivar}}month{{/_ivar}} {{day}}, {{year}}{{/date}}","privacy":"<h1>Privacy Policy</h1><ol class=\"terms\"><li><h3>General</h3> <p>By using, accessing or participating in the Service, you agree to the terms of this privacy policy (the \u201cPrivacy Policy\u201d). Capitalized terms not defined in this Privacy Policy have the meanings set forth in the Terms and Conditions, located at <a href=\"/#/terms\">http://duolingo.com/#/terms</a>. We reserve the right to change our Privacy Policy at any time. If we do this, we will post a notice that we have made changes to this Privacy Policy on the Website for at least 7 days after the changes are posted and will indicate at the bottom of the Privacy Policy the date these terms were last revised. Any revisions to this Privacy Policy will become effective the earlier of (i) the end of the foregoing 7-day period or (ii) the first time you access or use the Service after any such changes. If you do not agree to abide by this Privacy Policy, you are not authorized to use, access or participate in the Service.</p></li><li><h3>Information We Collect</h3><p>When you use the Service you provide us with two types of information: (i) information you submit via the Service and (ii) information regarding your use of the Service collected by us as you interact with the Service.</p><p>When you enter the Website, we collect your browser type and IP address. This information is gathered for all Website visitors. In addition, we store certain information from your browser using \"cookies.\" A cookie is a piece of data stored on the user's computer tied to information about the user. We use session ID cookies to confirm that users are logged in. If you do not want information collected through the use of cookies, there is a simple procedure in most browsers that allows you to deny or accept the cookie feature; however, you should note that cookies may be necessary to provide you certain features (e.g., customized delivery of information) available on the Website.</p><p>Through the registration process you may provide us with your name, email address, hometown, and other information that may be requested during the registration process.</p><p>When you use the Service you may submit information and content to your profile, generate Activity Data through engaging in educational activities on the Service, or send messages and otherwise transmit information to other users. We store this information so that we can provide you the Service and offer personalized features.</p></li><li><h3>Use of Information Obtained by Duolingo</h3><p>We may use your contact information to send you notifications regarding new services offered by Duolingo and its partners that we think you may find valuable. Duolingo may also send you service-related announcements from time to time through the general operation of the Service. Generally, you may opt out of such emails, although Duolingo reserves the right to send you notices about your account even if you opt out of all voluntary email notifications.</p><p>Profile information is used by Duolingo primarily to be presented back to and edited by you when you access the Service and to be presented to other users. In some cases, other users may be able to supplement your profile, including by submitting comments.</p><p>Duolingo may use aggregate or anonymous data collected through the Service, including Activity Data, for any purpose. This data may be used by Duolingo and shared with third parties in any manner.</p> </li><li><h3>Sharing Your Personally-Identifiable Information with Third Parties</h3> <p>Duolingo shares your personally-identifiable information only in limited circumstances where Duolingo believes such sharing is reasonably necessary to offer the Service, legally required or, permitted by you. For example:</p><p>We may provide personally-identifiable information to service providers who help us bring you the Service, such as hosting the Service at a co-location facility or sending email updates. In connection with these operations, our service providers may have access to personally-identifiable information for use for a limited time. Where we utilize service providers for the processing of any of personally-identifiable information, we implement reasonable contractual protections limiting the use of that personally-identifiable information to the provision of services to Duolingo.</p><p>We may be required to disclose personally-identifiable information pursuant to lawful requests, such as subpoenas or court orders, or in compliance with applicable laws. Additionally, we may share account or other personally-identifiable information when we believe it is necessary to comply with law, to protect our interests or property, to prevent fraud or other illegal activity perpetrated through the Service or using the Duolingo name, or to prevent imminent harm. This may include sharing personally-identifiable information with other companies, lawyers, agents or government agencies.</p><p>If the ownership of all or substantially all of the Duolingo business, or individual business units or assets owned by Duolingo that are related to the Service, were to change, your personally-identifiable information may be transferred to the new owner. In any such transfer of information, your personally-identifiable information would remain subject to this section.</p></li><li><h3>Links</h3> <p>The Service may contain links to other websites. We are of not responsible for the privacy practices of other websites. We encourage users to be aware when they leave the Service to read the privacy statements of other websites that collect personally identifiable information. This Privacy Policy applies solely to information collected by Duolingo via the Service.</p></li><li style=\"list-style: none\">Last revised on April 20th, 2012</li></ol>","profile":"<div class=\"header-pane\"><div class=\"circular-avatar-large\">{{^deactivated}}<div class=\"avatar-large\" title=\"{{username}}\"><!--PUPPY LOCATION-->{{#avatar}}<img src=\"{{avatar}}/large\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{id}}/large\">{{/avatar}}</div>{{/deactivated}}{{#deactivated}}<div class=\"avatar-large\" title=\"{{#_i}}[deactivated user]{{/_i}}\"><img src=\"http://duolingo.com/avatars/deactivated_user/large\"></div>{{/deactivated}}<div class=\"overlay\"></div></div><div class=\"profile-pane\"><div class=\"top-row\"><h1>{{username}}</h1>{{#fullname}}<h2 class=\"user\">{{fullname}}</h2>{{/fullname}}{{#location}}<span class=\"location\">{{location}}</span>{{/location}}</div><div class=\"bottom-row\">{{^current_user_profile}}<a href=\"javascript:;\" class=\"btn {{#is_following}}is-friend success{{/is_following}}{{^is_following}}add-friend primary{{/is_following}}\" data-toggle=\"follow\" data-user=\"{{id}}\" data-follow-text=\"{{#_i}}Add friend{{/_i}}\" data-unfollow-text=\"{{#_i}}Friends{{/_i}}\" data-follow-class=\"add-friend primary\" data-unfollow-class=\"is-friend\">{{#is_following}}{{#_i}}Friends{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Add friend{{/_i}}{{/is_following}}</a>{{/current_user_profile}}{{#current_user_profile}}<a href=\"/#/settings/profile\" class=\"btn edit-profile\">{{#_i}}Edit profile{{/_i}}</a>{{/current_user_profile}}<ul class=\"social-links-new\">{{#twitter_id}}<li class=\"twitter\"><a href=\"https://twitter.com/account/redirect_by_id?id={{twitter_id}}\" target=\"_blank\" class=\"twitter\"></a></li>{{/twitter_id}}{{#facebook_id}}<li class=\"facebook\"><a href=\"http://www.facebook.com/{{facebook_id}}\" target=\"_blank\"></a></li>{{/facebook_id}}</ul>{{#bio}}<div class=\"bio\"><span class=\"inner\">{{bio}}</span></div>{{/bio}}</div></div><ul id=\"stats\" class=\"user-stats\"></ul></div><div class=\"profile-left\">{{>skill-tree}}</div><div class=\"profile-right\"><h5>{{#_i}}Language levels{{/_i}}</h5><div class=\"language-levels gray-inset-box\"><ul class=\"level-badges new\">{{#points_languages}}{{#learning}}<li class=\"{{language}}\"><span class=\"language\"></span>{{level}}</li>{{/learning}}{{/points_languages}}{{#language_badge_fill}}<li class=\"empty\"></li>{{/language_badge_fill}}</ul></div><div id=\"friends\"></div></div> ","profile-friends":"<h5>{{#_i}}Friends{{/_i}}: <span class=\"number\">{{num_following}}</span></h5><div class=\"friends-grid gray-inset-box\"><ul class=\"circular-avatars-grid\">{{#following}}<li>{{^deactivated}}<a href=\"#/{{username}}\" class=\"medium-circular-avatar has-twipsy\" title=\"{{username}}\"><!--PUPPY-->{{#avatar}}<img src=\"{{avatar}}/medium\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{id}}/medium\" class=\"avatar\"/>{{/avatar}}</a>{{/deactivated}}{{#deactivated}}<span class=\"medium-circular-avatar has-twipsy\" title=\"{{#_i}}[deactivated user]{{/_i}}\"><img src=\"http://duolingo.com/avatars/deactivated_user/medium\"></span>{{/deactivated}}</li>{{/following}}{{#show_more_following}}<li><a href=\"javascript:;\" class=\"more\" data-type=\"following\"><span class=\"inner\">+{{num_show_more_following}}</span></a></li><div id=\"following-modal\" class=\"modal hide hidden\" style=\"margin-top: -200px;\"><div class=\"modal-header\"><h4>{{#_i}}{{username}}'s Friends{{/_i}}</h4><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"></div></div>{{/show_more_following}}</ul></div><h5>{{#_i}}Followers{{/_i}}: <span class=\"number\">{{num_followers}}</span></h5><div class=\"friends-grid gray-inset-box\"><ul class=\"circular-avatars-grid\">{{#followers}}<li>{{^deactivated}}<a href=\"#/{{username}}\" class=\"medium-circular-avatar has-twipsy\" title=\"{{username}}\"><!--PUPPY-->{{#avatar}}<img src=\"{{avatar}}/medium\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{id}}/medium\" class=\"avatar\"/>{{/avatar}}</a>{{/deactivated}}{{#deactivated}}<span class=\"medium-circular-avatar has-twipsy\" title=\"{{#_i}}[deactivated user]{{/_i}}\"><img src=\"http://duolingo.com/avatars/deactivated_user/medium\"></span>{{/deactivated}}</li>{{/followers}}{{#show_more_followers}}<li><a href=\"javascript:;\" class=\"more\" data-type=\"followers\"><span class=\"inner\">+{{num_show_more_followers}}</span></a></li><div id=\"followers-modal\" class=\"modal hide hidden\" style=\"margin-top: -200px;\"><div class=\"modal-header\"><h4>{{#_i}}{{username}}'s Followers{{/_i}}</h4><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"></div></div>{{/show_more_followers}}</ul></div> ","profile-side-bar":"<div class=\"user-pane-small\">{{>avatar_medium}}<a href=\"/#/{{username}}\"><h4>{{username}}</h4>{{#current_user}}<span>{{#_i}}View my profile{{/_i}} \u2192</span>{{/current_user}}</a></div><div class=\"language-progress\" style=\"margin-top: 0;\"><div class=\"white-inset-box\" style=\"margin-bottom: 10px;\"><ul class=\"switch-progress\"><li class=\"active overall\" data-toggle=\"tab\" data-selector=\"#overall-progress\" data-group=\"progress\"><a href=\"javascript:;\" style=\"text-transform: capitalize;\">{{#_ivar}}language_string{{/_ivar}}</a></li><li class=\"weekly\" data-toggle=\"tab\" data-selector=\"#weekly-progress\" data-group=\"progress\"><a href=\"javascript:;\">{{#_i}}Weekly progress{{/_i}}</a></li></ul><div id=\"overall-progress\" class=\"inner-content\">{{^max_level}}{{#current_user}}<div class=\"level-bar new\">{{#level_percent}}<div class=\"bar\" style=\"width: {{level_percent}}%;\"></div>{{/level_percent}}<div class=\"end\"><span class=\"star\">{{next_level}}</span></div><div class=\"beginning\">{{level}}</div></div><div class=\"level-bar-legend\" style=\"color: #404040;\"><span class=\"coin-small\"></span><strong>{{level_progress}}/{{level_points}}</strong> {{#_i}}in level{{/_i}} {{level}}</div>{{/current_user}}{{/max_level}}<ul class=\"user-points simple\" {{^current_user}}style=\"border-top: none; padding-top: 20px; margin-top: 0;\"{{/current_user}}><li class=\"has-twipsy skill-points\" title=\"{{#_i}}Skill points{{/_i}}\"><span class=\"coin\"></span><h3><strong>{{points}}</strong></h3></li><li class=\"has-twipsy words-learned\" style=\"float:none;\" title=\"{{#_i}}Words learned{{/_i}}\"><span class=\"words-icon {{#ui_language_es}}es{{/ui_language_es}} {{#ui_language_pt}}es{{/ui_language_pt}} {{#ui_language_it}}es{{/ui_language_it}} {{#ui_language_fr}}fr{{/ui_language_fr}}\"></span><h3><strong id=\"word-count\">{{#loading_word_count}}<img src=\"/images/medium-loader.gif\" style=\"position: relative; top: -5px;\" />{{/loading_word_count}}{{^loading_word_count}}{{word_count}}{{/loading_word_count}}</strong></h3></li><li class=\"has-twipsy streak-display\" title=\"{{#_i}}{{streak}}-day streak{{/_i}}\"><span class=\"streak\"></span><h3><strong>{{streak}}</strong></h3></li></ul>{{#current_user}}{{#show_practice}}<div class=\"practice-section\"><h5>{{#_i}}Strengthen your words:{{/_i}}</h5><a href=\"/#/practice\" class=\"btn {{#num_following}}primary{{/num_following}} practice-button\" style=\"font-weight: normal;\">{{#_i}}Practice all skills{{/_i}}</a></div>{{/show_practice}}{{/current_user}}</div><div id=\"weekly-progress\" class=\"inner-content hidden\"><div class=\"daily-progress no-border\"><ul class=\"progress-calendar\" style=\"{{^current_user}}margin: 0;{{/current_user}}\">{{#calendar}}<li class=\"{{state}}\"><strong class=\"day\">{{#day_of_week}}{{day}}{{/day_of_week}}</strong><div class=\"coins\" data-toggle=\"popover\" data-placement=\"above\" data-popover=\"#{{day}}-popover\" data-margin=\"20\"><div class=\"stack amount{{stack}}\"></div>{{#points}}<div id=\"{{day}}-popover\" class=\"popover black above lesspadding\"><div class=\"arrow\"></div><div class=\"inner\"><div class=\"content\" style=\"color: white\"><ul class=\"popover-points-list\"><li><span class=\"skill-points-small\"><span class=\"icon-star-small\" style=\"margin: 0 3px -4px 0;\"></span>{{points}} </span> {{#_i}}Skill {{#pluralize}}point,points,{{points}}{{/pluralize}}{{/_i}}</li></ul></div></div></div>{{/points}}</div></li>{{/calendar}}</ul>{{#current_user}}<div class=\"send-email\"><p>{{#_i}}Get skill points every day for best results{{/_i}}</p><label><input id=\"notify-practice\" type=\"checkbox\" {{#notify_practice}}checked=\"checked\"{{/notify_practice}}/> {{#_i}}Daily reminder email{{/_i}}</label>{{#notify_practice}}<div class=\"send-time\">{{#_i}}at{{/_i}}<select id=\"practice-notify-time\" class=\"medium\">{{#practice_times}}<option {{#selected}}selected=\"selected\"{{/selected}} value=\"{{offset}}\">{{time}}</option>{{/practice_times}}</select></div>{{/notify_practice}}</div>{{/current_user}}</div></div></div></div>{{#logged_in}}{{^current_user}}<div class=\"follow-user\"><a id=\"follow\" class=\"follow-button btn large {{^is_following}}primary{{/is_following}}{{#is_following}}success{{/is_following}}\">{{#is_following}}{{#_i}}Following {{username}}{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow {{username}}{{/_i}}{{/is_following}}</a><p style=\"margin: 0;\">{{^is_following}}{{#_i}}Receive updates from {{username}} and compare your learning progress.{{/_i}}{{/is_following}}{{#is_following}}{{#_i}}You are subscribed to {{username}}\u2019s updates.{{/_i}}{{/is_following}}</p></div>{{/current_user}}{{/logged_in}}{{#current_user}}<div id=\"ranking\" class=\"home-leaderboard\"></div><div class=\"duo-family\"><h5>{{#_i}}Join the Duolingo family!{{/_i}}</h5><ul id=\"fb-page-like\"><li class=\"twitter\"><iframe allowtransparency=\"true\" frameborder=\"0\" scrolling=\"no\" src=\"//platform.twitter.com/widgets/follow_button.html?screen_name=duolingo&show_count=true&lang={{ui_language}}\" style=\"width:300px; height:20px;\"></iframe></li><li class=\"facebook\"><iframe src=\"//www.facebook.com/plugins/like.php?href=http%3A%2F%2Ffacebook.com%2Fduolingo&amp;send=false&amp;layout=button_count&amp;width=450&amp;show_faces=true&amp;font&amp;colorscheme=light&amp;action=like&amp;height=21&amp;appId=234536436609303\" scrolling=\"no\" frameborder=\"0\" style=\"border:none; overflow:hidden; width:300px; height:21px;\" allowTransparency=\"true\"></iframe></li></ul></div>{{/current_user}}","profile-stats":"<li data-toggle=\"popover\" data-popover=\"#skillpoints-breakdown\" data-placement=\"below\"><span class=\"skill-points\"></span>{{total_points}}<div id=\"skillpoints-breakdown\" class=\"popover points-breakdown black top below\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h4>{{#_i}}Skill points{{/_i}}</h4><ul class=\"\">{{#points_languages}}{{#learning}}<li><span class=\"gold-coin\"></span><strong class=\"points\">{{points}}</strong><span class=\"text\">{{#_ivar}}language_string{{/_ivar}}</span></li>{{/learning}}{{/points_languages}}<li><span class=\"activity\"></span><strong class=\"points\">+{{points_gained_in_week}}</strong><span class=\"text\">{{#_i}}{{#pluralize}}Point,Points,{{points_gained_in_week}}{{/pluralize}} this week{{/_i}}</span></li></ul></div></div></div></li><li data-toggle=\"popover\" data-popover=\"#words-breakdown\" data-placement=\"below\"><span class=\"words-icon {{#ui_language_es}}es{{/ui_language_es}} {{#ui_language_pt}}es{{/ui_language_pt}} {{#ui_language_it}}es{{/ui_language_it}} {{#ui_language_fr}}fr{{/ui_language_fr}}\"></span><span id=\"word-count\">{{#loading_word_count}}<img src=\"/images/profile-word-spinner.gif\" style=\"\" class=\"spinner\" />{{/loading_word_count}}{{^loading_word_count}}{{#vocab_size}}{{total}}{{/vocab_size}}{{/loading_word_count}}</span><div id=\"words-breakdown\" class=\"popover points-breakdown black top below\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h4>{{#_i}}Words{{/_i}}</h4><ul class=\"\">{{#vocab_size}}{{#languages}}<li><span class=\"words-icon small {{#ui_language_es}}es{{/ui_language_es}} {{#ui_language_pt}}es{{/ui_language_pt}} {{#ui_language_it}}es{{/ui_language_it}} {{#ui_language_fr}}fr{{/ui_language_fr}}\"></span><strong class=\"points\">{{count}}</strong><span class=\"text\">{{#_ivar}}language_string{{/_ivar}}</span></li>{{/languages}}{{/vocab_size}}</ul></div></div></div></li><li data-toggle=\"popover\" data-popover=\"#streak-breakdown\" data-placement=\"below\"><span class=\"streak\"></span>{{longest_streak}}<div id=\"streak-breakdown\" class=\"popover points-breakdown black top below\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h4>{{#_i}}Streaks{{/_i}}</h4><ul class=\"\">{{#streak_languages}}{{#learning}}<li><span class=\"streak-small\"></span><strong class=\"points\">{{streak}}</strong><span class=\"text\">{{#_ivar}}language_string{{/_ivar}}</span></li>{{/learning}}{{/streak_languages}}</ul></div></div></div></li>","progress-bar":"<ul class=\"progress-small clearfix\">{{#elements}}<li id=\"element-{{.}}\" class=\"nothing\"></li>{{/elements}}</ul> ","rate-event":"{{#user}}{{>avatar_medium}}{{/user}}<ul class=\"point-gain-box\"><li><span class=\"icon-voted-up\"></span><span class=\"voted-up-points\">+1</span></li></ul><h5>{{#user}}<a href=\"#/{{username}}\" class=\"user\">{{username}}</a>{{/user}}{{#_i}}{{#others}} and {{others}} {{#pluralize}}other,others,{{others}}{{/pluralize}}{{/others}} {{#pluralize}}thinks,think,{{count}}{{/pluralize}} {{#for_user}}{{username}}{{/for_user}}'s translation is very good.{{/_i}}</h5><p><a href=\"#/translation/{{translation_id}}/{{sentence_id}}/{{sentence_translation_id}}\" class=\"\">{{title}}</a></p><div class=\"stream-comments {{^has_comments}}hidden{{/has_comments}}\"></div>{{>event-footer}} ","rate-reward":"{{^state_rate}}<span class=\"coin\">+1</span>{{/state_rate}}{{#state_rate}}<div class=\"coin-message\">{{#first}}<span class=\"reward\">+1</span>{{#_i}}<strong>Nice!</strong> You are the first to rate.{{/_i}}{{/first}}{{^first}}{{#correct_rating}}<span class=\"reward\">+1</span>{{#_i}}You agree with<br/><strong>{{num_agreers}} {{#pluralize}}other,others,{{num_agreers}}{{/pluralize}}!</strong>{{/_i}}{{/correct_rating}}{{^correct_rating}}{{#_i}}<strong>Hmm</strong>, no others agree with you{{/_i}}. {{/correct_rating}}{{/first}}</div>{{/state_rate}}","register":"<div class=\"center-pane\"><form action=\"/welcome\" method=\"post\" id=\"register-form\"><input type=\"hidden\" name=\"came_from\" value=\"{{came_from}}\"/><input type=\"hidden\" name=\"register\" value=\"register\"/><input type=\"submit\" class=\"hidden\" value=\"firefox_submit\"/><fieldset class=\"clearfix\">{{^facebook_id}}{{^twitter_id}}{{^invite}}{{^invited_by}}<h1 class=\"sign-up\">{{#_i}}Sign up{{/_i}}</h1>{{/invited_by}}{{/invite}}{{/twitter_id}}{{/facebook_id}}{{#facebook_id}}<h1>{{#_i}}Connected to Facebook!{{/_i}}</h1><h2>{{#_i}}Now complete your profile.{{/_i}}</h2><input name=\"profile_image\" type=\"hidden\" value=\"http://graph.facebook.com/{{facebook_id}}/picture?type=large\"><input name=\"facebook_id\" type=\"hidden\" value=\"{{facebook_id}}\">{{/facebook_id}}{{#twitter_id}}<h1>{{#_i}}Connected to Twitter!{{/_i}}</h1><h2>{{#_i}}Now complete your profile.{{/_i}}</h2><input name=\"profile_image\" type=\"hidden\" value=\"http://api.twitter.com/1/users/profile_image?screen_name={{twitter_username}}&size=bigger\"><input name=\"twitter_id\" type=\"hidden\" value=\"{{twitter_id}}\">{{/twitter_id}}{{#invite}}<h1>{{#_i}}It\u2019s here!{{/_i}}</h1><h2>{{#_i}}You have an invitation.<br/>Register for Duolingo.{{/_i}}</h2>{{/invite}}{{#invited_by}}<h1>{{#_i}}It\u2019s here!{{/_i}}</h1><h2>{{#_i}}You have an invitation.<br/>Register for Duolingo.{{/_i}}</h2>{{/invited_by}}<ul class=\"login-signup-list\"><li><select class=\"medium\" name=\"learning_language\" id=\"learning-language\">{{#available_languages}}<option value=\"{{key}}\">{{i_want_to_learn}} {{learning_language_name}} {{from_info}}</option>{{/available_languages}}</select></li><li><label for=\"login\">{{#_i}}Choose a username{{/_i}}</label><input class=\"large\" id=\"login\" name=\"register_login\" size=\"30\" type=\"text\" value=\"{{username}}\"><div class=\"error-flag\" id='login-error'>{{#_i}}Username is too short/Username contains special characters{{/_i}}</div></li><li><label for=\"password\">{{#_i}}Choose a password{{/_i}}</label><input class=\"large\" id=\"password\" name=\"register_password\" size=\"30\" type=\"password\"><div class=\"error-flag\" id='password-error'>{{#_i}}Password is too short or invalid{{/_i}}</div></li><li><label for=\"email\">{{#_i}}Email{{/_i}}</label><input class=\"large\" id=\"email\" name=\"email\" size=\"30\" type=\"text\" value=\"{{email}}\"><div class=\"error-flag\" id='email-error'>{{#_i}}Enter a correct email address{{/_i}}</div></li><input name=\"ui_language\" type=\"hidden\" value=\"{{ui_language}}\"><input name=\"invite\" type=\"hidden\" value=\"{{invite}}\"><input name=\"invited_by\" type=\"hidden\" value=\"{{invited_by}}\"><li><input id=\"register-button\" type=\"submit\" class=\"btn large primary\" value=\"{{#_i}}Create Account{{/_i}}\"/></li></ul></fieldset><p class=\"legalese\">{{#_i}}By clicking \"Create Account\", you are indicating that you<br/>have read and agree to the <a target=\"_blank\" href=\"/#/terms\">Terms of Service</a>.{{/_i}}</p></form></div> ","reset":"<div class=\"center-pane\"><form action=\"\" method=\"post\" id=\"reset-form\" style=\"margin: 0;\"><input type=\"hidden\" name=\"came_from\" value=\"{{came_from}}\"/><input type=\"hidden\" id=\"email\" name=\"email\" value=\"{{email}}\"/><input type=\"hidden\" id=\"token\" name=\"token\" value=\"{{token}}\"/><fieldset class=\"clearfix\"><h1>{{#_i}}Reset Password{{/_i}}</h1><ul class=\"login-signup-list\"><li><label for=\"new-password\">{{#_i}}New Password{{/_i}}</label><input class=\"large\" id=\"new-password\" name=\"new-password\" size=\"30\" type=\"password\"></li><li><label for=\"confirm-new-password\">{{#_i}}Confirm New Password{{/_i}}</label><input class=\"large\" id=\"confirm-new-password\" name=\"confirm-new-password\" size=\"30\" type=\"password\"></li><li><input type=\"submit\" class=\"btn large primary\" style=\"width: 288px;\" value=\"{{#_i}}Submit{{/_i}}\"/></li></ul></fieldset></form><div id=\"form_txt_good\" class=\"form_msg hidden\"><h1 style=\"margin: 0 0 25px -55px; width: 400px;\">{{#_i}}Password Changed!{{/_i}}</h1><h3><a href=\"/\">{{#_i}}Click here to continue to Duolingo{{/_i}}</a></h3></div><div id=\"reset-message\"></div></div>","select-element":"<h1>{{#_i}}<strong>Select</strong> the correct image{{/_i}}</h1><h2>\u201c{{hint}}\u201d</h2><ul class=\"select-images-list {{#new_player_blame_experiment_true}}new{{/new_player_blame_experiment_true}}\">{{#options}}<li id=\"option-{{number}}\"><div class=\"image-container\" style=\"background-image: url('{{image}}')\"></div><input type=\"radio\" class=\"radio\" name=\"selection\" value=\"{{phrase}}\" data-number=\"{{number}}\"><strong class=\"number\">{{number}}</strong><h4 class=\"name\">{{phrase}}</h4></li>{{/options}}</ul>{{#options}}<div id=\"speaker-{{number}}\"></div>{{/options}}","sentences-rank-modal":"<div class=\"modal-header\"><h4 style=\"margin: 0 0 10px 0;\">{{#_i}}{{#_ivar}}learning_language_string{{/_ivar}} translation rank{{/_i}}</h4><p style=\"margin: 0 0 -5px 0;\" class=\"grayDark\">{{#_i}}{{#current_user}}You follow {{/current_user}}{{^current_user}}{{username}} follows {{/current_user}} {{num_following}} {{#pluralize}}person,people,{{num_following}}{{/pluralize}} and {{#current_user}}are{{/current_user}}{{^current_user}}is{{/current_user}} ranked {{#ranked_number}}{{sentences_translated_rank}}{{/ranked_number}} compared to them.{{/_i}}</p><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"><div class=\"list-users-small-legend\"><span class=\"sentences-translated\"></span></div><ul class=\"list-users-small\">{{#sentences_translated_ranking_data}}<li {{#self}}class=\"self\"{{/self}}><span class=\"position\">{{rank}}.</span>{{>avatar_small}}<a href=\"#/{{username}}\" class=\"user\">{{username}}</a><span class=\"sentences-translated\">{{sentences_translated}}</span></li>{{/sentences_translated_ranking_data}}</ul></div>","session":"{{>player-header}}<div id=\"session-element-container\"></div><div class=\"intro\"></div><div id=\"controls\" class=\"player-action\"><div class=\"row\"><div class=\"left {{#points_per_correct}}timer{{/points_per_correct}}\" style=\"padding: 0 0 0 20px;\"><div id=\"grade\" ></div></div>{{#requires_ready}}<div class=\"right ready-panel\"><button id=\"start-button\" type=\"submit\" class=\"btn success large right\" tabindex=\"10\">{{#_i}}Start timed practice{{/_i}}</button>{{#allow_opt_out}}<button id=\"untimed-button\" type=\"submit\" class=\"btn large right\" tabindex=\"10\" style=\"margin: 0 10px 0 0;\">{{#_i}}Practice without a timer{{/_i}}</button>{{/allow_opt_out}}</div>{{/requires_ready}}<div class=\"right {{#requires_ready}}action-panel hidden{{/requires_ready}}\"><div style=\"margin-left: 10px; float: right;\"><button id=\"continue_button\" type=\"submit\" class=\"btn success large right\" disabled=\"disabled\" data-margin=\"5\" title=\"{{#_i}}Press Enter to Continue{{/_i}}\" tabindex=\"20\">{{#_i}}Continue{{/_i}}</button></div><button id=\"submit_button\" type=\"submit\" class=\"btn success large right\" disabled=\"disabled\" data-margin=\"5\" title=\"{{#_i}}Press Enter to Check{{/_i}}\" tabindex=\"10\">{{#_i}}Check{{/_i}}</button><button id=\"no-mic-link\" style=\"display: none; margin-right: 10px;\" type=\"submit\" class=\"btn large right hidden\" tabindex=\"10\">{{#_i}}Activate microphone later{{/_i}}</button>{{^new_player_blame_experiment_true}}<div class=\"below-continue\"><a id=\"skip_button\" href=\"javascript:;\" tabindex=\"30\">{{#_i}}Don\u2019t know the answer? \u2014 skip{{/_i}}</a></div>{{/new_player_blame_experiment_true}}</div></div></div><div id=\"no-sound-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"><div class=\"modal-header\"><h4>{{#_i}}We can't play sound in your browser.{{/_i}}</h4><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"></div></div>","session-end":"{{^awesome}}<div class=\"new-session-end\">{{^first_time}}<div class=\"player-action-right\"><h2 style=\"\">{{#_i}}<strong>{{num_strengthened}} {{#pluralize}}word,words,{{num_strengthened}}{{/pluralize}} strengthened</strong>{{/_i}}</h2><ul class=\"words-strengthened\">{{#words_strengthened}}<li>{{#new}}<span class=\"icon-present-small left\" title=\"New word\"></span>{{/new}} <span class=\"lexeme-form\">{{value}}</span><ul class=\"word-strength small\"><li class=\"filled\"></li><li {{#strength_s}}class=\"filled\"{{/strength_s}}></li><li {{#strength_m}}class=\"filled\"{{/strength_m}}></li><li {{#strength_l}}class=\"filled\"{{/strength_l}}></li></ul></li>{{/words_strengthened}}{{^words_strengthened}}<div class=\"zero-words-text\">{{#_i}}Keep practicing to strengthen your vocabulary!{{/_i}}</div>{{/words_strengthened}}</ul><div class=\"button-relocator\">{{#home}}{{^has_accumulation}}<button data-r=\"home\" data-href=\"\" class=\"end-continue btn large primary\">{{#_i}}Continue learning{{/_i}}</button>{{/has_accumulation}}{{#has_accumulation}}<button data-r=\"home\" data-href=\"practice/timed\" type=\"submit\" style=\"display:inline-block; margin: 10px 7px 0 7px\" class=\"end-continue btn large two-buttons\">{{#_i}}Practice again{{/_i}}</button><button data-r=\"home\" data-href=\"\" type=\"submit\" style=\"display:inline-block; margin: 10px 7px 0 7px\" class=\"end-continue btn large primary two-buttons\">{{#_i}}Done{{/_i}}</button>{{/has_accumulation}}{{/home}}{{^home}}{{^has_accumulation}}{{#to_skill}}<button data-r=\"skill\" data-href=\"/skill/{{language}}/{{skill_name}}\" type=\"submit\" class=\"end-continue btn large primary\">{{#_i}}Continue learning{{/_i}}</button>{{/to_skill}}{{/has_accumulation}}{{#has_accumulation}}<button data-r=\"skill\" data-href=\"skill/{{language}}/{{skill_name}}/practice/timed\" type=\"submit\" style=\"display:inline-block; margin: 10px 7px 0 7px\" class=\"end-continue btn large two-buttons\">{{#_i}}Practice again{{/_i}}</button>{{#to_skill}}<button data-r=\"skill\" data-href=\"/skill/{{language}}/{{skill_name}}\" type=\"submit\" style=\"display:inline-block; margin: 10px 7px 0 7px\" class=\"end-continue btn large primary two-buttons\">{{#_i}}Done{{/_i}}</button>{{/to_skill}}{{/has_accumulation}}{{#from_word}}<button data-r=\"vocab\" data-href=\"/word/{{language}}/{{from_word}}/{{pos}}\" type=\"submit\" class=\"end-continue btn large primary\">{{#_i}}Back to {{from_word}}{{/_i}}</button>{{/from_word}}{{#from_skill_vocab}}<button data-r=\"vocab\" data-href=\"/vocab/{{from_skill_vocab}}{{#lesson}}/{{lesson}}{{/lesson}}\" type=\"submit\" class=\"end-continue btn large primary\">{{#_i}}Back to Vocabulary{{/_i}}</button>{{/from_skill_vocab}}{{#welcome}}<button data-r=\"home\" data-href=\"\" class=\"end-continue btn large\">{{#_i}}Done{{/_i}}</button>{{/welcome}}{{/home}}</div></div>{{/first_time}}<div id=\"session-element-container\">{{#has_hearts}}<h1>{{^is_timed}}{{#gained_skill_points}}{{#hearts-0}}{{#_i}}<strong>Phew!</strong> You finished with zero hearts{{/_i}}{{/hearts-0}}{{/gained_skill_points}}{{^gained_skill_points}}{{#hearts-0}}{{#_i}}<strong>Great!</strong> You completed this lesson again.{{/_i}}{{/hearts-0}}{{/gained_skill_points}}{{#hearts-4}}{{#_i}}<strong>Awesome!</strong> You finished with 4 hearts left{{/_i}}{{/hearts-4}}{{#hearts-3}}{{#_i}}<strong>Awesome!</strong> You finished with 3 hearts left{{/_i}}{{/hearts-3}}{{#hearts-2}}{{#_i}}<strong>Pretty sweet!</strong> You finished with 2 hearts left{{/_i}}{{/hearts-2}}{{#hearts-1}}{{#_i}}<strong>Good job!</strong> You finished with 1 heart left{{/_i}}{{/hearts-1}}{{/is_timed}}{{#is_timed}}{{^seconds_left}}{{#_i}}<b>You ran out of time</b>, so this is all you get{{/_i}}{{/seconds_left}}{{#seconds_left}}{{#_i}}<b>Awesome!</b> You finished with <span class=\"inline-timer\"></span>{{#format_seconds}}{{seconds_left}}{{/format_seconds}} left{{/_i}}{{/seconds_left}}{{/is_timed}}</h1>{{/has_hearts}}{{^has_hearts}}{{#correct}}{{^seconds_left}}<h1>{{#_i}}<b>Time\u2019s up!</b> You got {{point_accumulation}} {{#pluralize}}answer,answers,{{point_accumulation}}{{/pluralize}} correct{{/_i}}</h1>{{/seconds_left}}{{#seconds_left}}<h1>{{#_i}}<b>You beat the clock</b> and got {{point_accumulation}} {{#pluralize}}answer,answers,{{point_accumulation}}{{/pluralize}} correct!{{/_i}}</h1>{{/seconds_left}}{{/correct}}{{^correct}}<h1>{{#_i}}<b>Oh no!</b> You didn\u2019t get any answers correct{{/_i}}</h1>{{/correct}}{{/has_hearts}}{{^is_timed}}{{^gained_skill_points}}<img class=\"congrats-owl\" src=\"/images/lesson-end/congrats-owl.png\"/>{{/gained_skill_points}}{{/is_timed}}{{#gained_skill_points}}<div class=\"rewards\"><div class=\"reward-big\"><div class=\"animated-pieces\">{{^is_timed}}{{#lesson_points}}<div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><img class=\"hidden\" data-style=\"reward-coin-big\" src=\"http://static.duolingo.com/images/lesson-end/big-coin.png\"/></div></div><div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><span class=\"hidden\" data-style=\"reward-text-big\">+{{lesson_points}}</span></div></div>{{/lesson_points}}{{/is_timed}}{{#has_accumulation}}{{#point_accumulation}}<div class=\"animation-wrapper-big\"><div class=\"animation-table-cell-big\"><img class=\"hidden\" data-style=\"reward-coin-big\" src=\"http://static.duolingo.com/images/lesson-end/big-coin.png\"/></div></div><div class=\"animation-wrapper-big\"><div class=\"animation-table-cell-big\"><span class=\"hidden\" data-style=\"reward-text-big\">+{{point_accumulation}}</span></div></div>{{/point_accumulation}}{{/has_accumulation}}{{^has_accumulation}}{{#is_timed}}{{#time_bonus}}<div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><img class=\"hidden\" data-style=\"reward-coin-big\" src=\"http://static.duolingo.com/images/lesson-end/big-coin.png\"/></div></div><div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><span class=\"hidden\" data-style=\"reward-text-big\">+{{time_bonus}}</span></div></div>{{/time_bonus}}{{/is_timed}}{{/has_accumulation}}</div></div>{{^has_hearts}}{{#has_accumulation}}<div class=\"reward-small\"><div class=\"animated-pieces\"><div class=\"animation-wrapper-small\"><div class=\"animation-table-cell-small\"><div id=\"timer-container\" style=\"width: 73px; height: 73px\"></div><img class=\"hidden\" src=\"/images/lesson-end/timer.png\" data-style=\"lesson-end-timer\"></div></div><div class=\"animation-wrapper-small\"><div class=\"animation-table-cell-small\"><span id=\"timer-text\" class=\"hidden\" data-style=\"lesson-end-timer-text\">{{#format_seconds}}0{{/format_seconds}}</span></div></div></div></div>{{/has_accumulation}}{{/has_hearts}}{{#hearts_bonus}}{{#lesson_points}}<div class=\"reward-small\"><div class=\"animated-pieces\"><div class=\"animation-wrapper-small\"><div class=\"animation-table-cell-small\"><img class=\"hidden\" data-style=\"reward-coin-small\" src=\"http://static.duolingo.com/images/lesson-end/medium-coin.png\"/></div></div><div class=\"animation-wrapper-small\"><div class=\"animation-table-cell-small\"><span class=\"hidden\" data-style=\"reward-text-small\">+{{hearts_bonus}}</span></div></div></div><div class=\"popover-pad-1\" data-toggle=\"popover\" data-placement=\"above\" data-popover=\"#big-coin-popover\"></div><div id=\"big-coin-popover\" class=\"popover black top above\" styled=\"position:absolute; top: 116px; left: 248px\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h3> {{#_i}}Heart Bonus{{/_i}}</h3></div></div></div> <!-- end popover --><div class=\"popover-pad-2\" data-toggle=\"popover\" data-placement=\"above\" data-popover=\"#med-coin-popover\"></div><div id=\"med-coin-popover\" class=\"popover black top above\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h3>{{#_i}}Lesson Completed{{/_i}}</h3></div></div></div> <!-- end popover --></div>{{/lesson_points}}{{^lesson_points}}<div class=\"reward-small\"><div class=\"animated-pieces\"><div class=\"animation-wrapper-small-single\"><div class=\"animation-table-cell-small\"><img class=\"hidden\" data-style=\"reward-coin-small\" src=\"http://static.duolingo.com/images/lesson-end/medium-coin.png\"/></div></div><div class=\"animation-wrapper-small-single\"><div class=\"animation-table-cell-small\"><span class=\"hidden\" data-style=\"reward-text-small\">+{{hearts_bonus}}</span></div></div></div></div>{{/lesson_points}}{{/hearts_bonus}}</div>{{/gained_skill_points}}{{#gained_skill_points}}<div class=\"progress-bar-big\"></div>{{#points_data}}<div class=\"level-progress-end\"><span style=\"position:relative; right:3px\">{{next_level}}</span></div><div class=\"progress-slice\" style=\"width: {{level_before_bar_width}}px\"><div class=\"popover-outer\"><div class=\"popover-marker\"><span class=\"level-popover\"><img style=\"display:inline-block; vertical-align: text-bottom; padding-right: 5px; position: relative; top: 2px\" src=\"/images/lesson-end/small-coin.png\">{{#_i}}<b><span id=\"left-in-level\">{{level_left_before}}</span> away</b> from Level {{next_level}}{{/_i}}</span></div></div></div><div class=\"level-progress-start\">{{level}}</div>{{/points_data}}{{/gained_skill_points}}</div></div>{{/awesome}}{{#awesome}}<div class=\"awesome-end\"><div class=\"container\"><img src=\"http://static.duolingo.com/images/color-burst-light.png\" class=\"color-burst\" />{{>awesome-stats}}<div class=\"share-panel-big\">{{>session-end-social}}{{#home}}<button data-r=\"home\" data-href=\"\" class=\"end-continue btn right primary\">{{#_i}}Continue learning{{/_i}}</button>{{/home}}{{^home}}{{#to_skill}}<button data-r=\"skill\" data-href=\"/skill/{{language}}/{{skill_name}}\" type=\"submit\" class=\"end-continue btn right primary\">{{#_i}}Continue learning{{/_i}}</button>{{/to_skill}}{{#from_word}}<button data-r=\"vocab\" data-href=\"/word/{{language}}/{{from_word}}/{{pos}}\" type=\"submit\" class=\"end-continue btn large right primary\">{{#_i}}Back to {{from_word}}{{/_i}}</button>{{/from_word}}{{#from_skill_vocab}}<button data-r=\"vocab\" data-href=\"/vocab/{{from_skill_vocab}}\" type=\"submit\" class=\"end-continue btn large right primary\">{{#_i}}Back to Vocabulary{{/_i}}</button>{{/from_skill_vocab}}{{/home}}<div class=\"fb-auto-post\"><input id=\"fb-auto-post\" type=\"checkbox\" {{#auto_facebook_post}}checked=\"checked\"{{/auto_facebook_post}}/> {{#_i}}Automatically share on Facebook{{/_i}}</div></div><div id=\"trumpet\"></div></div></div>{{/awesome}} ","session-end-social":"<a id=\"facebook-post-action\" class=\"facebook-share-big left\" href=\"javascript:;\" style=\"margin: 1px 5px 0 0;\"><i></i>{{#_i}}Share on Facebook{{/_i}}</a><div style=\"display: inline-block; margin-bottom: -5px; float: left;\"><a href=\"https://twitter.com/share\" style=\"margin: 1px 0 0 0;\" class=\"twitter-share-button\" {{#level_event}}data-text=\"{{#_i}}I reached Level {{new_level}} {{#_ivar}}language_string{{/_ivar}}!{{/_i}}\"{{/level_event}}{{^level_event}}data-text=\"{{#_i}}I {{#mastered}}mastered {{#_ivar}}headline_mastered{{/_ivar}}{{/mastered}}{{^mastered}}{{#learned}}learned {{#_ivar}}headline_learned{{/_ivar}}{{/learned}}{{/mastered}} in {{#_ivar}}language_string{{/_ivar}}!{{/_i}}\"{{/level_event}} data-url=\"http://duolingo.com\" data-count=\"none\" data-via=\"duolingo\" data-size=\"large\">{{#_i}}Tweet{{/_i}}</a></div> ","session-explanation":"<div class=\"inner\"><span class=\"icon\"></span>{{#_i}}Tips and notes{{/_i}}</div><div class=\"popover below\"><div class=\"arrow\"></div><div class=\"close\"></div><div class=\"inner\"><div class=\"content\">{{{explanation}}}</div></div></div>","session-failed":"{{>player-header}}<div id=\"session-element-container\"><h1 style=\"margin: 15px 0 50px 0; text-align: center; text-shadow: 0 1px 0 white; font-size: 30px;\">{{#learning_es}}<strong>\u00a1Ay!</strong>{{/learning_es}}{{#learning_de}}<strong>Verdammt!</strong>{{/learning_de}}{{#learning_fr}}<strong>Oups !</strong>{{/learning_fr}}{{#learning_en}}<strong>Ouch!</strong>{{/learning_en}} &nbsp; {{#none_correct}}{{#_i}}You didn't get any answers correct.{{/_i}}{{/none_correct}}{{^none_correct}}{{#times_up}}{{#_i}}You ran out of time...{{/_i}}{{/times_up}}{{^times_up}}{{#_i}}You are out of hearts...{{/_i}}{{/times_up}}{{/none_correct}}</h1><div class=\"owl-standing-crying\" style=\"left: 365px; bottom: 10px;\"></div><div class=\"close-fail\"><div class=\"close\"></div>{{#_i}}show my answer{{/_i}}</div></div><div id=\"controls\" class=\"player-action incorrect\"><div class=\"row\"><div class=\"left\" style=\"padding: 0 0 0 20px;\"><div id=\"grade\"></div></div><div class=\"right\"><button id=\"retry-button\" class=\"btn large right success\" style=\"margin: 0 0 0 10px;\">{{#_i}}Retry{{/_i}}</button><button id=\"home-button\" class=\"btn large right\">{{#_i}}Go back to home{{/_i}}</button></div></div></div> ","session-hearts":"<div class=\"inner\">{{#hover_heart_experiment_true}}<ul class=\"quarter-hearts\">{{#hearts}}<li class=\"heart\">{{#parts}}<div id=\"heart-{{index}}\" class=\"quarter-{{quarter}} heart-{{^used}}un{{/used}}used\"></div>{{/parts}}</li>{{/hearts}}</ul>{{/hover_heart_experiment_true}}{{^hover_heart_experiment_true}}<ul class=\"half-hearts\">{{#hearts}}{{#parts}}<li id=\"heart-{{index}}\" class=\"{{#odd}}odd{{/odd}}{{^odd}}even{{/odd}} heart-{{^used}}un{{/used}}used\"></li>{{/parts}}{{/hearts}}</ul>{{/hover_heart_experiment_true}}</div><div class=\"popover below\"><div class=\"arrow\"></div><div class=\"inner\" style=\"padding: 20px;\"><div class=\"content\">{{^hover_heart_experiment_true}}<h4>{{#_i}}{{num_hearts}} {{#pluralize}}Heart,Hearts,{{num_hearts}}{{/pluralize}}{{/_i}}</h4><p>{{#_i}}Don't make more than {{num_hearts}} {{#pluralize}}mistake,mistakes,{{num_hearts}}{{/pluralize}}<br/> or you'll have to start over!{{/_i}}</p>{{/hover_heart_experiment_true}}{{#hover_heart_experiment_true}}<h4>{{#_i}}{{fraction_hearts}} {{#pluralize}}Heart,Hearts,{{num_hearts}}{{/pluralize}}{{/_i}}</h4><p>{{#_i}}You lose a heart when you make a mistake and \u00bc heart when you peek{{/_i}}.</p>{{/hover_heart_experiment_true}}</div></div></div>","settings":"<ul id=\"settings_tab\" class=\"tabs big\"><li><a href=\"#/settings/account\" id=\"account_tab\">{{#_i}}Account{{/_i}}</a></li><li><a href=\"#/settings/profile\" id=\"profile_tab\">{{#_i}}Profile{{/_i}}</a></li><li><a href=\"#/settings/password\" id=\"password_tab\">{{#_i}}Password{{/_i}}</a></li><li><a href=\"#/settings/notifications\" id=\"notifications_tab\">{{#_i}}Notifications{{/_i}}</a></li></ul><div id='tab-container'></div><div class=\"player-action\"><button id=\"submit_button\" type=\"submit\" class=\"btn large primary right\">{{#_i}}Save changes{{/_i}}</button><!-- <button id=\"cancel_button\" type=\"reset\" class=\"btn large right\">{{#_i}}Cancel{{/_i}}</button> --><div id='confirmation-message' class='hidden save-message'>{{#_i}}Saved!{{/_i}}</div><div id='error-message' class='hidden save-message'>{{#_i}}Error{{/_i}}</div></div><button id=\"do-not-push\" class=\"hidden\"></button> ","settings_profile":"<div id=\"profile-content\" class=\"settings-content\"><div class=\"row\"><div class=\"column span11\"><ul class=\"settings\"><li><label>{{#_i}}Fullname{{/_i}}</label><div class=\"input\"><input class=\"large\" id=\"fullname\" name=\"fullname\" size=\"30\" type=\"text\" value=\"{{fullname}}\"></div></li><li><label for=\"location\">{{#_i}}Location{{/_i}}</label><div class=\"input\"><input class=\"large\" id=\"location\" name=\"location\" size=\"30\" type=\"text\" value=\"{{location}}\"></div></li><li><label for=\"bio\">{{#_i}}Bio{{/_i}}</label><div class=\"input\"><textarea id=\"bio\" name=\"bio\" rows=\"3\" cols=\"40\">{{bio}}</textarea><span class=\"help-block\"><span id=\"bio-count\">140</span> {{#_i}}characters left{{/_i}}</span></div></li><li><label for=\"facebook\">{{#_i}}Facebook Connect{{/_i}}</label><div class=\"input\"><input class=\"hidden\" id=\"facebook_id\" name=\"facebook_id\" size=\"30\" type=\"text\" value=\"{{facebook_id}}\">{{^facebook_id}}<a id=\"facebook-connect\" href=\"javascript:;\" class=\"btn primary large fb-connect\" style=\"margin: -5px 0 0 0\">{{#_i}}Connect to Facebook{{/_i}}</a>{{/facebook_id}}{{#facebook_id}}{{#_i}}You are connected as{{/_i}} {{^facebook_name}}<fb:name uid=\"{{facebook_id}}\" capitalize=\"true\" useyou=\"false\" />{{/facebook_name}}{{#facebook_name}}<a id=\"facebook-profile-link\" href=\"http://www.facebook.com/{{facebook_id}}\" target=\"_blank\">{{facebook_name}}</a>{{/facebook_name}}. <a id=\"facebook-disconnect\" href=\"javascript:;\" class=\"btn\">{{#_i}}Disconnect{{/_i}}</a>{{/facebook_id}}</div></li>{{#facebook_id}}<li><label for=\"auto_facebook_post\">{{#_i}}Automatically share on Facebook{{/_i}}</label><div class=\"input\"><ul class=\"inputs-inline\"><li><label><input class=\"\" id=\"auto_facebook_post_on\" name=\"auto_facebook_post\" type=\"radio\" value=\"true\" {{#auto_facebook_post}}checked{{/auto_facebook_post}}> {{#_i}}on{{/_i}}</label></li><li><label><input class=\"\" id=\"auto_facebook_post_off\" name=\"auto_facebook_post\" type=\"radio\" value=\"false\" {{^auto_facebook_post}}checked{{/auto_facebook_post}}> {{#_i}}off{{/_i}}</label></li></ul></div></li>{{/facebook_id}}<li><label for=\"twitter\">{{#_i}}Twitter Connect{{/_i}}</label><div class=\"input\"><input class=\"hidden\" id=\"twitter_id\" name=\"twitter_id\" size=\"30\" type=\"text\" value=\"{{twitter_id}}\">{{^twitter_id}}{{^just_twitter_disconnected}}<a id=\"twitter-connect\" href=\"javascript:;\" class=\"btn primary large twitter-connect\" style=\"margin: -5px 0 0 0\">{{#_i}}Connect to Twitter{{/_i}}</a>{{/just_twitter_disconnected}}{{#just_twitter_disconnected}}{{#_i}}In order to completely disconnect from Twitter, you need to revoke access to Duolingo from your <a href=\"http://twitter.com/settings/applications\" target=\"_blank\">Twitter settings page</a>.{{/_i}}{{/just_twitter_disconnected}}{{/twitter_id}}{{#twitter_id}}{{#_i}}You are connected as{{/_i}} <a id=\"twitter-profile-link\" href=\"http://www.twitter.com/account/redirect_by_id?id={{twitter_id}}\" target=\"_blank\">{{twitter_name}}</a>. <a id=\"twitter-disconnect\" href=\"javascript:;\" class=\"btn\">{{#_i}}Disconnect{{/_i}}</a>{{/twitter_id}}</div></li></ul></div></div></div> ","shadow-banned":"<div class=\"shadow-banned-modal modal\"><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div><div style=\"padding: 30px 30px 20px 30px\" class=\"modal-body\"><h3>Shadow Ban List</h3><span class=\"username-group\"><input id=\"add-username\" type=\"text\" class=\"add-username-input\" maxlength=\"100\"/><label for=\"add-username\">add a username</label></span><span class=\"add-banned pointer\"></span><ul class=\"ban-list\">{{#users}}<li class=\"banned-user\"><span style=\"float:left\">{{#user}}{{>avatar_medium}}{{/user}}</span><div class=\"banned-user-info\"><a class=\"username\" href=\"#/{{#user}}{{username}}{{/user}}\">{{#user}}{{username}}{{/user}}</a><p>{{datetime}}<button class=\"btn primary unban-user\" data-userid=\"{{#user}}{{id}}{{/user}}\" style=\"float:right\">unban</button></p></div></li>{{/users}}</ul></div></div>","short_list":"{{{one}}}{{#two}}{{^more_two}} {{#_i}}and{{/_i}}{{/more_two}}{{#more_two}},{{/more_two}} {{{two}}}{{#three}} {{#_i}}and{{/_i}} {{{three}}}{{/three}}{{#more}} {{#_i}}and {{more}} {{#pluralize}}other,others,{{more}}{{/pluralize}}{{/_i}}{{/more}}{{/two}} ","simple-comments":"<h4 class=\"left\" style=\"margin: 0 10px 10px 0;\">{{#_i}}Comments{{/_i}}: <span class=\"number\">{{num_comments}}</span></h4><strong class=\"golden-badge\" style=\"margin: 0 0 0 0\">{{#_i}}Ask anything{{/_i}}</strong><ul class=\"comment-list\" style=\"padding: 10px 0 0 0;\">{{#comments}}<li>{{#user}}{{>avatar_small}}{{/user}}{{message}} <span class=\"time\">{{datetime_string}}</span>{{#editable}}<a href=\"javascript:;\" class=\"delete-comment\" data-comment=\"{{id}}\">{{#_i}}delete{{/_i}}</a>{{/editable}}</li>{{/comments}}</ul><div class=\"form-row no-margin\"><label for=\"simple-comment-area\">{{#_i}}Write a comment{{/_i}}</label><textarea id=\"simple-comment-area\" class=\"submit\"></textarea><span class=\"post-help\">{{#_i}}Press Enter to post{{/_i}}</span></div>","skill":"{{#test}}{{^mastered}}<a class=\"btn test-out-lock\" href=\"#/skill/{{language}}/{{url_title}}/test\">{{#_i}}Test out of this skill{{/_i}}<div id=\"\" class=\"popover black below skill\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h4>{{#_i}}Feeling confident?{{/_i}}</h4><p style=\"margin: 15px 0 15px 0; color: #BBB\">{{#_i}}If you know about {{#_ivar}}title{{/_ivar}} you can quickly finish this skill by taking a short test.{{/_i}}</p><div class=\"recommended-inset\"><span class=\"icon-lock-small\"></span><span class=\"skill-points-small\" style=\"font-weight: normal\">{{test_count}} {{#_i}}{{#pluralize}} attempt, attempts,{{test_count}}{{/pluralize}} left{{/_i}}</span></div></div></div></div></a>{{/mastered}}{{/test}}<h1>{{#_ivar}}title{{/_ivar}}</h1><ul class=\"skill-path\" style=\"position: relative\"><div id=\"skill-canvas\" style=\"margin: -13px 0 0 -14px; left: auto; top: auto\"></div>{{#path}}<li {{#active}}class=\"active\"{{/active}}>{{#open}}{{^translation}}{{^refresh}}<a class=\"lesson unlocked\" href=\"/#/skill/{{language}}/{{url_title}}/{{lesson}}\"><h3>{{#_i}}Lesson{{/_i}}</h3>{{#active}}<span class=\"coin-medium\">+10</span>{{/active}}{{^active}}<span class=\"checkmark\"><span class=\"icon\"></span></span>{{/active}}<strong class=\"number\">{{index}}</strong>{{^active}}<ul class=\"word-strength small blue\">{{#strengths}}<li {{#filled}}class=\"filled\"{{/filled}}></li>{{/strengths}}</ul>{{/active}}</a>{{/refresh}}{{/translation}}{{#translation}}{{>snippet-list}}{{^snippet}}{{#active}}<div class=\"translation unlocked\"><span class=\"spinner\"></span></div>{{/active}}{{^active}}<a href=\"/#/skill/{{language}}/{{url_title}}/translation/{{index}}\" class=\"translation unlocked\"><span class=\"checkmark\"><span class=\"icon\"></span></span><strong class=\"number\">{{index}}</strong><h3>{{#_i}}Real world translation{{/_i}}</h3></a>{{/active}}{{/snippet}}{{/translation}}{{#refresh}}<a class=\"lesson unlocked\" href=\"/#/skill/{{language}}/{{url_title}}/practice/{{index}}\"><h3>{{#timed}}{{#_i}}Bonus round{{/_i}}{{/timed}}{{^timed}}{{#_i}}Refresh{{/_i}}{{/timed}}</h3>{{#active}}<span class=\"coin-medium\">+10</span>{{/active}}{{^active}}<span class=\"checkmark\"><span class=\"icon\"></span></span>{{/active}}{{#timed}}<span class=\"timer-icon\"></span><span class=\"best-time\">{{#best_time}}<strong>Time:</strong> {{#format_seconds}}{{best_time}}{{/format_seconds}}{{/best_time}}</span>{{/timed}}{{^timed}}<strong class=\"number\">{{index}}</strong>{{#no_data}}{{^active}}<ul class=\"hearts\"><li class=\"none\"></li><li class=\"none\"></li><li class=\"none\"></li>{{#beginner}}<li class=\"none\"></li>{{/beginner}}</ul>{{/active}}{{/no_data}}{{^no_data}}<ul class=\"hearts\">{{#hearts}}<li class=\"{{#filled}}filled{{/filled}}{{^filled}}empty{{/filled}}\"></li>{{/hearts}}</ul>{{/no_data}}{{/timed}}</a>{{/refresh}}{{/open}}{{^open}}{{#learn_marker}}<div class=\"end-learned {{#learned}}checked{{/learned}}\"><div class=\"circle\"><div class=\"icon\"></div></div></div>{{/learn_marker}}{{^learn_marker}}<div class=\"lesson locked\"></div>{{/learn_marker}}{{/open}}</li>{{/path}}</ul><ul class=\"skill-sub\"><li><div class=\"community\" style=\"position: relative\"><ul class=\"questions-explanations-tabs tabs big\" style=\"margin-bottom: 30px;\">{{#has_explanation}}<li class=\"active\" data-tab=\"explanation\"><a href=\"javascript:;\">{{#_i}}Tips{{/_i}}</a></li>{{/has_explanation}}<li class=\"{{^has_explanation}}active{{/has_explanation}}\" data-tab=\"comments\"><a href=\"javascript:;\">{{#_i}}Discussion{{/_i}}</a></li></ul><span id=\"ask-question\" class=\"btn skill-new hidden\" {{#has_explanation}}style=\"display: none{{/has_explanation}}\">{{#_i}}New Discussion{{/_i}}</span>{{#has_explanation}}<div id=\"explanation-panel\" class=\"questions-explanations-panel\">{{{explanation}}}</div>{{/has_explanation}}<div style=\"margin-top:-20px\"><div id=\"comments-panel\" class=\"questions-explanations-panel {{#has_explanation}}hidden{{/has_explanation}}\"></div></div></li><li id=\"vocab-overview\"><span class=\"skill-vocab-spinner\"></span></li></div></div><div class=\"modal post-comment hidden community\" id=\"question-fields\"></div> ","skill-item":"{{#locked}}<div class=\"skill-box blue locked dynamic\"><span class=\"icon\"></span><div class=\"screws\"></div></div>{{/locked}}{{^locked}}{{#current_user}}<a href=\"#/skill/{{language}}/{{url_title}}\" class=\"{{size}} {{#recommended}} recommended {{/recommended}} skill-box {{category}} skill-{{index}} dynamic {{#perfect_strength}}mastered{{/perfect_strength}}\">{{/current_user}}{{^current_user}}<span class=\"other-user {{size}} skill-box {{category}} skill-{{index}} {{#small}} small{{/small}} dynamic {{#perfect_strength}}mastered{{/perfect_strength}}\" >{{/current_user}}<div class=\"header\"><div class=\"icon\"></div></div><h5 class=\"title\">{{#_ivar}}short{{/_ivar}}</h5>{{#learned}}<div class=\"learned-trophy\"><span class=\"icon\"></span></div>{{/learned}}{{#current_user}}{{#changed}}<span class=\"added-lessons-badge\">+{{missing_lessons}}</span>{{/changed}}{{/current_user}}<ul class=\"word-strength medium\">{{#strengths}}<li {{#filled}}class=\"filled\"{{/filled}}></li>{{/strengths}}</ul>{{#current_user}}</a>{{/current_user}}{{#current_user}}</span>{{/current_user}}{{/locked}}{{#current_user}}{{^disable_hover}}<div class=\"{{^locked}}unlocked{{/locked}} popover black right skill {{category}} \"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h4>{{#_ivar}}title{{/_ivar}}</h4>{{#disabled}}<div class=\"black-inset\"><span class=\"lock\"></span>{{#_i}}Coming soon!{{/_i}}</div>{{/disabled}}<p class=\"description\">{{#_ivaru}}description{{/_ivaru}}</p><hr/><h5>{{#_i}}Sample words{{/_i}}</h5><p class=\"sample-words\">{{words_string}}</p>{{#dependencies_string}}<h5>{{#_i}}Requirements{{/_i}}</h5><p class=\"requirements\">{{dependencies_string}}</p>{{/dependencies_string}}{{^locked}}<div class=\"word-strength-box\"><h5>{{#_i}}Overall word strength{{/_i}}</h5><ul class=\"word-strength medium black\">{{#strengths}}<li {{#filled}}class=\"filled\"{{/filled}}></li>{{/strengths}}</ul><span class=\"strength\">{{#strength_1}}{{#_i}}Weak{{/_i}}{{/strength_1}}{{#strength_2}}{{#_i}}Medium{{/_i}}{{/strength_2}}{{#strength_3}}{{#_i}}Strong{{/_i}}{{/strength_3}}{{#strength_4}}{{#_i}}Perfect{{/_i}}{{/strength_4}}</span><div class=\"strength-message\">{{^show_strength_message}}{{#_i}}Word strength decays over time when you don\u2019t practice.{{/_i}}{{/show_strength_message}}{{#show_strength_message}}<p class=\"warning\">{{#_i}}Practice to get your word strength back{{/_i}}.</p>{{/show_strength_message}}</div></div>{{/locked}}{{#learned}}<div class=\"trophy\"><h5>{{#_i}}Achievements{{/_i}}</h5><div class=\"trophy-icon\"><div class=\"icon\"></div></div><span class=\"learned-status\">{{#_i}}You learned this skill{{/_i}}</span></div>{{/learned}}{{#changed}}<div class=\"new-lessons\"><h5>{{#_i}}New {{#pluralize}}lesson,lessons,{{missing_lessons}}{{/pluralize}}{{/_i}}</h5><p><span class=\"added-lessons-badge left\">+{{missing_lessons}}</span>{{#_i}}We have added new words to this skill. You now have {{missing_lessons}} more {{#pluralize}}lesson,lessons,{{missing_lessons}}{{/pluralize}} to complete.{{/_i}}</p></div>{{/changed}}</div></div></div>{{/disable_hover}}{{/current_user}}","skill-list":"{{#current_user}}{{#notifications}}<!-- {{#ui_english}}<div class=\"embedded-badge home-notification\"><strong class=\"message\"> &nbsp;</strong><span class=\"title\">It's Follow Friday. <a href=\"http://twitter.com/duolingo\" class=\"title\" style=\"text-decoration: underline;\" target=\"_blank\">Follow Duolingo on Twitter!</a></span></div>{{/ui_english}} -->{{#new_tree}}<div class=\"embedded-badge home-notification hidden\"><strong class=\"message\">{{#_i}}Notice something different?{{/_i}} </strong><span class=\"title\">{{#_i}}We\u2019ve added new skills and updated existing ones to teach you {{#_ivar}}language_string{{/_ivar}} better.{{/_i}}</span><div data-message=\"new_tree\" class=\"close\"></div></div>{{/new_tree}}{{/notifications}}{{/current_user}}<div class=\"row\"><div class=\"span10 columns home-left\">{{>skill-tree}}</div><div class=\"span5-5 columns home-right\">{{>profile-side-bar}}</div></div><div id=\"skill-rank-modal\" class=\"modal hide hidden\" style=\"margin-top: -200px;\"></div><div id=\"sentences-rank-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"></div><div id=\"karma-rank-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"></div><div id=\"followers-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"><div class=\"modal-header\"><h4>{{#_i}}{{#current_user}}Your{{/current_user}}{{^current_user}}{{username}}'s{{/current_user}} Followers{{/_i}}</h4><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"></div></div><div id=\"following-modal\" class=\"modal hidden\" style=\"margin-top: -200px;\"><div class=\"modal-header\"><h4>{{#_i}}{{#current_user}}You are{{/current_user}}{{^current_user}}{{username}} is{{/current_user}} following{{/_i}}</h4><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"></div></div> ","skill-progress-bar":"<div class=\"progress-bar-skill\">{{#progress_percent}}<div class=\"bar\" style=\"width: {{progress_percent}}%\"></div>{{/progress_percent}}<div class=\"label learned\" style=\"left: {{learning_threshold_percentage}}%;\"><span class=\"status\"></span>{{#learned}}{{#learned_more}}<div class=\"checkmark-middle\"></div>{{/learned_more}}{{^learned_more}}<div class=\"checkmark-end\"></div>{{/learned_more}}{{/learned}}</div><div class=\"label mastered\"><span class=\"status\"></span>{{#mastered}}<span class=\"checkmark\"></span>{{/mastered}}</div></div>","skill-rank-modal":"<div class=\"modal-header\"><h4 style=\"margin: 0 0 10px 0;\">{{#_i}}{{#_ivar}}learning_language_string{{/_ivar}} skill points rank{{/_i}}</h4><p style=\"margin: 0 0 -5px 0;\" class=\"grayDark\">{{#_i}}{{#current_user}}You follow {{/current_user}}{{^current_user}}{{username}} follows {{/current_user}} {{num_following}} {{#pluralize}}person,people,{{num_following}}{{/pluralize}} and {{#current_user}}are{{/current_user}}{{^current_user}}is{{/current_user}} ranked {{#ranked_number}}{{points_rank}}{{/ranked_number}} compared to them.{{/_i}}</p><div class=\"close\" data-dismiss=\"modal\">{{#_i}}close{{/_i}}</div></div><div class=\"modal-body\"><div class=\"list-users-small-legend\"><span class=\"skill-points\"></span></div><ul class=\"list-users-small\">{{#points_ranking_data}}<li {{#self}}class=\"self\"{{/self}}><span class=\"position\">{{rank}}.</span>{{>avatar_small}}<a href=\"#/{{username}}\" class=\"user\">{{username}}</a><span class=\"skill-points\">{{points}}</span></li>{{/points_ranking_data}}</ul></div>","skill-threshold-message":"{{^learned}}<p class=\"points-left\">{{#_i}}You need {{more_points}} more skill {{#pluralize}}point,points,{{more_points}}{{/pluralize}} to <i>learn</i> this skill and unlock the next one.{{/_i}}</p>{{/learned}}{{#learned}}{{^mastered}}<p class=\"points-left\">{{#_i}}You need {{left_points}} more skill {{#pluralize}}point,points,{{left_points}}{{/pluralize}} to <i>master</i> this skill.{{/_i}}</p>{{/mastered}}{{/learned}}","skill-tree":"<ul class=\"tabs big home-tabs {{#current_user}}{{#first_time}}hidden{{/first_time}}{{/current_user}}\">{{#current_user}}<li data-tab=\"skill-tree\" class=\"active\"><a href=\"javascript:;\">{{#_i}}{{#_ivar}}language_string{{/_ivar}} skill tree{{/_i}}</a></li>{{/current_user}}{{^current_user}}{{#languages}}{{#learning}}<li class=\"language-choice\" data-language=\"{{language}}\"><a href=\"javascript:;\">{{#_ivar}}stripped_language_string{{/_ivar}}{{^stripped_language_string}}{{#_ivar}}language_string{{/_ivar}}{{/stripped_language_string}}</a></li>{{/learning}}{{/languages}}{{/current_user}}<li data-tab=\"activity\" class=\"\"><a href=\"javascript:;\">{{#_i}}Stream{{/_i}} {{#current_user}}<span class=\"counter\">{{new_activities}}</span>{{/current_user}}</a></li></ul>{{#current_user}}{{#first_time}}<div class=\"speech-bubble arrow-bottom intro-bubble\"><h1>{{#_i}}This is your Skill Tree{{/_i}}</h1><h4>{{#_i}}Beginners start at <a href=\"/#/skill/{{learning_language}}/{{basics_title}}\">Basics 1</a><br/>Advanced learners try the <span class=\"golden-arrow-link\"><strong>Shortcut below</strong> <span class=\"lock\"></span></span>{{/_i}} </h4></div>{{/first_time}}{{/current_user}}<div id=\"activity-panel\" class=\"home-panel hidden\">{{#logged_in}}<div class=\"post-activity\"><div class=\"form-row post-row\"><textarea id=\"stream-post\" class=\"post\"></textarea><div class=\"button-vkeyboard\" id=\"toggle_vkeyboard\" style=\"right: 5px; top: 6px;\"></div><label for=\"stream-post\" class=\"stream-post-label\">{{#current_user_profile}}{{#_i}}Post something for your followers{{/_i}}{{/current_user_profile}}{{^current_user_profile}}{{#_i}}Write something to {{username}}{{/_i}}{{/current_user_profile}}</label></div><div class=\"post-footer hidden\"><div class=\"form-row\"><button id=\"stream-post-btn\" class=\"btn primary right\">{{#_i}}Post{{/_i}}</button></div></div><div id=\"vkeyboard-placeholder\"></div></div>{{/logged_in}}<div id=\"stream-container\"></div></div><div id=\"skill-tree-panel\" class=\"home-panel {{#current_user}}{{#first_time}}first-time-tree{{/first_time}}{{/current_user}}\" style=\"position: relative\"><div id=\"skill-grid\" class=\"{{^current_user}} dim-locked-tree{{/current_user}} {{#old_tree}}tree-{{language}}{{/old_tree}}\">{{#current_user}}{{#first_time}}<div class=\"owl-start-here\"></div>{{/first_time}}{{/current_user}}{{#rows}}<div class=\"skill-row row row-{{#row}}{{row}}{{/row}}{{^row}}shortcut{{/row}}\">{{#columns}}<div id=\"skill-{{column}}-{{row}}\" class=\"skill-row-{{row}} skill-span columns track-hover\"></div>{{/columns}}{{^columns}}<div class=\"skill-span columns track-hover\"></div><div class=\"skill-span columns track-hover\">{{#done}}<div id=\"big-test-{{level_test}}\" class=\"skill-box level-test done more-height\"><span class=\"lock\"></span></div>{{/done}}{{^done}}<a id=\"big-test-{{level_test}}\" href=\"/#/bigtest/{{language}}/{{level_test}}\" class=\"more-height skill-box level-test\" data-toggle=\"popover\" data-popover=\"#big-test-{{level_test}}-popover\" data-margin=\"-40\"><span class=\"lock\"></span></a><div id=\"big-test-{{level_test}}-popover\" class=\"level-test-popover popover black right skill\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h4>{{#_i}}Shortcut{{/_i}}</h4><div class=\"recommended-inset\"><span class=\"icon-lock-small\"></span><span class=\"skill-points-small\" style=\"font-weight: normal\">{{attempts}} {{#_i}}{{#pluralize}}attempt,attempts,{{attempts}}{{/pluralize}} left{{/_i}}</span></div><p style=\"margin: 15px 0 0 0;\">{{#_i}}Think you know everything up to here? Take a short test to unlock every skill above this point.{{/_i}}</p></div></div></div>{{/done}}</div><div class=\"skill-span columns track-hover\"></div>{{/columns}}</div>{{/rows}}</div>{{#current_user}}{{#first_time}}<div class=\"skill-tree-fade \"></div>{{/first_time}}{{/current_user}}<div id=\"skill-canvas\" class=\"{{^current_user}}dim-skill-canvas{{/current_user}}\"></div>{{#finished_tree}}<div class=\"finished-tree {{language}} {{^current_user}}friend-profile{{/current_user}}\"><div class=\"clouds\"><div class=\"trophy\" {{#current_user}}style=\"cursor:pointer\"{{/current_user}}{{#current_user_profile}}style=\"cursor:pointer\"{{/current_user_profile}}></div></div></div>{{/finished_tree}}</div> ","skill_og":"<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\" ><html><head prefix=\"og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# {{facebook_app_ns}}: http://ogp.me/ns/fb/{{facebook_app_ns}}#\"><meta property=\"fb:app_id\" content=\"{{facebook_app_id}}\" /><meta property=\"og:type\" content=\"{{facebook_app_ns}}:skill\" /><meta property=\"og:url\" content=\"http://duolingo.com/skill{{#facebook_debug}}_debug{{/facebook_debug}}/{{id}}\" /><meta property=\"og:title\" content=\"{{#_ivar}}language_string_title{{/_ivar}} \u2014 {{#_ivar}}title{{/_ivar}}\" /><meta property=\"og:description\" content=\"{{#_i}}With Duolingo you learn a language for free while helping to translate the Web.{{/_i}}\" /><meta property=\"og:image\" content=\"http://static.duolingo.com/images/facebook/skills/{{index}}.png\" /><meta property=\"{{facebook_app_ns}}:skill_description\" content=\"{{translated_description}}\" /><meta property=\"{{facebook_app_ns}}:language\" content=\"{{language_string}}\" /><meta property=\"og:locale\" content=\"{{locale}}\" />{{#available_locales}}<meta property=\"og:locale:alternate\" content=\"{{.}}\" />{{/available_locales}}<script type=\"text/javascript\"> window.location = \"//www.duolingo.com/#/skill/{{language}}/{{url_title}}\" </script></head></html>","slide-session-end":"<div class=\"slide-session-end\"><div id=\"end-carousel\" class=\"carousel slide\"><ul class=\"carousel-inner session-end-slider\"><li class=\"active item\" data-slide=\"0\"><h1>{{#has_hearts}}{{#gained_skill_points}}{{#hearts-0}}{{#_i}}<strong>Phew!</strong> You finished with zero hearts{{/_i}}{{/hearts-0}}{{/gained_skill_points}}{{^gained_skill_points}}{{#hearts-0}}{{#_i}}<strong>Great!</strong> You completed this lesson again.{{/_i}}{{/hearts-0}}{{/gained_skill_points}}{{#hearts-4}}{{#_i}}<strong>Awesome!</strong> You finished with 4 hearts left{{/_i}}{{/hearts-4}}{{#hearts-3}}{{#_i}}<strong>Awesome!</strong> You finished with 3 hearts left{{/_i}}{{/hearts-3}}{{#hearts-2}}{{#_i}}<strong>Pretty sweet!</strong> You finished with 2 hearts left{{/_i}}{{/hearts-2}}{{#hearts-1}}{{#_i}}<strong>Good job!</strong> You finished with 1 heart left{{/_i}}{{/hearts-1}}{{/has_hearts}}{{^has_hearts}}{{^times_up}}{{#_i}}<b>You beat the clock</b> and got {{point_accumulation}} {{#pluralize}}answer,answers,{{point_accumulation}}{{/pluralize}} correct!{{/_i}}{{/times_up}}{{#times_up}}{{#point_accumulation}}{{#_i}}<b>Time\u2019s up!</b> You got {{point_accumulation}} {{#pluralize}}answer,answers,{{point_accumulation}}{{/pluralize}} correct{{/_i}}{{/point_accumulation}}{{/times_up}}{{/has_hearts}}</h1>{{^gained_skill_points}}{{#hearts-0}}<img style=\"margin: 0 auto;\" src=\"/images/lesson-end/congrats-owl.png\"/>{{/hearts-0}}{{/gained_skill_points}}{{#gained_skill_points}}<div class=\"rewards\"><div class=\"reward-big\"><div class=\"animated-pieces\">{{^timed}}{{#lesson_points}}<div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><img class=\"hidden\" data-style=\"reward-coin-big\" src=\"http://static.duolingo.com/images/lesson-end/big-coin-glow.png\"/></div></div><div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><span class=\"hidden\" data-style=\"reward-text-big\">+{{lesson_points}}</span></div></div>{{/lesson_points}}{{/timed}}{{^word_practice}}{{^timed}}{{^lesson_points}}{{^skill_practice}}{{#point_accumulation}}<div class=\"animation-wrapper-big\"><div class=\"animation-table-cell-big\"><img class=\"hidden\" data-style=\"reward-coin-big\" src=\"http://static.duolingo.com/images/lesson-end/big-coin-glow.png\"/></div></div><div class=\"animation-wrapper-big\"><div class=\"animation-table-cell-big\"><span class=\"hidden\" data-style=\"reward-text-big\">+{{point_accumulation}}</span></div></div>{{/point_accumulation}}{{/skill_practice}}{{/lesson_points}}{{/timed}}{{/word_practice}}{{#skill_practice}}{{#timed}}<div class=\"animation-wrapper-single\"><div class=\"animation-table-cell-big\"><img class=\"hidden\" data-style=\"reward-coin-big\" src=\"http://static.duolingo.com/images/lesson-end/big-coin-glow.png\"/></div></div><div class=\"animation-wrapper-single\"><div class=\"animation-table-cell-big\"><span class=\"hidden\" data-style=\"reward-text-big\">+{{gained_skill_points}}</span></div></div>{{/timed}}{{^timed}}<div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><img class=\"hidden\" data-style=\"reward-coin-big\" src=\"http://static.duolingo.com/images/lesson-end/big-coin-glow.png\"/></div></div><div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><span class=\"hidden\" data-style=\"reward-text-big\">+{{lesson_points}}</span></div></div>{{/timed}}{{/skill_practice}}{{^has_accumulation}}{{^skill_practice}}{{#timed}}<div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><img class=\"hidden\" data-style=\"reward-coin-big\" src=\"http://static.duolingo.com/images/lesson-end/big-coin-glow.png\"/></div></div><div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><span class=\"hidden\" data-style=\"reward-text-big\">+{{point_accumulation}}</span></div></div>{{/timed}}{{/skill_practice}}{{/has_accumulation}}{{#word_practice}}<div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><img class=\"hidden\" data-style=\"reward-coin-big\" src=\"http://static.duolingo.com/images/lesson-end/big-coin-glow.png\"/></div></div><div class=\"animation-wrapper-{{#hearts_bonus}}big{{/hearts_bonus}}{{^hearts_bonus}}single{{/hearts_bonus}}\"><div class=\"animation-table-cell-big\"><span class=\"hidden\" data-style=\"reward-text-big\">+{{gained_skill_points}}</span></div></div>{{/word_practice}}</div></div>{{^has_hearts}}{{#has_accumulation}}<div class=\"reward-small\"><div class=\"animated-pieces\"><div class=\"animation-wrapper-small\"><div class=\"animation-table-cell-small\"><div id=\"timer-container\" style=\"width: 73px; height: 73px\"></div><img class=\"hidden\" src=\"/images/lesson-end/timer.png\" data-style=\"lesson-end-timer\"></div></div><div class=\"animation-wrapper-small\"><div class=\"animation-table-cell-small\"><span id=\"timer-text\" class=\"hidden\" data-style=\"lesson-end-timer-text\">{{#format_seconds}}0{{/format_seconds}}</span></div></div></div></div>{{/has_accumulation}}{{/has_hearts}}{{#hearts_bonus}}{{#lesson_points}}<div class=\"reward-small\"><div class=\"animated-pieces\"><div class=\"animation-wrapper-small\"><div class=\"animation-table-cell-small\"><img class=\"hidden\" data-style=\"reward-coin-small\" src=\"http://static.duolingo.com/images/lesson-end/medium-coin-glow.png\"/></div></div><div class=\"animation-wrapper-small\"><div class=\"animation-table-cell-small\"><span class=\"hidden\" data-style=\"reward-text-small\">+{{hearts_bonus}}</span></div></div></div><div class=\"popover-pad-1\" data-toggle=\"popover\" data-placement=\"above\" data-popover=\"#big-coin-popover\"></div><div id=\"big-coin-popover\" class=\"popover black top above\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h3 style=\"margin: 0;\"> {{#_i}}Heart Bonus{{/_i}}</h3></div></div></div><div class=\"popover-pad-2\" data-toggle=\"popover\" data-placement=\"above\" data-popover=\"#med-coin-popover\"></div><div id=\"med-coin-popover\" class=\"popover black top above\"><div class=\"arrow\"></div><div class=\"inner track-hover\"><div class=\"content\"><h3 style=\"margin: 0;\">{{#_i}}Lesson Completed{{/_i}}</h3></div></div></div></div>{{/lesson_points}}{{^lesson_points}}<div class=\"reward-small\"><div class=\"animated-pieces\"><div class=\"animation-wrapper-small-single\"><div class=\"animation-table-cell-small\"><img class=\"hidden\" data-style=\"reward-coin-small\" src=\"http://static.duolingo.com/images/lesson-end/medium-coin-glow.png\"/></div></div><div class=\"animation-wrapper-small-single\"><div class=\"animation-table-cell-small\"><span class=\"hidden\" data-style=\"reward-text-small\">+{{hearts_bonus}}</span></div></div></div></div>{{/lesson_points}}{{/hearts_bonus}}</div>{{/gained_skill_points}}{{#gained_skill_points}}<div class=\"session-end-progress\">{{#points_data}}<div class=\"end\">{{next_level}}</div><div class=\"bar\" style=\"width: {{level_before_bar_width}}px\"><div class=\"popover-outer\"><div class=\"popover-marker\"><span class=\"level-popover\"><img style=\"display:inline-block; vertical-align: text-bottom; padding-right: 5px; position: relative; top: 2px\" src=\"/images/lesson-end/small-coin.png\">{{#_i}}<b><span id=\"left-in-level\">{{level_left_before}}</span> away</b> from Level {{next_level}}{{/_i}}</span></div></div></div><div class=\"start\">{{level}}</div>{{/points_data}}</div>{{/gained_skill_points}}</li><li class=\"slider-pane-words item\" data-slide=\"1\"><h1>{{#_i}}You strengthened <strong>{{num_strengthened}} {{#pluralize}}word,words,{{num_strengthened}}{{/pluralize}}!</strong>{{/_i}}</h1><div class=\"words-diploma\"><div class=\"header\"></div><div class=\"words-strengthened-container\"><ul class=\"words-strengthened\">{{#words_strengthened}}<li>{{#new}}<span class=\"icon-present-medium\" title=\"New word\"></span>{{/new}} <span class=\"lexeme-form\">{{value}}</span><ul class=\"word-strength small right\"><li class=\"filled\"></li><li {{#strength_s}}class=\"filled\"{{/strength_s}}></li><li {{#strength_m}}class=\"filled\"{{/strength_m}}></li><li {{#strength_l}}class=\"filled\"{{/strength_l}}></li></ul></li>{{/words_strengthened}}{{#more_strengthened}}{{#num_strengthened}}<li class=\"more\">{{#_i}}and {{more_strengthened}} more{{/_i}}</li>{{/num_strengthened}}{{/more_strengthened}}{{^words_strengthened}}<div class=\"zero-words-text-new\">{{#_i}}Keep practicing to strengthen your vocabulary!{{/_i}}</div>{{/words_strengthened}}</ul></div><div class=\"footer\"></div></div></li></ul></div><div id=\"cloud-carousel\" class=\"carousel slide cloud-carousel\"><ul class=\"carousel-inner cloud-slider\"><li class=\"cloud-1 item active\"></li></ul></div><div class=\"player-action\"><ul class=\"dots\"><li data-slide=\"0\" class=\"carousel-dot active\"></li><li data-slide=\"1\" class=\"carousel-dot\"></li></ul><!--<a href=\"javascript:;\" class=\"btn primary continue large\">{{#_i}}Continue{{/_i}}</a>--><div class=\"buttons\">{{#home}}{{^practice}}<button data-r=\"home\" data-href=\"\" class=\"continue btn large primary\">{{#_i}}Continue{{/_i}}</button>{{/practice}}{{#practice}}{{#from_word}}<button data-r=\"vocab\" data-href=\"/word/{{language}}/{{from_word}}/{{pos}}\" type=\"submit\" class=\"continue btn large right primary\">{{#_i}}Continue{{/_i}}</button>{{/from_word}}{{#skill_id}}<button data-r=\"skill\" data-href=\"/skill/{{language}}/{{skill_name}}/practice\" type=\"submit\" class=\"end-continue btn large left two-buttons\">{{#_i}}Practice again{{/_i}}</button><button data-r=\"skill\" data-href=\"/skill/{{language}}/{{skill_name}}\" type=\"submit\" class=\"continue btn large primary two-buttons\">{{#_i}}Continue{{/_i}}</button>{{/skill_id}}{{^from_word}}{{^skill_id}}<button data-r=\"skill\" data-href=\"practice\" type=\"submit\" class=\"end-continue btn large left two-buttons\">{{#_i}}Practice again{{/_i}}</button><button data-r=\"home\" data-href=\"\" type=\"submit\" class=\"continue btn large primary\">{{#_i}}Continue{{/_i}}</button>{{/skill_id}}{{/from_word}}{{/practice}}{{/home}}{{^home}}{{^practice}}<button data-r=\"home\" data-href=\"/skill/{{language}}/{{skill_name}}\" type=\"submit\" class=\"continue btn large primary\">{{#_i}}Continue{{/_i}}</button>{{/practice}}{{#practice}}{{#from_word}}<button data-r=\"vocab\" data-href=\"/word/{{language}}/{{from_word}}/{{pos}}\" type=\"submit\" class=\"continue btn large right primary\">{{#_i}}Continue{{/_i}}</button>{{/from_word}}{{#skill_id}}{{#from_skill_vocab}}<button data-r=\"skill\" data-href=\"/skill_practice/{{from_skill_vocab}}{{#lesson}}/{{lesson}}{{/lesson}}\" type=\"submit\" class=\"end-continue btn large two-buttons left\">{{#_i}}Practice again{{/_i}}</button><button data-r=\"skill\" data-href=\"/vocab/{{from_skill_vocab}}{{#lesson}}/{{lesson}}{{/lesson}}\" type=\"submit\" class=\"continue btn large primary\">{{#_i}}Continue{{/_i}}</button>{{/from_skill_vocab}}{{^from_skill_vocab}}<button data-r=\"skill\" data-href=\"/skill/{{language}}/{{skill_name}}/practice\" type=\"submit\" class=\"end-continue btn large two-buttons left\">{{#_i}}Practice again{{/_i}}</button><button data-r=\"skill\" data-href=\"/skill/{{language}}/{{skill_name}}\" type=\"submit\" class=\"continue btn large primary\">{{#_i}}Continue{{/_i}}</button>{{/from_skill_vocab}}{{/skill_id}}{{^from_word}}{{^skill_id}}<button data-r=\"home\" data-href=\"practice\" type=\"submit\" class=\"end-continue btn large left two-buttons\">{{#_i}}Practice again{{/_i}}</button><button data-r=\"home\" data-href=\"\" type=\"submit\" class=\"continue btn large primary\">{{#_i}}Continue{{/_i}}</button>{{/skill_id}}{{/from_word}}{{/practice}}{{/home}}</div></div></div> ","small-register":"<form action=\"/welcome\" method=\"post\" id=\"register-form\"><fieldset class=\"inner\"><div id=\"signup-main\"><h1>{{#_i}}Free language education for the world{{/_i}}</h1><ul class=\"signup-buttons\"><li><a class=\"btn xlarge facebook signup-facebook\" href=\"javascript:;\"><span class=\"icon\"></span>{{#_i}}Sign up with Facebook{{/_i}}</a></li><li><a class=\"btn xlarge primary signup-email\" href=\"javascript:;\" id=\"email-link\">{{#_i}}Sign up with email{{/_i}}</a></li></ul>{{#ui_language_en}}<fieldset id=\"duolingo_offers_courses_in:\" class=\"offers\" style=\"margin-top: 50px\"><legend align=\"center\">{{#_i}}Duolingo offers courses in:{{/_i}}</legend><ul class=\"flags\"><li><span class=\"flag es\"></span><p>{{#_i}}Spanish{{/_i}}</p></li><li><span class=\"flag en\"></span><p>{{#_i}}English{{/_i}}</p></li><li><span class=\"flag fr\"></span><p>{{#_i}}French{{/_i}}</p></li><li><span class=\"flag de\"></span><p>{{#_i}}German{{/_i}}</p></li><li style=\"margin: 0 5px;\"><span class=\"flag pt\"></span><p>{{#_i}}Portuguese{{/_i}}</p></li><li><span class=\"flag it\"></span><p>{{#_i}}Italian{{/_i}}</p></li></ul></fieldset>{{/ui_language_en}}</div><div class=\"signup-email hidden\" id=\"signup-email\"><h1 style=\"margin-bottom: 40px;\">{{#_i}}Sign up for Duolingo{{/_i}}</h1><ul class=\"login-signup-list\">{{#facebook_id}}<li class=\"connected-to facebook\"><img src=\"{{profile_image}}\"/><span class=\"icon\"></span><strong>{{facebook_name}}</strong></li><input name=\"profile_image\" type=\"hidden\" value=\"http://graph.facebook.com/{{facebook_id}}/picture?type=large\"><input name=\"facebook_fullname\" type=\"hidden\" value=\"{{facebook_name}}\"><input name=\"facebook_username\" type=\"hidden\" value=\"{{facebook_username}}\">{{/facebook_id}}{{#twitter_id}}<li class=\"connected-to twitter\"><img src=\"{{profile_image}}\"/><span class=\"icon\"></span><strong>{{twitter_username}}</strong></li><input name=\"profile_image\" type=\"hidden\" value=\"http://api.twitter.com/1/users/profile_image?screen_name={{twitter_username}}&size=bigger\">{{/twitter_id}}<li><select class=\"medium\" name=\"learning_language\" id=\"learning-language\">{{#available_languages}}<option value=\"{{key}}\">{{i_want_to_learn}} {{learning_language_name}} {{^from_ui}}{{from_info}}{{/from_ui}}</option>{{/available_languages}}</select></li><li><label for=\"email\">{{#_i}}Email{{/_i}}</label><input class=\"large\" id=\"email\" name=\"email\" size=\"30\" type=\"text\" value=\"{{email}}\"><div class=\"error-flag\" id=\"invalid-email-error\">{{#_i}}Invalid email address{{/_i}}</div><div class=\"error-flag\" id=\"taken-email-error\">{{#_i}}Email already taken{{/_i}}</div></li><li><label for=\"login\">{{#_i}}Pick a username{{/_i}}</label><input class=\"large\" id=\"login\" name=\"register_login\" size=\"30\" type=\"text\" value=\"{{username}}\"><div class=\"error-flag\" id=\"invalid-login-error\">{{#_i}}Username must be between 3 and 16 valid characters (letters, numbers and \"-\", \".\", \"_\"){{/_i}}</div><div class=\"error-flag\" id=\"taken-login-error\">{{#_i}}Username already taken{{/_i}}</div></li><li><label for=\"password\">{{#_i}}Pick a password{{/_i}}</label><input class=\"large\" id=\"password\" name=\"register_password\" size=\"30\" type=\"password\"><div class=\"error-flag\" id=\"invalid-password-error\">{{#_i}}Password too short{{/_i}}</div></li><input name=\"ui_language\" type=\"hidden\" value=\"{{ui_language}}\"><input name=\"invite\" type=\"hidden\" value=\"{{invite}}\"><input name=\"invited_by\" type=\"hidden\" value=\"{{invited_by}}\">{{#facebook_id}}<input name=\"facebook_id\" type=\"hidden\" value=\"{{facebook_id}}\">{{/facebook_id}}{{#twitter_id}}<input name=\"twitter_id\" type=\"hidden\" value=\"{{twitter_id}}\">{{/twitter_id}}<li style=\"text-align: center;\"><a id=\"register-button\" href=\"javascript:;\" class=\"btn primary large\">{{^facebook_id}}{{^twitter_id}}{{#_i}}Create account{{/_i}}{{/twitter_id}}{{/facebook_id}}{{#facebook_id}}{{#_i}}Complete profile{{/_i}}{{/facebook_id}}{{#twitter_id}}{{#_i}}Complete profile{{/_i}}{{/twitter_id}}</a></li>{{#facebook_id}}<li class=\"signup-email-button go-back\">{{#_i}}or <a href=\"javascript:;\" class=\"email-link\" id=\"back-email-link\">Sign up with email</a>{{/_i}}</li>{{/facebook_id}}{{^facebook_id}}<li class=\"signup-social-buttons go-back\">{{#_i}}or <a href=\"javascript:;\" class=\"signup-facebook\">Sign up with Facebook</a>{{/_i}}</li>{{/facebook_id}}</ul></div></fieldset></form> ","snippet-list":"{{#snippet}}<a href=\"/#/translation/{{id}}?index={{start_index}}&skill={{skill_id}}{{#recommended}}&recommended{{/recommended}}\" class=\"translation unlocked\">{{#document}}{{#active}}{{^done}}<span class=\"coin-medium\">+{{sentence_points}}</span>{{/done}}{{#done}}{{^rated}}<span class=\"error has-twipsy\" title=\"{{#_i}}Missing rating{{/_i}}\">!</span>{{/rated}}{{/done}}{{/active}}{{^active}}<span class=\"checkmark\"><span class=\"icon\"></span></span>{{/active}}<strong class=\"number\">{{index}}</strong><h3>{{#_i}}Real world translation{{/_i}}</h3>{{/document}}</a>{{/snippet}}{{#refresh}}<a class=\"lesson unlocked\" href=\"/#/skill/{{language}}/{{url_title}}/practice/{{index}}\"><h3>{{#_i}}Refresh{{/_i}}</h3>{{#active}}<span class=\"coin-medium\">+10</span>{{/active}}{{^active}}<span class=\"checkmark\"><span class=\"icon\"></span></span>{{/active}}<strong class=\"number\">{{index}}</strong>{{#no_data}}{{^active}}<ul class=\"hearts\"><li class=\"none\"></li><li class=\"none\"></li><li class=\"none\"></li>{{#beginner}}<li class=\"none\"></li>{{/beginner}}</ul>{{/active}}{{/no_data}}{{^no_data}}<ul class=\"hearts\">{{#hearts}}<li class=\"{{#filled}}filled{{/filled}}{{^filled}}empty{{/filled}}\"></li>{{/hearts}}</ul>{{/no_data}}</a>{{/refresh}} ","speak-element":"<h1>{{#_i}}<strong>Click record</strong> and say{{/_i}}:</h1><h3><span id=\"big-speaker\"></span> {{text}}</h3><div><div id='audio-recorder'><p><a href=\"http://www.adobe.com/go/getflashplayer\"><img src=\"http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif\" alt=\"{{#_i}}Get Adobe Flash player{{/_i}}\" /></a></p></div></div><a id=\"no-mic-link\" style=\"color: #808080;\" href=\"javascript:;\"><b>{{#_i}}Click here if you don't want to use a microphone{{/_i}}<b></a>","speaker":"{{^new_player_blame_experiment_true}}{{#visible}}<span id=\"speaker-{{aid}}-button\" class=\"icon_speaker\"></span>{{/visible}}<div id='speaker-{{aid}}' src='{{sound_path}}' class='hidden'></div>{{#slowEnabled}}<div id='speaker-{{aid}}-slow' src='{{sound_path}}&speed=70p' class='hidden'></div><div class=\"slow-button\" id='speaker-{{aid}}-slow-button'><span class=\"icon\"></span>{{#_i}}slower{{/_i}}</div>{{/slowEnabled}}{{/new_player_blame_experiment_true}}{{#new_player_blame_experiment_true}}{{^slowEnabled}}{{#visible}}<span id=\"speaker-{{aid}}-button\" class=\"icon_speaker\"></span>{{/visible}}<div id='speaker-{{aid}}' src='{{sound_path}}' class='hidden'></div>{{/slowEnabled}}{{#slowEnabled}}{{#visible}}<span id=\"speaker-{{aid}}-button\" class=\"icon_speaker new\"></span>{{/visible}}<div id='speaker-{{aid}}' src='{{sound_path}}' class='hidden'></div><div class=\"icon_speaker_slow\" id='speaker-{{aid}}-slow-button'></div><div id='speaker-{{aid}}-slow' src='{{sound_path}}&speed=70p' class='hidden'></div>{{/slowEnabled}}{{/new_player_blame_experiment_true}}","speller-menu":"<div id=\"speller_menu\" class=\"speller-menu\" style=\"position:absolute;\">{{#speller_items}}<div class=\"speller-item\">{{item}}</div>{{/speller_items}}<div class=\"speller-divider\"></div><div class=\"speller-item\">{{#_i}}Ignore{{/_i}}</div></div> ","splash":"<div class=\"landscape\"></div><div id=\"main\" class=\"{{ui_language}}\"><div class=\"owl\"></div><div class=\"main\"><div class=\"signup\">{{>small-register}}</div><ul class=\"duo-features\"><li><a href=\"javascript:;\" id=\"video-toggle\"><span class=\"icon-free\"></span></a><h2>{{#_i}}It\u2019s free, for real{{/_i}}</h2><p>{{#_i}}No fees, no ads, no gimmicks. A college-quality education without the pricetag.{{/_i}} <a href=\"javascript:;\" id=\"video-toggle\" class=\"play-video\"><strong>{{#_i}}This is how we do it.{{/_i}}</strong></a></p></li>{{#ui_language_en}}<li><a href=\"#/effectiveness-study\"><span class=\"icon-atom\"></span></a><h2> Scientifically proven </h2><p>An independent study found that Duolingo trumps university-level language learning. <a href=\"#/effectiveness-study\"><strong>More.</strong></a></p></li>{{/ui_language_en}}{{^ui_language_en}}<li><span class=\"icon-eye\"></span><h2>{{#_i}}See, listen, speak{{/_i}}</h2><p>{{#_i}}Immerse your senses. Photos, speech recognition, and listening exercises make for powerful learning.{{/_i}}</p></li>{{/ui_language_en}}<li><span class=\"icon-hearts\"></span><h2>{{#_i}}Learning, gamified{{/_i}}</h2><p>{{#_i}}Lose hearts with incorrect answers, practice against the clock, level up. Duolingo is addictive.{{/_i}}</p></li><li><a href=\"#/mobile\"><span class=\"icon-mobile\"></span></a><h2>{{#_i}}Also on the go{{/_i}}</h2><p>{{#_i}}Make your breaks and commutes more productive with the Duolingo iPhone app.{{/_i}} <a href=\"#/mobile\"><strong>{{#_i}}Get it here.{{/_i}}</strong></a></p></li></ul></div></div>","stack-translate-element":"<h1>{{#_i}}<strong>Translate</strong> this text to {{#_ivar}}target_language_name{{/_ivar}}{{/_i}}</h1><span id=\"session-context\"></span><div class=\"challenge row\"><div class=\"span8 columns\"><span id=\"big-speaker\" class=\"\"></span><h3 class=\"hints translation-source\" style=\"margin: 0 0 20px 0\">{{sentence}}</h3></div></div><div class=\"row\"><div class=\"span8 columns relative\">{{>blame-popover}}<input class=\"one-line-input\" id=\"text-input\" style=\"width: 378px;\" name=\"text-input\" size=\"30\" type=\"text\" value=\"\" placeholder=\"{{#_i}}Enter translation here{{/_i}}\"></input><div id=\"vkeyboard-placeholder\"></div><div class=\"button-vkeyboard\" id=\"toggle_vkeyboard\" style=\"right: 72px; top: 8px;\"></div>{{#hover_instruction}}<div class=\"alert-message hint-message left\" style=\"margin: 20px 0 0 0;\">{{#_i}}Hover over the words to see their translation{{/_i}}</div>{{/hover_instruction}}{{#new_player_blame_experiment_true}}<div id=\"correct-solutions\"></div>{{/new_player_blame_experiment_true}}</div></div> ","standalone-event":"<ul class=\"activity-stream\"></ul>","stream-post":"{{#user}}{{>avatar_medium}}{{/user}}<h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#_i}}wrote{{^own}} to <a href=\"#/{{#for_user}}{{username}}{{/for_user}}\" class=\"user\">{{#for_user}}{{username}}{{/for_user}}</a>{{/own}}{{/_i}}</h5><p>{{{processed_text}}}</p><div class=\"stream-comments {{^has_comments}}hidden{{/has_comments}}\"></div>{{>event-footer}} ","stream_post":"{{#_i}}{{username}} posted on your stream{{/_i}}.","study":"<h1>{{#_i}}How effective is Duolingo?{{/_i}}</h1><fieldset class=\"conductors\"><legend align=\"center\">{{#_i}}Study conducted by:{{/_i}}</legend><ul class=\"list-conductors\"><li><strong>{{#_i}}Roumen Vesselinov, PhD{{/_i}}</strong><br/> Queens College<br/> City University of New York </li><li><strong>{{#_i}}John Grego, PhD{{/_i}}</strong><br/>{{#_i}}Statistics Department{{/_i}}<br/> University of South Carolina </li></ul><div class=\"atom\"></div></fieldset><h2>{{#_i}}Summary{{/_i}}</h2><div class=\"main-results\"><div class=\"diagram\"></div><div class=\"duolingo\">{{#_i}}<h2>34</h2>Hours of Duolingo{{/_i}}</div><div class=\"college\">{{#_i}}<h2>1</h2>University semester{{/_i}}<br/>{{#_i}}(11 weeks){{/_i}}</div></div><div class=\"summary\"><p>{{#_i}}An eight week study was <strong>independently conducted</strong> to assess the effectiveness of Duolingo as a language learning tool. The participants took one university placement Spanish language test at the beginning of the study and one at the end. The improvement of language abilities was measured as the difference between the initial and the final language test results.{{/_i}}</p><p>{{#_i}}The study estimated that a person with no knowledge of Spanish would need <strong>between 26 and 49 hours</strong> (or 34 hours on average) to cover the material for the first college semester of Spanish. Since a one semester university course usually takes more than 34 hours of work, this study suggests that Duolingo is more effective than university.{{/_i}}</p></div><div class=\"center signup-box\">{{^logged_in}}<a href=\"/#\" class=\"btn large primary sign-up\">{{#_i}}Sign up, it\u2019s free{{/_i}}</a>{{/logged_in}}<a href=\"http://static.duolingo.com/s3/DuolingoReport_Final.pdf\" target=\"_blank\" class=\"btn large {{#logged_in}}primary{{/logged_in}}\">{{#_i}}Download Study (PDF){{/_i}}</a></div> ","table":"<table border=\"1\" rules=\"groups\" cellpadding=10><thead bgcolor=\"aaddff\"><tr>{{#headers}}<th>{{name}}</th>{{/headers}}</tr></thead><tbody>{{#rows}}<tr>{{#cells}}<td>{{{cell}}}</td>{{/cells}}</tr>{{/rows}}</tbody></table> ","terms":"<h1>Terms and Conditions of Service</h1><ol class=\"terms\"><li><h3>Website and Service Terms and Conditions - General.</h3> <p>The Duolingo website (\u201cWebsite\u201d) and related services (together with the Website, the \u201cService\u201d) are operated by Duolingo, Inc. (\u201cDuolingo,\u201d \u201cus,\u201d or \u201cwe\u201d). Access and use of the Service is subject to the following Terms and Conditions of Service (\u201cTerms and Conditions\u201d). By accessing or using any part of the Service, you represent that you have read, understood, and agree to be bound by these Terms and Conditions including any future modifications. Duolingo may amend, update or change these Terms and Conditions. If we do this, we will post a notice that we have made changes to these Terms and Conditions on the Website for at least 7 days after the changes are posted and will indicate at the bottom of the Terms and Conditions the date these terms were last revised. Any revisions to these Terms and Conditions will become effective the earlier of (i) the end of such 7-day period or (ii) the first time you access or use the Service after such changes. If you do not agree to abide by these Terms and Conditions, you are not authorized to use, access or participate in the Service.</p></li><li><h3>Description of Website and Service</h3> <p>The Service allows users to (i) learn or practice a language while they translate content from the Web and (ii) submit material for translation by other users. Users interested in learning or practicing a language are presented with different types of educational activities; while they perform these activities, they also generate valuable data such as translations of Web content. Users interested in submitting material for translation may do so only if they comply with requirements set forth in these Terms and Conditions concerning the material submitted and use of the translation. Duolingo may, in its sole discretion and at any time, update, change, suspend, make improvements to or discontinue any aspect of the Service, temporarily or permanently.</p></li><li><h3>Registration; Submission of Material</h3><p>In connection with registering for and using the Service, you agree (i) to provide accurate, current and complete information about you and/or your organization as requested by Duolingo; (ii) to maintain the confidentiality of your password and other information related to the security of your account; (iii) to maintain and promptly update any registration information you provide to Duolingo, to keep such information accurate, current and complete; and (iv) to be fully responsible for all use of your account and for any actions that take place through your account.</p><p>Any material you submit for translation will be your original work or material owned by you. You will not submit any other type of material. The Service is not intended to be used to translate confidential or sensitive documents and you agree not to submit documents that include any such information. By submitting material to the Service, you grant us a fully paid up, worldwide license to use the material in connection with the operation of the Service and agree that, among other things, this license will allow us to (i) create translations that are derivative works of the material, (ii) disclose part or all of the material and any translations to one or more users of the Service in connection with their use of the Services and (iii) make the material and any translations available on the Service as a teaching tool, to promote the service or for other purposes in connection with our operation of the Service. This means that all or part of your submission and any translations may be indexed and available on search engines such as Google and Bing. You understand that other Users will have access to material you submit and that neither they or Duolingo have any obligation to you or anyone else to maintain the confidentiality of such material. If we are able to complete a translation of any material you submit, we will provide you with a copy of the translation. As between us and you, you will own the copyright in any derivative work we create that is a translation of material you submit provided that you do not make or permit any commercial use of the translation. If you wish to make or permit commercial use of a translation, please contact us. You must have a separate agreement with us that expressly auhorizes any commercial use of any translation produced by the Service before any such use occurs. </p><p>If you delete any material you submit from the Service we will in turn delete any translation tasks in progress and completed translations in the normal course of our operations. This may take up to thirty (30) days.</p></li><li><h3>Your Representations and Warranties</h3> <p>You represent and warrant to Duolingo that your access and use of the Service will be in accordance with these Terms and Conditions and with all applicable laws, rules and regulations of the United States and any other relevant jurisdiction, including those regarding online conduct or acceptable content, and those regarding the transmission of data or information exported from the United States and/or the jurisdiction in which you reside. You further represent and warrant that you have created or own any material you submit for translation and that you have the right to grant us a license to use that material as set forth in Section 3.</p></li><li><h3>Inappropriate Use</h3> <p>You will not upload, display or otherwise provide on or through the Service any content that: (i) is libelous, defamatory, abusive, threatening, harassing, hateful, offensive or otherwise violates any law or infringes upon the right of any third party (including copyright, trademark, privacy, publicity or other personal or proprietary rights); or (ii) in Duolingo\u2019s sole judgment, is objectionable or which restricts or inhibits any other person from using the Service or which may expose Duolingo or its users to any harm or liability of any kind. </p></li><li><h3>Indemnification of Duolingo</h3><p>You agree to defend, indemnify and hold harmless Duolingo and its directors, officers, employees, contractors, agents, suppliers, licensors, successors and assigns, from and against any and all losses, claims, causes of action, obligations, liabilities and damages whatsoever, including attorneys' fees, arising out of or relating to your access or use of the Service, any false representation made to us (as part of these Terms and Conditions or otherwise), your breach of any of these Terms and Conditions,or any claim that any translation we provide to you is inaccurate, inappropriate or defective in any way whatsoever. </p></li><li><h3>NO REPRESENTATIONS OR WARRANTIES</h3><p> THE SERVICE, INCLUDING ALL IMAGES, AUDIO FILES AND OTHER CONTENT THEREIN, AND ANY OTHER INFORMATION, PROPERTY AND RIGHTS GRANTED OR PROVIDED TO YOU BY DUOLINGO ARE PROVIDED TO YOU ON AN \u201cAS IS\u201d BASIS. DUOLINGO AND ITS SUPPLIERS MAKE NO REPRESENTATIONS OR WARRANTIES OF ANY KIND WITH RESPECT TO THE SERVICE, EITHER EXPRESS OR IMPLIED, AND ALL SUCH REPRESENTATIONS AND WARRANTIES, INCLUDING WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT, ARE EXPRESSLY DISCLAIMED. WITHOUT LIMITING THE GENERALITY OF THE FOREGOING, DUOLINGO DOES NOT MAKE ANY REPRESENTATION OR WARRANTY OF ANY KIND RELATING TO ACCURACY, SERVICE AVAILABILITY, COMPLETENESS, INFORMATIONAL CONTENT, ERROR-FREE OPERATION, RESULTS TO BE OBTAINED FROM USE, OR NON-INFRINGEMENT. ACCESS AND USE OF THE SERVICE MAY BE UNAVAILABLE DURING PERIODS OF PEAK DEMAND, SYSTEM UPGRADES, MALFUNCTIONS OR SCHEDULED OR UNSCHEDULED MAINTENANCE OR FOR OTHER REASONS. SOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF IMPLIED WARRANTIES, SO THE ABOVE EXCLUSION MAY NOT APPLY TO YOU.</p> </li><li><h3>LIMITATION ON TYPES OF DAMAGES/LIMITATION OF LIABILITY</h3> <p>IN NO EVENT WILL DUOLINGO BE LIABLE TO YOU OR ANY THIRD PARTY CLAIMING THROUGH YOU (WHETHER BASED IN CONTRACT, TORT, STRICT LIABILITY OR OTHER THEORY) FOR INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL OR EXEMPLARY DAMAGES ARISING OUT OF OR RELATING TO THE ACCESS OR USE OF, OR THE INABILITY TO ACCESS OR USE, THE SERVICE OR ANY PORTION THEREOF, INCLUDING BUT NOT LIMITED TO THE LOSS OF USE OF THE SERVICE, INACCURATE RESULTS, LOSS OF PROFITS, BUSINESS INTERRUPTION, OR DAMAGES STEMMING FROM LOSS OR CORRUPTION OF DATA OR DATA BEING RENDERED INACCURATE, THE COST OF RECOVERING ANY DATA, THE COST OF SUBSTITUTE SERVICES OR CLAIMS BY THIRD PARTIES FOR ANY DAMAGE TO COMPUTERS, SOFTWARE, MODEMS, TELEPHONES OR OTHER PROPERTY, EVEN IF DUOLINGO HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. DUOLINGO\u2019S LIABILITY TO YOU OR ANY THIRD PARTY CLAIMING THROUGH YOU FOR ANY CAUSE WHATSOEVER, AND REGARDLESS OF THE FORM OF THE ACTION, IS LIMITED TO THE AMOUNT PAID, IF ANY, BY YOU TO DUOLINGO FOR THE SERVICE IN THE 12 MONTHS PRIOR TO THE INITIAL ACTION GIVING RISE TO LIABILITY. THIS IS AN AGGREGATE LIMIT. THE EXISTENCE OF MORE THAN ONE CLAIM HEREUNDER WILL NOT INCREASE THIS LIMIT.</p> </li><li><h3>Termination</h3><p>Duolingo may terminate your access and use of the Service immediately at any time, for any reason, and at such time you will have no further right to use the Service. You may terminate your Duolingo account at any time by following the instructions available through the Service. The provisions of these Terms and Conditions relating to the protection and enforcement of Duolingo\u2019s proprietary rights, your representations and warranties, disclaimer of representations and warranties, release and indemnities, limitations of liability and types of damages, ownership of data and information, governing law and venue, and miscellaneous provisions shall survive any such termination.</p> </li><li><h3>Proprietary Rights in Service Content and Activity Data</h3><p>All content available through the Service, including designs, text, graphics, images, information, software, audio and other files, and their selection and arrangement (the \"Service Content\"), are the proprietary property of Duolingo or its licensors. No Service Content may be modified, copied, distributed, framed, reproduced, republished, downloaded, scraped, displayed, posted, transmitted, or sold in any form or by any means, in whole or in part, other than as expressly permitted in these Terms and Conditions. You may not use any data mining, robots, scraping or similar data gathering or extraction methods to obtain Service Content. As between you and Duolingo, all data and information generated from your access and use of the educational activities made available on or through the Service, including translated content generated by you (collectively, the \u201cActivity Data\u201d), shall be exclusively owned by Duolingo, and you shall not have any right to use such Activity Data except as expressly authorized by these Terms and Conditions. Activity Data will not include material you submit for translation or any resulting translation. By using the Service, you hereby assign to Duolingo any and all rights, title and interest, including any intellectual property rights or proprietary rights, in the Activity Data. All rights of Duolingo or its licensors that are not expressly granted in these Terms and Conditions are reserved to Duolingo and its licensors. </p> </li><li><h3>Trademarks</h3> <p>\u201cDuolingo\u201d and all other trademarks, service marks, graphics and logos used in connection with the Service are trademarks or service marks of Duolingo or their respective owners, and certain of them are registered with the United States Patent and Trademark Office. Access and use of the Service does not grant or provide you with the right or license to reproduce or otherwise use the Duolingo name or any Duolingo or third-party trademarks, service marks, graphics or logos.</p></li><li><h3>Privacy</h3> <p>Use of the Service is also governed by our Privacy Policy, a copy of which is located at <a href=\"/#/privacy\">http://duolingo.com/#/privacy</a>. By using the Service, you consent to the terms of the Privacy Policy. </p></li><li><h3>Notice for Claims of Copyright Violations and Agent for Notice</h3><p>If you are a copyright owner and have a good faith belief that any material available through the service infringes upon your copyrights, you may submit a copyright infringement notification to Duolingo pursuant to the Digital Millennium Copyright Act by providing us with the following information in writing:</p><ul style=\"margin-bottom: 20px;\"><li>an electronic or physical signature of the copyright owner or the person authorized to act on behalf of the owner of the copyright interest;</li><li>a description of the copyrighted work that you claim has been infringed;</li><li>a description of where the material that you claim is infringing is located on the Service, with enough detail that we may find it on the Service;</li><li>your address, telephone number, and email address;</li><li>a statement by you that you have a good faith belief that the disputed use is not authorized by the copyright owner, its agent, or the law; and</li><li>a statement by you, made under penalty of perjury, that the above information in your notice is accurate and that you are the copyright owner or are authorized to act on the copyright owner's behalf.</li></ul><p>Please consult your legal counsel for further details or see 17 U.S.C. \u00a7512(c)(3). Duolingo\u2019s Agent for Notice of claims of copyright infringement can be reached as follows:</p><ul><li>By mail: 5541 Walnut Street, third floor, Pittsburgh PA 15232</li><li>By email: <a href=\"mailto:abuse@duolingo.com\">abuse@duolingo.com</a></li></ul></li><li><h3>Governing Law and Arbitration</h3> <p>These Terms and Conditions, its subject matter and Duolingo\u2019s and your respective rights under these Terms and Conditions shall be governed by and construed under the laws of the Commonwealth of Pennsylvania, United States of America, excluding the conflict of law provisions of that or any other jurisdiction. Any dispute arising between you and Duolingo will be resolved by binding arbitration. The arbitration shall be conducted by a single arbitrator in the County of Allegheny in the Commonwealth of Pennsylvania. Unless otherwise expressly required by applicable law, each party shall bear its own attorneys\u2019 fees without regard to which party is deemed the prevailing party in the arbitration proceeding. </p></li><li><h3>Language</h3> <p>This agreement was originally written in English (US). To the extent any translated version of this agreement conflicts with the English version, the English version controls. </p></li><li><h3>Miscellaneous</h3> <p>These Terms and Conditions constitute the entire agreement between Duolingo and you concerning the subject matter hereof. In the event that any of the Terms and Conditions are held by a court or other tribunal of competent jurisdiction to be unenforceable, such provisions shall be limited or eliminated to the minimum extent necessary so that these Terms and Conditions shall otherwise remain in full force and effect. A waiver by Duolingo or you of any provision of these Terms and Conditions or any breach thereof, in any one instance, will not waive such term or condition or any subsequent breach thereof. Duolingo may assign its rights or obligations under these Terms and Conditions without condition. These Terms and Conditions will be binding upon and will inure to the benefit of Duolingo and you, and Duolingo\u2019s and your respective successors and permitted assigns. </p></li><li style=\"list-style: none;\">Last revised on April 24th, 2013</li></ol>","test-event":"{{#user}}{{>avatar_medium}}{{/user}}{{^shortcut}}<ul class=\"skill-grid-small\">{{#skills}}<li id=\"event-skills-{{#skill}}{{id}}{{/skill}}\"></li>{{/skills}}</ul>{{/shortcut}}<h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a>{{#shortcut}} {{#_i}}took a shortcut and learned {{num_skills}} {{#_ivar}}language_string{{/_ivar}} {{#pluralize}}skill,skills,{{num_skills}}{{/pluralize}}{{/_i}}{{/shortcut}}{{^shortcut}} {{#_i}}tested out of {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} skill{{/_i}}{{/shortcut}}</h5>{{#shortcut}}<ul class=\"skill-grid-small\">{{#skills}}<li id=\"event-skills-{{#skill}}{{id}}{{/skill}}\" style=\"margin: 0 5px 5px 0;\"></li>{{/skills}}</ul>{{/shortcut}}{{#any_unlocked}}<div class=\"unlocked-skills\">{{#_i}}New unlocked skills{{/_i}}: {{unlocked_string}}</div>{{/any_unlocked}}<div class=\"stream-comments {{^has_comments}}hidden{{/has_comments}}\"></div>{{>event-footer}} ","timed-session-intro":"<div class=\"intro-screen\">{{#path_node_index}}<h1>{{#_i}}Timed bonus round{{/_i}}</h1><h2 class=\"offset\">{{#_i}}Finish in less than 2 minutes!{{/_i}}</h2>{{/path_node_index}}{{^path_node_index}}<h1>{{#_i}}Timed practice{{/_i}}</h1><h2 class=\"offset\">{{#_i}}Answer correctly to get extra time and points{{/_i}}</h2>{{/path_node_index}}<div class=\"owl-workout\"></div><div class=\"speech-bubble arrow-left\"><h4>{{#_i}}Speed tip{{/_i}}</h4><div id=\"st_1\" class=\"hidden\">{{#_i}}Press <span class=\"key-button\">Enter</span> to submit your answers and continue{{/_i}}.</div><div id=\"st_2\" class=\"hidden\">{{#_i}}Select multiple choice answers with{{/_i}} <span class=\"key-button\">1</span><span class=\"key-button\">2</span><span class=\"key-button\">3</span></div><div id=\"st_3\" class=\"hidden\">{{#_i}}Move through drop down list options with{{/_i}} <span class=\"key-button\">\u25b2</span><span class=\"key-button\">\u25bc</span></div><div id=\"st_4\" class=\"hidden\">{{#_i}}Press <span class=\"key-button\">Ctrl</span>+<span class=\"key-button\">Space</span> to replay the audio{{/_i}}.</div></div></div> ","timer":"<div class=\"inner\"><strong>{{#format_seconds}}{{seconds}}{{/format_seconds}}</strong><div class=\"stopwatch\"><span class=\"counter\"></span></div></div> ","topic":"<div class=\"community\"><h1>{{#_i}}{{#_ivar}}name{{/_ivar}} Discussion{{/_i}}</h1><h2 class=\"offset\">{{#_ivar}}subtitle{{/_ivar}}</h2><div class=\"comment-search\" style=\"float : left\"></div><div class=\"comment-main\"><ul class=\"tabs big\" {{#show_active}}style=\"font-size: .9em;\"{{/show_active}}><li class=\"active\" data-tab=\"hot\" id=\"hot\"><a href=\"javascript:;\">{{#_i}}Popular{{/_i}}</a></li><li data-tab=\"new\" id=\"new\"><a href=\"javascript:;\">{{#_i}}<span id=\"label-new-f-pl\">New</span>{{/_i}}</a></li>{{^main_topic}}<li data-tab=\"sent\" id=\"sent\"><a href=\"javascript:;\">{{#_i}}Sentences{{/_i}}</a></li>{{/main_topic}}<li data-tab=\"top\" id=\"top\"><a href=\"javascript:;\">{{#_i}}Top All Time{{/_i}}</a></li>{{#show_active}}<li data-tab=\"active\" id=\"active\"><a href=\"javascript:;\">{{#_i}}Active{{/_i}}<span class=\"superscript\">(Mod)</span></a></li>{{/show_active}}</ul><div id=\"hot-tab\" class=\"panel\"></div><div id=\"new-tab\" class=\"panel hidden unordered-content\"></div>{{^main_topic}}<div id=\"sent-tab\" class=\"panel hidden unordered-content\"></div>{{/main_topic}}<div id=\"top-tab\" class=\"panel hidden unordered-content\"></div>{{#show_active}}<div id=\"active-tab\" class=\"panel hidden unordered-content\"></div>{{/show_active}}<div id=\"comments\" class=\"\"></div><i id=\"no-results\" class=\"hidden\">{{#_i}}No results found{{/_i}}</i><i id=\"not-watching\" class=\"hidden\">{{#_i}}You're not watching any questions or insights{{/_i}}</i></div><div class=\"comment-sidebar\">{{#logged_in}}<span id=\"ask-question\" class=\"btn large primary new-topic\">{{#_i}}New Discussion{{/_i}}</span>{{/logged_in}}<div class=\"form-row\"><span class=\"search-icon\"></span><label style=\"left: 36px; top: 12px; font-size: 14px\" for=\"search-comments\">{{#_i}}Search{{/_i}}</label><input type=\"text\" name=\"search\" value=\"\" class=\"search-box {{^logged_in}}logged-out{{/logged_in}}\" id=\"search-comments\" maxlength=\"50\"/><div class=\"clear-button btn\" style=\"display : none\">x</div></div>{{#user_skill}}<h5>{{#_i}}Skill{{/_i}}</h5><div id=\"comment-skill\" style=\"margin: 5px 0;\"></div>{{/user_skill}}<h3>{{#_i}}Sections{{/_i}}</h3><ul class=\"list-topics\">{{#subtopics}}<li class=\"{{#self}}active{{/self}}\"><strong><a href=\"#/topic/{{id}}\">{{#_ivar}}name{{/_ivar}}<span class=\"topic-flag flag-{{id}}\"></span></a></strong></li>{{/subtopics}}</ul><h3>{{#_i}}Experts{{/_i}}</h3><ul class=\"user-grid\">{{#expert_users}}<li class=\"expert\">{{>avatar_medium}}</li>{{/expert_users}}</ul></div><div id=\"insight-fields\" class=\"modal post-comment hidden\"></div><div class=\"modal post-comment hidden\" id=\"question-fields\"></div></div> ","translate-element":"<h1 style=\"position: relative;\">{{#_i}}<strong>Translate</strong> this text to {{#_ivar}}target_language_name{{/_ivar}}{{/_i}}{{#difficulty}}<span style=\"font-weight: normal; font-size: 13px; color: gray; position: absolute; right: 0px;\">DIFFICULTY: {{difficulty}}/10</span>{{/difficulty}}</h1><div class=\"challenge row\"><div class=\"span8 columns translate-column\">{{^need_flash}}<span id=\"big-speaker\"></span>{{/need_flash}}<h3 class=\"hints translation-source\">{{sentence}}</h3></div><div class=\"span8 columns relative translate-input-column\">{{>blame-popover}}<span class=\"textarea-arrow\"></span><textarea class=\"translation-textarea\" id=\"text-input\" name=\"text-input\" lang=\"{{target_language}}\" tabindex=\"1\"></textarea><div id=\"vkeyboard-placeholder\"></div><div class=\"button-vkeyboard\" id=\"toggle_vkeyboard\" style=\"right: 5px;\"></div>{{#new_player_blame_experiment_true}}<div id=\"correct-solutions\"></div>{{/new_player_blame_experiment_true}}<div id=\"other-translations\" class=\"other-translations hidden\"></div></div></div><div id=\"peek\" class=\"word-tooltip peek\"><span class=\"icon\"></span>{{#_i}}You peeked{{/_i}}<span class=\"word-tooltip-strength\"></span></div><div id=\"new-word\" class=\"word-tooltip new {{#translation_session}}added-to-practice{{/translation_session}}\"><span class=\"icon-container\"><span class=\"icon\"></span></span>{{#_i}}New word{{/_i}}</div>{{#multiple_new_words}}<div id=\"multiple-new-words\" class=\"word-tooltip new\"><span class=\"icon-container\"><span class=\"icon\"></span></span>{{num_new_words}} {{#_i}}new words{{/_i}}</div>{{/multiple_new_words}}{{#relevant_words}}<div class=\"word-tooltip relevant\" id=\"{{word}}-tooltip\">{{#_i}}Last seen <strong>{{#pretty_date}}{{last_seen}}{{/pretty_date}}</strong>{{/_i}}</div>{{/relevant_words}}<div id=\"new-concept\" class=\"word-tooltip new {{#translation_session}}added-to-practice{{/translation_session}}\"><span class=\"icon-container\"><span class=\"icon\"></span></span>{{#_i}}New concept{{/_i}}</div> ","translation-event":"{{#user}}{{>avatar_medium}}{{/user}}<ul class=\"point-gain-box\">{{#total_improvement}}<li><span class=\"icon-star-small\"></span><span class=\"skill-points-small\">+{{total_improvement}}</span></li>{{/total_improvement}}<li><span class=\"icon-puzzle-small\"></span><span class=\"contribution-points-small\">+{{count}}</span></li></ul><h5>{{#user}}<a href=\"#/{{username}}\" class=\"user\">{{username}}</a>{{/user}} {{#_i}}translated {{count}} {{#pluralize}}sentence,sentences,{{count}}{{/pluralize}} of{{/_i}}</h5><div class=\"translation\"><div class=\"image\">{{#preview_image}}<img src=\"{{preview_image}}\"/>{{/preview_image}}{{^preview_image}}<img src=\"http://static.duolingo.com/images/owl-waving-gray_mv_1eb4d87c9b09a75a3591e67cfbcad86a.png\"/>{{/preview_image}}</div><div class=\"excerpt\"><strong><a href=\"#/translation/{{translation_id}}\">{{title}}</a></strong><p>{{blurb}}</p></div></div><div class=\"stream-comments {{^has_comments}}hidden{{/has_comments}}\"></div>{{>event-footer}} ","translation-upload":"<div class=\"upload-container\"><h2>{{#_i}}Upload document{{/_i}}</h2><ol class=\"steps\"><li><span class=\"number\">1</span><h5>{{#_i}}Enter a web address:{{/_i}}</h5><span class=\"btn primary right\" id=\"preview\" disabled=\"disabled\">{{#_i}}Preview{{/_i}}</span><div class=\"input-wrapper\"><input type=\"text\" id=\"upload-url\" value=\"{{document_url}}\"/></div><div id=\"generating-preview\" class=\"hidden\">{{#_i}}Generating preview... (this may take some time){{/_i}}</div><div id=\"preview-failed\" class=\"hidden\">{{#_i}}This web address is invalid or the page could not be loaded.{{/_i}}</div><div class=\"hidden\" id=\"upload-preview\"><div class=\"article-look\">{{#_i}}This is how your article will look:{{/_i}}</div><div class=\"preview-container\"><div class=\"preview-text\">{{#image_url}}<img src=\"{{image_url}}\" class=\"preview-image\">{{/image_url}}<h5>{{title}}</h5>{{{snippet}}}</div></div><div class=\"detected-language\">{{#_i}}Detected language: {{#_ivar}}detected_language{{/_ivar}}{{/_i}}</div></div></li><li id=\"upload-choose-category\" class=\"hidden\"><span class=\"number\">2</span><h5>{{#_i}}Choose a category in which your article best fits:{{/_i}}</h5><select id=\"category\" name=\"\" class=\"\"><option value='None'>{{#_i}}<!--category-->None selected{{/_i}}</option>{{#categories}}<option value=\"{{id}}\">{{#_ivar}}label{{/_ivar}}</option>{{/categories}}</select></li><li id=\"upload-choose-language\" class=\"hidden\"><span class=\"number\">3</span><h5>{{#_i}}Choose the language into which to translate this document:{{/_i}}</h5><select id=\"language\" name=\"\" class=\"\"><option value='None'>{{#_i}}<!--language-->None selected{{/_i}}</option>{{#target_languages}}<option value=\"{{id}}\">{{#_ivar}}name{{/_ivar}}</option>{{/target_languages}}</select></li></ol><div class=\"legalese\">{{#_i}}You must own the copyright or have the necessary<br>rights for any content you upload.{{/_i}}</div><div class=\"upload-action\"><div id=\"uploading\" class=\"hidden\">{{#_i}}Uploading... (this may take some time){{/_i}}</div><div id=\"upload-success\" class=\"hidden\">{{#_i}}Upload succeeded!{{/_i}}</div><div id=\"upload-failure\" class=\"hidden\">{{#_i}}Your document failed to upload, please try a different webpage:{{/_i}}<ul><li>{{#_ivar}}upload_failure_reason{{/_ivar}}</ul></div><span class=\"btn right primary new-topic\" id=\"submit-upload\" disabled=\"disabled\" style=\"margin-left: 10px;\">{{#_i}}Submit{{/_i}}</span><span class=\"btn right new-topic\" id=\"cancel-upload\">{{#_i}}Cancel{{/_i}}</span></div></div> ","translations-ranked":"<h1>{{^category}}{{#_i}}Immerse yourself{{/_i}}{{/category}}{{#category}}{{#_i}}Category: {{#_ivar}}category_label{{/_ivar}}{{/_i}}{{/category}}</h1><h2 class=\"offset\">{{#_i}}Read and translate real {{#_ivar}}language_string{{/_ivar}} articles{{/_i}}</h2><div class=\"translate-main\" id=\"translation-tabs\"><ul class=\"tabs big\"><li class=\"active\" data-tab=\"top\"><a href=\"javascript:;\">{{#_i}}<span>Popular</span>{{/_i}}</a></li><li data-tab=\"recent\"><a href=\"javascript:;\">{{#_i}}<span>New</span>{{/_i}}</a></li><li data-tab=\"draft\"><a href=\"javascript:;\">{{#_i}}<span>Translated</span>{{/_i}}</a></li><li data-tab=\"history\"><a href=\"javascript:;\">{{#_i}}Your edits{{/_i}}</a></li>{{#user_has_uploaded}}<li data-tab=\"uploaded\"><a href=\"javascript:;\">{{#_i}}Your uploads{{/_i}}</a></li>{{/user_has_uploaded}}</ul><div id=\"top-tab\" class=\"panel\"></div><div id=\"recent-tab\" class=\"panel hidden unordered-content\"></div><div id=\"history-tab\" class=\"panel hidden unordered-content\"></div><div id=\"draft-tab\" class=\"panel hidden unordered-content\"></div><div id=\"uploaded-tab\" class=\"panel hidden unordered-content\"></div></div><div class=\"translate-main hidden\" id=\"translation-upload\"></div><div class=\"translate-sidebar new\"><center><span class=\"btn large primary new-document\" id=\"upload-document\">{{#_i}}Upload document{{/_i}}</span></center><br><br><div class=\"speech-bubble arrow-right\"><h4>{{#_i}}Help the world!{{/_i}}</h4><p style=\"margin-bottom: 14px;\">{{#_i}}While you read and edit {{#_ivar}}language_string{{/_ivar}} articles you help us translate the whole internet one piece at time.{{/_i}}</p><strong><a href=\"javascript:;\" class=\"watch-video\">{{#_i}}Learn more{{/_i}}</a></strong><div class=\"superduo-peeking-right\"></div></div><h3 class=\"light-grey\">{{#_i}}Categories{{/_i}}</h3><ul id=\"categories\" class=\"grey-box-list\"><li {{#all-active}}class=\"active\"{{/all-active}}><a href=\"/#/translations\">{{#_i}}All{{/_i}}</a></li>{{#categories}}<li {{#hidden}}class=\"hidden\"{{/hidden}} {{#active}}class=\"active\"{{/active}}><a href=\"/#/translations/{{id}}\">{{#_ivar}}label{{/_ivar}}</a></li>{{/categories}}{{^show_all}}<li><a href=\"javascript:;\" style=\"color: #999;\" id=\"show-all-categories\" class=\"show-more\">{{#_i}}show more{{/_i}}</a></li>{{/show_all}}</ul></div> ","translations-ranked-item":"{{#document}}{{#preview_image}}<span class=\"rounded-image-wrapper small\"><span class=\"image-frame\" style=\"background-image: url('{{preview_image}}')\"></span></span>{{/preview_image}}{{^preview_image}}<span class=\"rounded-image-wrapper small\"><span class=\"image-frame\" style=\"background-image: url('/images/owl-waving-gray.png')\"></span></span>{{/preview_image}}{{/document}}<div class=\"article-data\">{{#translated_title}}<div id=\"title-popover-{{id}}\" class=\"popover new above wiki-translation-popover title-popover\"><div id=\"title-popover-contents-{{id}}\" class=\"sentence-with-alignment\"></div><div class=\"arrow\" style=\"left:50px\"></div></div><h5><span id=\"title-{{id}}\" data-toggle=\"popover\" data-popover=\"#title-popover-{{id}}\" data-margin=\"5\" data-placement=\"above\" data-justification=\"left\" data-x-offset=\"-15\" data-arrow-left-offset=\"10\"><a href=\"/#/translation/{{id}}{{#draft}}?r{{/draft}}\"><span id=\"title-text-{{id}}\" class=\"sentence-with-alignment\">{{#document}}{{title}}{{/document}}</span></a></span></h5>{{/translated_title}}{{^translated_title}}<h5>{{#clickable}}<a href=\"#/translation/{{id}}{{#draft}}?r{{/draft}}\">{{#document}}{{title}}{{/document}}</a>{{/clickable}}{{^clickable}}{{#document}}{{title}}{{/document}}{{/clickable}}</h5>{{/translated_title}}<div class=\"metadata\"><div class=\"vote-module-small\"><div class=\"vote-count\">{{votes}}</div><div class=\"vote-buttons\"><button class=\"vote-up {{#user_upvoted}}voted{{/user_upvoted}}\" data-doc=\"{{#document}}{{id}}{{/document}}\">{{#_i}}vote up{{/_i}}</button><button class=\"vote-down {{#user_downvoted}}voted{{/user_downvoted}}\" data-doc=\"{{#document}}{{id}}{{/document}}\">{{#_i}}vote down{{/_i}}</button></div></div><span style=\"margin-left: 5px;\">{{^uploaded_by_username}}{{#_i}}Added {{published_date}} to <a href=\"/#/translations/{{category_id}}\" data-category=\"{{category_id}}\">{{#document}}{{#_ivar}}category{{/_ivar}}{{/document}}</a>{{/_i}}{{/uploaded_by_username}}{{#uploaded_by_username}}{{#_i}}Added {{published_date}} to <a href=\"/#/translations/{{category_id}}\" data-category=\"{{category_id}}\">{{#document}}{{#_ivar}}category{{/_ivar}}{{/document}}</a> by <a href=\"/#/{{uploaded_by_username}}\">{{uploaded_by_username}}</a>{{/_i}}{{/uploaded_by_username}}</span></div></div><div class=\"progress\" data-toggle=\"popover\" data-popover=\"#popover-{{id}}\" data-margin=\"5\"><div class=\"pie\">{{#progress}}<div class=\"sentence-pie\" style=\"height: 20px; width: 20px\" data-pie=\"{{progress}}+{{missing_progress}}\"></div>{{/progress}}</div><div class=\"percentage\">{{num_sentences_translated}}/{{num_sentences_total}}</div></div><div id=\"popover-{{id}}\" class=\"popover right black\"><div class=\"arrow\"></div><div class=\"inner\"><div class=\"content\" style=\"padding: 10px 20px;\">{{#_i}}<strong style=\"color: white\">{{progress}}%</strong> translated by the Duolingo community.{{/_i}}</div></div></div> ","translations-ranked-list":"<ul class=\"ranked-translations\"></ul>{{^translations}}<div class=\"no-docs-message\">{{#history}}{{#_i}}You have not translated any documents in this category.{{/_i}}{{/history}}{{^history}}{{#_i}}There are no documents in this category at the moment.{{/_i}}{{/history}}</div>{{/translations}}{{#more}}<img class=\"translations-spinner\" src=\"/images/medium-loader.gif\">{{/more}} ","twitter_redirect":"<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /><title>Duolingo</title>{{#css}}<link rel=\"stylesheet\" href=\"{{.}}\" />{{/css}}{{#js}}<script src=\"{{.}}\"></script>{{/js}}<script type=\"text/javascript\">{{^error}} window.opener.location = '/#/?twttr_token={{oauth_token}}&twttr_verifier={{oauth_verifier}}'; window.close(); {{/error}}</script></head><body>{{#error}}<h1 style=\"text-align: center; margin-top: 50px;\">{{#_i}}There seems to be a problem<br/>connecting to Twitter{{/_i}}</h1><h2 style=\"text-align: center;\">{{#_i}}Please try again later{{/_i}}</h2>{{/error}}</body></html>","ui-language-chooser":"<div class=\"change-language-dark\" {{^ui_languages}}style=\"display: none;\"{{/ui_languages}}><ul class=\"languages hidden\" style=\"display: none\">{{#ui_languages_list}}<a href=\"{{language}}\"><li class='ui-language-option' data-value='{{language}}'>{{language_name}}</li></a>{{/ui_languages_list}}</ul><div class=\"current\">{{#_i}}Language{{/_i}}: <strong>{{#_ivar}}ui_language_name{{/_ivar}}</strong></div></div> ","unfollow_wiki_translation":"{{#_i}}You will no longer receive emails about sentences in \"{{document_title}}\".{{/_i}}<br><br>{{#_i}}Go to <a href=\"duolingo.com\">Duolingo</a>{{/_i}}. ","unlock-event":"{{#user}}{{>avatar_medium}}{{/user}}<ul class=\"skill-grid-small\">{{^skills}}<div style=\"height: 10px;\"></div>{{/skills}}{{#skills}}<li id=\"event-skills-{{id}}\"></li>{{/skills}}</ul><h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#_i}}learned {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} skill{{/_i}}</h5>{{#any_unlocked}}<div class=\"unlocked-skills\">{{#_i}}New unlocked skills{{/_i}}: {{unlocked_string}}</div>{{/any_unlocked}}<div class=\"stream-comments {{^has_comments}}hidden{{/has_comments}}\"></div>{{>event-footer}}","user-search-results":"{{#users}}<li>{{>avatar_small}}<a href=\"javascript:;\" class=\"btn {{#is_following}}success is-friend{{/is_following}}{{^is_following}}{{/is_following}} right\" data-toggle=\"follow\" data-follow-text=\"{{#_i}}Add friend{{/_i}}\" data-unfollow-text=\"{{#_i}}Friends{{/_i}}\" data-user=\"{{id}}\" data-follow-class=\"\" data-unfollow-class=\"is-friend\">{{#is_following}}{{#_i}}Friends{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Add friend{{/_i}}{{/is_following}}</a><a href=\"/#/{{username}}\" class=\"username-link\"><strong>{{username}}</strong>{{fullname}}</a></li>{{/users}}{{^users}}<li style=\"padding-left: 10px;text-align: center;color: #999;\">{{#_i}}No users found.{{/_i}}</li>{{/users}}","user_flair":"<span class=\"user-flair\">{{#flair}}{{#mod}}<span class=\"moderator\"></span>{{/mod}}{{#level_data_sorted}}<span class=\"level-flag {{language}}\"></span>{{level}}{{/level_data_sorted}}{{#streak}}<span class=\"streak\"></span>{{streak}}{{/streak}}{{/flair}}</span>","vocab-overview":"<h1>{{^skill_id}}{{#_i}}{{#_ivar}}language_string{{/_ivar}} vocabulary{{/_i}}{{/skill_id}}{{#skill_id}}{{^lesson}}{{#_i}}Skill:{{/_i}} {{#_ivar}}skill_title{{/_ivar}}{{/lesson}}{{/skill_id}}{{#skill_id}}{{#lesson}}{{skill_title}}: {{#_i}}Lesson{{/_i}} {{lesson}}{{/lesson}}{{/skill_id}}</h1><h2 class=\"offset\">{{#_i}}All the words you have learned on Duolingo{{/_i}}</h2><div class=\"vocabulary-main\"><div class=\"header\"><!-- <div class=\"form-row right\"><label for=\"search-box\">Search word</label><input id=\"search-box\" type=\"text\" class=\"medium\"></div> --><h4>{{#_i}}Showing all {{vocab_count}} {{#pluralize}}word,words,{{vocab_count}}{{/pluralize}}{{/_i}}</h4></div><table class=\"vocabulary table table-striped\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><thead><tr><th class=\"sortable\" data-sort=\"word\">{{#_i}}Word{{/_i}} <span class=\"sorting-icon\"></th><th>{{#_i}}Forms{{/_i}}</th><th>{{#_i}}Skill{{/_i}}</th><th class=\"sortable\" data-sort=\"last_seen\">{{#_i}}Last practiced{{/_i}} <span class=\"sorting-icon\"></span></th><th class=\"sortable\" data-sort=\"strength\">{{#_i}}Strength{{/_i}} <span class=\"sorting-icon\"></span></th></tr></thead><tbody>{{#vocab}}{{>lemma-row}}{{/vocab}}{{^vocab}}<tr><td colspan=\"5\">{{#_i}}You haven't learned any words in {{#_ivar}}language_string{{/_ivar}} yet. Try doing some lessons.{{/_i}}</td></tr>{{/vocab}}</tbody></table>{{#has_vocab}}<img id=\"vocab-spinner\" src=\"/images/medium-loader.gif\" style=\"left: 45%; position: absolute\" class=\"\"/>{{/has_vocab}}</div><div class=\"vocabulary-sidebar\">{{#vocab_count}}<div class=\"box-practice\"><a href=\"javascript:;\" id=\"practice-button\" class=\"btn primary practice-button\">{{#_i}}Practice weakest words{{/_i}}</a></div>{{/vocab_count}}<!-- <div class=\"vocab-graph\"><h4>Vocabulary over time</h4><div id=\"vocab-graph\" style=\"width: 230px; height: 150px; position: relative; margin: 0 0 30px 0;\"></div><ul class=\"legend\"><li><span class=\"learning\"></span>Learning: <strong>{{learning_count}}</strong></li><li><span class=\"mastered\"></span>Long-term: <strong>{{capped_count}}</strong></li></ul></div> -->{{^skill_id}}<div class=\"speech-bubble arrow-right\"><h4>{{#_i}}Spaced repetition{{/_i}}</h4><p>{{#_i}}Duolingo\u2019s algorithms figure out when you should practice words to get them into your long-term memory.{{/_i}}</p><ul class=\"strength\"><li><ul class=\"word-strength small\"><li class=\"filled\"></li><li></li><li></li><li></li></ul>{{#_i}}Weak{{/_i}}</li><li><ul class=\"word-strength small\"><li class=\"filled\"></li><li class=\"filled\"></li><li></li><li></li></ul>{{#_i}}Medium{{/_i}}</li><li><ul class=\"word-strength small\"><li class=\"filled\"></li><li class=\"filled\"></li><li class=\"filled\"></li><li></li></ul>{{#_i}}Strong{{/_i}}</li><li><ul class=\"word-strength small\"><li class=\"filled\"></li><li class=\"filled\"></li><li class=\"filled\"></li><li class=\"filled\"></li></ul>{{#_i}}Perfect{{/_i}}</li></ul><div class=\"owl-peeking-right\"></div></div>{{/skill_id}}{{^lesson}}{{^skill_id}}<h4>{{#_i}}Vocabulary by skills{{/_i}}</h4>{{/skill_id}}{{#skill_id}}<h4>{{#_i}}Vocabulary by lessons{{/_i}}</h4>{{/skill_id}}<ul id=\"skills-counts\" class=\"simple-list\">{{#skills_lemma_count}}<li {{#hidden}}class=\"hidden\"{{/hidden}}><strong><a href=\"/#/vocab/{{id}}\" class=\"skill-filter\" data-skill=\"{{id}}\">{{#_ivar}}title{{/_ivar}}</a></strong> {{#_i}}{{count}} {{#pluralize}}word,words,{{count}}{{/pluralize}}{{/_i}}</li>{{/skills_lemma_count}}{{#lessons_lemma_count}}<li {{#hidden}}class=\"hidden\"{{/hidden}}><strong><a href=\"/#/vocab/{{skill_id}}/{{lesson}}\" class=\"skill-filter\">{{#_i}}Lesson {{lesson}}{{/_i}}</a></strong> {{#_i}}{{count}} {{#pluralize}}word,words,{{count}}{{/pluralize}}{{/_i}}</li>{{/lessons_lemma_count}}</ul>{{^show_all}}<a href=\"javascript:;\" id=\"show-more-counts\" class=\"show-more\">{{#_i}}show more{{/_i}}</a>{{/show_all}}{{/lesson}}</div> ","vocab-word":"<h1><span class=\"listen-button-small\"></span>{{surface_form}} {{#pos}}<span class=\"word-type\">({{#_ivar}}pos_string{{/_ivar}})</span>{{/pos}}</h1><div class=\"vocabulary-main\"><ul class=\"word-info\"><li><span class=\"label\">{{#_i}}Strength{{/_i}}</span><ul class=\"word-strength medium\"><li class=\"filled\"></li><li {{#strength_s}}class=\"filled\"{{/strength_s}}></li><li {{#strength_m}}class=\"filled\"{{/strength_m}}></li><li {{#strength_l}}class=\"filled\"{{/strength_l}}></li></ul></li><li>{{#_i}}Times seen{{/_i}}<h3>{{times_seen}}</h3></li>{{#pos}}<li>{{#_i}}Part of speech{{/_i}}<h3>{{#_ivar}}pos_string{{/_ivar}}</h3></li>{{/pos}}{{#gender}}<li>{{#_i}}Gender{{/_i}}<h3>{{gender}}</h3></li>{{/gender}}{{#pronunciation}}<li>{{#_i}}Pronounciation{{/_i}}<h3>{{pronunciation}}</h3></li>{{/pronunciation}}{{#seen_forms}}<li class=\"forms-seen\">{{#_i}}{{#pluralize}}Form,Forms,{{seen_forms}}{{/pluralize}} seen{{/_i}}<h3>{{seen_forms}}</h3></li>{{/seen_forms}}</ul>{{#lexemes_data}}{{#seen}}<table class=\"translations table table-striped\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><thead><tr><th style=\"width: 24%;\"><h4>{{surface_form}} {{#gender}}<span class=\"gender\">({{gender}})</span>{{/gender}}<ul class=\"word-strength xsmall right\" style=\"margin: 5px 0 0 5px;\"><li class=\"filled\"></li><li {{#strength_s}}class=\"filled\"{{/strength_s}}></li><li {{#strength_m}}class=\"filled\"{{/strength_m}}></li><li {{#strength_l}}class=\"filled\"{{/strength_l}}></li></ul></h4></th>{{#example_data}}{{#has_examples}}<th style=\"width: 33%;\">{{#_i}}Example sentence{{/_i}}</th><th style=\"width: 33%;\">{{#_i}}Translation{{/_i}}</th>{{/has_examples}}{{/example_data}}</tr></thead><tbody>{{#example_data}}{{#examples}}<tr><td style=\"background: white;\"><strong class=\"translation\">{{hint}}</strong></td>{{#example}}<td>{{value}}</td><td>{{translation}}</td>{{/example}}</tr>{{#sentences}}<tr class=\"more\"><td style=\"border-top: none; background: white;\"></td><td>{{value}}</td><td>{{translation}}</td></tr>{{/sentences}}{{/examples}}{{^has_examples}}<tr><td><strong class=\"translation\">{{hint}}</strong></td><td></td><td></td></tr>{{/has_examples}}{{/example_data}}</tbody></table>{{/seen}}{{/lexemes_data}}{{#is_verb}}<h4>{{#_i}}Conjugation table{{/_i}}</h4><div id=\"verb-table\"></div>{{/is_verb}}</div><div class=\"vocabulary-sidebar\"><div class=\"box-practice\"><a href=\"/#/word_practice/{{language}}/{{lemma_value}}/{{pos_key}}\" class=\"btn primary large\">{{#_i}}Practice word{{/_i}}</a>{{^strength_l}}<div class=\"remove\"><strong>{{#_i}}Know this word perfectly?{{/_i}}</strong><a href=\"javascript:;\" id=\"cap-word\" class=\"btn\">{{#_i}}Remove from practice{{/_i}}</a></div>{{/strength_l}}</div>{{#image}}<div class=\"image\"><img src=\"{{image}}\"><span class=\"caption\">{{noun_phrase}}</span><span class=\"overlay\"></span></div>{{/image}}</div> ","welcome-event":"{{#user}}{{>avatar_medium}}{{/user}}<ul class=\"point-gain-box\"><li><span class=\"icon-star-small\"></span><span class=\"skill-points-small\">+10</span></li></ul><h5><a href=\"#/{{#user}}{{username}}{{/user}}\" class=\"user\">{{#user}}{{username}}{{/user}}</a> {{#_i}}did the {{#_ivar}}language_string{{/_ivar}} welcome lesson{{/_i}}</h5><div class=\"stream-comments {{^has_comments}}hidden{{/has_comments}}\"></div>{{>event-footer}}","welcome-fb-friends":"{{>player-header}}<div id=\"session-element-container\"><div class=\"friend-boxes\">{{#num_friends}}{{#registered_with_facebook}}<h1 style=\"margin-bottom: 40px;\">{{#_i}}Your Facebook friends on Duolingo{{/_i}}</h1>{{/registered_with_facebook}}<div class=\"pane\"><h3>{{num_friends}} of your friends are already here</h3><div class=\"subline\"><p>{{#_i}}You are now following them:{{/_i}}</p></div><ul id=\"followed-friends\" class=\"list-users-small\">{{#show_friends}}<li {{#not_shown}} style=\"display: none\"{{/not_shown}}><a class=\"follow-button btn right success\" data-user=\"{{user_id}}\">Following</a><a href=\"#/{{username}}\" class=\"has-twipsy avatar-small\" data-original-title=\"{{name}}\"><img src=\"{{#picture}}{{#data}}{{url}}{{/data}}{{/picture}}\" class=\"avatar\"></a><a href=\"#/{{username}}\" class=\"user\">{{name}}</a><span class=\"language\">{{#_i}}{{#_ivar}}learning_language_string{{/_ivar}} Level {{learning_language_level}}{{/_i}}</span></li>{{/show_friends}}</ul>{{#num_more_friends}}<p class=\"more-friends-on-duo\">{{#_i}}<strong>+{{num_more_friends}} more</strong> of your friends are already here{{/_i}} <a id=\"show-more-friends\" href=\"javascript:;\">\u2192 {{#_i}}show them{{/_i}}</a></p>{{/num_more_friends}}</div>{{/num_friends}}{{^num_friends}}<h1 style=\"margin-bottom: 40px;\">{{#_i}}None of your Facebook friends are here yet. Invite them!{{/_i}}</h1>{{/num_friends}}<div class=\"pane\">{{#num_friends}}<h3>{{#_i}}Now invite others to the party!{{/_i}}</h3>{{/num_friends}}<div class=\"subline\"><div class=\"form-row\"><span class=\"search-icon\"></span><label class=\"search-friends-label\" for=\"search-friends\">{{#_i}}Search for friends to invite{{/_i}}</label><input type=\"text\" class=\"search\" id=\"search-friends\"></div></div><ul id=\"invite-friends\" class=\"list-users-small\">{{>other-fb-friends}}</ul></div></div></div><div id=\"controls\" class=\"player-action\"><div class=\"row\"><div class=\"offset8 span8 columns\"><button id=\"next-button\" type=\"submit\" class=\"btn large right\">{{#_i}}Next{{/_i}}</button></div></div></div> ","welcome-no-fb":"{{>player-header}}<div class=\"intro\"><div class=\"bottom\"></div></div><div id=\"session-element-container\"><h1 style=\"margin: 15px 0 40px 0; text-align: center\">{{#_i}}You\u2019re an early adopter!{{/_i}}</h1><h2>{{#_i}}None of your Facebook friends are on Duolingo yet{{/_i}}</h2></div><div id=\"controls\" class=\"player-action\"><div class=\"row\"><div class=\"offset8 span8 columns\"><button id=\"next-button\" type=\"submit\" class=\"btn large right\">{{#_i}}Next{{/_i}}</button></div></div></div> ","welcome-session-end-fb":"{{>player-header}}<div id=\"session-element-container\" style=\"padding: 0\" class=\"fb-connect-step\"><div class=\"intro screen-1\"><div class=\"owl-friends\"></div><h1 style=\"margin: 115px 0 15px 0;\">{{#_i}}Find your friends on Facebook!{{/_i}}</h1><h2>{{#_i}}Learners with friends have <strong>200% more success</strong>.{{/_i}}</h2></div></div><div id=\"controls\" class=\"player-action\"><div class=\"row\"><div class=\"offset8 span8 columns\"><button id=\"facebook-connect\" class=\"btn large primary right fb-connect\" style=\"margin-left: 10px;\">{{#_i}}Connect using Facebook{{/_i}}</button><button id=\"skip-button\" type=\"submit\" class=\"btn large right\">{{#_i}}Skip this step{{/_i}}</button></div></div></div> ","welcome-session-end-skills":"{{>player-header}}<div class=\"intro session-end-skill\"><div class=\"top\"><!-- <div class=\"sky-with-sun-3\"></div><div class=\"cloud small\" style=\"right: 420px; top: 50px\"></div> --></div><div class=\"bottom\"><div class=\"skill-tree-bubble\"></div></div></div><div id=\"session-element-container\" style=\"min-height: 375px;\"><h1 style=\"margin: 0 0 40px 0; font-size: 30px;\" class=\"clearfix\">{{#_i}}<strong style=\"float: left;margin-right: 20px;\">Good going!</strong>{{/_i}}<a id=\"facebook-post-action\" class=\"facebook-share-big left\" href=\"javascript:;\" data-name=\"Duolingo\" data-caption=\"{{#_i}}%firstname% did the {{#_ivar}}language_string{{/_ivar}} welcome lesson{{/_i}}\" data-description=\"{{>facebook-description}}\" data-toggle=\"facebook-share\" style=\"margin: 4px 5px 0 0; border: 1px solid #CAD4E7; background: #ECEEF5; height: 26px; line-height: 26px;\"><i></i>{{#_i}}Share on Facebook{{/_i}}</a><div style=\"display: inline-block; float: left; margin-top: 3px;\"><a href=\"https://twitter.com/share\" style=\"margin: 1px 0 0 0;\" class=\"twitter-share-button\" data-text=\"{{#_i}}I did the {{#_ivar}}language_string{{/_ivar}} welcome lesson!{{/_i}}\" data-url=\"http://duolingo.com\" data-count=\"none\" data-via=\"duolingo\" data-size=\"large\"><i></i>{{#_i}}Tweet{{/_i}}</a></div></h1><ul class=\"tour-achievements\"><li><span class=\"circle-star\">10</span>{{#_i}}You just earned your first 10 <strong>skill points</strong>.{{/_i}}</li><li>{{#_i}}At Duolingo you learn by mastering skills.<br/>Complete the <strong>skill tree</strong> to become proficient <br/>in {{#_ivar}}language_string{{/_ivar}}.{{/_i}}<div class=\"end-arrow-blue\"></div></li></ul></div><div id=\"controls\" class=\"player-action\"><div class=\"row\"><div class=\"offset8 span8 columns\"><a href=\"#\" class=\"btn large primary right\">{{#_i}}Continue to Duolingo homepage{{/_i}}</a></div></div></div> ","welcome-suggested-friends":"{{>player-header}}<div id=\"session-element-container\"><h1 style=\"margin: 15px 0 40px 0; text-align: center\">{{#_i}}Follow part of the <strong>Duolingo team</strong>{{/_i}}</h1><ul class=\"fb-follow-friends\">{{#show_friends}}<li class=\"{{#singular}}only-one{{/singular}}\" {{#not_shown}} style=\"display: none\"{{/not_shown}}><a class=\"follow-button {{#is_following}}success{{/is_following}} btn right\" data-user=\"{{id}}\">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</a><!--PUPPY LOCATION-->{{#avatar}}<img src=\"{{avatar}}/large\" class=\"avatar\">{{/avatar}}{{^avatar}}<img src=\"http://duolingo.com/avatars/{{id}}/large\" class=\"avatar\"/>{{/avatar}}<strong><a href=\"/#/{{username}}\" target=\"_blank\">{{username}}</a></strong><p>{{#_i}}is learning {{#_ivar}}learning_language_string{{/_ivar}}{{/_i}}</p></li>{{/show_friends}}</ul></div><div id=\"controls\" class=\"player-action\"><div class=\"row\"><div class=\"offset8 span8 columns\"><button id=\"next-button\" type=\"submit\" class=\"btn large right\">{{#_i}}Next{{/_i}}</button></div></div></div> ","wiki-document-sentence":"<span id=\"sentence-{{index}}\" data-index=\"{{index}}\" class=\"show-hints sentence\">{{#sentence_tokens}}<span class=\"token\" data-token-index=\"{{token_index}}\" id=\"token_{{token_index}}\">{{token}}</span>{{/sentence_tokens}}</span><span {{^index}}style=\"letter-spacing: 0;\"{{/index}}>&nbsp;</span>{{#can_be_edited}}{{#cur_translation}}<div class=\"sentence-action\" style=\"{{^index}}vertical-align: middle{{/index}}\"><span class=\"edit-button {{#translation_popover_click_experiment_true}}warning{{/translation_popover_click_experiment_true}} btn\" id=\"edit-button-{{index}}\" disabled=\"disabled\" data-index=\"{{index}}\" data-toggle=\"popover\" data-margin=\"5\" data-placement=\"below\" data-popover=\"#edit-button-popover-{{index}}\"><span class=\"icon\"></span></span><span class=\"comment-button btn\" id=\"comment-button-{{index}}\" disabled=\"disabled\" data-index=\"{{index}}\" data-toggle=\"popover\" data-margin=\"5\" data-placement=\"below\" data-popover=\"#comment-button-popover-{{index}}\">{{num_comments}}<span class=\"icon\"></span></span><span class=\"check-button btn\" id=\"check-button-{{index}}\" disabled=\"disabled\" data-index=\"{{index}}\" data-toggle=\"popover\" data-margin=\"5\" data-placement=\"below\" data-popover=\"#check-button-popover-{{index}}\"><span class=\"icon\"></span></span></div><div class=\"popover below small\" id=\"edit-button-popover-{{index}}\"><div class=\"inner\"><div class=\"content\">{{#_i}}Edit translation{{/_i}}</div></div><div class=\"arrow\"></div></div><div class=\"popover below small\" id=\"check-button-popover-{{index}}\"><div class=\"inner\"><div class=\"content check-button-tool-tip\"></div></div><div class=\"arrow\"></div></div>{{/cur_translation}}{{^cur_translation}}<div class=\"sentence-action\" style=\"{{^index}}vertical-align: middle{{/index}}\"><span class=\"edit-button btn warning \" id=\"edit-button-{{index}}\" data-index=\"{{index}}\" data-toggle=\"popover\" data-margin=\"5\" data-placement=\"below\" data-popover=\"#edit-button-popover-{{index}}\" disabled=\"disabled\"><span class=\"icon\"></span></span><span class=\"comment-button btn\" id=\"comment-button-{{index}}\" disabled=\"disabled\" data-index=\"{{index}}\" data-toggle=\"popover\" data-margin=\"5\" data-placement=\"below\" data-popover=\"#comment-button-popover-{{index}}\">{{num_comments}}<span class=\"icon\"></span></span></div><div class=\"popover below small\" id=\"edit-button-popover-{{index}}\"><div class=\"inner\"><div class=\"content\">{{#_i}}Click to translate{{/_i}}</div></div><div class=\"arrow\"></div></div>{{/cur_translation}} &nbsp; {{/can_be_edited}}","wiki-document-sentence-popover":"{{#can_be_edited}}<div class=\"inner {{^cur_translation}}no-translation{{/cur_translation}}\"><div class=\"content\"><div class=\"wiki-action popover-header hidden\">{{#cur_translation}}<span class=\"last-edit\">{{#_i}}Last edited by{{/_i}} <a href=\"http://duolingo.com/#/{{username}}\" target=\"_blank\">{{username}}</a></span><a href=\"javascript:;\" class=\"show-revisions left\">{{#_i}}Show revisions{{/_i}}</a>{{/cur_translation}}<a href=\"javascript:;\" class=\"save-edit btn success right\" disabled=\"disabled\">{{#cur_translation}}{{#_i}}Save{{/_i}}{{/cur_translation}}{{^cur_translation}}{{#_i}}Submit translation{{/_i}}{{/cur_translation}}</a><a href=\"javascript:;\" class=\"cancel-edit btn right\">{{#_i}}Cancel{{/_i}}</a></div>{{^cur_translation}}<div class=\"cur-translation no-translation-message\"><span class=\"triangle\"></span>{{#_i}}Sentence not yet translated. Get points for translating it!{{/_i}}</div>{{/cur_translation}}{{#cur_translation}}<div class=\"cur-translation\"><div class=\"popover-header\"><div class=\"popover-header-text\"><div class=\"small-circular-avatar\"><img src=\"http://duolingo.com/avatars/{{user_id}}/small\"></div>{{#_i}}Translation last edited by {{username}}{{/_i}}</div></div><div class=\"popover-body\">{{#cur_translation_tokens}}<span id=\"sentence-{{index}}-token-{{token_index}}\" class=\"token\">{{token}}</span>{{/cur_translation_tokens}}</div></div>{{/cur_translation}}<div class=\"form-row no-margin wiki-textarea-container\"><label for=\"edit-text-input-{{index}}\">{{#_i}}Enter translation here{{/_i}}</label><textarea id=\"edit-text-input-{{index}}\" name=\"edit-text-input\" class=\"wiki-textarea edit-text-input\">{{^user_input}}{{cur_translation}}{{/user_input}}{{#user_input}}{{user_input}}{{/user_input}}</textarea><div class=\"error-flag\" id=\"invalid-translation-error\" style=\"display: hidden;\">{{#_i}}Translation does not seem correct{{/_i}}.</div></div></div></div>{{/can_be_edited}}{{^can_be_edited}}<div class=\"inner\"><div class=\"content\"><div class=\"cur-translation\"><div class=\"popover-body\">{{#cur_translation_tokens}}<span id=\"sentence-{{index}}-token-{{token_index}}\" class=\"token\">{{token}}</span>{{/cur_translation_tokens}}</div></div></div></div>{{/can_be_edited}}","wiki-document-title-popover":"<div class=\"inner\"><div class=\"content\"><div class=\"cur-translation\"><div class=\"popover-body\">{{cur_translation}}</div></div></div></div> ","wiki-sentence-revision":"{{#show_diff_with_earlier}}{{#diff_with_earlier}}{{#equal}}{{new_text}}{{/equal}}{{^equal}}<span style=\"background-color:yellow\">{{new_text}}</span>{{/equal}}{{/diff_with_earlier}}{{/show_diff_with_earlier}}{{#show_diff_with_later}}{{#diff_with_later}}{{#equal}}{{old_text}}{{/equal}}{{^equal}}<span style=\"background-color:yellow\">{{old_text}}</span>{{/equal}}{{/diff_with_later}}{{/show_diff_with_later}}{{#no_diff}}{{text}}{{/no_diff}} ","wiki-sentence-revisions":"<div class=\"modal-body\"><div class=\"wiki-sentence-revisions\"><div class=\"head\"><div class=\"btn right\" id=\"follow-revisions\">{{#_i}}Follow revisions{{/_i}}</div><div class=\"btn right is-friend success\" id=\"following-revisions\" style=\"display:none\">{{#_i}}Following revisions{{/_i}}</div></div><h2>{{#_i}}Revision history{{/_i}}</h2><div class=\"translation-source\" style=\"padding: 0;\">{{original_text}}</div><ul class=\"versions\">{{#revisions}}<li class=\"revision-item\" data-index=\"{{index}}\"><label><a href=\"http://duolingo.com/#/{{username}}\"><span class=\"medium-circular-avatar \"><img src=\"http://duolingo.com/avatars/{{user_id}}/medium\"/></span></a><div class=\"date-user\"><strong><a href=\"http://duolingo.com/#/{{username}}\">{{username}}</a></strong><br/>{{date}}</div><div class=\"sentence\" id=\"revision-{{index}}\"></div><div class=\"radio\"><input id=\"radio\" type=\"radio\" name=\"revision\" value=\"{{text}}\" data-first=\"{{#first}}true{{/first}}\" {{#first}}checked{{/first}}></div></label></li>{{/revisions}}</ul></div></div><div class=\"modal-footer\"><a href=\"javascript:;\" class=\"revert btn right\" style=\"margin: 0 0 0 10px;\" disabled=\"disabled\">{{#_i}}Revert to selected translation{{/_i}}</a><a href=\"javascript:;\" class=\"cancel btn right\">{{#_i}}Cancel{{/_i}}</a></div><div class=\"close cancel\"></div> ","wiki-translation":"<div class=\"wiki-header\"><div class=\"top\"><div class=\"coin-medium animated\" id=\"coin-count\">0</div><div class=\"bonus right\" id=\"wiki-progress-bar\"></div><div class=\"message left\"><h5>{{#_i}}Read this article{{/_i}}</h5><p>{{#_i}}Collect points for editing and checking.{{/_i}}</p></div></div><div class=\"finish-owl\"><div id=\"finish-owl\" class=\"superduo-peeking-right hidden animated\"></div></div><div class=\"meta-bar\"><a href=\"/#/translated/{{id}}\">\u2192 {{#_i}}View current translation{{/_i}}</a>{{#user_uploaded_translation}}<a href=\"/translate_jobs/{{translate_job_id}}/export\" class=\"light\">{{#_i}}Download current translation{{/_i}}</a>{{/user_uploaded_translation}}{{#user_can_disable_translation}}{{^translation_disabled}}<a href=\"javascript:;\" id=\"disable-translation\" class=\"light\"><span class=\"trash-icon\"></span>{{#_i}}Remove article{{/_i}}</a>{{/translation_disabled}}{{#translation_disabled}}<a href=\"javascript:;\" id=\"enable-translation\" class=\"light\"><span class=\"trash-icon\"></span>{{#_i}}Re-enable article{{/_i}}</a>{{/translation_disabled}}{{/user_can_disable_translation}}{{#user_reported_inappropriate}}<span class=\"reported-message\">{{#_i}}You have reported this article.{{/_i}}</span>{{/user_reported_inappropriate}}{{^user_reported_inappropriate}}<a href=\"javascript:;\" id=\"report-inappropriate\" class=\"report-inappropriate\">{{#_i}}Report article{{/_i}}</a>{{/user_reported_inappropriate}}</div></div><span id=\"click-to-edit\" class=\"cursor-message warning\" style=\"display:none\"></span><div class=\"shift-down\">{{#document_paragraphs}}{{#sentences}}<div class=\"comments modal hidden\" id=\"comments-{{index}}\"></div><div class=\"revisions modal hidden\" id=\"revisions-{{index}}\"></div>{{/sentences}}{{/document_paragraphs}}{{#document_paragraphs}}{{#sentences}}<div id=\"popover-{{index}}\" class=\"popover new above wiki-translation-popover\" data-anchor=\"{{#index}}#paragraph-{{paragraph_index}}{{/index}}{{^index}}#sentence-0{{/index}}\" data-margin=\"5\"><div id=\"session-{{index}}\" class=\"animated\"></div><div class=\"arrow\" id=\"arrow-{{index}}\" style=\"left:80px\"></div></div>{{/sentences}}<div class=\"wiki-paragraph\" style=\"display:block\" id=\"paragraph-{{paragraph_index}}\">{{#sentences}}{{#second}}<span class=\"rounded-image-wrapper\">{{#has_images}}<a class=\"fbox fancybox.image\" rel=\"group\" href=\"{{first_image_url}}\" style=\"display: inline; height: 100%;\"><img src=\"{{first_image_url}}\" class=\"image-thumb\"></a>{{#hidden_images}}<a class=\"fbox fancybox.image\" rel=\"group\" href=\"{{.}}\" style=\"display: none;\"></a>{{/hidden_images}}{{/has_images}}{{^has_images}}<img src=\"/images/owl-waving-gray.png\" class=\"image-thumb\"/>{{/has_images}}</span>{{/second}}{{^index}}<div class=\"document-header\" style=\"{{#user_uploaded_translation}}margin-top: 170px;{{/user_uploaded_translation}}\"><h1 class=\"wiki-document-title\"><span class=\"sentence-wrapper\" data-index=\"{{index}}\" id=\"sentence-wrapper-{{index}}\"></span></h1><div class=\"meta\"><div class=\"vote-module-small\"><div class=\"vote-count\">{{document_vote_sum}}</div><button class=\"rate-option vote-up\" data-rating=\"1\">{{#_i}}vote up{{/_i}}</button><button class=\"rate-option vote-down\" data-rating=\"-1\">{{#_i}}vote down{{/_i}}</button></div><div class=\"source-website\">{{#document_url}}{{#_i}}from{{/_i}} <a href=\"{{document_url}}\" target=\"_blank\">{{display_url}}</a>{{/document_url}}{{#uploaded_by_username}}&nbsp;{{#_i}}uploaded by{{/_i}} <a href=\"/#/{{uploaded_by_username}}\">{{uploaded_by_username}}</a>{{/uploaded_by_username}}</div></div></div>{{/index}}{{#index}}<span class=\"sentence-wrapper\" data-index=\"{{index}}\" id=\"sentence-wrapper-{{index}}\"></span>{{/index}}{{/sentences}}</div>{{/document_paragraphs}}</div><div class=\"modal hidden report\" id=\"flag-translation-reason-modal\"><div class=\"modal-body\"><h2>{{#_i}}What is the issue?{{/_i}}</h2><ul><li><label><input name=\"flag-translation-reason\" type=\"radio\" value=\"CONTENT\" checked>{{#_i}}Violent, sexual, or other inappropriate content.{{/_i}}</label></li><li><label><input name=\"flag-translation-reason\" type=\"radio\" value=\"COPYRIGHT\">{{#_i}}Copyright violation{{/_i}}</label></li></ul><h5>{{#_i}}Provide additional details (optional):{{/_i}}</h5><textarea class=\"report-translation-details\" id=\"additional-details\"></textarea></div><div class=\"modal-footer\"><a href=\"javascript:;\" class=\"primary btn right\" style=\"margin: 0 0 0 10px;\" id=\"report-inappropriate-reason\">{{#_i}}Submit{{/_i}}</a><a href=\"javascript:;\" class=\"cancel btn right\" id=\"cancel-report-inappropriate\">{{#_i}}Cancel{{/_i}}</a></div></div><div><button id=\"load-more-sentences\" class=\"btn\" style=\"margin-top: 20px\">{{#_i}}load more{{/_i}}</button></div><div class=\"related-articles\"><div class=\"inner\"><h2>{{#_i}}Discover more great articles on Duolingo{{/_i}}</h2><ul class=\"list\">{{#recommended_articles}}<li><a href=\"{{translation_url}}\" class=\"article\"><span class=\"rounded-image-wrapper small\"><span class=\"image-frame\" style=\"background-image: url('{{#image_url}}{{image_url}}{{/image_url}}{{^image_url}}/images/owl-waving-gray.png{{/image_url}}')\"></span></span><h5>{{title}}</h5><h5 class=\"original\">{{title_translation}}{{^title_translation}}[{{#_i}}title not yet translated{{/_i}}]{{/title_translation}}</h5></a><a class=\"category-badge\" href=\"/#/translations/{{category}}\">{{#_ivar}}category_label{{/_ivar}}</a></li>{{/recommended_articles}}</ul></div></div> ","wiki-translation-progress":"<h5>{{#done}}<div id=\"message-done\" class=\"done animated\">{{#_i}}You finished. Well done!{{/_i}}</div>{{/done}}{{^done}}<div id=\"message-not-done\" class=\"not-done animated\">{{#_i}}Finish to get bonus points{{/_i}}</div>{{/done}}</h5><!-- Less than 15 sentences <ul class=\"progress-small coin-end\"><li class=\"done\"></li><li class=\"done\"></li><li class=\"done\"></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li class=\"coin-goal\"> +10 </li><div class=\"coin-medium-small\">10</div></ul> --><ul class=\"progress-small coin-end flexible\"><li class=\"first\"><div class=\"done\" style=\"width: 0;\"></div></li><li class=\"coin-goal {{#done}}hidden{{/done}}\" id=\"coin-goal-unmet\"><span>+{{num_bonus_points}}</span></li><div class=\"coin-medium-small animated {{^done}}hidden{{/done}}\" id=\"coin-goal-met\">{{num_bonus_points}}</div></ul> ","word-lookup":"<span class=\"search-icon\"></span><label for=\"lookup-word-{{id}}\">{{#_i}}Translate English word{{/_i}}</label><input type=\"text\" id=\"lookup-word-{{id}}\" class=\"left\"/><button class=\"translate-lookup btn left\" style=\"margin: 0 0 0 5px; display: none\">{{#_i}}Translate{{/_i}}</button><div class=\"lookup-hints translation-source\"></div>","word-strength":"{{#strength}}<ul class=\"word-strength small\"><li class=\"filled {{#blink_0}}animated flash{{/blink_0}}\"></li><li class=\"{{#strength_s}}filled{{/strength_s}} {{#blink_s}}animated flash{{/blink_s}}\"></li><li class=\"{{#strength_m}}filled{{/strength_m}} {{#blink_m}}animated flash{{/blink_m}}\"></li><li class=\"{{#strength_l}}filled{{/strength_l}} {{#blink_l}}animated flash{{/blink_l}}\"></li></ul>{{/strength}} ","zendesk":"<script type=\"text/javascript\"> duo.zendesk_ids = {'en-es': 20147053, 'en-pt': 20155226, 'en-it': 20156447, 'en-de': 20156387, 'en-fr': 20145121, 'es-en': 20152956, 'pt-en': 20154387, 'it-en': 20142791, 'fr-en': 20175858, 'en-none': 20147203, 'pt-none': 20155198, 'it-none': 20155416, 'es-none': 20155406, 'fr-none': 20175838}; (function() { {{#logged_in}} var ui_language = duo.user.get('ui_language'); var learning_language = duo.user.get('learning_language'); {{/logged_in}}{{^logged_in}} var ui_language = '{{browser_language}}'; var learning_language = 'none'; {{/logged_in}} var id = duo.zendesk_ids[ui_language + '-' + learning_language]; if (zen_opt) Zenbox.update({'dropboxID': 20155416}); var zen_opt = { dropboxID: id, url: \"https://duolingotest.zendesk.com\", tabID: \"Feedback\", tabColor: \"black\", tabPosition: \"Left\", hide_tab: \"true\" {{#logged_in}}, requester_email: duo.user.get('email'), requester_name: duo.user.get('username') {{/logged_in}} }; $.getScript('//asset0.zendesk.com/external/zenbox/v2.5/zenbox.js', function() { _.defer(function() { Zenbox.init(zen_opt); }); }); })(); </script><div id=\"wrapped-support\"><div id=\"support-button\" onClick=\"Zenbox.show(); return false;\">{{#_i}}Support{{/_i}}</div></div>"};duo.SessionElement=Backbone.Model.extend({isOpener:function(){return this.get('type')==='translate'&&this.get('unknown');},getDisplayText:function(){if(this.has('text')){return this.get('text');}else if(this.has('sentence')){return this.get('sentence');}else{return this.get('hint');}}});duo.SessionElementList=Backbone.Collection.extend({model:duo.SessionElement});duo.SessionElementSolution=Backbone.Model.extend({url:function(){if(this.has('session_type')){if(this.has('session_element')&&this.get('session_element').has('type')){return'/session_element_solutions/'+this.get('session_type')+'/'+this.get('session_element').get('type');}
return'/session_element_solutions/'+this.get('session_type');}
return'/session_element_solutions';},parse:function(data){data.session_element=new duo.SessionElement(data.session_element);if('correct_solutions'in data){data.num_solutions=data.correct_solutions.length;}
return data;},isDone:function(){return!(this.get('session_element').get('type')=='speak')||(this.has('try_again')&&!this.get('try_again'));},getDisplayText:function(){if(this.has('value')){return this.get('value');}else if(this.has('sentence')){return this.get('sentence');}else if(this.has('word')){return(this.has('article')?this.get('article')+' ':'')+this.get('word')}else if(this.has('choices')){var chosen=_.filter(this.get('session_element').get('sentences'),function(sentence,i){return this.get('choices')[i]==='correct';},this);return JSON.stringify(_.pluck(chosen,'sentence'));}else{return this.get('session_element').getDisplayText();}}});duo.SessionElementSolutionList=Backbone.Collection.extend({model:duo.SessionElementSolution});duo.Grade=Backbone.Model.extend({});duo.Session=Backbone.Model.extend({transitions:{'empty,rendered':'render','rendered,ready':'input','ready,rendered':'clear','ready,submitted':'submit','submitted,ready':'retry','submitted,graded':'grade','graded,empty':'continue','graded,ended':'end','submitted,failed':'fail','ready,failed':'fail','rendered,failed':'fail'},url:function(){return'/sessions';},fetch:function(options){options=options||{};options.data=options.data||{};options.data.type=this.type;options.data.id=this.id;options.data.speak_capable=(navigator.userAgent.toLowerCase().indexOf('ipad')<0)&&(navigator.userAgent.toLowerCase().indexOf('iphone')<0);Backbone.Model.prototype.fetch.call(this,options);},initialize:function(){this.set({session_element_solutions:new duo.SessionElementSolutionList(),state:'empty',position:-1,failed:false});this.bind('change:state',this.fireStateEvents,this);this.bind('error',this.defaultErrorHandler);},parse:function(data){console.log('new data in session');data.session_elements=new duo.SessionElementList(data.session_elements);return data;},toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);json_data['session_elements']=undefined;json_data['session_element_solutions']=this.get('session_element_solutions').map(function(ses){var ses_json=ses.toJSON();ses_json.session_element=undefined;return ses_json;});json_data['language_information']=undefined;json_data['choose_language']=!!json_data['available_languages'];return json_data;},defaultErrorHandler:function(model,error){window.location='/';},fireStateEvents:function(model,state){var previous_state=model.previous('state');model.trigger(this.transitions[previous_state+','+state]);},incrementPosition:function(){this.set({position:this.get('position')+1});},currentElement:function(){return this.get('session_elements').at(this.get('position'));},previousElement:function(){return this.get('session_elements').at(this.get('position')-1);},initializeHearts:function(num_hearts){var hearts=[];for(var i=0;i<num_hearts;i++){var heart_data=null;if(duo.user.get('ab_options').hover_heart_experiment){heart_data=_.map([1,3,2,4],function(j){return{quarter:j,used:false,value:i+j/4,index:4*i+j-1}});}else{heart_data=_.map(_.range(1,3),function(j){return{odd:j%2,used:false,value:i+j/2,index:2*i+j-1}});}
hearts.push({parts:heart_data});}
this.set({'num_hearts':num_hearts,'hearts':hearts,'max_hearts':num_hearts});},removeHeart:function(lost){if(lost===undefined){lost=1;}
var hearts_left=this.get('num_hearts')-lost;var hearts=this.get('hearts');_.each(hearts,function(heart){_.each(heart.parts,function(part){part.used=(part.value>hearts_left);});});this.set({'num_hearts':hearts_left});return hearts_left;},addSolution:function(ses){ses.set({learning_language:this.get('language'),session_type:this.get('type'),skill_id:this.get('skill_id'),lesson_number:this.get('lesson_number'),from_language:this.get('ui_language')});ses.get('session_element').set({activity_uuid:this.get('activity_uuid')});this.get('session_element_solutions').add(ses);},isTest:function(){return false;}});duo.SentenceTranslationSession=duo.Session.extend({type:'sentence_translation',toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);return json_data;},editSolution:function(text){ var se=this.get('session_elements').at(0);var solution=new duo.SessionElementSolution({session_element:se,value:text});this.addSolution(solution);solution.save();},makeRate:function(in_step){var progresses_skill=this.get('from_skill')&&this.get('recommended');var rate_session=new duo.RateSession({activity_uuid:this.get('activity_uuid'),in_step:in_step,progresses_skill:progresses_skill,has_next:!progresses_skill&&this.get('has_next'),sentence_index:this.get('index'),go_to_complete:!this.get('failed'),go_to_next:this.get('failed'),document_sentence_id:this.get('docment_sentence_id')});return rate_session;},getRate:function(n){var self=this;$.post('/contribute/'+this.get('translation_id')+'/'+this.get('sentence_id')+'/view_rate',{n:n,activity_uuid:this.get('activity_uuid'),skill_distribution:JSON.stringify(this.get('skill_distribution')),document_sentence_id:this.get('document_sentence_id')},function(data){if(!self.get('user_translated')){self.set({user_viewed:true});}
self.get('rate_session').set(duo.Session.prototype.parse.call(this,data))});}});duo.WordsPracticeSession=duo.Session.extend({type:'words_practice'});duo.SkillPracticeSession=duo.Session.extend({type:'skill_practice'});duo.RateSession=duo.Session.extend({type:'rate',toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);return json_data;},getAllCandidates:function(callback,context,n){var self=this;$.get('/contribute/all_candidates/'+this.get('translation_id')+'/'+this.get('sentence_id'),{n:n,shown_translations:JSON.stringify(this.get('session_elements').pluck('solution_key')),activity_uuid:this.get('activity_uuid'),document_sentence_id:this.get('document_sentence_id')},function(data){self.get('session_elements').add(data);callback.call(context);});}});duo.GlobalPracticeSession=duo.Session.extend({type:'global_practice',fetch:function(options){if(this.has('language')){options=options||{};options.data=options.data||{};options.data.language=this.get('language');}
duo.Session.prototype.fetch.call(this,options);}});duo.DebugSession=duo.Session.extend({type:'debug'});duo.WelcomeSession=duo.Session.extend({type:'welcome',parse:function(data){data=duo.Session.prototype.parse.call(this,data);var hints_dict=data.special_hints;var special_hints={Duo:{value:'Duo',hint_table:{rows:[{cells:[{colspan:1,hint:'Duo'}]}]}}};for(var word in hints_dict){special_hints[word]={value:word,hint_table:{rows:[{cells:[{colspan:1,hint:hints_dict[word]}]}]}};}
data.special_hints=special_hints;return data;}});duo.TestSession=duo.Session.extend({type:'test',isTest:function(){return true;}});duo.BigTestSession=duo.TestSession.extend({type:'big_test'});duo.LessonSession=duo.Session.extend({type:'lesson',fetch:function(options){options=options||{};options.data=options.data||{};options.data.type=this.type;options.data.skill_id=this.get('skill_id');options.data.lesson_number=this.get('lesson_number');options.data.speak_capable=(navigator.userAgent.toLowerCase().indexOf('ipad')<0)&&(navigator.userAgent.toLowerCase().indexOf('iphone')<0);Backbone.Model.prototype.fetch.call(this,options);}});duo.DocumentSentenceList=Backbone.Collection.extend({model:duo.SentenceTranslationSession,parse:function(data){return _.map(data,function(sentence){return duo.SentenceTranslationSession.prototype.parse(sentence);});}});duo.Router=Backbone.Router.extend({switchView:function(view,view_class,body_class,meta_description){$('#app').replaceWith(view.render().el);$('#app').removeClass(duo.view);if(duo.body_class){$('body').removeClass(duo.body_class);}
if(view_class){$('#app').addClass(view_class);}
if(body_class){$('body').addClass(body_class);}
if(meta_description){$('#meta-description').attr("content",meta_description);}
duo.view=view_class;duo.body_class=body_class;$(document).scrollTop(0);$('.logged-out-message').empty();$('#topbar-menu').show();}});duo.Event=Backbone.Model.extend({urlRoot:'/events',parse:function(data){if('comment_data'in data){data['comments']=new duo.EventCommentList(duo.EventCommentList.prototype.parse.call(this,data.comment_data));data['comments'].event_id=this.id||data.id;}
return data;},deletePost:function(){var self=this;$.post('/events/'+this.id+'/delete',{user_id:this.get('for_user').id},function(data){self.set(duo.Event.prototype.parse.call(self,data));});},like:function(){var self=this;$.post('/events/'+this.id+'/like',function(data){self.set(duo.Event.prototype.parse.call(self,data));});}},{getView:function(type){var view_name=type.replace('_',' ');view_name=view_name.toTitleCase();view_name=view_name.replace(' ','');return duo[view_name+'EventView'];}});duo.LevelEvent=duo.Event.extend({});duo.FollowEvent=duo.Event.extend({});duo.PracticeEvent=duo.Event.extend({});duo.LessonEvent=duo.Event.extend({});duo.TranslationEvent=duo.Event.extend({});duo.UnlockEvent=duo.Event.extend({});duo.WelcomeEvent=duo.Event.extend({});duo.CollapsedEvent=duo.Event.extend({});duo.StreamPost=duo.Event.extend({url:'/post'});duo.DeleteEvent=duo.Event.extend({});duo.EventList=Backbone.Collection.extend({model:duo.Event,url:function(){ if(this.user_id===undefined){throw new Error(JSON.stringify({user_id:this.user_id,before:this.before}));}
return'/stream/'+this.user_id;},fetch:function(options){options=options||{};options.data=options.data||{};options.data.before=this.before;options.data.p_view=this.p_view;Backbone.Collection.prototype.fetch.call(this,options);},parse:function(data){var events=data;if(data.before){this.before=data.before;this.more_events=data.more_events;events=data.events;}
return _.map(events,function(event){return duo.Event.prototype.parse.call(this,event);});}});duo.EventView=Backbone.View.extend({tagName:'li',template:duo.templates['event'],events:{'click .show-comments':'showComments','click .upvotes .vote':'like','click .event-context':'showContext','click .unfollow-channel':'unfollowChannel','click .delete-stream-post':'deleteStreamPost'},initialize:function(options){this.show_time=options.show_time;this.model.bind('change',this.reRender,this);},render:function(){var total_improvement=0;if(this.model.has('skills')){total_improvement=_.reduce(this.model.get('skills'),function(memo,skill){return memo+skill.improvement;},0);}
$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.getRenderData(),{total_improvement:total_improvement}),duo.templates));this.renderComments();return this;},getRenderData:function(){var has_comments=this.model.has('comments')&&this.model.get('comments').length>0;return{show_time:this.show_time,has_comments:has_comments,merged:this.model.get('count')>1};},reRender:function(){var comments_shown=this.$('.show-comments').size()===0;var comments_footer=this.$('.post-footer:visible').size()>0;this.render();if(comments_shown){this.$('.stream-comments').show();this.$('.show-comments').remove();if(comments_footer){this.$('.stream-comments .post').focus().blur();}}},renderComments:function(){if(this.model.has('comments')){var comments_view=new duo.EventCommentsView({model:this.model,el:this.$('.stream-comments')});comments_view.render();}},showComments:function(){this.$('.stream-comments').show();this.$('.show-comments').remove();this.$('.stream-comments .post').focus();},like:function(){mixpanel.track('like event');this.model.like();},showContext:function(){this.$('.event-context').addClass('active');this.$('.even-context-menu').show();var self=this;$(document).one('click.event',function(){self.$('.even-context-menu').hide();});return false;},unfollowChannel:function(){var channel_source=null;if(this.model.get('channel')==='friends'){channel_source=new duo.User({id:this.model.get('channel_source')});channel_source.unfollow();}else if(this.model.get('channel')==='topics'){channel_source=new duo.Topic({id:this.model.get('channel_source')});channel_source.unfollow(function(){duo.user.trigger('change');});}},deleteStreamPost:function(){this.model.deletePost();}});duo.SkillEventView=duo.EventView.extend({render:function(){duo.EventView.prototype.render.call(this);this.renderSkills();return this;},renderSkills:function(){var self=this;_.each(this.model.get('skills'),function(skill){var skill_view=null;if('improvement'in skill){if(skill.skill){skill_view=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(self,skill.skill)),improvement:skill.improvement,size:'small',current_user:duo.user?self.model.get('user').id==duo.user.id:null,disable_hover:duo.user!=null});}
skill=skill.skill;}else{skill_view=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(self,skill)),size:'small',current_user:duo.user?self.model.get('user').id==duo.user.id:null,disable_hover:duo.user!=null});}
if(skill_view){self.$('#event-skills-'+skill.id).append(skill_view.render().el);}});}});duo.LevelEventView=duo.EventView.extend({template:duo.templates['level-event']});duo.FollowEventView=duo.EventView.extend({template:duo.templates['follow-event']});duo.PassEventView=duo.EventView.extend({template:duo.templates['pass-event']});duo.RateEventView=duo.EventView.extend({template:duo.templates['rate-event'],render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.getRenderData(),{others:this.model.get('users').length-1,count:this.model.get('users').length,disable_upvotes:true}),duo.templates));this.renderComments();return this;}});duo.CommentEventView=duo.EventView.extend({template:duo.templates['comment-event']});duo.DeleteEventView=duo.EventView.extend({template:duo.templates['delete-event']});duo.MasterEventView=duo.SkillEventView.extend({template:duo.templates['master-event']});duo.PracticeEventView=duo.EventView.extend({template:duo.templates['practice-event'],render:function(){var total_improvement=0;var refresh=this.model.has('skills')&&this.model.get('skills').length>0;if(refresh){total_improvement=_.reduce(this.model.get('skills'),function(memo,skill){return memo+skill.improvement;},0);}else{total_improvement=10;}
$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.getRenderData(),{refresh:refresh,total_improvement:total_improvement}),duo.templates));return this;}});duo.WelcomeEventView=duo.EventView.extend({template:duo.templates['welcome-event']});duo.LessonEventView=duo.EventView.extend({template:duo.templates['lesson-event'],getRenderData:function(){var data=duo.EventView.prototype.getRenderData.call(this);data.just_one=this.model.get('count')===1;return data;}});duo.TranslationEventView=duo.EventView.extend({template:duo.templates['translation-event'],render:function(){var total_improvement=0;if(this.model.has('skills')){total_improvement=_.reduce(this.model.get('skills'),function(memo,skill){return memo+skill.improvement;},0);}
$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.getRenderData(),{total_improvement:total_improvement,disable_upvotes:true}),duo.templates));this.renderComments();return this;}});duo.TestEventView=duo.SkillEventView.extend({template:duo.templates['test-event'],render:function(){var num_skills=this.model.has('skills')?this.model.get('skills').length:0;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.getRenderData(),{any_unlocked:this.model.has('unlocked')&&this.model.get('unlocked').length>0,unlocked_string:_.pluck(this.model.get('unlocked'),'title').join(', '),num_skills:num_skills,shortcut:num_skills>1}),duo.templates));this.renderSkills();this.renderComments();return this;}});duo.UnlockEventView=duo.SkillEventView.extend({template:duo.templates['unlock-event'],render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.getRenderData(),{any_unlocked:this.model.get('unlocked').length>0,unlocked_string:_.pluck(this.model.get('unlocked'),'title').join(', ')}),duo.templates));this.renderSkills();this.renderComments();return this;}});duo.StreamPostEventView=duo.EventView.extend({template:duo.templates['stream-post'],render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.getRenderData(),{processed_text:this.replaceURLs(this.model.get('text')),deletable:duo.user?(this.model.get('for_user').id==duo.user.id)||(this.model.get('user').id==duo.user.id):false}),duo.templates));this.renderComments();return this;},replaceURLs:function(text){var url_regex=/\b(?:(?:https?|ftp):\/\/|www\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gi;return text.replace(url_regex,function(url){return'<a href="'+url+'" class="underline grayDark" target="_blank">'+url+'</a>';});}});duo.CollapsedEventView=duo.EventView.extend({template:duo.templates['collapsed-event'],initialize:function(){this.collapsed=_.map(this.model.attributes,function(json){return new duo.Event(json);});},render:function(){$(this.el).html($.duostache(this.template,{events:this.collapsed},duo.templates));var self=this;_.each(this.collapsed,function(event){var view_name=event.get('type').replace('_',' ').toTitleCase().replace(' ','');var event_view=new duo[view_name+'EventView']({model:event});self.$('#collapsed-event-'+event.id).replaceWith(event_view.render().el);});return this;}});duo.StandaloneEventView=Backbone.View.extend({id:'app',template:duo.templates['standalone-event'],initialize:function(){var view_class=duo.Event.getView(this.model.get('type'));this.event_view=new view_class({model:this.model});},render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));this.$('.activity-stream').append(this.event_view.render().el);return this;}});duo.EventsView=Backbone.View.extend({template:duo.templates['events'],events:{'click #more-stream':'moreStream'},initialize:function(options){this.collection=options.collection;this.collection.bind('add',this.addOne,this);this.collection.bind('remove',this.render,this);this.collection.bind('change:deleted',this.eventDeleted,this);_.bindAll(this,'render','moreStream');this.last_request_length=0;},render:function(){$(this.el).html($.duostache(this.template,{more_events:this.collection.more_events,error:this.collection.error},duo.templates));this.addAll();var self=this;$(document).unbind('.stream_scroll').bind('scroll.stream_scroll.infinite_scroll',function(e){var total_height=$(document).height();var view_height=total_height-$(document).scrollTop();var visible_height=$(window).height();if(view_height<1.5*visible_height&&self.collection.length>self.last_request_length){self.$('#more-stream').hide();self.last_request_length=self.collection.length;self.moreStream();}});return this;},addAll:function(){this.collection.each(this.addOne,this);},addOne:function(event,collection,options){var view=null;if(event.has('type')){var show_time=this.last_datetime===undefined||event.get('datetime_string')!==this.last_datetime;var view_name=duo.Event.getView(event.get('type'));view=new view_name({model:event,show_time:show_time});this.last_datetime=event.get('datetime_string');}else{view=new duo.CollapsedEventView({model:event});}
if(options.at===0){this.$('.activity-stream').prepend(view.render().el);}else{this.$('.activity-stream').append(view.render().el);}},eventDeleted:function(model){this.collection.remove(model);},moreStream:function(){this.collection.fetch({update:true,remove:false});},cleanUp:function(){$(document).unbind('.stream_scroll');}});duo.EventCommentsView=Backbone.View.extend({template:duo.templates['event-comments'],events:{'click .post-event-comment':'postComment','click .post':'onCommentBox','focus .post':'onCommentBox'},initialize:function(){this.collection=this.model.get('comments');this.collection.bind('all',this.render,this);},render:function(){$(this.el).html($.duostache(this.template,{comments:this.collection.toJSON(),has_comments:this.collection.length>0,id:this.model.id},duo.templates));if(duo.user){this.$('.post').vkeyboard({language:duo.user.get('learning_language'),placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:false,caps:false});this.$('.search-box').wordLookup({templates:duo.templates,source_language:duo.user.get('ui_language'),target_language:duo.user.get('learning_language'),id:this.model.id,callback:this.lookedupWord,callback_context:this});}
var self=this;_.defer(function(){self.$('label').inFieldLabels();self.$('textarea').autosize();});},postComment:function(){var message=$.trim(this.$('.post').val());if(message.length>0){this.collection.create({message:message});mixpanel.track('post_activity_comment',{event_type:this.model.get('event_type')});}},onCommentBox:function(){this.$('.post-footer').show();this.$('.post').addClass('focus');},lookedupWord:function(){mixpanel.track('post_hints_lookup');}});function translate_text(text){if(duo.ui_translations){text=text.replace(/{{/g,'<%').replace(/}}/g,'%>');if(text in duo.ui_translations){var val=duo.ui_translations[text];return val==null?'':val.replace(/<%/g,'{{').replace(/%>/g,'}}');}else{console.debug("NO TRANSLATION FOR",text);return text;}}else{return text;}}
(function($){function pluralize(singular,plural,n){if(n==0||n>1)
return plural;else
return singular;} 
function mpluralize(text,render){var args=render(text).split(',');return pluralize.apply(this,args);} 
function mgenderize(text,render){var table={'m':'masculine','f':'feminine','nt':'neuter','pl':'plural'};return table[render(text)];}
function mnumberize(text,render){var table={'sg':'singular','pl':'plural'};return table[render(text)];} 
function mcaserize(text,render){var cases=render(text);var cases_array=cases.split(',');if(cases_array.length>1){return"this";}else{var table={'nom':'nominative','acc':'accusative','dat':'dative','gen':'genitive'};return table[cases_array[0]];}} 
function mrank(text,render){var n=parseInt(render(text));var mod_100=n%100;if(mod_100<20&&mod_100>10){return n+'th';}
switch(n%10){case 1:return n+'st';case 2:return n+'nd';case 3:return n+'rd';default:return n+'th';}}
function mindex(text,render){var n=parseInt(render(text));return n+1;}
function mdayweek(text,render){var short_days=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];var day=parseInt(render(text));return translate_text(short_days[day]);}
function mshortlist(text,render){var list=render(text).split(',').slice(0,-1);if(list.length===0){return'';}
var data={one:list[0],two:list[1],more_two:list.length>2,three:list.length>3?null:list[2],more:list.length<=3?null:list.length-2}
return $.duostache(duo.templates.short_list,data);}
function padNumber(n){if(n<10){return'0'+n;}
return n;}
function mformattime(text,render){var n=parseInt(render(text));var minutes=padNumber(parseInt(Math.floor(n/60)));var seconds=padNumber(parseInt(n)%60);return minutes+':'+seconds;}
var short_months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];function prettyDate(time){var date=new Date((time||"")),diff=(((new Date()).getTime()-date.getTime())/1000),day_diff=Math.floor(diff/86400);if(isNaN(day_diff)||day_diff<0){date=new Date((time||"").replace(/-/g,"/").replace(/[TZ]/g," "));diff=(((new Date()).getTime()-date.getTime())/1000);day_diff=Math.floor(diff/86400);}
if(isNaN(day_diff)||day_diff<0)
return{date:true,month:short_months[date.getMonth()],day:date.getDate(),year:date.getFullYear()};return day_diff==0&&(diff<60&&{just:true}||diff<120&&{minute:true}||diff<3600&&{minutes:true,n:Math.floor(diff/60)}||diff<7200&&{hour:true}||diff<86400&&{hours:true,n:Math.floor(diff/3600)})||day_diff==1&&{yesterday:true}||day_diff<7&&{days:true,n:day_diff}||day_diff<31&&{weeks:true,n:Math.floor(day_diff/7)}||day_diff<365&&{months:true,n:Math.floor(day_diff/30)}||{years:true,n:Math.floor(day_diff/365)};}
function mprettydate(text,render){var date_str=render(text);var data=prettyDate(date_str);return $.duostache(duo.templates.pretty_date,data);}
var vowels={a:true,e:true,i:true,o:true,u:true};function mdeterminer(text,render){var word=render(text);if(word.toLowerCase().charAt(0)in vowels){return'an';}
return'a';}
function translate(text,render){return render(translate_text(text));}
function translate_variable(text,render){var val=render('{{'+text+'}}');return render(translate_text(val));}
function translate_variable_unescaped(text,render){var val=render('{{{'+text+'}}}');return render(translate_text(val));}
var _default_view={pluralize:function(){return mpluralize;},ranked_number:function(){return mrank;},_i:function(){return translate;},_ivar:function(){return translate_variable;},_ivaru:function(){return translate_variable_unescaped;},genderize:function(){return mgenderize;},caserize:function(){return mcaserize;},numberize:function(){return mnumberize;},from_index:function(){return mindex;},day_of_week:function(){return mdayweek;},short_list:function(){return mshortlist;},format_seconds:function(){return mformattime;},pretty_date:function(){return mprettydate;},determiner:function(){return mdeterminer;}};var _default_partials={};$.duostache=function(template,view,partials){var user_options={};if(duo.user){user_options=duo.user.toJSON().ab;user_options.logged_in=true;user_options['ui_language_'+duo.user.get('ui_language')]=true;}else{_.each(duo.ab_options,function(value,exp){user_options[exp+'_'+value]=true;});user_options['ui_language_'+duo.browser_language]=true;}
var extended_view=$.extend({},_default_view,user_options,view);var extended_partials=$.extend({},_default_partials,partials);return $.mustache(template,extended_view,extended_partials);};})(jQuery);(function($){var _DICT_HOST='http://d.duolingo.com/';var _GENDERS={'m':'masculine','f':'feminine','nt':'neuter'}
var __hints__={};var __text_pos__=0;var __new_explanation__=false;__hints__.settings={url:_DICT_HOST+'words/hints',verb_table_url:_DICT_HOST+'words/verb_tables',source_language:'es',target_language:'en',callback:null,callback_context:null,show_hints:3,hover_options:{sensitivity:3,interval:120},templates:{'hints-sentence':'<span class="hints-sentence"></span>','hints-token':'<span class="token" id="token_{{index}}">{{value}}</span>','hints-link':'<a class="hints-link" href="{{value}}"></a>'},example:false,show_tokens:[],top:20,highlights:null,language_information:null,reverse:false,highlight_verb_endings:false,style_mapping:null,explanations:null,new_explanation_ids:[]};__hints__.verb_table_settings={url:_DICT_HOST+'words/verb_tables',source_language:'es',templates:{'hints-sentence':'<span class="hints-sentence"></span>','hints-token':'<span class="token" id="token_{{index}}">{{value}}</span>','hints-link':'<a class="hints-link" href="{{value}}"></a>'},language_information:null};__hints__.token_hints_settings={url:_DICT_HOST+'words/hints',source_language:'es',target_language:'en',templates:{'hints-sentence':'<span class="hints-sentence"></span>','hints-token':'<span class="token" id="token_{{index}}">{{value}}</span>','hints-link':'<a class="hints-link" href="{{value}}"></a>'},show_hints:3,language_information:null};__hints__.Token=Backbone.Model.extend({defaults:{'type':'text','index':null},toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);if($.trim(json_data.value).length===0)json_data.is_space=true;if(!$.support.leadingWhitespace)json_data.value=json_data.value.replace(' ','&nbsp; ');if('hint_table'in json_data&&!('headers'in json_data.hint_table)){for(var i=0;i<json_data.hint_table.rows.length;i++){var row=json_data.hint_table.rows[i];for(var j=0;j<row.cells.length;j++){var cell=row.cells[j];if('infinitives'in cell&&cell.infinitives.length>0){cell.has_infinitives=true;cell.infinitives_string=JSON.stringify(cell.infinitives);}}}}
return json_data;},getHints:function(){if(!this.has('hint_table')){return'';}
return this.get('hint_table').rows[0].cells[0].hint;}});__hints__.TokenList=Backbone.Collection.extend({model:__hints__.Token});__hints__.VerbTable=Backbone.Model.extend({defaults:{title:true},fetch:function(options){options=options||{};options.data=options.data||{};options.data.infinitives=JSON.stringify(this.get('infinitives'));options.data.verb_patterns=true;options.dataType='jsonp';Backbone.Model.prototype.fetch.call(this,options);},toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);if(!('language_information'in json_data)||!json_data.language_information){return json_data;}
var MAX_COLUMNS=3;json_data.infinitives_data={};for(var i=0;i<json_data.infinitives.length;i++){var infinitive=json_data.infinitives[i];var tables={};json_data.infinitives_data[infinitive]={infinitive:infinitive,tables:tables};for(var category in json_data.language_information.tenses){var tenses=json_data.language_information.tenses[category];json_data.infinitives_data[infinitive]['has_'+category]=true;tables[category]=[];for(var l=0;l<Math.ceil(tenses.length/MAX_COLUMNS);l++){tables[category].push({tenses:tenses.slice(l*MAX_COLUMNS,(l+1)*MAX_COLUMNS),table:[],more_tables:l<Math.ceil(tenses.length/MAX_COLUMNS)-1});}
var pronoun_mappings=json_data.language_information.pronoun_mapping;if(category=='others'){ pronoun_mappings=pronoun_mappings.slice(0,1);}
for(var j=0;j<pronoun_mappings.length;j++){var row=[];var pronoun_mapping=pronoun_mappings[j];for(var k=0;k<tenses.length;k++){var tense=tenses[k].tense;var verbs=json_data.data[infinitive][pronoun_mapping.tenses[tense]];if(!(pronoun_mapping.tenses[tense]in json_data.data[infinitive])){verbs=json_data.data[infinitive][pronoun_mapping.tenses[tense].split('_')[0]];} 
if(this.get('language')=='de'&&pronoun_mapping.tenses[tense]=='present_first_person_singular'){verbs=verbs.slice(0,1);}
var word=_.map(verbs,function(verb_info){return highlight_verb_patterns.apply(this,verb_info);}).join(', ');row.push({word:word});}
for(var l=0;l<Math.ceil(tenses.length/MAX_COLUMNS);l++){tables[category][l].table.push({pronoun:pronoun_mapping.pronoun,row:row.slice(l*MAX_COLUMNS,(l+1)*MAX_COLUMNS)});}}}}
return json_data;},parse:function(data){var processed_data={};for(var i=0;i<this.get('infinitives').length;i++){var infinitive=this.get('infinitives')[i];processed_data[infinitive]=data[i];}
return{data:processed_data};}});__hints__.SentenceView=Backbone.View.extend({tagName:'span',initialize:function(options){this.settings=options.settings;this.template=this.settings.templates['hints-sentence'];__text_pos__=0;__new_explanation__=false;$(this.el).html($.duostache(this.template));this.addAll();this.$('.verb-table-modal').modal({backdrop:true,show:false});if(options.render_callback!=undefined)
options.render_callback();},addAll:function(){this.collection.each(this.addOne,this);},addOne:function(token){var view_class=token.get('type').toTitleCase()+'TokenView'; if(this.settings.specials&&token.get('value')in this.settings.specials){token.set(this.settings.specials[token.get('value')]);}
if(this.settings.bold&&_.indexOf(this.settings.bold,token.get('value').toLowerCase())>=0){token.set({bold:true});}
var view=new __hints__[view_class]({model:token,settings:this.settings});this.$('.hints-sentence').append(view.render().el);}});__hints__.TextTokenView=Backbone.View.extend({tagName:'span',events:{'hover .more-hints':'moreHints','click .btn.conjugate':'showVerbTable','click .conjugate-small':'showReverseVerbTable','click .btn.explain':'showExplanation','click .btn.dismiss':'hideExplanation'},initialize:function(options){this.settings=options.settings;this.template=this.settings.templates['hints-token'];var hint_table=this.model.get('hint_table');if(hint_table&&hint_table.rows.length>this.settings.show_hints){var index=this.settings.show_hints;for(;index<hint_table.rows.length;index++){hint_table.rows[index]['hide']=true;}
hint_table['more_hints']=true;}
if(hint_table&&hint_table.rows.length>0){hint_table['max_colspan']=1;if('colspan'in hint_table.rows[0].cells[0]){hint_table['max_colspan']=hint_table.rows[0].cells[0]['colspan'];}}
if(this.settings.explanations!=null&&this.model.get('index')!=null){var explanation=this.settings.explanations[this.model.get('index')];if(explanation!=null){this.model.set('explanation',explanation);}}
this.ignore_mouse_leave=false;},bindHover:function(){var context=this;var handler_in_out=function(event){context.renderHints.apply(context,[event]);};var hover_settings={over:handler_in_out,out:handler_in_out,sensitivity:this.getSensitivity()};$.extend(hover_settings,this.settings.hover_options);this.$('.token-wrapper').hoverIntent(hover_settings);},render:function(){if(this.settings.highlights!=null){var value=this.model.get('value');for(var i=0;i<this.settings.highlights.length;i++){var highlight=this.settings.highlights[i];if(__text_pos__>=highlight[0]&&__text_pos__<highlight[1]){this.model.set({'highlighted':true});}}
__text_pos__+=value.length;}
if(this.settings.new_words!=null&&_.indexOf(this.settings.new_words,this.model.get('value').toLowerCase())>=0){this.model.set({'new_word':true});}
var style_mapping=this.settings.style_mapping||{};var verb_tables_enabled='language_information'in this.settings&&this.settings.language_information!=null;var infinitives=this.model.get('infinitives');var part_of_speech=this.model.get('PoS');var is_verb=part_of_speech==='VERB'&&infinitives!=null&&infinitives.length>0;var show_verb_table=verb_tables_enabled&&!this.settings.reverse&&is_verb;var show_reverse_verb_table=verb_tables_enabled&&this.settings.reverse;var style_classes=style_mapping[this.model.get('value').toLowerCase()];var modifiers=this.model.get('modifiers');var hint_table=this.model.get('hint_table');var show_gender=(modifiers!=null&&'gender'in modifiers&&modifiers['gender']in _GENDERS);show_gender=show_gender&&(('POS'in modifiers&&modifiers['POS']=='n')||part_of_speech==='NOUN');show_gender=show_gender&&(hint_table!=null&&hint_table.headers==null);var gender=show_gender?_GENDERS[modifiers['gender']]:null;if(duo.user.get('ab_options').optional_pronoun_hint_experiment&&duo.user.get('learning_language')=='en'&&this.settings['target_language']=='en'&&is_verb)
var prettify_hint=this.newPrettifyHint;else
var prettify_hint=this.prettifyHint;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{prettify_hint:function(){return prettify_hint;},show_verb_table:show_verb_table,show_reverse_verb_table:show_reverse_verb_table,render_verb_table_div:show_verb_table||show_reverse_verb_table,position:this.getPosition(),gender:gender,style_classes:style_classes}),this.settings.templates));this.bindHover();if(!__new_explanation__&&this.model.get('explanation')!=null){var explanation=this.model.get('explanation');if(_.indexOf(this.settings.new_explanation_ids,explanation.id)!=-1){__new_explanation__=true;_.defer(_.bind(this.renderNewExplanation,this));}}
var lowerCaseValue=this.model.get('value').toLowerCase();if(!__new_explanation__&&_.indexOf(this.settings.show_tokens,lowerCaseValue)!=-1){this.settings.show_tokens=_.without(this.settings.show_tokens,lowerCaseValue);_.defer(_.bind(this.renderNewWord,this));}
if(this.settings.highlight_verb_endings&&!this.settings.reverse&&this.model.has('verb_patterns')){var value=highlight_verb_patterns(this.model.get('value'),this.model.get('verb_patterns'));if(this.model.get('highlighted')){this.$('.token strong').html(value);}else{this.$('.token').html(value);}}
return this;},renderNewWord:function(){var hint_table=this.model.get('hint_table');if(!hint_table)return;if(this.settings.callback){var args=[this.model.get('value'),this.model.get('index'),this.el,undefined,true];var show_hints=this.settings.callback.apply(this.settings.callback_context,args);if(show_hints===false)return;}
var parent=$(this.el).parents('.hints-sentence');this.$('.token').toggleClass('highlighted');if(hint_table.references){for(var i=0;i<hint_table.references.length;i++){parent.find('#token_'+hint_table.references[i]).toggleClass('highlighted');}}
$(this.el).css('position','relative');this.$('.hint-table').toggle();this.centerHints();},renderNewExplanation:function(){this.$('.content').hide();this.$('.explanation').show();this.renderNewWord();},showExplanation:function(){this.ignore_mouse_leave=true;this.$('.content').hide();this.$('.explanation').show();this.centerHints();this.resetMoreHints();},hideExplanation:function(){this.ignore_mouse_leave=true;this.$('.explanation').hide();this.$('.content').show();this.$('.fadeInUp').removeClass('animated').removeClass('fadeInUp');this.centerHints();},renderHints:function(event){ var hint_table=this.model.get('hint_table');if(!hint_table)return; var ignore_mouse_leave=this.ignore_mouse_leave;this.ignore_mouse_leave=false; if(event.type==='mouseenter'){ if(this.$('.hint-table').is(":visible"))return; this.hideAllHints();this.toggleHintClasses(); this.$('.hint-table').show();this.centerHints();if(this.settings.callback){args=[this.model.get('value'),this.model.get('index'),this.el,this.model.getHints()];this.settings.callback.apply(this.settings.callback_context,args);}
}else if(event.type==='mouseleave'){if(ignore_mouse_leave)return; this.hideAllHints();this.$('.explanation').hide();this.$('.content').show();this.$('.fadeInUp').removeClass('animated').removeClass('fadeInUp');this.resetMoreHints();}},moreHints:function(event){this.$('tr.hidden').show();this.$('.more-hints').hide();this.centerHints();},resetMoreHints:function(){this.$('tr.hidden').hide();this.$('.more-hints').show();},getPosition:function(){ return'below';},getSensitivity:function(){ return 7;},centerHints:function(){var MIN_LEFT=-10;var parentWidth=this.$('.token').outerWidth();var parentLeft=this.$('.token').offset().left;var width=this.$('.hint-table').outerWidth();var left=parentWidth/2-width/2;if((parentLeft+left)<MIN_LEFT){var leftPerc=(parentLeft-MIN_LEFT+parentWidth/2)*100.0/width;this.$('.arrow').css({left:leftPerc+'%'});left=MIN_LEFT-parentLeft;}else{this.$('.arrow').css({left:'50%'});}
this.$('.hint-table').css({top:this.settings.top,left:left});},hideAllHints:function(){var parent=$(this.el).parents('.hints-sentence');if(parent==null||parent.length==0){parent=$(this.el).parents('#app');}
parent.find('.explanation').hide();parent.find('.content').show();parent.find('.fadeInUp').removeClass('animated').removeClass('fadeInUp');parent.find('.hint-table').hide();parent.find('.token').removeClass('highlighted');parent.find('.new').fadeOut(400);},toggleHintClasses:function(){var hint_table=this.model.get('hint_table');var parent=$(this.el).parents('.hints-sentence');this.$('.token').toggleClass('highlighted');if(hint_table.references){for(var i=0;i<hint_table.references.length;i++){parent.find('#token_'+hint_table.references[i]).toggleClass('highlighted');}}
$(this.el).css('position','relative');},newPrettifyHint:function(text,render){var hint=render(text); return hint.replace(/\((.+)-(.+)\)/g,"$1").replace(/\((.+?)\)/g,"$1");},prettifyHint:function(text,render){var hint=render(text);return hint.replace(/\((.+?)\)/g,"<i>($1)</i>");},showVerbTable:function(){if(!this.model.get('infinitives')){console.log(this.model.get('value'),'has no infinitives');return;}
var table=new __hints__.VerbTable({infinitives:this.model.get('infinitives'),language_information:this.settings.language_information,language:this.settings.source_language});table.url=this.settings.verb_table_url+'/'+this.settings.source_language;var modal=this.$('.verb-table-modal').clone().appendTo('body').modal({backdrop:true});var table_view=new __hints__.VerbTableView({settings:this.settings,model:table,el:modal.find('.modal-body')});modal.on('hidden',function(){modal.remove();});},showReverseVerbTable:function(e){var button=$(e.target);if(!button.data('infinitives')){console.log('hint in',this.model.get('value'),'has no infinitives');return;}
var table=new __hints__.VerbTable({infinitives:button.data('infinitives'),language_information:this.settings.language_information,language:this.settings.target_language});table.url=this.settings.verb_table_url+'/'+this.settings.target_language;var modal=this.$('.verb-table-modal').clone().appendTo('body').modal({backdrop:true});var table_view=new __hints__.VerbTableView({settings:this.settings,model:table,el:modal.find('.modal-body')});modal.on('hidden',function(){modal.remove();});}});__hints__.HintTableView=__hints__.TextTokenView.extend({events:{'hover .more-hints':'moreHints','mouseleave .hint-table':'lessHints','click .conjugate-container .btn':'showVerbTable','click .conjugate-small':'showReverseVerbTable'},initialize:function(option){__hints__.TextTokenView.prototype.initialize.call(this,option);this.template=this.settings.templates['hints-table'];this.anchor=option.anchor;},render:function(){__hints__.TextTokenView.prototype.render.call(this);this.centerHints();this.$('.hint-table').show();return this;},centerHints:function(){this.$('.hint-table').anchor({anchor:this.anchor,type:'below'});},moreHints:function(){__hints__.TextTokenView.prototype.moreHints.call(this);this.centerHints();},lessHints:function(){this.$('tr.hidden').hide();if(this.$('.hint-footer').find('.footer-container').size()>0){this.$('.more-hints').show();}else{this.$('.hint-footer').show();}
this.centerHints();}});__hints__.TextTokenSideView=__hints__.TextTokenView.extend({centerHints:function(){this.$('.hint-table').anchor({anchor:$(this.el),container:$(this.el),type:'left'}); $(this.el).css('position','');},toggleHintClasses:function(){},getPosition:function(){ return'left';},getSensitivity:function(){ return 7;}});__hints__.LinkTokenView=Backbone.View.extend({tagName:'span',initialize:function(options){this.settings=options.settings;this.template=this.settings.templates['hints-link'];$(this.el).html($.duostache(this.template,this.model.toJSON()));this.collection=new __hints__.TokenList();this.collection.reset(this.model.get('tokens'));this.addAll();},addAll:function(){this.collection.each(this.addOne,this);},addOne:function(token){token.set({'in_link':true,'url':this.model.get('value')});var view=new __hints__.TextTokenView({model:token,settings:this.settings});this.$('.hints-link').append(view.render().el);}});__hints__.VerbTableView=Backbone.View.extend({events:{'click .tabs li':'switchTables','click a[data-infinitive]':'switchInfinitive','click .more-tenses':'moreTenses'},initialize:function(options){this.settings=options.settings;this.template=this.settings.templates['hints-verb-table'];this.model.bind('sync',this.render,this);this.model.fetch();},render:function(){var self=this;var model_json=this.model.toJSON();if(this.current_infinitive===undefined){this.current_infinitive=this.model.get('infinitives')[0];}
var infinitive_index=_.indexOf(this.model.get('infinitives'),this.current_infinitive);$(this.el).html($.duostache(this.template,_.extend({},model_json,{verb_table:function(){return self.getEntry;},current_infinitive:this.current_infinitive,pre_infinitives:_.first(this.model.get('infinitives'),infinitive_index),post_infinitives:_.rest(this.model.get('infinitives'),infinitive_index+1),current_infinitive_data:model_json.infinitives_data[this.current_infinitive]}),this.settings.templates));this.$('#subjunctive-tables').hide();this.$('.verb-table').hide();this.$('.verb-tables .verb-table:first, .verb-tables .more-tenses:first').show();return this;},switchTables:function(e){var li=$(e.currentTarget);var tab=li.data('table');this.$('.tabs li').removeClass('active');li.addClass('active');this.$('.verb-tables').hide();this.$('#'+tab+'-tables').show();this.$('#'+tab+'-tables .verb-table:first, .verb-tables .more-tenses:first').show();},switchInfinitive:function(e){var a=$(e.currentTarget);var infinitive=a.data('infinitive');this.current_infinitive=infinitive;this.render();},moreTenses:function(e){var a=$(e.currentTarget);a.hide();a.next('.verb-table').show();a.next('.more-tenses').show();}});__hints__.WordLookup=Backbone.View.extend({events:{'keyup input':'onLookup','click .translate-lookup':'lookupWord','click .lookup-hints .close':'closeHints'},initialize:function(options){this.settings=options.settings;this.template=this.settings.templates['word-lookup'];},render:function(){$(this.el).html($.duostache(this.template,{id:this.settings.id},this.settings.templates));var self=this;$(document).bind('click.hints',function(){self.offSearchBox();});return this;},onLookup:function(e){if(this.$('input').val().length>0){this.$('.translate-lookup').show();if(e.which===13){this.lookupWord();}else{this.closeHints();}}else{this.$('.translate-lookup').hide();}
return false;},closeHints:function(){this.$('.hint-table').remove();this.$('.lookup-hints').hide();},offSearchBox:function(){if($('textarea:focus').size()>0||this.$('input:focus').size()>0){return;}
this.$('.lookup-hints .hint-table').remove();this.$('.lookup-hints').hide();},lookupWord:function(e){var word=$.trim(this.$('input').val());this.$('input').hints({text:word,word_only:true,source_language:this.settings.source_language,target_language:this.settings.target_language,templates:this.settings.templates,reverse:true,container:this.$('.lookup-hints')});this.$('.lookup-hints').show();if(this.settings.callback){this.settings.callback.apply(this.settings.callback_context);}
return false;}});function highlight_verb_patterns(text,highlights){var value=text;var offset=0;_.each(highlights,function(positions){value=value.slice(0,positions[0]+offset)+'<b>'+value.slice(positions[0]+offset,positions[1]+offset)+'</b>'+value.slice(positions[1]+offset);offset+=7;});return value;}
function build_manual_hints(manual_hints){var data={tokens:[]};for(var i=0;i<manual_hints.length;i++){var token_hint={};if(_.isArray(manual_hints[i])){token_hint.value=manual_hints[i][0];}else{token_hint.value=manual_hints[i];}
if(manual_hints[i].length>1){token_hint.hint_table={rows:[{cells:[{hint:manual_hints[i][1]}]}]};token_hint.index=i+1;}
data.tokens.push(token_hint);}
return data;}
$.fn.hints=function(options){return this.each(function(){ var settings=$.extend({},__hints__.settings,options); var element=$(this);var html=settings.text?settings.text:element.text(); url=[settings.url,settings.source_language,settings.target_language];url=url.join('/')+'?callback=?';$.getJSON(url,{format:'new',sentence:html},function(data){if(settings.example)data=__HINTS__EXAMPLE;if(settings.manual_hints)data=build_manual_hints(settings.manual_hints);if(!data)return;if(settings.word_only){var token=new __hints__.Token(data.tokens[0]);var view=new __hints__.HintTableView({model:token,settings:settings,el:settings.container,anchor:element});view.render();}else{ var sentence=new __hints__.TokenList();sentence.reset(data.tokens); var view=new __hints__.SentenceView({collection:sentence,settings:settings,render_callback:options.render_callback});element.empty().append(view.render().el);}
if(settings.render_callback)settings.render_callback.call(settings.callback_context);},'json');});};$.fn.wordLookup=function(options){return this.each(function(){var view=new __hints__.WordLookup({el:this,settings:options});view.render();});};$.fn.verbTable=function(options){return this.each(function(){var settings=$.extend({},__hints__.verb_table_settings,options);var table=new __hints__.VerbTable({infinitives:[settings.infinitive],language_information:settings.language_information,language:settings.source_language,title:false});table.url=settings.url+'/'+settings.source_language;var table_view=new __hints__.VerbTableView({settings:settings,model:table,el:$(this)});});};function get_token_hints(url,settings,request_split_text_tokens){$.ajax({url:url,dataType:'jsonp',data:{tokens:JSON.stringify(_.pluck(request_split_text_tokens,'text'))},type:'GET',success:function(data){ var formatted_data=_.map(data,function(hints,token){ if(hints.length>0&&_.isArray(hints[0])){var compound_hints=hints[0];hints=compound_hints[1];}
var new_format={value:token,hint_table:{rows:_.map(hints,function(hint){return{cells:[{hint:hint}]};})},id:token};return new_format;});var tokens=new __hints__.TokenList();tokens.reset(formatted_data);_.each(request_split_text_tokens,function(text_token_el){var token=tokens.get(text_token_el.text);if(token){var view=new __hints__.TextTokenSideView({model:token,settings:settings,el:$(text_token_el.el)});view.render();}else{console.error(text_token_el.text,'is missing from hints');}});}});}
$.fn.tokenHints=function(options){var settings=$.extend({},__hints__.token_hints_settings,options);var $elements=this; var split=500;var url=[settings.url,settings.source_language,settings.target_language];url=url.join('/'); var token_index=0;var text_tokens=_.map(this,function(el){return{text:$(el).text(),el:el};});while(token_index<text_tokens.length){var request_split_text_tokens=[]; var char_count=0;for(var i=token_index;i<text_tokens.length;i++){ request_split_text_tokens.push(text_tokens[i]); var request=url+encodeURI(JSON.stringify(_.pluck(request_split_text_tokens,'text')));if(request.length<split){ char_count+=text_tokens[i].text.length;token_index=i+1;}else{ request_split_text_tokens.pop();break;}}
get_token_hints(url,settings,request_split_text_tokens);}
return this;};var __HINTS__EXAMPLE={'tokens':[{'index':1,'value':'The','hint_table':{'rows':[{'cells':[{'hint':'el'}]},{'cells':[{'hint':'la'}]}]}},{'value':' '},{'index':2,'value':'dog','hint_table':{'rows':[{'cells':[{'hint':'perro'}]},{'cells':[{'hint':'macho'}]},{'cells':[{'hint':'tipo'}]},{'cells':[{'hint':'perseguir'}]}]}},{'value':' '},{'index':3,'value':'is','hint_table':{'rows':[{'cells':[{'hint':'(él/ella) es'}]}]}},{'value':' '},{'index':4,'value':'black','hint_table':{'references':[5,6],'headers':[{'token':'black','selected':true},{'token':'and'},{'token':'white'}],'rows':[{'cells':[{'hint':'blanco y negro','colspan':3}]},{'cells':[{'hint':'negro'},{},{}]}]}},{'value':'-'},{'index':5,'value':'and','hint_table':{'references':[4,6],'headers':[{'token':'black'},{'token':'and','selected':true},{'token':'white'}],'rows':[{'cells':[{'hint':'blanco y negro','colspan':3}]},{'cells':[{},{'hint':'y'},{}]},{'cells':[{},{'hint':'e'},{}]}]}},{'value':'-'},{'index':6,'value':'white','hint_table':{'references':[4,5],'headers':[{'token':'black'},{'token':'and'},{'token':'white','selected':true}],'rows':[{'cells':[{'hint':'blanco y negro','colspan':3}]},{'cells':[{},{},{'hint':'blanco'}]}]}},{'value':';'},{'value':' '},{'index':7,'value':'ruft','hint_table':{'separable':true,'references':[10],'headers':[{'token':'ruft','selected':true},{'token':' … '},{'token':'an'}],'rows':[{'cells':[{'hint':'(he/she/it) calls (up)'}]},{'cells':[{'hint':'(he/she/it) is calling (up)'}]}]}},{'value':' '},{'type':'link','value':'http://www.duolingo.com','tokens':[{'index':8,'value':'the','hint_table':{'rows':[{'cells':[{'hint':'la'}]},{'cells':[{'hint':'el'}]}]}},{'value':' '},{'index':9,'value':'compoundword','hint_table':{'headers':[{'token':'compound','selected':true},{'token':'word','selected':true}],'rows':[{'cells':[{'hint':'palabra compuesta','colspan':2}]},{'cells':[{'hint':'compuesta'},{'hint':'palabra'}]},{'cells':[{'hint':'compuesto'},{}]},{'cells':[{'hint':'mezcla'},{}]}]}},{'value':' '},{'index':10,'value':'an','hint_table':{'separable':true,'references':[7],'headers':[{'token':'ruft'},{'token':' … '},{'token':'an','selected':true}],'rows':[{'cells':[{'hint':'(he/she/it) calls (up)'}]},{'cells':[{'hint':'(he/she/it) is calling (up)'}]}]}}]},{'value':'.'}]};})(jQuery);(function($){var _counter=0;var _current_sounds=[];$.need_flash=false;$.tts={};$.tts.playerError=function(error_msg){console.error(error_msg);$.post('/diagnostics/js_error',{'msg':error_msg,'name':'TTS flash error','url':window.location.href});};$.tts.setUp=function(prefer_flash){soundManager.setup({preferFlash:prefer_flash});};$.tts.setupSoundManager=function(){ var _is_chrome=(navigator.userAgent.toLowerCase().indexOf('chrome')!=-1)&&(navigator.userAgent.toLowerCase().indexOf('chromium')==-1);soundManagerNew.setup({url:'/swf/sm2',debugMode:false,preferFlash:!_is_chrome, flashLoadTimeout:8000,onready:function(){console.debug('ready');},ontimeout:function(status){if(status.error.type==='NO_FLASH'){$.need_flash=true;}
$.tts.playerError('SM2 failed to start. Status: '+status.success+'; Error type: '+status.error.type);}});soundManager=soundManagerNew;}
$.tts.cleanAll=function(){for(var i=0;i<_current_sounds.length;i++){soundManager.destroySound(_current_sounds[i]);}
_current_sounds=[];};$.fn.tts=function(options){var settings={host:'t.duolingo.com',text:'duolingo',autoplay:true,visible:true,slowEnabled:false,absoluteURL:null,absolute_slow_URL:null,sentenceType:'lesson',beginner:false};return this.each(function(){if(options==='cleanUp'){ settings=$(this).data('tts');for(var i=0;i<_current_sounds.length;i++){if(_current_sounds[i]===settings.speaker_id||_current_sounds[i]===settings.slow_speaker_id){soundManager.destroySound(_current_sounds[i]);_current_sounds.splice(i,1);i--;}}
return;}
if(options){if(!options.aid){options.aid='audio-'+(++_counter);}
$.extend(settings,options);}
var speaker_id='speaker-'+settings.aid;settings.speaker_id=speaker_id;settings.quoted_text=escape(encodeURIComponent(settings.text.replace('/',' ')));if(settings.absoluteURL!==null){settings.sound_path=settings.absoluteURL;}else{settings.sound_path="http://"+settings.host+"/tts/speak/"+settings.language+"/"+settings.quoted_text+'?type='+settings.sentenceType;}
if(settings.absolute_slow_URL!==null){settings.slow_sound_path=settings.absolute_slow_URL;}else{settings.slow_sound_path="http://"+settings.host+"/tts/speak/"+settings.language+"/"+settings.quoted_text+'?type='+settings.sentenceType+'&speed=70p';} 
if(settings.template){$(this).html($.duostache(settings['template'],settings));}
var final_url=settings.sound_path;var sound=soundManager.createSound({id:speaker_id,url:final_url,autoPlay:settings.autoplay&&!settings.beginner,onload:function(){if(settings.onload){settings.onload();}}});_current_sounds.push(speaker_id);var slow_sound=null;if(settings.slowEnabled){settings.slow_speaker_id=speaker_id+'-slow';var final_slow_url=settings.slow_sound_path;slow_sound=soundManager.createSound({id:settings.slow_speaker_id,url:final_slow_url,autoPlay:settings.autoplay&&settings.beginner});_current_sounds.push(settings.slow_speaker_id);}
$(this).data('tts',settings);if(settings.click){ settings.play_trigger='click';} 
if(settings.visible){$(this).find('#'+speaker_id+'-button').click(function(){soundManager.stopAll();sound.play();});$(this).find('#'+speaker_id+'-slow-button').click(function(){soundManager.stopAll();slow_sound.play();});}else if(settings.play_trigger){$(this).bind(settings.play_trigger,function(){soundManager.stopAll();sound.play();});}});};})(jQuery);duo.Skill=Backbone.Model.extend({url:function(){var new_url='/skills/'+this.get('language')+'/'+encodeURIComponent(this.get('name'));return new_url;},toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);json_data['learned_more']=json_data['progress_percent']-json_data['learning_threshold_percentage']>=5;return json_data;},parse:function(data){if(data.comment_data){data['comments']=new duo.SkillCommentList(duo.SkillCommentList.prototype.parse(data.comment_data));data['comments'].skill=this;}
return data;}});duo.SkillList=Backbone.Collection.extend({model:duo.Skill,parse:function(data){return _.map(data,function(skill){return duo.Skill.prototype.parse.call(this,skill);});},checkFinished:function(){var finished_tree=true;this.each(function(skill){if(skill.get('learned')==false)
finished_tree=false;});return finished_tree;}});duo.Comment=Backbone.Model.extend({urlRoot:'comments',toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);var max_length=300;var message=json_data['marked_down_message'];if(!('marked_down_message'in json_data)){message=json_data['message'];}
if(!('processed_message'in json_data)){json_data['processed_message']=this.replaceURLs(json_data['message']);}
json_data['short_message']=this.replaceURLs(message.substring(0,max_length));json_data['shortened_message']=json_data['message'].length>max_length;if('best_comment'in json_data&&json_data['best_comment']){var comment=json_data['best_comment'];var sub_message=comment['marked_down_message'];if(!('marked_down_message'in comment)){message=comment['message'];}
comment['best_short_message']=this.replaceURLs(sub_message.substring(0,max_length));comment['best_shortened_message']=comment['message'].length>max_length;}else if('comments'in json_data){json_data['comments']=json_data['comments'].toJSON();}
_.each(json_data.followers,function(follower){follower.expert=_.indexOf(json_data.experts,follower.id)>=0},this);return json_data;},replaceURLs:function(text){var url_regex=/\b(?:(?:https?|ftp):\/\/|www\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gi;return text.replace(url_regex,function(url){return'<a href="'+url+'" class="underline grayDark" target="_blank">'+url+'</a>';});},parse:function(data){if('user'in data&&data['user'].flair){data['user'].flair.level_data_sorted=data['user'].flair.level_data.sort(function(a,b){return b.level-a.level})}
if('comments'in data){var num_hidden=0;data['comments']=_.map(data.comments,function(comment){_.extend(comment,{experts:data.experts||this.get('experts')});return duo.Comment.prototype.parse.call(this,comment);},this);data['comments']=new duo.CommentList(data['comments']);data['comments'].parent=this;if('votes'in data){data['hidden']=(data['votes']<-2);}
var count_hidden=0;data['comments'].each(function(comment){if(comment.get('votes')>2)
data['hidden']=false;if(comment.get('hidden'))
{count_hidden+=1;count_hidden+=comment.get('num_comments')}
if(comment.get('user')&&comment.get('user').flair){comment.get('user').flair.level_data_sorted=comment.get('user').flair.level_data.sort(function(a,b){return b.level-a.level})}},this);data['num_hidden']=count_hidden;}else if('best_comment'in data&&data['best_comment']!==null){data['best_comment']['processed_message']=this.replaceURLs(data['best_comment']['marked_down_message']);}
if('message'in data){data['processed_message']=this.replaceURLs(data['marked_down_message']);}
return data;},voteUp:function(){var self=this;mixpanel.track('comment upvote');$.post('/comments/'+this.id+'/upvote',{best_only:this.has('best_only')},function(data){console.log(data);self.set(duo.Comment.prototype.parse.call(self,data));});},voteDown:function(){var self=this;mixpanel.track('comment downvote');$.post('/comments/'+this.id+'/downvote',{best_only:this.has('best_only')},function(data){console.log(data);self.set(duo.Comment.prototype.parse.call(self,data));});},del:function(del_thread){var self=this;mixpanel.track('comment delete');$.post('/comments/'+this.id+'/delete',{del_thread:del_thread},function(data){console.log(data);self.set(duo.Comment.prototype.parse.call(self,data));});},undel:function(del_thread){var self=this;mixpanel.track('comment undelete');$.post('/comments/'+this.id+'/undelete',{del_thread:del_thread},function(data){console.log(data);self.set(duo.Comment.prototype.parse.call(self,data));});},reply:function(message){var self=this;$.post('/comments/'+this.id+'/reply',{message:message,best_only:this.has('best_only')},function(data){console.log(data);mixpanel.track("Questions reply");self.set(duo.Comment.prototype.parse.call(self,data));});},watch:function(){var self=this;$.post('/comments/'+this.id+'/watch',{best_only:this.has('best_only')},function(data){console.log(data);self.set(duo.Comment.prototype.parse.call(self,data));});},unwatch:function(){var self=this;$.post('/comments/'+this.id+'/unwatch',{best_only:this.has('best_only')},function(data){console.log(data);self.set(duo.Comment.prototype.parse.call(self,data));});}});duo.EventComment=duo.Comment.extend({url:function(){if(this.collection){return _.result(this.collection,'url');}
return duo.Comment.prototype.url.call(this);},toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);json_data['processed_message']=this.replaceURLs(json_data['message']);return json_data;}});duo.Topic=Backbone.Model.extend({currentPanel:'hot',searchResults:{},url:function(){if(this.id){return'/topics/'+this.id;}
return'/topics';},parse:function(data){if(data.comments){var hot_comments=new duo.CommentList();hot_comments.reset(duo.CommentList.prototype.parse.call(hot_comments,data));hot_comments.sort_by='hot';hot_comments.page=1;hot_comments.more=data.more_comment;data.comments=hot_comments;data.new_comments=new duo.CommentList();data.new_comments.sort_by='new';data.new_comments.more=true;data.top_comments=new duo.CommentList();data.top_comments.sort_by='top';data.top_comments.more=true;data.sent_comments=new duo.CommentList();data.sent_comments.sort_by='sent';data.sent_comments.more=true;data.active_comments=new duo.CommentList();data.active_comments.sort_by='active';data.active_comments.more=true;}
return data;},follow:function(){var self=this;$.post('/topics/'+this.id+'/follow',function(data){if(data.response==='OK'){self.set(data.topic);}});},unfollow:function(callback,context){var self=this;$.post('/topics/'+this.id+'/unfollow',function(data){if(data.response==='OK'){self.set(data.topic);}
if(callback){callback.call(context||this);}});}});duo.CommentList=Backbone.Collection.extend({model:duo.Comment,url:function(){return'/comments';},fetch:function(options){options=options||{};options.data=options.data||{};options.data.sort_by=this.sort_by;options.data.filter=this.filter_option;Backbone.Collection.prototype.fetch.call(this,options);},parse:function(data){this.page=data.page;this.more=data.more;this.user_skills=data.user_skills;this.experts=data.experts;return _.map(data.comments,function(comment){return duo.Comment.prototype.parse(comment);});}});duo.SkillCommentList=duo.CommentList.extend({url:function(){return'/skills/'+this.skill.id+'/comments';}});duo.EventCommentList=duo.CommentList.extend({model:duo.EventComment,url:function(){return'/events/'+this.event_id+'/comments';},parse:function(data){return data;}});duo.TranslationComment=duo.EventComment.extend({});duo.TranslationCommentList=duo.CommentList.extend({model:duo.TranslationComment,url:function(){return'/translations/'+this.translation_id+'/comments';},parse:function(data){return data;}});duo.SearchResults=duo.CommentList.extend({fetch:function(options){var self=this;options=options||{};options.data=options.data||{};options.data=_.extend({wt:'json',q:this.q,fq:this.fq,start:this.length},options.data);if($.trim(options.data.q).length===0){this.reset([]);return;}
$.ajax({url:'http://'+duo.search_host+'/solr/select',data:options.data,success:function(data){var items=data.response.docs;self.num_results=data.response.numFound;if(!items.length){if(!options.data.start){self.reset([]);}
return;}
$.getJSON('/comments/load',{comment_ids:JSON.stringify(_.pluck(items,'parent_id'))},function(comment_info){var highlightings=data.highlighting;items=_.map(items,function(item_data,i){var extract=highlightings[item_data.id].title||highlightings[item_data.id].message;if(!extract){extract=item_data.title||item_data.message;extract=extract.substring(0,50)+'...';}
item_data.parent_title=comment_info[item_data.parent_id]?comment_info[item_data.parent_id].title:item_data.title;item_data.extract=extract;return item_data;});if(!options.data.start){self.reset(items);}else{self.add(items);}});},dataType:'jsonp',jsonp:'json.wrf'});},parse:function(data){console.log("parsing: ");console.log(data);}});var _ttsURL='http://static.duolingo.com/tts/';duo.CommentView=Backbone.View.extend({id:'app',template:duo.templates['comment'],events:{'click .vote-up':'upvote','click .vote-down':'downvote','click #post-comment':'reply','click .delete-comment':'deleteComment','click .delete-thread':'deleteThread','click .edit-comment':'editComment','click .update-comment':'updateComment','click .add-reply':'addReply','click #post-reply':'postReply','click .cancel-update-comment':'cancelUpdate','click #watch':'watch','click #unwatch':'unwatch','click #post-text-box':'focusReplyBox','hover .original-post':'showEdit','click #edit-data':'dropDownEdit','click #show-toggle':'showHiddenComments'},initialize:function(){this.model.bind('change',this.render,this);this.has_hidden=false;},render:function(){var tts=this.model.get('title');if(tts[0]=='\"'&&tts[tts.length-1]=='\"'){tts=tts.slice(1,-1);}
this.$('.modal').modal('hide');$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{got_related:this.model.has('related')&&this.model.get('related').length>0,num_followers:this.model.has('followers')?this.model.get('followers').length:0,logged_in_user:duo.user?{id:duo.user.id,avatar:duo.user.get('avatar'),username:duo.user.get('username')}:null,expert:_.indexOf(this.model.get('experts'),this.model.get('user').id)>=0,show_badges:true,num_hidden:this.model.get('num_hidden'),format_title:tts}),duo.templates));if(this.model.has('skill')){var skill_view=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(this,this.model.get('skill'))),el:this.$("#comment-skill")});skill_view.render();}
this.model.get('comments').each(function(comment){var comment_view=new duo.NestedCommentView({model:comment,el:this.$('#comment-'+comment.id)});if(comment.get('hidden'))
{this.$('#comment-'+comment.id).addClass("hidden-comment");this.$('#comment-'+comment.id).hide();this.has_hidden=true;this.num_hidden+=1;}
comment_view.render();},this);if(this.has_hidden==false)
{this.$('#show-toggle').hide();}
var language=this.model.get('show_tts')?this.model.get('sentence_language'):this.model.get('translation_language')
var tts_id=this.model.get('show_tts')?this.model.get('sentence_id'):this.model.get('translation_id');var self=this;_.defer(function(){self.$('.listen-button-small').tts({absoluteURL:_ttsURL+language+'/sentence/'+tts_id,template:duo.templates['speaker'],visible:false,autoplay:false,click:true});});_.defer(function(){self.$('label').inFieldLabels();});this.$('.modal').modal({keyboard:true,backdrop:true,show:false});if(this.model.get('sentence_comment')){if(this.model.get('show_tts')){this.$('.title').hints({templates:duo.templates,source_language:self.model.get('sentence_language'),target_language:self.model.get('translation_language'),top:35});}else{this.$('.trans').hints({templates:duo.templates,source_language:self.model.get('translation_language'),target_language:self.model.get('sentence_language'),top:15});}}
return this;},reply:function(){var message=$.trim(this.$('#post-text-box').val());if(message.length>0){this.$('#post-text-box, #post-comment').attr('disabled','disabled');this.$('#post-text-box').val('');this.model.reply(message);}},focusReplyBox:function(){this.$('.comment-box').autosize({append:"\n"});this.$('#post-button').fadeIn(500);},upvote:function(e){this.model.voteUp();e.stopPropagation();return false;},downvote:function(e){this.model.voteDown();e.stopPropagation();return false;},deleteComment:function(e){var del=confirm('Delete this comment?');if(!del){return;}
this.model.del();duo.commentRouter.navigate('/topic/'+this.model.get('root').id,true);return false;},deleteThread:function(e){var del=confirm('Delete this thread?');if(!del){return;}
this.model.del(true);duo.commentRouter.navigate('/topic/'+this.model.get('root').id,true);return false;},editComment:function(e){var edit_view=new duo.PostModalView({el:this.$('#edit-modal'),type:this.model.get('question')?'question':'insight',edit:this.model,all_topics:this.model.get('all_topics'),selected:this.model.get('topic').id,success:this.onPost});edit_view.render();this.$('#edit-modal').modal('show');return false;},updateComment:function(e){var title=$.trim(this.$('.comment-head .title-edit-box').val());var message=$.trim(this.$('#main-post-edit').val());if(title.length>0){this.model.save({title:title,message:message});}else{alert('Title cannot be empty!');}},cancelUpdate:function(){this.render();return false;},addReply:function(){this.$('#postreply-'+this.model.id).autosize({append:"\n"});this.$('#reply-box-'+this.model.id).fadeToggle(400);this.$('#postreply-'+this.model.id).focus();return false;},postReply:function(e){var message=$.trim(this.$('#postreply-'+this.model.id).val());if(message.length>0){this.$('#post-reply, #postreply-'+this.model.id).attr('disabled','disabled');this.$('#postreply-'+this.model.id).val('');this.model.reply(message);}},onPost:function(){this.$('.modal').modal('hide');},watch:function(){this.model.watch();},unwatch:function(){this.model.unwatch();},showEdit:function(e){if(this.$('#edit-data').is(':visible')){this.$('#edit-data').hide();this.$('#edit-data-drop-'+this.model.id).hide();}
else
this.$('#edit-data').show();e.stopPropagation();return false;},dropDownEdit:function(e){this.$('.edit-data').addClass('active');this.$('#edit-data-drop-'+this.model.id).toggle();var self=this;$(document).one('click.event',function(){self.$('#edit-data-drop-'+self.model.id).hide();});e.stopPropagation();return false;},showHiddenComments:function(e){var hidden_comments=this.$('.first-reply > .hidden-comment').fadeIn(400);hidden_comments.find('.hidden-comment').show();hidden_comments.find('.show-toggle').hide();this.$('#show-toggle').hide();e.stopPropagation();return false;}});duo.CompactCommentView=duo.CommentView.extend({template:duo.templates['compact-comment'],events:{'click .vote-up':'upvote','click .vote-down':'downvote','click .reply':'reply','click .show-answer-input':'showAnswerInput','click .body .more':'moreMessage','click .nested-comment .more':'moreComment'},initialize:function(options){this.model.bind('change',this.render,this);this.from_skill=options.from_skill;this.experts=options.experts;},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{expert:_.indexOf(this.experts,this.model.get('user').id)>=0,from_skill:this.from_skill,show_badges:true}),duo.templates));if(this.model.has('skill')){var skill=this.model.get('skill');skill_view=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(this,skill)),size:'xxsmall',current_user:'points'in skill});this.$('.skill-'+skill.id).append(skill_view.render().el);}
return this;},reply:function(){var message=$.trim(this.$('.comment-reply-box').val());if(message.length>0){this.model.reply(message);}},showAnswerInput:function(){this.$('.answer-input').show().find('textarea').focus();this.$('.show-answer-input').hide();},moreMessage:function(){this.$('.body').html(this.model.get('processed_message'));},moreComment:function(){this.$('.nested-body p').remove();this.$('.nested-body').append(this.model.get('best_comment').processed_message);}});duo.NestedCommentView=duo.CommentView.extend({template:duo.templates['nested-comment'],events:{'click .vote-up':'upvote','click .vote-down':'downvote','click #post-comment':'reply','click .delete-comment':'deleteComment','click .undelete-comment':'undeleteComment','click .edit-comment':'editComment','click .update-comment':'updateComment','click .add-reply':'addReply','click .post-reply':'postReply','click .cancel-reply':'cancelReply','click .cancel-update-comment':'cancelUpdate','click #watch':'watch','click #unwatch':'unwatch','click #post-text-box':'focusReplyBox','click .edit-data':'dropDownEdit','hover #self-comment':'hoverNested','click .show-toggle':'showHiddenComments'},initialize:function(){duo.CommentView.prototype.initialize.call(this);this.model.bind('change:model_deleted',this.onDelete,this);this.model.bind('change:model_removed',this.onRemove,this);this.model.bind('change:model_undeleted',this.onUnDelete,this);this.has_hidden=false;},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{expert:(this.model.collection)?_.indexOf(this.model.collection.parent.get('experts'),this.model.get('user').id)>=0:null,show_badges:true}),duo.templates));this.model.get('comments').each(function(comment){var comment_view=new duo.NestedCommentView({model:comment,el:this.$('#comment-'+comment.id)});comment_view.render();if(comment.get('hidden'))
{this.$('#comment-'+comment.id).addClass("hidden-comment");this.$('#comment-'+comment.id).hide();this.has_hidden=true;this.num_hidden+=1;}},this);if(this.has_hidden==false)
{this.$('#show-toggle-'+this.model.id).hide();}
return this;},deleteComment:function(e){this.$('#edit-data-drop-'+this.model.id).hide();var del=confirm('Delete this comment?');if(!del){return false;}
this.model.del();e.stopPropagation();return false;},undeleteComment:function(e){var undel=confirm('Undelete this comment?');if(!undel){return;}
this.model.undel();return false;},onDelete:function(){if(this.model.get('model_deleted')){var comment_list=this.model.collection;if(comment_list===undefined){return;}
comment_list.remove(this.model);comment_list.parent.set({num_comments:comment_list.parent.get('num_comments')-1});}},onRemove:function(){if(this.model.get('model_removed')){var comment_list=this.model.collection;if(comment_list===undefined){return;}
comment_list.parent.trigger('change');this.model.set('model_removed',false);}},onUnDelete:function(){ if(this.model.get('model_undeleted')){var comment_list=this.model.collection;comment_list.parent.trigger('change');this.model.set('model_undeleted',false);}},editComment:function(e){this.$('#edit-data-'+this.model.id).hide();this.$('#edit-data-drop-'+this.model.id).hide();this.$('#body-'+this.model.id).hide();this.$('.title-edit-box, #edit-box-'+this.model.id).show();this.$('.edit-post-box textarea').val(this.model.get('message'));this.$('#edit-box-'+this.model.id+' textarea').focus();e.stopPropagation();return false;},updateComment:function(e){var message=$.trim(this.$('.post-edit-box').val());this.model.save({message:message});e.stopPropagation();return false;},cancelUpdate:function(e){this.render();e.stopPropagation();return false;},dropDownEdit:function(e){this.$('#edit-data-'+this.model.id).addClass('active');this.$('#edit-data-drop-'+this.model.id).fadeToggle(100);var self=this;$(document).one('click.event',function(){self.$('#edit-data-drop-'+self.model.id).fadeOut(100);});e.stopPropagation();return false;},cancelReply:function(e){this.$('#reply-box-'+this.model.id).fadeToggle(400);e.stopPropagation();return false;},hoverNested:function(e){this.$('#edit-data-'+this.model.id).fadeToggle(100);this.$('#edit-data-drop-'+this.model.id).fadeOut(100);e.stopPropagation();return false;},showHiddenComments:function(e){this.$('.hidden-comment').fadeIn(400);this.$('.show-toggle').hide();e.stopPropagation();return false;}});duo.CommentListView=Backbone.View.extend({template:duo.templates['comment-list'],events:{'click #ask-question':'toggleQuestion','click #write-insight':'toggleInsight','click #post-question':'postQuestion','click #post-insight':'postInsight','click #load-more-comments':'onClickLoad'},initialize:function(options){this.collection=options.collection;this.collection.bind('add',this.render,this);this.collection.bind('change',this.render,this);this.collection.bind('reset',this.render,this);if(options.buttons!=undefined){this.buttons=options.buttons;}else{this.buttons=true;}
this.infinite_scrolling=options.infinite_scrolling;this.topic_id=options.topic_id;this.topic_name=options.topic_name;this.from_skill=options.from_skill;this.experts=options.experts;},render:function(){$(this.el).html($.duostache(this.template,{comments:this.collection.toJSON(),more:this.collection.more,buttons:this.buttons,topic_id:this.topic_id,topic_name:this.topic_name,infinite_scrolling:this.infinite_scrolling,experts:this.experts},duo.templates));var self=this;this.collection.each(function(comment){var comment_view=new duo.CompactCommentView({model:comment,el:self.$('#comment-'+comment.id),from_skill:self.from_skill,experts:self.experts?self.experts:self.collection.experts});comment_view.render();});this.$('textarea').characterLimit(65000);this.$('a.topic-label[data-topic="'+this.topic_id+'"]').remove();_.defer(function(){self.$('label').inFieldLabels();});return this;},postQuestion:function(){if($.trim(this.$('#question-title').val()).length>0){this.collection.create({message:this.$('#question-post').val(),title:this.$('#question-title').val(),type:'question'},{at:0});}},postInsight:function(){if($.trim(this.$('#insight-title').val()).length>0){this.collection.create({message:this.$('#insight-post').val(),title:this.$('#insight-title').val(),type:'insight'},{at:0});}},toggleQuestion:function(){var self=this;this.$('#insight-fields').slideUp(function(){self.$('#question-fields').slideToggle();});},toggleInsight:function(){var self=this;this.$('#question-fields').slideUp(function(){self.$('#insight-fields').slideToggle();});},onClickLoad:function(){this.loadMoreComments();},loadMoreComments:function(data){data=data||{};data=_.extend(data,{page:this.collection.page+1});this.collection.fetch({data:data,update:true,remove:false});}});duo.AllCommentsView=Backbone.View.extend({id:'app',template:duo.templates['all-comment-list'],events:{'click #ask-question':'toggleQuestion','click #write-insight':'toggleInsight','click #post-question':'postQuestion','click #post-insight':'postInsight','click #settings-tab li':'tabChange','change #sorted-choice':'sortedChange','keyup #search-comments':'search'},initialize:function(options){this.collection=options.collection;this.sort_by=options.sort_by;this.throttledSearch=_.debounce(this.throttledSearch,500);},render:function(sort_by){var data={};data[this.sort_by]=true;$(this.el).html($.duostache(this.template,_.extend(data,{skill_list:this.collection.user_skills,language_string:duo.user.getSkills().language_string}),duo.templates));var comments_view=new duo.CommentListView({el:this.$('#comments'),collection:this.collection,buttons:false});comments_view.render();this.$('textarea').characterLimit(65000);var self=this;_.defer(function(){self.$("label").inFieldLabels();});return this;},toggleQuestion:function(){var self=this;this.$('#insight-fields').slideUp(function(){self.$('#question-fields').slideToggle();});},toggleInsight:function(){var self=this;this.$('#question-fields').slideUp(function(){self.$('#insight-fields').slideToggle();});},postQuestion:function(){var title=$.trim(this.$('#question-title').val());var message=$.trim(this.$('#question-post').val());if(title.length===0){console.log(this.$('#question-title'),'question title cannot be empty');return;}
var question=new duo.Comment({title:title,message:message,type:'question'});if(this.$('#question-skill-choice').val()!=='na'){question.url='/skills/'+this.$('#question-skill-choice').val()+'/comments';}else{question.set({category:'general'});}
var self=this;question.save(null,{success:function(){self.collection.add(question,{at:0});}});mixpanel.track("Questions Post",{type:"question"});this.$('#posted-label').show().delay(3000).fadeOut(1000);this.$('#question-title').val('').blur();this.$('#question-post').val('').blur();},postInsight:function(){var title=$.trim(this.$('#insight-title').val());var message=$.trim(this.$('#insight-post').val());if(title.length===0){console.log(this.$('#insight-title'),'insight title cannot be empty');return;}
var insight=new duo.Comment({title:title,message:message,type:'insight'});if(this.$('#insight-skill-choice').val()!=='na'){insight.url='/skills/'+this.$('#insight-skill-choice').val()+'/comments';}else{insight.set({category:'general'});}
var self=this;insight.save(null,{success:function(){self.collection.add(insight,{at:0});}});mixpanel.track("Questions Post",{type:"insight"});this.$('#posted-label').show().delay(3000).fadeOut(1000);this.$('#insight-title').val('').blur();this.$('#insight-post').val('').blur();},tabChange:function(e){var tab=$(e.target).closest('li');var self=this;this.$('#settings-tab li').removeClass('active');tab.addClass('active');this.collection.filter_option=tab.data('filter');this.collection.fetch({success:function(){if((self.collection.filter_option==='watched')&&(self.collection.length==0)){self.$('#comments').hide();self.$('#not-watching').show();}else{self.$('#comments').show();self.$('#not-watching').hide();}}});},sortedChange:function(e){this.collection.sort_by=this.$('#sorted-choice').val();this.collection.fetch();},throttledSearch:function(){var q=this.$('#search-comments').val();if($.trim(q).length>0){var self=this;this.collection.fetch({data:{q:q},success:function(){if(self.collection.length==0){self.$('#comments').hide();self.$('#no-results').show();}else{self.$('#comments').show();self.$('#no-results').hide();}}});}else{this.collection.fetch();this.$('#comments').show();this.$('#no-results').hide();}},search:function(){mixpanel.track("Questions Search");this.throttledSearch();},changeLanguage:function(){this.collection.fetch();},cleanup:function(){duo.user.unbind('change:learning_language',this.changeLanguage,this);}});duo.SimpleCommentsView=Backbone.View.extend({template:duo.templates['simple-comments'],events:{'keyup textarea':'keyCheck','click .delete-comment':'deleteComment'},initialize:function(options){this.collection=options.collection;this.collection.bind('add',this.render,this);this.collection.bind('change',this.render,this);this.collection.bind('remove',this.render,this);this.collection.bind('reset',this.render,this);this.throttledPost=_.debounce(this.throttledPost,500);},render:function(sort_by){$(this.el).html($.duostache(this.template,{num_comments:this.collection.length,language_string:duo.user.getSkills().language_string,comments:this.collection.toJSON()},duo.templates));var comments_view=new duo.CommentListView({el:this.$('#comments'),collection:this.collection,buttons:false});comments_view.render();this.$('textarea').characterLimit(65000);var self=this;_.defer(function(){self.$("label").inFieldLabels();self.$('textarea').autosize();});return this;},keyCheck:function(e){if(e.which===13){this.post();return false;}},throttledPost:function(){if($.trim(this.$('textarea').val()).length>0){this.collection.create({message:this.$('textarea').val()});}
this.$('textarea').val('');},post:function(){mixpanel.track("Translation Post Comment");this.throttledPost();},deleteComment:function(e){var comment_id=$(e.currentTarget).data('comment');var del=confirm('Delete this comment?');if(!del){return;}
var comment=this.collection.get(comment_id);this.collection.remove(comment);comment.destroy();}});duo.TopicSearchView=Backbone.View.extend({template:duo.templates['community-search'],events:{'click #load-more-comments':'loadMoreComments'},initialize:function(options){this.collection=options.collection;this.collection.bind('reset',this.onReset,this);this.collection.bind('add',this.render,this);},render:function(){$(this.el).html($.duostache(this.template,{comments:this.collection.toJSON(),results_count:this.collection.num_results,has_more:this.collection.length<this.collection.num_results},duo.templates));return this;},loadMoreComments:function(){this.collection.fetch();},onReset:function(){this.last_request_length=0;this.render();}})
duo.TopicView=Backbone.View.extend({id:'app',template:duo.templates['topic'],events:{'click #ask-question':'toggleQuestion','click #write-insight':'toggleInsight','click .follow':'toggleFollow','click .show-more':'showMoreSubtopics','click .comment-main .tabs li':'switchTab','click .clear-button':'clearSearch','keyup #search-comments':'keyCheckSearch'},initialize:function(){this.throttledSearch=_.debounce(this.throttledSearch,500);this.model.bind('change',this.render,this);this.last_request_length=0;_.bindAll(this,'onPost'); duo.topbar.bind('navigate',this.cleanup,this);},render:function(){if(!this.show_all){_.each(this.model.get('subtopics'),function(subtopic,i){if(i>=10){subtopic.hide=true;}
subtopic.self=subtopic.id===this.model.id;},this);}
$(this.el).html($.duostache(this.template,_.extend({},this.model.toJSON(),{num_subtopics:this.model.get('subtopics').length,showing_all:this.show_all||this.model.get('subtopics').length<=10,main_topic:this.model.get('name')=='Duolingo'||this.model.get('name')=='Troubleshooting',show_active:this.model.get('admin_user')||this.model.get('mod_user')}),duo.templates));this.hot_comments=new duo.CommentListView({el:this.$('#hot-tab'),collection:this.model.get('comments'),buttons:false,infinite_scrolling:true,topic_id:this.model.id,sort:'hot',experts:this.model.get('experts')});this.new_comments=new duo.CommentListView({el:this.$('#new-tab'),collection:this.model.get('new_comments'),infinite_scrolling:true,experts:this.model.get('experts')});this.top_comments=new duo.CommentListView({el:this.$('#top-tab'),collection:this.model.get('top_comments'),infinite_scrolling:true,experts:this.model.get('experts')});this.sent_comments=new duo.CommentListView({el:this.$('#sent-tab'),collection:this.model.get('sent_comments'),infinite_scrolling:true,experts:this.model.get('experts')});this.active_comments=new duo.CommentListView({el:this.$('#active-tab'),collection:this.model.get('active_comments'),infinite_scrolling:true,experts:this.model.get('experts')});if(!this.search_collection){this.search_collection=new duo.SearchResults();this.search_view=new duo.TopicSearchView({collection:this.search_collection,el:this.$('.comment-search')});this.search_collection.bind('all',this.toggleSearchView,this);}else{this.$('.comment-search').replaceWith(this.search_view.render().el);}
if(this.model.has('user_skill')){var skill_view=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(this,this.model.get('user_skill'))),el:this.$("#comment-skill")});skill_view.render();}
var insight_modal=new duo.PostModalView({el:this.$('#insight-fields'),type:'insight',edit:false,selected:this.model.id,all_topics:this.model.get('all_topics'),success:this.onPost});insight_modal.render();var question_modal=new duo.PostModalView({el:this.$('#question-fields'),type:'question',edit:false,selected:this.model.id,all_topics:this.model.get('all_topics'),success:this.onPost});question_modal.render();this.$('textarea').characterLimit(65000);var self=this;this.$('.modal').modal({keyboard:true,backdrop:true,show:false});_.defer(function(){self.$("label").inFieldLabels();});$(document).unbind('.topic_scroll').bind('scroll.topic_scroll.infinite_scroll',function(e){var total_height=$(document).height();var view_height=total_height-$(document).scrollTop();var visible_height=$(window).height();if(view_height<1.5*visible_height){var comments_view=self.hot_comments;if(self.current_panel=='top'){comments_view=self.top_comments;}else if(self.current_panel=='new'){comments_view=self.new_comments;}else if(self.current_panel=='sent'){comments_view=self.sent_comments;}else if(self.current_panel=='active'){comments_view=self.active_comments;}
if(comments_view.collection.more!=false){if(self.search_on){comments_view=self.search_view;}
if(comments_view.last_request_length===undefined){comments_view.last_request_length=0;}
if(comments_view.collection.length>comments_view.last_request_length){comments_view.last_request_length=comments_view.collection.length;comments_view.loadMoreComments({topic_id:self.model.id,per_page:10});}}}});return this;},toggleFollow:function(){if(this.model.get('is_following')){this.model.unfollow();}else{this.model.follow();}},toggleQuestion:function(){this.$('.modal').modal('hide');this.$('#question-fields').modal('show');},toggleInsight:function(){this.$('.modal').modal('hide');this.$('#insight-fields').modal('show');},onPost:function(comment){var comment_topic_id=parseInt(comment.get('topic_id'));if(_.indexOf(this.model.get('included_topics'),comment_topic_id)>=0){if(this.model.get('new_comments').length){this.model.get('new_comments').add(comment,{at:0});}}
this.$('.modal').modal('hide');duo.commentRouter.navigate('/comment/'+comment.get('id'),true);},keyCheckSearch:function(e){var q=$.trim(this.$('#search-comments').val());this.throttledSearch(q);if(q.length){this.$('.clear-button').show();}else{this.$('.clear-button').hide();}},toggleSearchView:function(){if(this.$('#search-comments').val()!=''){this.$('.comment-search').show();this.$('.comment-main').hide();this.search_on=true;}else{this.$('.comment-search').hide();this.$('.comment-main').show();this.search_on=false;}},throttledSearch:function(q){ mixpanel.track("Questions Search");if(duo.user){this.search_collection.fq='-(learning_language:* AND -learning_language:'+this.model.get('learning_language')+') AND from_language:'+duo.user.get('ui_language');}else{this.search_collection.fq='from_language:'+duo.browser_language;}
this.search_collection.q=q;this.search_collection.reset([]);this.search_collection.fetch();return;},typeSelect:function(){ var comment_id=this.$menu.find('.active').data('id');this.$menu.remove();duo.commentRouter.navigate('/comment/'+comment_id,true);},showMoreSubtopics:function(){this.$('.show-more').remove();this.$('.list-topics li').show();this.show_all=true;},changeLanguage:function(){this.model.fetch();},cleanup:function(){duo.topbar.unbind('navigate',this.cleanUp,this);$(document).unbind('.topic_scroll');duo.user.unbind('change:learning_language',this.changeLanguage,this);},switchTab:function(e){var tab=$(e.currentTarget).data('tab');if(tab==this.current_panel)
return false;this.$('.panel').fadeOut("fast");this.changeSort(tab);duo.commentRouter.navigate('/topic/'+this.model.id+'/'+tab,false);},changeSort:function(sort_by){var tab=$('#'+sort_by);var tab_name=sort_by;var tab_panel=this.$('#'+sort_by+'-tab');tab_panel.fadeIn("fast");this.$('.comment-main .tabs li').removeClass('active');tab.addClass('active');this.current_panel=tab_name;if(tab_name!=='hot'&&this.model.get(tab_name+'_comments').length===0){this.model.get(tab_name+'_comments').fetch({data:{topic_id:this.model.id}});}else{this[tab_name+'_comments'].render();}},clearSearch:function(){this.$('#search-comments').val('').keyup().blur();}});duo.PostModalView=Backbone.View.extend({template:duo.templates['post-modal'],events:{'click .submit-post':'submitPost','keyup .skill-list':'onTopic','change .skill-list':'onTopic'},initialize:function(options){this.type=options.type;this.edit=options.edit;this.success=options.success;this.selected=options.selected;this.all_topics=options.all_topics;},render:function(){var data={edit:this.edit?this.edit.toJSON():false,all_topics:this.all_topics,type:this.type};data[this.type]=true;$(this.el).html($.duostache(this.template,data,duo.templates));if(this.selected){var option=this.$('.skill-list [data-topic="'+this.selected+'"]');var topic_name=option.data('name');this.$('.skill-list').val(option.attr('value'));if(topic_name)
this.$('.topic').text(translate_text(topic_name));}
if(this.edit){this.$('.post-field').text(this.edit.get('message'));}
_.defer(_.bind(function(){this.$("label").inFieldLabels();},this));return this;},submitPost:function(){var title=$.trim(this.$('.title-field').val());var message=$.trim(this.$('.post-field').val());if(title.length===0){console.log(this.$('.title-field'),'title cannot be empty');return;}
this.$('input, textarea, .submit-post').attr('disabled','disabled');if(this.edit){var selected_val=this.$('.skill-list').val();var topic_id=this.$('.skill-list [value="'+selected_val+'"]').data('topic');if(!topic_id)
topic_id=this.selected;this.edit.save({title:title,message:message,topic_id:topic_id},{success:this.success});}else{var comment=new duo.Comment({title:title,message:message,type:this.type});var topic=this.$('.skill-list').val();if(topic.indexOf('skill-')===0){var skill_id=topic.substring(6);var topic_id=this.$('.skill-list [value="'+topic+'"]').data('topic');comment.url='/skills/'+skill_id+'/comments';comment.set({topic_id:topic_id});}else{comment.set({topic_id:topic});}
comment.save(null,{success:this.success});mixpanel.track("Questions Post",{type:this.type});this.$('#posted-label').show().delay(3000).fadeOut(1000);this.render();}},onTopic:function(){var selected_val=this.$('.skill-list').val();var topic_name=this.$('.skill-list [value="'+selected_val+'"]').data('name');this.$('.topic').text(translate_text(topic_name));}});duo.CommentModalView=Backbone.View.extend({template:duo.templates['discussion-page'],events:{'click #post-text-box':'focusReplyBox','click .cancel-update-comment':'cancelUpdate','click #post-comment':'reply','click #show-discussion':'showDiscussion','click #watch':'toggleWatch','click #show-toggle':'showHiddenComments'},initialize:function(options){this.model.bind('change',this.onChange,this);this.correct=options.correct;this.modal_shown=true;this.has_hidden=false;this.ui_language=options.ui_language;this.learning_language=options.learning_language;this.document_sentence_discussion=options.document_sentence_discussion||false;duo.topbar.bind('navigate',this.cleanUp,this);},render:function(){var self=this;if(this.model.get('comment'))
{this.view=new duo.CommentView({model:this.model.get('comment'),el:this.$('discussion-modal')});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{correct:this.correct,comments:this.model.get('comment').get('comments').toJSON(),got_related:this.model.has('related')&&this.model.get('related').length>0,num_followers:this.model.has('followers')?this.model.get('followers').length:0,logged_in_user:duo.user?{id:duo.user.id,username:duo.user.get('username'),avatar:duo.user.get('avatar')}:null,num_comments:this.model.get('comment').get('num_comments'),num_hidden:this.model.get('comment').get('num_hidden'),show_badges:true}),duo.templates));this.model.get('comment').get('comments').each(function(comment){var comment_view=new duo.NestedCommentView({model:comment,el:this.$('#comment-'+comment.id)});if(comment.get('hidden'))
{this.$('#comment-'+comment.id).addClass("hidden-comment");this.$('#comment-'+comment.id).hide();this.has_hidden=true;this.num_hidden+=1;}
comment_view.render();},this);if(this.has_hidden==false)
{this.$('#show-toggle').hide();}
var follow_tag=(this.model.get('comment').get('watching'))?'Following Discussion':'Follow Discussion';if(this.model.get('comment').get('watching'))
this.$('#watch').addClass("success");this.$('#watch').attr('value',follow_tag);this.model.get('comment').unbind();this.model.get('comment').bind('change',this.onChange,this);}
else
{$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{correct:this.correct,logged_in_user:duo.user?{id:duo.user.id,username:duo.user.get('username'),avatar:duo.user.get('avatar')}:null,show_badges:true}),duo.templates));}
if(this.document_sentence_discussion){this.$('#discussion-modal').show();}else{this.$('#discussion-modal').modal({backdrop:true,show:this.modal_shown}).on('hidden',function(){self.modal_shown=false;}).delegate('.medium-circular-avatar, .username','click',function(e){$(this).closest('.modal').modal('hide');});}
_.defer(function(){self.$("label").inFieldLabels();});var language=this.learning_language;if(this.model.get('sentence_language')==this.learning_language){this.$('.title').hints({templates:duo.templates,source_language:this.learning_language,target_language:this.ui_language,top:35});var tts_id=this.model.get('sentence_id');}else{this.$('.trans').hints({templates:duo.templates,source_language:this.learning_language,target_language:this.ui_language,top:15});var tts_id=this.model.get('translation_id');}
_.defer(function(){self.$('.listen-button-small').tts({absoluteURL:_ttsURL+language+'/sentence/'+tts_id,template:duo.templates['speaker'],visible:false,autoplay:false,click:true});});return this;},focusReplyBox:function(){this.$('.comment-box').autosize({append:"\n"});this.$('#post-button').fadeIn(500);if(!this.document_sentence_discussion){this.$('.player-discuss-guide').fadeIn(500);}},reply:function(){var message=$.trim(this.$('#post-text-box').val());if(message.length>0){this.$('#post, #post-comment').attr('disabled','disabled');if(this.model.get('comment')){this.model.get('comment').unbind();}
this.model.addComment(message,this.ui_language,this.learning_language);}},cancelUpdate:function(){this.$('#post-button').fadeOut(500);this.$('#post-text-box').val('');this.$('.player-discuss-guide').fadeOut(500);return false;},showDiscussion:function(){this.$('#discussion-modal').modal('show');this.modal_shown=true;},onChange:function(){this.$('#discussion-modal').modal('hide');this.modal_shown=true;this.render();},toggleWatch:function(){if(this.model.get('comment').get('watching'))
{this.model.get('comment').unwatch();this.$('#watch').removeClass("success");this.$('#watch').attr('value','Follow Discussion');}
else
{this.model.get('comment').watch();this.$('#watch').addClass("success");this.$('#watch').attr('value','Following Discussion');}},cleanUp:function(){duo.topbar.unbind('navigate',this.cleanUp,this);this.$('#discussion-modal').modal('hide');},showHiddenComments:function(e){var hidden_comments=this.$('.first-reply > .hidden-comment').fadeIn(400);hidden_comments.find('.hidden-comment').show();hidden_comments.find('.show-toggle').hide();this.$('#show-toggle').hide();e.stopPropagation();return false;}});duo.Translation=Backbone.Model.extend({urlRoot:'/translations',parse:function(data){if('sentences'in data){data.sentences=new duo.DocumentSentenceList(duo.DocumentSentenceList.prototype.parse(data.sentences));data.comments=new duo.TranslationCommentList(duo.TranslationCommentList.prototype.parse.call(this,data.comments));data.comments.translation_id=this.id||data.id;}
data.clickable=(data.target_language==duo.user.get('ui_language'));return data;}});duo.TranslationsOverview=Backbone.Model.extend({url:'/translations',parse:function(data){if(data.translations){var ranked_translations=new duo.RankedTranslationList();ranked_translations.reset(duo.RankedTranslationList.prototype.parse.call(ranked_translations,data.translations));ranked_translations.page=1;ranked_translations.sort='hot';ranked_translations.category=data.category;ranked_translations.more=data.more;data.translations=ranked_translations; data.recent_translations=new duo.RankedTranslationList([],{sort:'date',category:data.category,more:true}); data.history_translations=new duo.RankedTranslationList([],{sort:'history',category:data.category,more:true}); data.draft_translations=new duo.RankedTranslationList([],{sort:'hot',category:data.category,draft:true,more:true}); data.uploaded_translations=new duo.RankedTranslationList([],{sort:'uploaded',category:data.category,more:true});}
return data;}});duo.RankedTranslationList=Backbone.Collection.extend({url:'/ranked_translations',model:duo.Translation,initialize:function(models,options){if(!options)
return;this.category=options.category;this.sort=options.sort||'hot';this.draft=options.draft||undefined;this.more=options.more||true;},fetch:function(options){options=options||{};options.data=options.data||{};options.data.sort=this.sort;options.data.category=this.category;options.data.draft=this.draft;Backbone.Collection.prototype.fetch.call(this,options);},parse:function(data){this.page=data.page;this.more=data.more;return _.map(data.data,function(translation){return duo.Translation.prototype.parse.call(this,translation);});}});duo.WikiTranslation=Backbone.Model.extend({urlRoot:'/wiki_translations',reportUserFinishedTranslation:function(callback){if(this.get('user_finished_translation'))
return;var url='/wiki_translation/'+this.get('translation_id')+'/user_finished_translation';var self=this;$.post(url,{},function(data){self.set('user_finished_translation',true);callback(data.num_points_awarded,data.level_event);});}});duo.CurrentWikiTranslation=Backbone.Model.extend({url:function(){var ui_language=duo.browser_language;if(duo.user)
ui_language=duo.user.get('ui_language');return'/wiki_translations/'+this.get('id')+'/'+ui_language+'/cur_translation';}});duo.WikiDocumentSentence=Backbone.Model.extend({addRevision:function(revised_translation,explanation,callback){var self=this;var url='/wiki_translation_sentence/'+this.get('translation_id')+'/'+this.get('document_sentence_id')+'/add_revision';var args={translation:revised_translation};if(explanation)
args['explanation']=explanation;$.post(url,args,function(data){self.set(data);callback(data.rejected,data.num_points_awarded,data.level_event);});}, rateCurrentTranslation:function(rating,undo,callback){var self=this;var url=('/wiki_translation_sentence/'+this.get('translation_id')+'/'+
this.get('document_sentence_id')+'/'+this.get('cur_sent_trans_id')+'/rate');$.post(url,{rating:rating,undo:undo},function(data){var new_rating=undo?0:rating;self.set({user_approved:new_rating==1,user_disapproved:new_rating==-1});callback(data.num_points_awarded,data.level_event,data.vote_sum);});},toggleTranslationApproval:function(callback){var undo=this.get('user_approved')==true;this.rateCurrentTranslation(1,undo,callback);}});duo.WikiDocumentSentenceRevisionHistory=Backbone.Model.extend({url:function(){var u='/wiki_translation_sentence/'+this.get('translation_id')+'/'+this.get('document_sentence_id')+'/get_revisions';return u;},follow:function(callback){this.followOrUnfollow(callback,true);},unfollow:function(callback){this.followOrUnfollow(callback,false);},followOrUnfollow:function(callback,follow){var self=this;var url='/wiki_translation_sentence/'+this.get('translation_id')+'/'+this.get('document_sentence_id');if(follow){url=url+'/follow';}else{url=url+'/unfollow';}
$.post(url,{},function(result){callback(result.success);if(result.success){self.set('following',follow);}else{alert('Back-end failed.  Please try again later.');}});}});duo.WikiDocumentSentenceRevision=Backbone.Model.extend({});duo.WikiDocumentSentenceComments=Backbone.Model.extend({url:function(){var u='/wiki_translation_sentence/'+this.get('translation_id')+'/'+this.get('document_sentence_id')+'/get_comments';return u;},parse:function(data){if('comment'in data){var comment=new duo.Comment();comment.set(comment.parse(data.comment));data.comment=comment;}
return data;},addComment:function(message,ui_language,learning_language){var self=this;var data={translation_id:this.get('translation_id'),document_sentence_id:this.get('document_sentence_id'),message:message};$.post('/wiki_translation_sentence/add_comment',data,function(stuff){self.fetch({});});}});duo.WikiDocumentSentenceComments2=Backbone.Model.extend({url:function(){var u='/wiki_translation_sentence/'+this.get('translation_id')+'/'+this.get('document_sentence_id')+'/get_comments';return u;},addComment:function(message,callback){var self=this;var data={translation_id:this.get('translation_id'),document_sentence_id:this.get('document_sentence_id'),message:message};$.post('/wiki_translation_sentence/add_comment',data,function(stuff){self.fetch({success:function(data){callback();}});});}});$(function($){duo.connectToFacebook=function(callback,context){var auth_response=FB.getAuthResponse();var args=_.toArray(arguments).slice(2)
if(auth_response){args.splice(0,0,auth_response);callback.apply(context,args);}else{FB.login(function(login_response){if(login_response.authResponse){args.splice(0,0,login_response.authResponse);callback.apply(context,args);}},{scope:'email,publish_actions'});}};duo.postFacebookAction=function(ns,action,options){FB.api('/me/'+ns+':'+action,'post',options,function(response){if(!response||response.error){console.log('error posting open graph action');}else{console.log(response.id);}});};duo.hookupTwitter=function(button_selector,callback,context){if(window.twttr){twttr.anywhere(function(T){if(T.isConnected()){var user=T.currentUser;$(button_selector).click(function(){$.post('/login_with_twitter',function(data){if(data.response==='OK'){console.debug('logged in',window.location.hash);window.location.reload(true);}else{callback.call(context,user);}},'json');});}else{$(button_selector).click(function(){T.signIn();});T.bind("authComplete",function(e,user){$.post('/login_with_twitter',function(data){if(data.response==='OK'){console.debug('logged in',window.location.hash);window.location.reload(true);}else{callback.call(context,user);}},'json');});}});}};duo.scrollToElement=function(ele,duration,callback){try{var old_y=Math.max($('html').scrollTop(),$('body').scrollTop());var new_y=Math.max(0,ele.offset().top+ele.height()/2-$(window).height()/2);duration=duration||Math.min(1500,Math.abs(new_y-old_y)*1.8);$('html, body').stop().animate({scrollTop:new_y},duration,callback);}catch(e){}}
duo.formatTime=function(num,t,m){var lang=duo.user.get('ui_language');if(lang=='pt'||lang=='fr'){return num+":00";}else{return t+m;}}
duo.generatePracticeTimes=function(notify_time){var times=_.map(_.range(24),function(num){var m=num<12?'am':'pm';var t=num%12;var offset=num*60;if(t===0){t=12;}
return{offset:offset,time:duo.user&&duo.formatTime(num,t,m),selected:offset==notify_time}});return times;}
duo.wordStrengthData=function(strength){var data={};strength=Math.round(strength*4);data.strength_s=strength>1;data.strength_m=strength>2;data.strength_l=strength>3;if(data.strength_l)data.blink_l=true;else if(data.strength_m)data.blink_m=true;else if(data.strength_s)data.blink_s=true;else data.blink_0=true;return data;}
var _email_patt=/^([a-zA-Z0-9_\+\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;duo.isEmail=function(email){return _email_patt.test(email);}
var _username_patt=/^([a-zA-Z0-9_\.\-])+$/;duo.isUsername=function(username){if(username.length<3||username.length>16){return false;}
return _username_patt.test(username);}
duo.isPassword=function(password){return password.length>=6;}
$(document).ready(function(){$('body').on('click','[data-toggle="facebook-share"]',function(e){if(!window.FB){return;}
var button=$(e.currentTarget);var post_data={name:button.data('name'),description:button.data('description'),caption:button.data('caption')};mixpanel.track('facebook share click');duo.connectToFacebook(postToFacebook,this,post_data);});$('body').on('click','[data-toggle="facebook-invite"]',function(e){if(!window.FB){return;}
var button=$(e.currentTarget);var fb_id=button.data('user');mixpanel.track('facebook invite click',{from:button.data('trackFrom')});FB.ui({method:'send',link:'http://duolingo.com/#/register?ib='+duo.user.id,to:fb_id,name:button.data('name'),description:button.data('description'),picture:'http://static.duolingo.com/images/facebook/owl.png'},function(response){if(response){mixpanel.track('facebook invited');button.attr('disabled','disabled').text(button.data('sent'));}});});$('body').on('click','[data-toggle="tweet"]',function(e){var width=575,height=400,left=($(window).width()-width)/2,top=($(window).height()-height)/2,url=this.href,$this=$(this),opts='status=1'+',width='+width+',height='+height+',top='+top+',left='+left;var params={};if($this.data('text')){params.text=$this.data('text');}
if($this.data('url')){params.url=$this.data('url');}
if($this.data('via')){params.via=$this.data('via');}
console.log(url+'?'+$.param(params));window.open(url+'?'+$.param(params),'twitter',opts);return false;});$('body').on('mouseenter','[data-toggle="popover"]',function(e){var anchor=$(e.currentTarget);var popover=$(anchor.data('popover'));hoverIn(anchor,popover);}).on('mouseleave','[data-toggle="popover"]',function(e){var anchor=$(e.currentTarget);var popover=$(anchor.data('popover'));hoverOut(popover);});$('body').on('click','[data-toggle="follow"]',function(e){var button=$(e.currentTarget);var user_id=button.data('user');if(button.hasClass('success')){duo.user.unfollow(user_id,button.data('silent'));button.removeClass('success').text(button.data('followText'));if(button.data('followClass')){button.addClass(button.data('followClass'));}
if(button.data('unfollowClass')){button.removeClass(button.data('unfollowClass'));}}else{duo.user.follow(user_id,button.data('silent'));button.addClass('success').text(button.data('unfollowText'));if(button.data('followClass')){button.removeClass(button.data('followClass'));}
if(button.data('unfollowClass')){button.addClass(button.data('unfollowClass'));}}});$('body').on('click','[data-toggle="tab"]',function(e){var button=$(e.currentTarget);var tab=$(button.data('selector'));$('[data-group="'+button.data('group')+'"]').each(function(){$(this).removeClass('active');$($(this).data('selector')).hide();});tab.show();button.addClass('active');});});function postToFacebook(authResponse,post_data){var access_token=authResponse.accessToken;FB.api('/me?access_token='+access_token,function(data){var first_name=data.first_name;var options={method:'feed',picture:'http://static.duolingo.com/images/facebook/owl.png',access_token:access_token,name:post_data.name.replace('%firstname%',first_name),link:'http://www.duolingo.com/',caption:post_data.caption.replace('%firstname%',first_name),description:post_data.description.replace('%firstname%',first_name)};console.log(options);try{$(document).scrollTop(0);}catch(e){}
FB.ui(options,function(response){if(response&&response.post_id){mixpanel.track('facebook shared');}});});}
function positionPopover(anchor,popover){if(!anchor.offset()||(anchor.offset().left==0&&anchor.offset().top==0&&anchor.width()==0&&anchor.height()==0)){return false;}
var placement=anchor.data('placement')||'right';var margin=anchor.data('margin')||0;popover.anchor({type:placement,anchor:anchor,margin:margin,container:$('#app')});var justification=anchor.data('justification')||'center';if(justification=='left'){popover.css('left',anchor.position().left);}
var x_offset=parseInt(anchor.data('x-offset')||'0');popover.css('left',parseInt(popover.css('left'))+x_offset);return true;}
function hoverIn(anchor,popover){if(positionPopover(anchor,popover))
popover.show();}
function hoverOut(popover){popover.hide();}
duo.validateEmail=function(email){var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email);}
duo.showIntroVideo=function(language){var VIDEO_IDS={'en':'WyzJ2Qq9Abs','es':'SMQLhoZ8yys','pt':'0ADEBEzPGB4','it':'6ZwGhFhPp6o','fr':'4rXv89pD_lc'};$.fancybox({'padding':0,'autoScale':false,'transitionIn':'none','transitionOut':'none','width':680,'height':495,'href':'http://www.youtube.com/v/'+VIDEO_IDS[language]+'?rel=0&feature=player_embedded','type':'swf','swf':{'wmode':'transparent','allowfullscreen':'true'}});}}(window.jQuery));(function($){duo.RedditTranslationsView=Backbone.View.extend({id:'app',template:duo.templates['translations-ranked'],events:{'click .translate-main .tabs li':'switchTab','click #show-all-categories':'showAllCategories','click .watch-video':'watchVideo','click #upload-document':'uploadDocument'},initialize:function(){this.model.bind('change',this.render,this);},render:function(){var self=this;var some_category_active=false;_.each(this.model.get('categories'),function(category,i){if(i>9){category.hidden=true;}
if(category.id==self.model.get('category')){category.active=true;some_category_active=true;}});if(!some_category_active){this.model.set({'all-active':true});}
this.show_all_categories=this.show_all_categories||this.model.get('categories').length<10;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{show_all:this.show_all_categories}),duo.templates));this.top_translations=new duo.RankedTranslationsView({el:this.$('#top-tab'),collection:this.model.get('translations'),category_label:this.model.get('category_label')});this.top_translations.render();this.recent_translations=new duo.RankedTranslationsView({el:this.$('#recent-tab'),collection:this.model.get('recent_translations'),category_label:this.model.get('category_label')});this.history_translations=new duo.RankedTranslationsView({el:this.$('#history-tab'),collection:this.model.get('history_translations'),category_label:this.model.get('category_label'),history:true});this.draft_translations=new duo.RankedTranslationsView({el:this.$('#draft-tab'),collection:this.model.get('draft_translations'),category_label:this.model.get('category_label'),draft:true});if(this.$('#uploaded-tab').size()==1){this.uploaded_translations=new duo.RankedTranslationsView({el:this.$('#uploaded-tab'),collection:this.model.get('uploaded_translations'),category_label:this.model.get('category_label'),uploaded:true});}
return this;},switchTab:function(e){var tab=$(e.currentTarget);var tab_name=tab.data('tab');var tab_panel=this.$('#'+tab_name+'-tab');this.$('.panel').hide();tab_panel.show();this.$('.translate-main .tabs li').removeClass('active');tab.addClass('active'); if(tab_name!=='top'&&this.model.get(tab_name+'_translations').length===0){this.model.get(tab_name+'_translations').fetch({data:{per_page:10}});}else{this[tab_name+'_translations'].render();}},showAllCategories:function(){this.$('#categories li').show();this.show_all_categories=true;this.$('#show-all-categories').remove();},watchVideo:function(){var lang=duo.user.get('ui_language');duo.showIntroVideo(lang);},uploadDocument:function(){if(!this.upload){this.upload=new duo.TranslationUploadView({el:this.$('#translation-upload'),model:new Backbone.Model()});this.upload.render();}
this.$('#translation-tabs').hide();this.$('#translation-upload').show();this.$('#upload-url').focus();}});duo.RankedTranslationsView=Backbone.View.extend({template:duo.templates['translations-ranked-list'],initialize:function(options){this.collection=options.collection;this.category_label=options.category_label;this.history=options.history;this.uploaded=options.uploaded;this.draft=(options.draft==true);this.collection.bind('reset',this.render,this);this.collection.bind('add',this.addOne,this);},render:function(){$(this.el).html($.duostache(this.template,{translations:this.collection.toJSON(),category_label:this.category_label,more:this.collection.more,history:this.history,draft:this.draft},duo.templates));this.collection.each(this.addOne,this);this.last_request_length=0;var self=this;$(document).unbind('.translations.infinite_scroll').bind('scroll.translations.infinite_scroll',function(e){var total_height=$(document).height();var view_height=total_height-$(document).scrollTop();var visible_height=$(window).height();if(view_height<1.5*visible_height&&self.collection.length>self.last_request_length){self.last_request_length=self.collection.length;self.loadMore();}});return this;},addOne:function(translation,collection,options){var view=new duo.RankedTranslationView({model:translation,draft:this.draft});this.$('.ranked-translations').append(view.render().el);},loadMore:function(data){var self=this;data=data||{};data=_.extend(data,{page:this.collection.page+1,per_page:10});this.collection.fetch({data:data,update:true,remove:false,success:function(collection,data){if(!data.more){self.$('.translation-spinner').remove();}}});}});duo.RankedTranslationView=Backbone.View.extend({tagName:'li',template:duo.templates['translations-ranked-item'],events:{'click .vote-down':'voteDown','click .vote-up':'voteUp'},initialize:function(options){this.model.bind('change',this.render,this);this.draft=options.draft;},render:function(){var json=_.extend(this.model.toJSON(),{draft:this.draft});$(this.el).html($.duostache(this.template,json,duo.templates));var sentence_pie_colors=['#c0cad4','rgba(255, 255, 255, 0.0)'];var self=this;_.defer(function(){self.$('.sentence-pie').pie({colors:sentence_pie_colors});if(json.translated_title!=undefined){var model=new duo.WikiDocumentSentence(_.extend(json.translated_title,{can_be_edited:false}));var popover_contents=self.$('#title-popover-contents-'+self.model.id);var popover_view=new duo.WikiDocumentSentencePopoverView({el:popover_contents,model:model});popover_view.render();var sentence_element=self.$('#title-text-'+self.model.id);var sentence_view=new duo.WikiDocumentSentenceView({el:sentence_element,model:model,popover_view:popover_view});sentence_view.render();}});return this;},throttledRateDocument:function(rating,e){if((rating==1&&this.model.get('user_upvoted'))||(rating==-1&&this.model.get('user_downvoted'))){rating=0;}
var self=this;$.post('/documents/'+this.model.get('document').id+'/rate',{rating:rating},function(data){self.model.set({votes:data.votes,user_upvoted:rating===1,user_downvoted:rating===-1});});mixpanel.track('rate document',{rating:rating});},voteUp:function(e){this.throttledRateDocument(1,e);},voteDown:function(e){this.throttledRateDocument(-1,e);}});duo.TranslationUploadView=Backbone.View.extend({template:duo.templates['translation-upload'],events:{'click #preview':'clickPreview','keypress #upload-url':'handleKeyPress','click #cancel-upload':'clickCancel','click #submit-upload':'clickSubmit','change #category':'updateProperties','change #language':'updateProperties','input #upload-url':'updateProperties'},render:function(){var json=this.model.toJSON();$(this.el).html($.duostache(this.template,json,duo.templates));this.updateProperties();},clickPreview:function(){if(this.$('#preview').attr('disabled'))
return;var self=this;var generating_preview=self.$('#generating-preview');generating_preview.show();var url=$.trim(this.$('#upload-url').val());self.$('#upload-preview').hide();$.post('/translate_jobs/preview',{url:url},function(data){generating_preview.hide();self.model.clear().set(data);self.render();});},handleKeyPress:function(e){if(e.which==13){e.preventDefault();this.clickPreview();}else{this.updateProperties();}},clickCancel:function(){if(this.$('#cancel-upload').attr('disabled'))
return;$('#translation-upload').hide();$('#translation-tabs').show();this.model.clear();this.render();},clickSubmit:function(){if(this.$('#submit-upload').attr('disabled'))
return;var translateJob=new duo.TranslateJob({url:this.model.get('document_url'),target_language:this.$('#language').val(),category:this.$('#category').val()});var self=this;this.$('#uploading').show();this.setEnabled('#preview',false);this.setEnabled('#cancel-upload',false);this.setEnabled('#submit-upload',false);translateJob.save(null,{success:function(model,response){if(!translateJob.get('failed')){self.$('#uploading').hide();self.$('#upload-success').show();duo.translationRouter.navigate('/translation/'+response.translation_id,true)}else{self.model.set({'upload_failed':true,'upload_failure_reason':translateJob.get('failure_reason')});self.render();}}});},updateProperties:function(){var category=this.$('#category');var language=this.$('#language');var upload_enabled=category.val()!='None'&&language.val()!='None';this.setEnabled('#submit-upload',upload_enabled);var url=$.trim(this.$('#upload-url').val());if(this.model.get('preview_failed')==true&&this.model.get('document_url')==url){this.$('#preview-failed').show();}else{this.$('#preview-failed').hide();}
var failed=this.model.get('preview_failed')==true||this.model.get('upload_failed')==true;this.$('#upload-url').toggleClass('error',failed&&this.model.get('document_url')==url);var show_preview=!failed&&this.model.get('document_url')==url;if(show_preview){this.$('#upload-preview').show();this.$('#upload-choose-category').show();this.$('#upload-choose-language').show();}else{this.$('#upload-preview').hide();this.$('#upload-choose-category').hide();this.$('#upload-choose-language').hide();this.model.set('document_url',null);}
if(this.model.get('upload_failed')){this.$('#upload-failure').show();}
this.setEnabled('#preview',url.length>0&&url!=this.model.get('document_url'));},setEnabled:function(selector,enabled){if(enabled){this.$(selector).removeAttr('disabled');}else{this.$(selector).attr('disabled','disabled');}}});duo.WikiTranslationProgressView=Backbone.View.extend({id:undefined,template:duo.templates['wiki-translation-progress'],initialize:function(){this.model.bind('change:num_sentences_left',this.render,this);this.model.bind('change:user_finished_translation',this.finishDocumentFanfare,this);},render:function(){var done=this.model.get('user_finished_translation')==true;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{done:done}),duo.templates));var frac_done=1.0;if(!done){var num_left=this.model.get('num_sentences_left');frac_done=1.0-num_left*1.0/this.model.get('num_sentences');}
if(frac_done<=0.0){this.$('.done').hide();}else{this.$('.done').show();this.$('.done').width(100.0*frac_done+'%');}
if(done){this.$('#coin-goal-met').show();}else{this.$('#coin-goal-met').hide();}},finishDocumentFanfare:function(){this.render();this.$('#coin-goal-met').addClass('bounceIn');$('#finish-owl').removeClass("hidden").addClass("rotateInDownLeft");$('#message-not-done').addClass("fadeOutDown");$('#message-done').removeClass("hidden").addClass("fadeInDown");}});duo.WikiTranslationView=Backbone.View.extend({id:'app',template:duo.templates['wiki-translation'],events:{'click .wiki-paragraph':'clickParagraph','mouseenter .sentence-wrapper':'hoverSentenceHandler','mouseleave .wiki-paragraph':'unhoverParagraph','click .rate-option':'rateDocument','click #report-inappropriate':'reportInappropriate','click #cancel-report-inappropriate':'cancelReportInappropriate','click #report-inappropriate-reason':'reportInappropriateReason','click #disable-translation':'disableTranslation','click #enable-translation':'enableTranslation','click #load-more-sentences':'renderMoreSentences'},initialize:function(options){this.model.bind('change:document_vote_sum',this.renderVotes,this);this.click_to_reveal=duo.user.get('ab_options').translation_popover_click_experiment;},render:function(){var self=this;var json=this.model.toJSON();$(this.el).html($.duostache(this.template,json,duo.templates));var header_view=new duo.WikiTranslationProgressView({model:this.model,el:this.$('#wiki-progress-bar')});header_view.render();popover_views=new Array();this.sentence_models=new Array();this.cur_paragraph_index=0;this.cur_sentence_index=0;self.renderMoreSentences();if(this.model.get('user_document_rating')!==null){this.$('.rate-option[data-rating="'+this.model.get('user_document_rating')+'"]').addClass('active');}
this.$(".fbox").fancybox({'prevEffect':null,'nextEffect':null});this.$('.modal').modal({keyboard:true,backdrop:true,show:false});this.$('img').bind('load',function(){_.each(popover_views,function(view){view.reposition();});});this.$('#coin-count').text(this.model.get('user_num_points'));var self=this;$(document).unbind('.translation.infinite_scroll').bind('scroll.translation.infinite_scroll',function(e){var total_height=$(document).height();var view_height=total_height-$(document).scrollTop();var visible_height=$(window).height();if(visible_height>0.3*view_height){self.renderMoreSentences();}});return this;},renderMoreSentences:function(){if(this.more_sentences_to_render==false){return;}
var json=this.model.toJSON();var num_rendered=0;for(;this.cur_paragraph_index<json.document_paragraphs.length;this.cur_paragraph_index++){var paragraph=json.document_paragraphs[this.cur_paragraph_index];for(;this.cur_sentence_index<paragraph.sentences.length;this.cur_sentence_index++){var sentence=paragraph.sentences[this.cur_sentence_index];var opt=_.extend(sentence,{translation_id:json.translation_id,source_language:json.source_language,target_language:json.target_language,can_be_edited:true,hovered:false,translation_revealed:false});var sentence_model=new duo.WikiDocumentSentence(opt);this.sentence_models.push(sentence_model);this.renderSentence(sentence_model);num_rendered+=1;if(num_rendered==50){this.cur_sentence_index++;return;}}
this.cur_sentence_index=0;}
this.more_sentences_to_render=false;this.$('#load-more-sentences').remove();},renderSentence:function(sentence_model){var i=sentence_model.get('index');var element=this.$('#session-'+i);var revisions_element=this.$('#revisions-'+i);var comments_element=this.$('#comments-'+i);var popover_element=this.$('#popover-'+i);var sentence_wrapper=this.$('#sentence-wrapper-'+i);var popover_view=new duo.WikiDocumentSentencePopoverView({model:sentence_model,el:element,parent_view:this,popover_element:popover_element,revisions_element:revisions_element,comments_element:comments_element});popover_views.push(popover_view);var sentence_view=new duo.WikiDocumentSentenceView({model:sentence_model,popover_view:popover_view,parent_view:this,el:sentence_wrapper});sentence_view.render();var self=this;sentence_model.bind('change:cur_translation',function(){self.handleTranslationSubmitted(i);});var comments_model=popover_view.comments_model;comments_model.bind('change',function(){var num_comments=comments_model.get('comment').get('num_comments');sentence_model.set('num_comments',num_comments);});},renderVotes:function(){this.$('.vote-count').text(this.model.get('document_vote_sum'));},clickParagraph:function(e){var i=this.hoveredSentenceIndex();if(i!=-1){this.clickSentence(i);}},clickSentence:function(index){if(this.editableSentenceIndex()!=-1)
return;var first_non_translated=this.model.get('first_non_translated');if(index>first_non_translated)
return false;if(this.click_to_reveal){if(!this.translationRevealed(index)){this.setTranslationRevealed(index);}else{this.setTranslationRevealed(-1);}}else{this.sentence_models[index].set('editable',true);}},hoverSentenceHandler:function(e){if(this.click_to_reveal)
return;var scrollTop=$(window).scrollTop();var wikiHeader=$('.wiki-header')[0];if($(e.currentTarget)[0].offsetTop-scrollTop+70<wikiHeader.offsetTop+wikiHeader.offsetHeight){return false;}
var index=$(e.currentTarget).data('index');this.hoverSentence(index);},hoverSentence:function(index){if(this.sentence_models[index].get('hovered')||this.editableSentenceIndex()!=-1)
return false;var first_non_translated=this.model.get('first_non_translated');if(index>first_non_translated)
return false;this.positionPopover(index);this.setHovered(index);},hoveredSentenceIndex:function(){for(var i=0;i<this.sentence_models.length;i++){if(this.sentence_models[i].get('hovered')==true)
return i;}
return-1;},translationRevealed:function(index){if(this.click_to_reveal)
return this.sentence_models[index].get('translation_revealed')==true;else
return this.sentence_models[index].get('hovered')==true;},editableSentenceIndex:function(){for(var i=0;i<this.sentence_models.length;i++){if(this.sentence_models[i].get('editable')==true)
return i;}
return-1;},setHovered:function(index){for(var i=0;i<this.sentence_models.length;i++)
this.sentence_models[i].set('hovered',i==index);},setTranslationRevealed:function(index){for(var i=0;i<this.sentence_models.length;i++)
this.sentence_models[i].set('translation_revealed',i==index);},unhoverParagraph:function(e){if(this.editableSentenceIndex()==-1){this.setHovered(-1);}},positionPopover:function(index){var popover_element=this.$('#popover-'+index);var v_anchor=this.$(popover_element.data('anchor'));if(v_anchor.size()==0)
return;var margin=popover_element.data('margin')||0;var h_anchor=v_anchor;var left;if(index==this.model.get('first_non_translated')&&!this.sentence_models[index].get('editable')){left=h_anchor.position().left-15;}else if(index==0){h_anchor=$(this.el);left=(h_anchor.outerWidth()/2)-(popover_element.outerWidth()/2);}else{left=h_anchor.position().left+(h_anchor.outerWidth()/2)-(popover_element.outerWidth()/2);}
popover_element.css({top:v_anchor.position().top-popover_element.outerHeight()-margin,left:left});},incrementCoinCount:function(coins_delta,level_event){this.model.set('user_num_points',this.model.get('user_num_points')+coins_delta);var count=this.$('#coin-count');if(coins_delta!=0){count.text(this.model.get('user_num_points'));if(coins_delta>0){count.addClass('bounce');_.delay(function(){count.removeClass('bounce');},1000);}} 
if(level_event&&level_event.status=='leveled'){Backbone.history.once('route',function(){this.model.set('level_event',level_event);var awesome_view=new duo.SlideSessionAwesomeView({model:this.model});awesome_view.render();awesome_view.$el.appendTo('body').modal({keyboard:true,backdrop:true,show:true}).on('hidden',function(){this.remove();});$('#awesome-modal').modal('show');},this);}
else if(level_event&&level_event.status=='unleveled'){Backbone.history.unbind('route');}},incrementNumSentencesDone:function(num_sentences_done){var old_num_sentences_left=this.model.get('num_sentences_left');var new_num_sentences_left=old_num_sentences_left-num_sentences_done;this.model.set('num_sentences_left',new_num_sentences_left);if(new_num_sentences_left==0&&!this.model.get('user_finished_translation')){var self=this;this.model.reportUserFinishedTranslation(function(num_points_awarded,level_event){self.incrementCoinCount(num_points_awarded,level_event);});}},rateDocument:function(e){e.stopPropagation();var element=$(e.currentTarget);var rating=element.data('rating');if(rating==this.model.get('user_document_rating')){rating=0;}
var self=this;$.post('/documents/'+this.model.get('document_id')+'/rate',{rating:rating},function(data){self.model.set({document_vote_sum:data.votes});},"json");this.$('.rate-option').removeClass('active');if(rating!=0)
element.addClass('active');this.model.set({user_document_rating:rating});mixpanel.track('rate document',{rating:rating});},reportInappropriate:function(e){this.$('#flag-translation-reason-modal').modal('show');},cancelReportInappropriate:function(e){this.$('#flag-translation-reason-modal').modal('hide');},reportInappropriateReason:function(e){var self=this;var reason=$.trim(this.$('input[type="radio"]:checked').val());var additional_details=$.trim(this.$('#additional-details').val());var info={reason:reason,additional_details:additional_details};$.post('/wiki_translations/'+this.model.get('translation_id')+'/report_inappropriate',info,function(data){self.$('#flag-translation-reason-modal').modal('hide');self.model.set('user_reported_inappropriate',true);self.render();},'json');},disableTranslation:function(e){var self=this;$.post('/wiki_translations/'+this.model.get('translation_id')+'/disable',{},function(data){duo.translationRouter.navigate('/translations',true);});},enableTranslation:function(e){var self=this;$.post('/wiki_translations/'+this.model.get('translation_id')+'/enable',{},function(data){self.model.set('translation_disabled',false);self.render();});},openSentenceView:function(index){this.hoverSentence(index);this.clickSentence(index);},handleTranslationSubmitted:function(index){if(index==this.model.get('first_non_translated')){var i=this.model.get('first_non_translated');while(i<this.sentence_models.length&&this.sentence_models[i].get('cur_translation')){this.sentence_models[i].set('is_first_non_translated',false);i++;}
this.model.set('first_non_translated',i);if(i<this.sentence_models.length){this.sentence_models[i].set('is_first_non_translated',true);}}}});duo.WikiDocumentSentenceView=Backbone.View.extend({id:undefined,template:duo.templates['wiki-document-sentence'],events:{'mouseenter .token':'hoverToken','mouseleave .token':'unhoverToken','click .edit-button':'clickEditButton','click .check-button':'clickCheckButton','click .comment-button':'clickCommentButton','mouseenter .sentence':'hoverSentence'},initialize:function(options){this.model.bind('change:hovered',this.render,this);this.model.bind('change:num_comments',this.render,this);this.model.bind('change',this.updateObjectClasses,this);this.popover_view=options.popover_view;this.parent_view=options.parent_view;this.hovered_token_index=-1;},render:function(){var html=$.duostache(this.template,this.model.toJSON(),duo.templates);$(this.el).html(html);this.updateObjectClasses();if(this.model.get('hovered')==true){var interval=250;if(this.model.get('editable')||this.clickToReveal())
interval=100;this.showHints(interval);}
return this.el;},hoverToken:function(e){var token_index=$(e.currentTarget).data('token-index');if(this.model.get('can_be_edited')==true&&(!this.translationRevealed()||this.model.get('editable')||this.model.get('cur_translation')==null))
return;$(e.currentTarget).addClass('part-of-alignment');this.hovered_token_index=token_index;var alignment=this.getAlignment(token_index);if(alignment.found){this.popover_view.highlightTokenRange(alignment.target_start,alignment.target_end);}else{this.popover_view.unhighlightTokens();}},clickToReveal:function(){return this.parent_view&&this.parent_view.click_to_reveal;},translationRevealed:function(){if(this.clickToReveal())
return this.model.get('translation_revealed')==true;else
return this.model.get('hovered')==true;},isAccessible:function(){return this.model.get('cur_translation')!=null||this.model.get('is_first_non_translated');},unhoverToken:function(e){if(this.model.get('editable'))
return;var token_index=$(e.currentTarget).data('token-index');$(e.currentTarget).removeClass('part-of-alignment');this.hovered_token_index=-1;this.popover_view.unhighlightTokens();},getAlignment:function(token_index){alignment=this.model.get('alignment');if(!alignment){return{found:false};}
for(var i=0;i<alignment.length;++i){var item=alignment[i];source_start=item[0];source_end=item[1];target_start=item[2];target_end=item[3];if(source_start<=token_index&&token_index<source_end){return{source_start:source_start,source_end:source_end,target_start:target_start,target_end:target_end,found:true};}}
return{found:false};},unhighlightTokens:function(){$(this.el).find('.token').removeClass('part-of-alignment');},clickEditButton:function(e){if($(e.currentTarget).attr('disabled')=='disabled'){e.stopPropagation();return false;}
this.model.set('editable',true);e.stopPropagation();},clickCheckButton:function(e){if($(e.currentTarget).attr('disabled')=='disabled'){e.stopPropagation();return false;}
var self=this;this.model.toggleTranslationApproval(function(num_points_awarded,level_event){self.parent_view.incrementCoinCount(num_points_awarded,level_event);var num_sentences_done=1;if(!(self.model.get('user_approved')))
num_sentences_done=-1;self.parent_view.incrementNumSentencesDone(num_sentences_done);});e.stopPropagation();this.model.set({editable:false,hovered:false,translation_revealed:false});},clickCommentButton:function(e){if($(e.currentTarget).attr('disabled')=='disabled'){e.stopPropagation();return false;}
this.popover_view.showComments();e.stopPropagation();},hoverSentence:function(e){if(this.clickToReveal()&&this.parent_view)
this.parent_view.hoverSentence(parseInt(this.model.get('index')));},showHints:function(interval){var margin=15;if(this.model.get('index')==0){margin=35;}
var self=this;
var render_callback=function(){self.updateObjectClasses();}
var hints_option={templates:duo.templates,source_language:this.model.get('source_language'),target_language:this.model.get('target_language'),top:margin,hover_options:{sensitivity:3,interval:interval},render_callback:render_callback};this.$('.sentence').hints(hints_option);},setObjectClass:function(obj,class_name,present){if(present){obj.addClass(class_name);}else{obj.removeClass(class_name);}},updateObjectClasses:function(){var sentence=this.$('.sentence');var first_non_translated=this.model.get('is_first_non_translated');this.setObjectClass(sentence,'first-non-translated',first_non_translated);var non_translated=!this.model.get('cur_translation');this.setObjectClass(sentence,'non-translated',non_translated);this.setObjectClass(sentence,'checked',this.model.get('user_approved'));this.setObjectClass(this.$('.check-button'),'checked',this.model.get('user_approved'));var tip=this.$('.check-button-tool-tip');if(this.model.get('user_approved'))
tip.text(translate_text('Uncheck'));else
tip.text(translate_text('This translation looks good'));if(this.translationRevealed()){this.$('.edit-button').removeAttr('disabled');this.$('.check-button').removeAttr('disabled');this.$('.comment-button').removeAttr('disabled');}else{if(!first_non_translated){this.$('.edit-button').attr('disabled','disabled');this.$('.check-button').attr('disabled','disabled');this.$('.comment-button').attr('disabled','disabled');}}
this.$('.sentence').toggleClass('highlighted',this.model.get('hovered')==true);if(this.hovered_token_index!=-1){var token=this.$('#token_'+this.hovered_token_index);if(!this.model.get('editable')){token.addClass('part-of-alignment');}else{token.removeClass('part-of-alignment');this.hovered_token_index=-1;}}
var edit=this.$('.edit-button');var check=this.$('.check-button');var disable=!this.isAccessible()||(this.clickToReveal()&&!this.translationRevealed());this.enableToolTip(edit,!disable);this.enableToolTip(check,!disable);},enableToolTip:function(obj,enable){if(obj.size()==0)
return;if(!enable){if(!obj.data('original-popover'))
obj.data('original-popover',obj.data('popover'));obj.data('popover','');}else{obj.data('popover',obj.data('original-popover'));}}});duo.CurrentWikiTranslationView=Backbone.View.extend({id:'app',template:duo.templates['current-wiki-translation'],render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));return this;}});})(window.jQuery);(function($){duo.SkillListView=Backbone.View.extend({id:'app',template:duo.templates['skill-list'],events:{'click #follow':'follow','click .modal .follow-button':'toggleFollow','change #notify-practice':'toggleNotifyPractice','keyup #notify-practice':'toggleNotifyPractice','click .biography h3':'toggleBio','click .home-notification .close':'dismissNotification','click .home-notification .dismiss':'dismissNotification','click .modal-trigger':'showRanking','click .tabs li':'switchTab','click .language-choice':'switchLanguage','click #pick-language':'showLanguageChooser','click [data-group="progress"]':'switchProgressTab','focus .post-activity textarea, .post-activity input':'onStreamPost','click .post-activity #stream-post-btn':'makeStreamPost','keyup #stream-post':'enablePosting','input #stream-post':'enablePosting','propertychange #stream-post':'enablePosting','change #practice-notify-time':'changePracticeTime','keyup #practice-notify-time':'changePracticeTime','click .trophy':'showFinishedModal'},initialize:function(){_.bindAll(this,'drawTree');this.model.bind('change',this.render,this);if(duo.user){this.current_user=this.model.id==duo.user.id;if(this.current_user){this.tab='skill-tree';var self=this;$.getJSON('/activity_count',function(data){if(!data){self.$('.counter').remove();}else{self.$('.counter').html(data);}
duo.user.set({new_activities:data},{silent:true});});}else{this.tab='activity';}}},getCalendar:function(){var now=new Date();var start_week=new Date(now.getFullYear(),now.getMonth(),now.getDate(),0,0,0,0);start_week.setDate(now.getDate()-6);var now_day=now.getDay();var weekday_offset=now_day;var signup=new Date(this.model.get('created_dt'));if(signup>start_week){weekday_offset=signup.getDay()-1;} 
var calendar_data=_.chain(this.model.getSkills().calendar).map(function(improvement_data){return{datetime:new Date(improvement_data.datetime),improvement:improvement_data.improvement};}).filter(function(improvement_data){return improvement_data.datetime>start_week;}).groupBy(function(improvement_data){return improvement_data.datetime.getDay();}).value(); _.each(calendar_data,function(improvement_data_list,day,obj){var improvement=_.reduce(improvement_data_list,function(improvement,data){if(data.improvement===null){return improvement+10;}
return improvement+data.improvement;},0);obj[day]=improvement;});var calendar=[]; var today_index=(now_day-weekday_offset+6)%7;for(var i=0;i<7;i++){var day_data={};var date_day=(i+weekday_offset+1)%7;if(date_day===now_day){day_data.state='current';}else if(i<today_index){day_data.state='done';}else{day_data.state='';}
if(date_day in calendar_data){day_data.stack=Math.min(10,Math.ceil(calendar_data[date_day]/10));day_data.points=calendar_data[date_day];}else{day_data.stack=0;day_data.points=0;} 
day_data.day=(date_day+6)%7;calendar.push(day_data);}
return calendar;},generatePracticeTimes:function(){return duo.generatePracticeTimes(this.model.getSkills().notify_time);},getLevelTests:function(){var level_tests=[];if(this.current_user){var skills_data=this.model.getSkills();level_tests=_.filter(skills_data.level_tests,function(level){return level.attempts>0;});}
return level_tests;},findY:function(original_y,level_tests){var y=original_y;for(var i=0;i<level_tests.length;i++){if(original_y>=level_tests[i].level){y++;}}
return y;},zeroFill:function(number,width)
{width-=number.toString().length;if(width>0)
{return new Array(width+(/\./.test(number)?2:1)).join('0')+number;}
return number+"";},buildSkillGrid:function(){ var skills_data=this.model.getSkills();var skill_collection=skills_data.skills;var level_tests=this.getLevelTests();var self=this;var organized=skill_collection.groupBy(function(skill){return self.findY(skill.get('coords_y'),level_tests);});for(var i=0;i<level_tests.length;i++){organized[level_tests[i].level+i]={test_row:true,level:level_tests[i].level,level_test:level_tests[i].index,coords_y:this.findY(level_tests[i].level,level_tests)-1,attempts:level_tests[i].attempts,done:level_tests[i].level<=skills_data.max_tree_level};}
organized=_.toArray(organized);organized=_.sortBy(organized,function(skills){if(skills.test_row){return skills.coords_y;}
return self.findY(skills[0].get('coords_y'),level_tests);});var num_following=this.model.get('num_following');return _.map(organized,function(skills,row_index){if(skills.test_row){return skills;}
var y=skills[0].get('coords_y');return{row:y,columns:_.map(_.range(1,4),function(column){return{column:column,row:y};})};},this);},addOne:function(skill){var coords={x:skill.get('coords_x'),y:skill.get('coords_y'),index:skill.get('index')};var view=new duo.SkillItemView({model:skill,el:this.$('#skill-'+coords.x+'-'+coords.y),current_user:this.current_user});$(view.render().el).addClass('skill-'+coords.index);},render:function(){ timing.start('SkillListView.render()');this.delegateEvents();var skills_data=this.model.getSkills();var skill_collection=skills_data.skills;var now=new Date()
var streak=0;_.each(this.model.get('languages'),function(language_data){language_data.stripped_language_string=language_data.language_string.split(' ')[0];if(language_data.current_learning==true){streak=language_data.streak;}});var basics_title=null;if(skills_data.first_time){basics_title=skill_collection.find(function(skill){return skill.get('name')==='BASICS';}).get('url_title');}
timing.mark('SkillListView MP1'); $(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),skills_data,{rows:this.buildSkillGrid(),current_user:this.current_user,current_user_profile:this.current_user,finished_tree:skill_collection.checkFinished(),following_short:this.model.get('following').slice(-3),followers_short:this.model.get('followers').slice(-3),num_ranked:this.model.get('num_following')+1,next_level:skills_data.level+1,calendar:this.getCalendar(),practice_times:this.generatePracticeTimes(),loading_word_count:!('word_count'in this.model.getSkills()),basics_title:basics_title,chrome_web_app_notification:navigator.userAgent.toLowerCase().indexOf('chrome')>-1&&!(chrome.app.isInstalled),ui_english:this.model.get('ui_language')=='en',streak:streak
}),duo.templates));timing.mark('SkillListView MP2');skill_collection.each(this.addOne,this);timing.mark('SkillListView MP2a');if(this.current_user){if(!this.leader_view){this.leader_view=new duo.LeaderBoard({model:this.model,el:this.$('#ranking')});this.leader_view.render();}else{this.$('#ranking').replaceWith(this.leader_view.el);this.leader_view.delegateEvents();}}
timing.mark('SkillListView MP3');var self=this;this.$('.modal').modal({keyboard:true,backdrop:true,show:false}).bind('hidden',function(){if(self.model.hasChanged('num_followers')||self.model.hasChanged('num_following')){self.model.change();}}).delegate('a.user','click',function(e){$(this).closest('.modal').modal('hide');});timing.mark('SkillListView MP4');if(duo.user){ this.$('#search-box').wordLookup({templates:duo.templates,source_language:duo.user.get('ui_language'),target_language:duo.user.get('learning_language'),id:this.model.get('username'),callback:this.lookedupWord,callback_context:this}); this.$('#stream-post').vkeyboard({language:duo.user.get('learning_language'),placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:false,caps:false});} 
if(!('word_count'in this.model.getSkills())){$.getJSON('/vocabularies/size',{user_id:this.model.id,language:this.model.getSkills().language},function(data){self.$('#word-count').text(data.vocab_size.total);self.model.getSkills().word_count=data.vocab_size.total;});}
var interval_id=window.setInterval("blink()",1000);window.clearInterval(interval_id); if(this.tab){this.switchToTab(this.tab);}else{this.$('.tabs li[data-language="'+this.model.get('learning_language')+'"]').addClass('active');this.$('#skill-tree-panel').show();}
if(this.progress_tab){this.$('[data-selector="'+this.progress_tab+'"]').click();}
timing.stop('SkillListView.render()'); _.defer(this.drawTree);_.defer(function(){if(($('#app').hasClass('home')||($('#app').hasClass('profile')&&!$('#app').hasClass('other-user')))&&self.$('.home-notification').size()>0){$('#app').animate({'margin-top':'57px'},600);self.$('.practice-this .pointer').animate({'top':'200px'},600);self.$('.home-notification').fadeIn();}else if($('#app').hasClass('home')||$('#app').hasClass('profile')){$('#app').animate({'margin-top':'0px'},600);}
self.$('.post-activity label, #invite-box label').inFieldLabels();self.$('.post-activity textarea').autosize(); duo.topbar.bind('navigate',self.cleanUp,self);});return this;},drawTree:function(){timing.start('SkillListView.drawTree()'); var skill_canvas=this.$('#skill-canvas').empty().css({'position':'absolute'});var skill_drawing=Raphael(skill_canvas[0],this.$('#skill-tree-panel').innerWidth(),this.$('#skill-tree-panel').innerHeight()); var max_depth=0;var min_depth=0; var tree_nodes={};var skills_data=this.model.getSkills();var skill_collection=skills_data.skills; var skill_level_representative={};skill_collection.each(function(skill){var coords={x:skill.get('coords_x'),y:skill.get('coords_y'),index:skill.get('index')};var grid_cell=this.$('#skill-'+coords.x+'-'+coords.y+' .skill-box');var cell_position=grid_cell.position();var node_position={left:cell_position.left+grid_cell.outerWidth()/2,top:cell_position.top+grid_cell.outerHeight()/2};tree_nodes[skill.get('title')]={position:node_position,coords_y:skill.get('coords_y'),edges:skill.get('dependencies'),options:{stroke:"#bbbbbb"}};if(coords.y==skills_data.max_tree_level){max_depth=cell_position.top+grid_cell.outerHeight();}
if(coords.y==1){min_depth=cell_position.top;}
if(!(coords.y in skill_level_representative)||(skill_level_representative[coords.y].get('coords_x')>skill.get('coords_x'))){ skill_level_representative[coords.y]=skill;}},this); var min_dy=this.$('.skill-row:first .skill-box').position().top-this.$('.skill-row:eq(1) .skill-box').position().top; _.each(skills_data.level_tests,function(level){var grid_cell=this.$('#big-test-'+level.index);if(grid_cell.size()===0){return;}
var cell_position=grid_cell.position();var node_position={left:cell_position.left+grid_cell.outerWidth()/2,top:cell_position.top+grid_cell.outerHeight()/2};tree_nodes['big-test-'+level.index]={position:node_position,edges:[],options:{stroke:"#bbbbbb"}};_.each(tree_nodes,function(tree_node,skill_title){if(skill_title.indexOf('big-test')===0){ return;}
if(tree_node.coords_y<level.level){ return;}
var dependencies=tree_node.edges;var new_dependencies=[];for(var i=0;i<dependencies.length;i++){if(tree_nodes[dependencies[i]].coords_y<level.level){ tree_nodes['big-test-'+level.index].edges.push(dependencies[i]);new_dependencies.push('big-test-'+level.index);}else{ new_dependencies.push(dependencies[i]);}}
tree_node.edges=new_dependencies;});}); skill_drawing.tree(tree_nodes,min_dy); this.$('.practice-this').css('height',max_depth-min_depth);this.$('.practice-this').show(); var self=this;$(function(){$(window).scroll(function(){if($(window).scrollTop()>max_depth-48){$(".practice-this .pointer").addClass("locked");$('.practice-this .pointer').css('top',max_depth-min_depth-73);}else{var top=self.$('.home-notification').size()?200:145;$(".practice-this .pointer").removeClass("locked");$('.practice-this .pointer').css('top',top);}});}); var self=this;if($(window).height()>775){$(".start-advanced").addClass("locked");}
$(".start-advanced").click(function(){$('html, body').stop().animate({scrollTop:400},800);});$(function(){$(window).resize(function(){var viewportHeight=$(window).height();if(viewportHeight>775){$(".start-advanced").addClass("locked");}else{$(".start-advanced").removeClass("locked");}});$(window).scroll(function(){var viewportHeight=$(window).height();if(viewportHeight<775){if($(window).scrollTop()+viewportHeight>775){$(".start-advanced").addClass("locked");}else{$(".start-advanced").removeClass("locked");}}});});$(".golden-arrow, .golden-arrow-link").click(function(){$('html, body').stop().animate({scrollTop:400},800);});timing.stop('SkillListView.drawTree()');return this;},showLanguageChooser:function(){if(this.$('.languages').is(':visible')){return;}
this.$('.languages').slideDown();this.$('#pick-language').addClass('active');var self=this;$(document).one('click',function(){self.$('#pick-language').removeClass('active');self.$('.languages').slideUp();});return false;},switchLanguage:function(e){var language_li=$(e.currentTarget);this.model.switchLanguage(language_li.data('language'));},follow:function(){ if(!this.model.get('is_following')){this.model.follow();}else{this.model.unfollow();}},toggleFollow:function(e){var button=$(e.target);var user_id=button.data('user');if(button.hasClass('success')){duo.user.unfollow(user_id,true);button.removeClass('success').text(translate_text('Follow'));}else{duo.user.follow(user_id,true);button.addClass('success').text(translate_text('Following'));}},toggleNotifyPractice:function(){var new_value=this.$('#notify-practice').is(':checked');var timezone=$.getTimezone();var settings=duo.user.get('language_settings')||{};if(!(duo.user.get('learning_language')in settings)){settings[duo.user.get('learning_language')]={};}
settings[duo.user.get('learning_language')].notify_practice=new_value;duo.user.save({language_settings:settings,timezone:timezone});duo.user.getSkills().notify_practice=new_value;mixpanel.track('toggle_notify_practice',{new_value:new_value});mixpanel.register({'notify_practice':new_value});},changePracticeTime:function(){var practice_time=this.$('#practice-notify-time').val();var timezone=$.getTimezone();var settings=duo.user.get('language_settings')||{};if(!(duo.user.get('learning_language')in settings)){settings[duo.user.get('learning_language')]={};}
settings[duo.user.get('learning_language')].notify_practice=true;settings[duo.user.get('learning_language')].notify_time=practice_time;duo.user.save({language_settings:settings,timezone:timezone});duo.user.getSkills().notify_time=practice_time;mixpanel.track('change practice time',{practice_time:practice_time});},toggleBio:function(){this.$('.biography .arrow').toggleClass('open');this.$('.biography ul').slideToggle();},dismissNotification:function(e){ var close=$(e.currentTarget);var message=close.data('message');if(message!=undefined)
duo.user.dismissNotification(message);else
this.model.set('reactivated',false);close.closest('.home-notification').fadeOut(600,function(){$(this).remove();});$('#app').animate({'margin-top':'0px'},600);},showRanking:function(e){var target=$(e.currentTarget);var modal_name=target.data('modalName');var modal=this.$('#'+modal_name); if(target.hasClass('follow-modal')){if(!this.model.hasFriendshipsLoaded()){this.model.getFriendships(true,function(){this[modal_name]=new duo.FriendshipListModal({friends:this.model.get(target.data('type')),el:modal.find('.modal-body')});this[modal_name].render();modal.modal('show');},this);}else{if(!(modal_name in this)){this[modal_name]=new duo.FriendshipListModal({friends:this.model.get(target.data('type')),el:modal.find('.modal-body')});}
this[modal_name].render();modal.modal('show');}}else{modal.html($.duostache(duo.templates[modal_name],_.extend(this.model.toJSON(),this.model.getSkills()),duo.templates));modal.modal('show');}},moreStream:function(){this.model.get('events').fetch({update:true,remove:false});},updateActivity:function(){this.model.get('events').profile_view=false;this.model.get('events').user_id=this.model.id;this.events_view=new duo.EventsView({el:this.$('#stream-container'),collection:this.model.get('events')});this.events_view.render();this.model.set({new_activities:0},{silent:true});},switchToTab:function(tab){this.$('.home-panel').hide();this.$('.tabs li').removeClass('active');this.$('.tabs li[data-tab="'+tab+'"]').addClass('active');this.$('#'+tab+'-panel').removeClass('hidden').show();if(tab==='activity'){ this.model.updateActivity(_.bind(this.updateActivity,this),{silent:true});this.$('.counter').hide();mixpanel.track('present stream',{own_wall:this.current_user});}else{this.cleanUp(true);}},switchTab:function(e){var li=$(e.currentTarget);var tab=li.data('tab');this.tab=tab;if(tab){this.switchToTab(tab);mixpanel.track('click stream',{own_wall:this.current_user});}else{this.cleanUp(true);}},switchProgressTab:function(e){var li=$(e.currentTarget);var tab_selector=li.data('selector');this.progress_tab=tab_selector;},cleanUp:function(no_unbind){if(this.events_view){this.events_view.cleanUp();}
if(!no_unbind){this.model.unbind('change',this.render,this);duo.topbar.unbind('navigate',this.cleanUp,this);}},lookedupWord:function(){mixpanel.track('post_hints_lookup',{own_wall:this.current_user});},onStreamPost:function(){this.$('.post-activity .post-footer').show();this.$('.post-activity .post-footer').removeClass('wrong');this.$('.post-activity #wrong-language-box').hide();this.$('.post-activity #search-box').show();this.$('.post-activity .post').addClass('focus');if($.trim(this.$('.post-activity .post').val())=='')
this.$('#stream-post-btn').attr('disabled','disabled');return false;},makeStreamPost:function(){var text=$.trim(this.$('.post-activity .post').val());if(text=='')
return false;var post=new duo.StreamPost({for_user_id:this.model.id,text:text});var self=this;post.save(null,{success:function(model,obj){if(model.get('response')=='empty comment'){return false;}
self.model.get('events').add(post,{at:0});self.$('.post-activity .post').val('').blur();mixpanel.track('post_on_stream',{own_wall:self.current_user});}});return false;},enablePosting:function(){if($.trim(this.$('.post-activity .post').val())==''){this.$('#stream-post-btn').attr('disabled','disabled');}else{this.$('#stream-post-btn').removeAttr('disabled');}},showFinishedModal:function(){if(!duo.user||this.model.get('id')!=duo.user.id)
return;var awesome_view=new duo.SlideSessionAwesomeView({skipToAwesome:true,model:this.model});awesome_view.render();awesome_view.$el.appendTo('body').modal({keyboard:true,backdrop:true,show:true}).on('hidden',function(){awesome_view.remove();});$('#awesome-modal').modal('show');}});duo.HomeView=duo.SkillListView.extend({template:duo.templates['home'],initialize:function(){duo.SkillListView.prototype.initialize.call(this);this.friends_in_tree=true;}});duo.ProfileView=duo.SkillListView.extend({template:duo.templates['profile'],initialize:function(){_.bindAll(this,'drawTree');this.model.bind('change',this.render,this);if(duo.user){this.current_user=this.model.id==duo.user.id;}},render:function(){this.delegateEvents();var skills_data=this.model.getSkills();var skill_collection=skills_data.skills;var calendar_data=this.getCalendar();var num_learning_languages=0;_.each(this.model.get('languages'),function(language_data){if(language_data.learning){num_learning_languages++;}
language_data.stripped_language_string=language_data.language_string.split(' ')[0];});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),skills_data,{rows:this.buildSkillGrid(),current_user:false,current_user_profile:this.current_user,finished_tree:skill_collection.checkFinished(),following_short:this.model.get('following').slice(-3),followers_short:this.model.get('followers').slice(-3),num_ranked:this.model.get('num_following')+1,next_level:skills_data.level+1,calendar:calendar_data,points_languages:_.sortBy(this.model.get('languages'),function(d){return-d.points;}),language_badge_fill:_.range((3+(-num_learning_languages%3))%3)}),duo.templates));skill_collection.each(this.addOne,this);var self=this;if(duo.user){ this.$('#search-box').wordLookup({templates:duo.templates,source_language:duo.user.get('ui_language'),target_language:duo.user.get('learning_language'),id:this.model.get('username'),callback:this.lookedupWord,callback_context:this}); this.$('#stream-post').vkeyboard({language:duo.user.get('learning_language'),placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:false,caps:false});} 
if(this.tab){this.switchToTab(this.tab);}else{this.$('.tabs li[data-language="'+this.model.get('learning_language')+'"]').addClass('active');this.$('#skill-tree-panel').show();} 
_.defer(this.drawTree);_.defer(function(){self.$('.post-activity label, #invite-box label').inFieldLabels();self.$('.post-activity textarea').autosize(); duo.topbar.bind('navigate',self.cleanUp,self);});if(!this.model.hasFriendshipsLoaded()){this.model.getFriendships(true,function(){var friends_view=new duo.ProfileFriendsView({model:this.model,el:this.$('#friends')});friends_view.render();},this);}else{var friends_view=new duo.ProfileFriendsView({model:this.model,el:this.$('#friends')});friends_view.render();}
var stats_view=new duo.ProfileStatsView({model:this.model,el:this.$('#stats'),calendar_data:calendar_data});stats_view.render();return this;},switchLanguage:function(e){var language_li=$(e.currentTarget);if(this.$('#activity-panel').is(':visible')){this.cleanUp(true);this.$('#activity-panel').hide();}
if(language_li.data('language')===this.model.get('learning_language')){this.$('.tabs li').removeClass('active');language_li.addClass('active');this.$('#skill-tree-panel').show();}else{this.model.switchLanguage(language_li.data('language'),undefined,true);}},switchToTab:function(tab){this.$('.home-panel').hide();this.$('.tabs li').removeClass('active');this.$('.tabs li[data-tab="'+tab+'"]').addClass('active');this.$('#'+tab+'-panel').removeClass('hidden').show();if(tab==='activity'){ this.model.updateActivity(_.bind(this.updateActivity,this),{silent:true},true);this.$('.counter').hide();mixpanel.track('present stream',{own_wall:this.current_user});}else{this.cleanUp(true);}}});duo.ProfileFriendsView=Backbone.View.extend({template:duo.templates['profile-friends'],events:{'click .more':'showMore'},render:function(){var num_to_show_following=this.model.get('num_following')===10?10:9;var num_to_show_followers=this.model.get('num_followers')===10?10:9;$(this.el).html($.duostache(this.template,{following:this.model.get('following').slice(-num_to_show_following),followers:this.model.get('followers').slice(-num_to_show_followers),show_more_following:this.model.get('num_following')>10,num_show_more_following:this.model.get('num_following')-10,show_more_followers:this.model.get('num_followers')>10,num_show_more_followers:this.model.get('num_followers')-10,num_following:this.model.get('num_following'),num_followers:this.model.get('num_followers'),username:this.model.get('username')},duo.templates));return this;},showMore:function(e){var $ele=$(e.currentTarget);var type=$ele.data('type');var modal=this.$('#'+type+'-modal');var view=new duo.FriendshipListModal({friends:this.model.get(type),el:modal.find('.modal-body')});view.render();modal.modal('show');var self=this;modal.bind('hidden',function(){if(self.model.hasChanged('num_followers')||self.model.hasChanged('num_following')){self.model.change();}}).delegate('a.user','click',function(e){$(this).closest('.modal').modal('hide');});}});duo.ProfileStatsView=Backbone.View.extend({template:duo.templates['profile-stats'],initialize:function(options){this.calendar_data=options.calendar_data;this.streak=0;},render:function(){var total_points=0;var total_sentences_translated=0;_.each(this.model.get('languages'),function(language_data){total_points+=language_data.points;total_sentences_translated+=language_data.sentences_translated;this.streak=this.streak<language_data.streak?language_data.streak:this.streak;},this);$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{loading_word_count:!this.model.has('vocab_size'),points_gained_in_week:_.reduce(this.calendar_data,function(memo,day){return memo+day.points;},0),total_points:total_points,total_sentences_translated:total_sentences_translated,longest_streak:this.streak,points_languages:_.sortBy(this.model.get('languages'),function(d){return-d.points;}),sentences_translated_languages:_.sortBy(this.model.get('languages'),function(d){return-d.sentences_translated;}),streak_languages:_.sortBy(this.model.get('languages'),function(d){return-d.streak;})}),duo.templates)); var self=this;if(!this.model.has('vocab_size')){$.getJSON('/vocabularies/size',{user_id:this.model.id,language:'all'},function(data){data.vocab_size.languages=_.sortBy(data.vocab_size.languages,function(d){return-d.count;});self.model.set({vocab_size:data.vocab_size},{silent:true});self.render();});}
return this;}});duo.SkillItemView=Backbone.View.extend({template:duo.templates['skill-item'],events:{'click a':'hoverOut'},initialize:function(options){if('improvement'in options){this.show_improvement=true;this.improvement=options.improvement;}
if(options.size){this.size=options.size;}
this.return_arrow=options.return_arrow;if('current_user'in options){this.current_user=options.current_user;}else{this.current_user=this.model.has('points');}
_.bindAll(this,'hoverIn','hoverOut','positionPopover');if(this.model!=null){this.model.bind('change',this.render,this);}},render:function(){ var rounded_strength=Math.round(this.model.get('strength')*4);var strengths=_.map(_.range(4),function(i){return{filled:rounded_strength>i};},this);var num_strengths=_.filter(strengths,function(s){return s.filled;}).length;var words_list=this.model.get('words')||[];var data={words_string:words_list.join(', ').replace(/<\*sf>(, )?/g,''),dependencies_string:_.map(this.model.get('dependencies'),function(dn){return translate_text(dn);}).join(', '),category:this.model.get('category').replace(/\s/g,'-'),improvement:this.improvement,show_improvement:this.show_improvement,size:this.size,current_user:this.current_user,return_arrow:this.return_arrow,strengths:strengths,disable_hover:this.options.disable_hover,perfect_strength:rounded_strength==4};data['strength_'+num_strengths]=true;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),data),duo.templates));if(!this.options.disable_hover){ var hover_settings={over:this.hoverIn,out:this.hoverOut};this.$('.skill-box').hoverIntent(hover_settings);}
return this;},positionPopover:function(){ var margin=13;var box_width=this.$('.skill-box').outerWidth();if(!this.$('.skill-box').offset()){console.log(this.$('.skill-box').offset(),this.$('.skill-box'),this.model.toJSON());}
var box_x=this.$('.skill-box').offset().left;if(box_x+box_width+margin+this.$('.popover').outerWidth()>$(window).width()){ this.$('.popover').removeClass('right').addClass('left').anchor({type:'left',anchor:this.$('.skill-box'),margin:margin,container:$('#app')});}else{ this.$('.popover').anchor({type:'right',anchor:this.$('.skill-box'),margin:margin,container:$('#app')});}},hoverIn:function(){this.positionPopover();this.$('.popover').show();},hoverOut:function(){this.$('.popover').hide();}});duo.FriendshipListModal=Backbone.View.extend({template:duo.templates['friendship-list'],events:{'scroll':'onScroll'},initialize:function(options){this.friends=options.friends;this.num_shown=10;},render:function(){$(this.el).html($.duostache(this.template,{shown_friends:this.friends.slice(0,this.num_shown)},duo.templates));},onScroll:function(e){var total_height=this.$('ul').height();var view_height=total_height-$(this.el).scrollTop();var visible_height=$(this.el).height();if(view_height<visible_height&&this.num_shown<this.friends.length){this.num_shown+=10;this.render();}}});duo.InviteFriend=Backbone.View.extend({template:duo.templates['invite-friend'],events:{'click #invite-box #send-invite':'sendInvite','keyup #invite-box #invite-email':'inviteKeyCheck'},render:function(){if(this.model.get('invites')){var num_invited=this.model.get('invites').invited.length;}else{var num_invited=0;}
$(this.el).html($.duostache(this.template,_.extend({},this.model.toJSON(),{num_invited:num_invited}),duo.templates));return this;},inviteKeyCheck:function(e){this.$('#invite-box p.error').hide();this.$('#invite-box #invite-email').removeClass('error');if(e.which===13){this.sendInvite();}},sendInvite:function(){var invite_email=$.trim(this.$('#invite-email').val());var self=this;if(invite_email.length===0){return;}
$.post('/invite',{email:invite_email},function(data){var sent=false;if(data.response==='OK'){duo.user.get('invites').invites_left=data.invites_left;self.render();self.$('#invited-email').text(invite_email);self.$('.send-notification').slideDown().delay(3000).slideUp();self.$('#invite-box label').inFieldLabels();sent=true;}else if(data.response==='user has already joined'){self.$('#already-joined').slideDown().delay(6000).slideUp();}else if(data.response==='user has already been invited'){self.$('#already-joined').slideDown().delay(6000).slideUp();}else if(data.response==='not an email'){self.$('#not-email').slideDown().delay(3000).slideUp();self.$('#invite-email').addClass('error');}
mixpanel.track('invited friend',{valid:sent});});}});duo.LeaderBoard=duo.InviteFriend.extend({template:duo.templates['leaderboard'],events:{'click .email':'inviteByEmail','click .toggle-search':'toggleSearch','click .facebook':'fbConnect','click .go-back':'goBack','click .search-user-button':'search','keyup #search-input':'keycheckSearch','click .send-invite':'sendInvite','keyup #invite-email':'inviteKeyCheck','click #invite-box .close':'closeInviteBox'},initialize:function(){this.lazySearch=this.debounce(this._search,1500,true);},debounce:function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args);};if(immediate&&!timeout)func.apply(context,args);clearTimeout(timeout);timeout=setTimeout(later,wait);};},render:function(){if(this.model.get('invites')){var num_invited=this.model.get('invites').invited.length;}else{var num_invited=0;}
$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.model.getSkills(),{fb_friends:duo.user.fb_friends,invite_fb_friends:this.board==='fb',search_friends:this.board==='search',invite_friends:this.board==='invite',num_invited:num_invited}),duo.templates));if(duo.user.fb_friends){this.$('#filter-fb-input').typeahead({source:_.pluck(duo.user.fb_friends,'name'),render:this.renderSearch,lookup:this.typeaheadLookup,data:{view:this}});}
this.renderSubViews();var self=this;_.defer(function(){self.$('label').inFieldLabels();var board=self.$('#points-ranking .list-users');var board_height=board.innerHeight();var user_row=board.children('li.self');var user_pos=user_row.position().top;board.scrollTop(user_pos-board_height/2+user_row.outerHeight()/2);});return this;},renderSubViews:function(){if(!this.search_view){this.search_friends=new duo.UserList();this.search_view=new duo.FriendsListView({collection:this.search_friends,is_search_list:true,el:this.$('#search-friends .list-users').hide(),hide_empty:false});this.search_view.template=duo.templates['leaderboard-list'];this.search_view.render();}else{this.$('#search-friends .list-users').replaceWith(this.search_view.el);this.search_view.delegateEvents();}
if(!this.ranking_view){this.ranking_view=new duo.LeaderRankingView({model:this.model,el:this.$('#points-ranking')});this.ranking_view.render();}else{this.$('#points-ranking').replaceWith(this.ranking_view.el);this.ranking_view.delegateEvents();}},inviteByEmail:function(){this.$('#invite-box').slideToggle();},closeInviteBox:function(){this.$('#invite-box').slideUp();},toggleSearch:function(){if(this.board!=='search'){this.board='search';this.render();this.$('.board, .invite-action').hide();this.$('.toggle-search .icon-search').addClass("leaderboard");this.$('.go-back').show();this.$('#search-friends').show();}else{this.$('.toggle-search .icon-search').removeClass("leaderboard");this.goBack();}},fbConnect:function(){if(duo.user.fb_friends===undefined){this.loginFB();}else{this.showFB();}},showFB:function(){this.board='fb';this.render();this.$('.board, .invite-action').hide();this.$('.go-back').show();this.$('#fb-friends').show();},goBack:function(){this.board='ranking';this.render();this.$('#points-ranking').show();},loginFB:function(){var self=this;if(!window.FB){return;}
FB.login(function(response){if(!response.authResponse){return;}
self.fetchFromFB.call(self,response.authResponse);},{scope:'publish_actions'});},fetchFromFB:function(auth_response){var facebook_id=auth_response.userID;var access_token=auth_response.accessToken;var self=this;duo.user.set({facebook_id:facebook_id},{silent:true});FB.api('/me/friends?access_token='+access_token+'&fields=picture,installed,name',function(friends_data){var duo_friends=_.filter(friends_data.data,function(friend){return friend.installed;});$.post('/facebook_connect',{facebook_id:facebook_id,facebook_friends:JSON.stringify(duo_friends),auto_follow:true,return_points:false},function(data){for(var i=0;i<friends_data.data.length;i++){var friend_data=friends_data.data[i];if(friend_data.id in data.friends){data.friends[friend_data.id].user_id=data.friends[friend_data.id].id;_.extend(friend_data,data.friends[friend_data.id]);}}
duo.user.fb_friends=_.sortBy(friends_data.data,function(friend_data){return friend_data.name;});self.showFB();duo.user.set(data.user_following.data,{silent:true});_.extend(duo.user.getSkills(),data.user_following.skill_rank_data);});});},typeaheadLookup:function(event){this.query=this.$element.val()
if(!this.query){this.options.data.view.$('#fb-friends .list-users li').removeClass('filtered-fb-friend').show();return this;}
return this.search(this.query).hide()},renderSearch:function(friends){var filtered_friends_names={};_.each(friends,function(friend_name){filtered_friends_names[friend_name]=true;});this.options.data.view.$('#fb-friends .list-users li').each(function(index,ele){var friend=duo.user.fb_friends[index];if(friend.name in filtered_friends_names){$(ele).removeClass('filtered-fb-friend');}else{$(ele).addClass('filtered-fb-friend');}});this.options.data.view.$('#fb-friends .list-users li').show();this.options.data.view.$('.filtered-fb-friend').hide();return this;},_search:function(){var q=$.trim(this.$('#search-input').val());if(q.length>0){this.search_friends.url='/users/search?q='+q;this.search_friends.fetch();this.$('#search-friends .list-users').show();}else{this.search_friends.reset();}},search:function(){this.lazySearch();},keycheckSearch:function(e){if(e.which===13){this.search();}},sendInvite:function(){var invite_email=$.trim(this.$('#invite-email').val());var self=this;if(invite_email.length===0){return;}
$.post('/invite',{email:invite_email},function(data){var sent=false;if(data.response==='OK'){duo.user.get('invites').invites_left=data.invites_left;self.$('#invite-email').val('');self.$('#invited-email').text(invite_email);self.$('.send-notification').slideDown().delay(3000).slideUp();}else if(data.response==='user has already joined'){self.$('#already-joined .user-link').attr('href','/#/'+data.user.username).text(data.user.username);self.$('#already-joined').slideDown().delay(3000).slideUp();}else if(data.response==='user has already been invited'){self.$('#already-joined').slideDown().delay(3000).slideUp();}else if(data.response==='not an email'){self.$('#not-email').slideDown().delay(3000).slideUp();self.$('#invite-email').addClass('error');}
mixpanel.track('invited friend',{valid:sent});});}});duo.LeaderRankingView=Backbone.View.extend({template:duo.templates['leaderboard-ranking'],events:{'mouseover .skill-points':'showBreakdown','mouseleave .skill-points':'hideBreakdown'},initialize:function(){this.model.bind('change',this.render,this);this.min_rank=Math.max(0,this.model.getSkills().points_rank-5);this.max_rank=this.model.getSkills().points_rank+5;},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.model.getSkills(),{}),duo.templates));$(this.el).css('position','relative');if(!duo.user.getSkills().points_ranking_data.got_weekly){duo.user.getSkills().points_ranking_data.got_weekly=true;var self=this;var now=new Date();var start_week=new Date(now.getFullYear(),now.getMonth(),now.getDate(),0,0,0,0);start_week.setDate(now.getDate()-6);$.getJSON('/friendships/weekly_activity',{start_time:start_week.toJSON()},function(d){_.each(d,function(points,userid){self.$('#points-breakdown-'+userid+' .weekly-progress .points').text('+'+points);}); _.each(duo.user.getSkills().points_ranking_data,function(point_data){if(point_data.id in d){point_data.weekly=d[point_data.id];}});});}
return this;},showBreakdown:function(e){var ele=$(e.currentTarget);var userid=ele.data('user');var popover=this.$('#points-breakdown-'+userid);if(ele.parent().position().top<0){return;}
var right_most=$(this.el).offset().left+$(this.el).width()+popover.width();if($(window).width()<right_most){popover.anchor({'type':'left','anchor':ele.parent(),'container':$(this.el)}).removeClass('right').addClass('left');var left=popover.css('left');left=left.substring(0,left.length-2);popover.css('left',parseInt(left)+ele.position().left-5);}else{popover.anchor({'type':'right','anchor':ele.parent(),'container':$(this.el)}).removeClass('left').addClass('right');}
popover.show();},hideBreakdown:function(e){var ele=$(e.currentTarget);var userid=ele.data('user');var popover=this.$('#points-breakdown-'+userid);popover.hide();},onScroll:function(e){var total_height=this.$('ul').height();var view_height=total_height-$(this.el).scrollTop();var visible_height=$(this.el).height();if(view_height<visible_height&&this.max_rank<this.model.getSkills().points_ranking_data.length){this.max_rank+=10;this.render();}}});duo.SkillView=Backbone.View.extend({id:'app',template:duo.templates['skill'],events:{'click .questions-explanations-tabs li':'switchTab','click .practice':'practice','click #ask-question':'toggleQuestion'},initialize:function(){_.bindAll(this,'drawPath','loadVocab');},render:function(){var path=_.map(this.model.get('path'),function(node){var data=_.clone(node);if(node.strength!==undefined){ var rounded_strength=Math.round(node.strength*4);data.strengths=_.map(_.range(4),function(i){return{filled:rounded_strength>i};},this);}
return data;},this);$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{words_string:this.model.get('words').join(', '),category:this.model.get('category').replace(/\s/g,'-'),skill_id:this.model.id,points_to_gain:Math.min(10,this.model.get('left_points')),path:path}),duo.templates));var topic_id=this.model.has('topic')?this.model.get('topic').id:null;var topic_name=this.model.has('topic')?this.model.get('topic').name:null;var comments_view=new duo.CommentListView({el:this.$('#comments-panel'),collection:this.model.get('comments'),topic_id:topic_id,topic_name:topic_name,from_skill:this.model.id});comments_view.render();var self=this;this.loadVocab();var active_translation=_.find(this.model.get('path'),function(path_node){return path_node.active&&path_node.translation;});if(active_translation&&!active_translation.snippet){$.getJSON('/skills/'+this.model.get('language')+'/'+this.model.get('url_title')+'/translation/'+active_translation.index,function(data){var snippet_data={};if(data.refresh){snippet_data=_.extend(active_translation,data);}else{snippet_data.snippet=_.extend(active_translation,data);}
self.$('.skill-path > .active').html($.duostache(duo.templates['snippet-list'],_.extend(self.model.toJSON(),snippet_data),duo.templates));self.drawPath();});}else{_.defer(this.drawPath);}
if(!this.model.get('explanation')){ this.model.get('comments').fetch();}
var post_modal=new duo.PostModalView({el:this.$('#question-fields'),type:'question',edit:false,selected:topic_id,all_topics:[{skill_id:this.model.id,id:topic_id,name:topic_name}],success:_.bind(this.onPost,this),model:new duo.Topic(this.model.get('topic'))});post_modal.render();return this;},drawPath:function(){ var skill_canvas=this.$('#skill-canvas').empty().css({'position':'absolute'});var skill_drawing=Raphael(skill_canvas[0],this.$('.skill-path').innerWidth(),this.$('.skill-path').innerHeight());var tree_nodes={};var index=0;this.$('.skill-path > li').each(function(){var grid_cell=$(this);var cell_position=$(this).position();var node_position={left:cell_position.left+grid_cell.outerWidth()/2,top:cell_position.top+grid_cell.outerHeight()/2};var unlocked=grid_cell.children('.unlocked, .checked').size()>0;tree_nodes[index]={position:node_position,edges:index>0?[index-1]:[],options:{stroke:unlocked?'#cdcdcd':'#cdcdcd'}};index++;},this);skill_drawing.tree(tree_nodes);},loadVocab:function(){var self=this;var vocab=new duo.Vocab();vocab.fetch({data:{skill_id:this.model.id,per_page:10,preload_strength:false},success:function(){var vocab_view=new duo.MiniVocabOverview({model:vocab,el:self.$('#vocab-overview')});vocab_view.render();}});},switchTab:function(e){var li=$(e.currentTarget);var tab=this.$('#'+li.data('tab')+'-panel');this.$('.questions-explanations-tabs li').removeClass('active');this.$('.questions-explanations-panel').fadeOut("fast");li.addClass('active');tab.fadeIn("fast");if(li.data('tab')==='comments'&&this.model.get('comments').length===0){this.model.get('comments').fetch();}
if(li.data('tab')==='comments')
this.$('#ask-question').fadeToggle("fast");else
this.$('#ask-question').hide();},practice:function(){duo.skillRouter.navigate('/skill/'+this.model.get('language')+'/'+this.model.get('url_title')+'/practice',true);},toggleQuestion:function(){this.$('.modal').modal('hide');this.$('#question-fields').modal('show');},onPost:function(comment){var comment_topic_id=parseInt(comment.get('topic_id'));this.model.get('comments').add(comment,{at:0});this.$('.modal').modal('hide');duo.commentRouter.navigate('/comment/'+comment.get('id'),true);}});})(window.jQuery);(function($){var _ttsURL='http://static.duolingo.com/tts/';duo.SessionElementView=Backbone.View.extend({id:'session-element-container',initialize:function(options){this.session=options.session; _.bindAll(this,'graded');this.session.bind('continue',this.clear,this);this.session.bind('end',this.clear,this);},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{need_flash:$.need_flash}),duo.templates));return this;},clear:function(){},graded:function(session_element_solution,resp){this.session.set({state:'graded'}); var data=session_element_solution.toJSON();var type=this.model.get('type');data[type]=true;data.has_discussion=type!=='name'&&type!=='select';this.$('#player-nav-secondary').html($.duostache(duo.templates['player-nav-secondary'],data,duo.templates));},skip:function(){this.submit();},submit:function(){},save:function(ses){ if(this.session.get('state')==='submitted'||this.session.get('state')==='graded'){return;}
if(this.session.get('state')!=='ready'){this.session.set({state:'ready'});}
ses.set({time_taken:this.stopTiming()});this.session.addSolution(ses);var self=this;this.session.set({state:'submitted'});ses.save(null,{success:this.graded,error:function(){ ses.set({correct:true});self.graded(ses,null);}});},startTiming:function(){var now=new Date();this.startTime=Date.UTC(now.getFullYear(),now.getMonth(),now.getDate(),now.getHours(),now.getMinutes(),now.getSeconds(),now.getMilliseconds());},stopTiming:function(){var now=new Date();this.stopTime=Date.UTC(now.getFullYear(),now.getMonth(),now.getDate(),now.getHours(),now.getMinutes(),now.getSeconds(),now.getMilliseconds());return this.stopTime-this.startTime;},showBlame:function(){if(!duo.user.get('ab_options').new_player_blame_experiment){return}
var solution=this.session.get('session_element_solutions').last();var solution_data=solution.toJSON();if(solution_data.blame&&solution_data.blame!='wrong_word'&&$.trim(solution_data.blame_message)!=''){this.$('#blame-1 .icon-warning').after(solution_data.blame_message);try{this.$('#blame-1').anchor({type:'above',margin:15,anchor:$('.red-bold'),container:$('#app')});}catch(e){this.$('#blame-1').anchor({type:'above',margin:15,anchor:$('.line-through'),container:$('#app')});}
$('#blame-1').show();};if(solution_data.highlights!=undefined&&solution_data.highlights.length>0&&!this.hints_shown){var correct_highlights=_.map(solution_data.highlights,function(x){return x[0];});$('.translation_source').first().highlight('highlight',correct_highlights);$('.highlight').css({'font-weight':'bold'});}}});duo.ExampleNameElementView=duo.SessionElementView.extend({template:duo.templates['example-name-element'],initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.session.bind('render',this.readyContinue,this);this.session.bind('render',this.postRender,this);},readyContinue:function(){var self=this;_.defer(function(){self.session.set({state:'ready'}); self.session.addSolution(new duo.SessionElementSolution({session_element:self.model}));self.session.set({state:'submitted'});self.session.set({state:'graded'});});},postRender:function(){this.$('#big-speaker').tts(_.extend(this.model.toJSON(),{absoluteURL:_ttsURL+this.model.get('language')+'/sentence/'+this.model.get('phrase_id'),template:duo.templates['speaker'],text:this.model.get('phrase'),autoplay:duo.user.shouldAutoPlay(),language:this.model.get('language')}));},clear:function(){this.session.unbind('render',this.readyContinue);this.session.unbind('render',this.postRender);}});duo.NameElementView=duo.SessionElementView.extend({events:{'keyup #word-input':'change','change #word-input':'change','change #article-input':'change'},template:duo.templates['name-element'],initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.session.bind('render',this.focusInput,this);this.session.bind('grade',this.graded_,this);},render:function(){duo.SessionElementView.prototype.render.call(this); var articles=this.model.get('articles');if(articles!=null&&articles.length==1){this.$('#article-input').val(articles[0]);this.$('#article-input').attr('disabled','disabled');}
this.$('#word-input').vkeyboard({language:this.model.get('language'),placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:true,caps:false});this.startTiming();return this;},focusInput:function(){this.$('#word-input').focus();},getSubmitData:function(){return{article:this.$('#article-input').val(),word:$.trim(this.$('#word-input').val()),session_element:this.model};},submit:function(){this.$('#word-input').attr('disabled','disabled').blur();this.$('#article-input').attr('disabled','disabled').blur();var ses=new duo.SessionElementSolution(this.getSubmitData());this.save(ses);},skip:function(){this.$('#word-input').attr('disabled','disabled').blur();this.$('#article-input').attr('disabled','disabled').blur();var empty_data={article:'',word:'',session_element:this.model};var ses=new duo.SessionElementSolution(empty_data);this.save(ses);},isValid:function(){var data=this.getSubmitData();return(data.article==null||data.article.length>0)&&data.word.length>0;},renderArticle:function(article,word){if(_.indexOf(this.model.get('articles'),article)!=-1){this.$('#article-input').val(article);this.$('#word-input').val(word);return true;}else{return false;}},checkArticle:function(){var data=this.getSubmitData();var separator=data.word.indexOf(" ");if(separator==-1)separator=data.word.indexOf("'");if(separator==-1)separator=data.word.length-1;var article=$.trim(data.word.substring(0,separator+1).toLowerCase());var word=$.trim(data.word.substring(separator+1).toLowerCase());this.renderArticle(article,word);},change:function(event){if(event.which==32||event.keyCode==222)this.checkArticle();if(this.isValid()&&this.session.get('state')==='rendered'){this.session.set({state:'ready'});}else if(!this.isValid()&&this.session.get('state')==='ready'){this.session.set({state:'rendered'});}},graded_:function(){var text=this.$('#word-input').val();var article=this.$('#article-input').val();this.$('#word-input').replaceWith("<span id='graded-word-input' class='fake-input'></span>");this.$('#graded-word-input').text(text);this.$('#article-input').replaceWith("<span id='graded-article-input' class='fake-select'>"+article+"</span>");var solution=this.session.get('session_element_solutions').last();var solution_data=solution.toJSON();solution_data.has_solutions=solution_data.correct_solutions&&solution_data.correct_solutions.length>0;var article_length=(article==null)?-1:article.length;if(solution_data.highlights!=undefined&&solution_data.highlights.length>0){if(solution_data.blame=='wrong_word'||solution_data.blame=='case_gender'||solution_data.blame=='gender'){var css_class_='line-through';}else{var css_class_='red-bold';}
if(solution_data.highlights[0][0][0]==0){this.$('#graded-article-input').highlight(css_class_,[[0,article_length]]);}
solution_data.highlights=_.map(solution_data.highlights,function(x){var y=[];y[0]=x[1][0]-article_length-1;y[1]=x[1][1]-article_length-1;return y;});this.$('#graded-word-input').highlight(css_class_,solution_data.highlights);}
this.$('#vkeyboard-placeholder').hide();this.$('#toggle_vkeyboard').hide();this.$('#correct-solutions').html($.duostache(duo.templates['correct-solutions'],solution_data,duo.templates));this.showBlame();},clear:function(){this.session.unbind('render',this.focusInput);this.session.unbind('grade',this.graded_);}});duo.SelectElementView=duo.SessionElementView.extend({events:{'click .select-images-list li':'onSelect','change .select-images-list input':'onInput','keyup .select-images-list input':'onInput','click .select-images-list input':'onInput'},template:duo.templates['select-element'],initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.session.bind('render',this.postRender,this);$(document).bind('keyup.judge.session',_.bind(this.keyCheck,this));},render:function(){var options=_.map(this.model.get('options'),function(option,index){option.number=index+1;return option;});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{options:options}),duo.templates));this.startTiming();return this;},postRender:function(){_.each(this.model.get('options'),function(option,index){this.$('#speaker-'+option.number).tts({absoluteURL:_ttsURL+this.model.get('language')+'/sentence/'+option.phrase_id,template:'',visible:false,text:option.phrase,autoplay:false,language:this.model.get('language'),sentenceType:'lesson',click:true});},this);},onSelect:function(e){if(this.session.get('state')!=='ready'&&this.session.get('state')!=='rendered'){return;}
var option=$(e.currentTarget);this.$('.select-images-list li').removeClass('selected');option.addClass('selected');option.find('input').prop('checked',true).change();},onInput:function(e){var input=$(e.currentTarget);if(this.session.get('state')==='rendered'){this.session.set({state:'ready'});}
this.$('#speaker-'+input.data('number')).click();},submit:function(){this.$('.select-images-list').addClass('deactivated');var option=this.$('input[name="selection"]:checked').val();var ses=new duo.SessionElementSolution({value:option,correct:option===this.model.get('phrase'),incorrect:option!==this.model.get('phrase'),correct_solutions:[this.model.get('phrase')],session_element:this.model});this.save(ses);},graded:function(session_element_solution,resp){duo.SessionElementView.prototype.graded.call(this,session_element_solution,resp);var solution=session_element_solution;_.each(this.model.get('options'),function(option,index){if(option.phrase===solution.get('value')){ this.$('#option-'+(index+1)).addClass(solution.get('correct')?'correct':'incorrect');}else if(option.phrase===this.model.get('phrase')){ this.$('#option-'+(index+1)).addClass('correct');}},this);},save:function(ses){this.session.addSolution(ses);this.session.set({state:'submitted'});this.graded(ses);},skip:function(){this.$('#word-input').attr('disabled','disabled').blur();this.$('#article-input').attr('disabled','disabled').blur();var empty_data={article:'',word:'',session_element:this.model};var ses=new duo.SessionElementSolution(empty_data);this.save(ses);},keyCheck:function(e){switch(e.which){case 49: case 97: this.$('#option-1').click();break;case 50: case 98: this.$('#option-2').click();break;case 51: case 99: this.$('#option-3').click();break;default:break;}},clear:function(){this.session.unbind('render',this.postRender);$(document).unbind('.judge');}});duo.SpeakElementView=duo.SessionElementView.extend({template:duo.templates['speak-element'],events:{'click #no-mic-link':'turnMicOff'},initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.ses=new duo.SessionElementSolution({session_element:this.model});this.session.addSolution(this.ses);this.session.bind('render',this.postRender,this);duo.updateGrade=_.bind(this.receiveScore,this);duo.onSpeakConnect=_.bind(this.onSpeakConnect,this);$(document).bind('keyup.speak.session',_.bind(this.keyCheck,this));},postRender:function(){this.session.trigger('loading_recorder');swfobject.embedSWF('/swf/audioRecorder-1-5.swf','audio-recorder','600','150','10',duo.cdn+'/swf/expressInstall.swf',{server:'rtmp://duolingo.com/SpeechService',timeLimit:20,text:this.model.get('stripped_text'),lang:this.model.get('source_language'),userid:duo.user.id,streamID:this.model.get('sound_id'),recordString:translate_text('Record'),stopString:translate_text('Stop'),playbackString:translate_text('Play back your recording'),delay:0},{allowScriptAccess:"always",wmode:"transparent"},{id:'audio-recorder',name:'audio-recorder',styleclass:'recorder-object'});if(this.model.get('source_language')===duo.user.get('ui_language')){return;}
this.$('#big-speaker').tts(_.extend(this.model.toJSON(),{absoluteURL:_ttsURL+this.model.get('source_language')+'/sentence/'+this.model.get('solution_key'),template:duo.templates['speaker'],autoplay:duo.user.shouldAutoPlay()
}));this.startTiming();},receiveScore:function(score){if(!this.canSubmit()){return;}
if(score>=this.model.get('threshold')){ this.session.set({state:'ready'}); swfobject.getObjectById('audio-recorder').disable(); this.ses.set({correctness:score,correct:true,incorrect:false,try_again:false});this.save(this.ses);}else{ this.session.set({state:'ready'}); this.ses.set({correctness:score,incorrect:true,try_again:true,odd:!this.ses.get('odd'),heart:this.session.get('type')==='lesson',skip:this.session.get('type')!=='lesson'});this.save(this.ses);}},onSpeakConnect:function(){this.session.trigger('loaded_recorder');},keyCheck:function(e){if(e.which===13&&this.canSubmit()){ try{swfobject.getObjectById('audio-recorder').toggleRecording();}catch(err){}}},canSubmit:function(){return(_.include(['rendered','ready'],this.session.get('state'))||!this.ses.isDone());},save:function(ses){if(this.session.get('state')!=='ready'){this.session.set({state:'ready'});}
if(!this.ses.get('try_again')){ses.set({time_taken:this.stopTiming()});this.ses.save(null,{success:this.graded});this.session.set({state:'submitted'});$(document).unbind('.speak');}else{this.session.set({state:'submitted'});this.session.set({state:'ready'});}},submit:function(){},skip:function(){ try{swfobject.getObjectById('audio-recorder').disable();}catch(err){}
this.ses.set({correctness:0,correct:false,incorrect:true,try_again:false,next_time:true});this.save(this.ses);},turnMicOff:function(message){this.$('#no-mic-link').css('visibility','hidden');this.session.set({state:'ready'});duo.user.save({microphone:false}); try{swfobject.getObjectById('audio-recorder').disable();}catch(err){} 
var this_index=this.session.get('session_elements').indexOf(this.model);var speak_elements=this.session.get('session_elements').filter(function(element,index){return element.get('type')=='speak'&&index>this_index;});this.session.get('session_elements').remove(speak_elements);this.ses.set({correctness:0,correct:true,incorrect:false,mic_off:true,message:message!==false,try_again:false});this.save(this.ses);},clear:function(){this.session.unbind('render',this.postRender);duo.updateGrade=null;duo.onSpeakConnect=null;$(document).unbind('.speak');}});duo.JudgeElementView=duo.SessionElementView.extend({events:{'change input':'mark'},template:duo.templates['judge-element'],initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.session.bind('render',this.postRender,this);$(document).bind('keyup.judge.session',_.bind(this.keyCheck,this));},render:function(){duo.SessionElementView.prototype.render.call(this);this.$('.hints').hints({callback:this.hintHover,callback_context:this,templates:duo.templates,source_language:this.model.get('source_language'),target_language:this.model.get('target_language'),language_information:this.session.get('language_information'),reverse:this.model.get('target_language')===this.session.get('language'),highlight_verb_endings:true});return this;},postRender:function(){var self=this;_.defer(function(){self.$('input[type=checkbox]').first().focus();});this.startTiming();if(this.model.get('source_language')===duo.user.get('ui_language')){return;}
this.$('#big-speaker').tts(_.extend(this.model.toJSON(),{absoluteURL:_ttsURL+this.model.get('source_language')+'/sentence/'+this.model.get('solution_key'),template:duo.templates['speaker'],autoplay:duo.user.shouldAutoPlay()
}));},mark:function(e){var self=this;var cb=$(e.currentTarget);if(this.$('input[type=checkbox]:checked').length>0){_.defer(function(){self.session.set({state:"ready"});});}else{_.defer(function(){self.session.set({state:"rendered"});});}
if(cb.prop('checked')){cb.closest('.cb-container-long').addClass('active');}else{cb.closest('.cb-container-long').removeClass('active');}},submit:function(){this.$('.dotted-frame').addClass('disabled');this.submitted=true;var choices=this.$('input[type=checkbox]').map(function(){if($(this).is(':checked')){return'correct';}else{return'incorrect';}}).get();this.$('input[type=checkbox]').attr('disabled','disabled').blur();var ses=new duo.SessionElementSolution({session_element:this.model,choices:choices});this.save(ses);},skip:function(){var choices=this.$(':checked').map(function(){return'skip';}).get();this.$('input[type=checkbox]').attr('disabled','disabled').blur();var ses=new duo.SessionElementSolution({session_element:this.model,choices:choices});this.save(ses);},keyCheck:function(e){if($('#report-options').is(':visible')){return true;}
switch(e.which){case 49: case 97: this.$('#sentence-0').click().change();this.$('input[type=checkbox]').blur();break;case 50: case 98: this.$('#sentence-1').click().change();this.$('input[type=checkbox]').blur();break;case 51: case 99: this.$('#sentence-2').click().change();this.$('input[type=checkbox]').blur();break;default:break;}},graded:function(session_element_solution,resp){duo.SessionElementView.prototype.graded.call(this,session_element_solution,resp);var solution=session_element_solution;var direction=this.model.get('target_language')===this.session.get('language')?'forward':'reverse';var correct=true;if(solution.get('incorrect')){correct=false;}
var correct_choices=solution.get('correct_choices');var choices=solution.get('choices');this.$('.cb-container-long').each(function(index,checkbox){if(choices[index]==='correct'){ $(checkbox).addClass(correct_choices[index]);}else if(correct_choices[index]==='correct'){ $(checkbox).addClass(correct_choices[index]);}});},clear:function(){this.session.unbind('render',this.postRender);$(document).unbind('.judge');}});duo.FormElementView=duo.SessionElementView.extend({events:{'change select':'change','keyup select':'change'},template:duo.templates['form-element'],initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.session.bind('render',this.postRender,this);},postRender:function(){this.$('select').first().focus();this.startTiming();},submit:function(){ var sentence_tokens=_.map(this.model.get('tokens'),function(token){if(token.word){return token.display_value;}else{return this.$('select#options_'+token.i).val();}});var sentence=sentence_tokens.join(' ');this.$('.medium').attr('disabled','disabled').blur();var ses=new duo.SessionElementSolution({session_element:this.model,sentence:sentence});this.save(ses);},graded:function(solution,response){duo.SessionElementView.prototype.graded.call(this,solution,response);var solution_data=solution.toJSON();solution_data.has_solutions=solution_data.correct_solutions&&solution_data.correct_solutions.length>0;this.$('#correct-solutions').html($.duostache(duo.templates['correct-solutions'],solution_data,duo.templates));},skip:function(){this.$('.medium').attr('disabled','disabled').blur();var ses=new duo.SessionElementSolution({session_element:this.model,sentence:''});this.save(ses);},change:function(e){var changed_select=$(e.target);if(changed_select.val()&&(changed_select.val().length>0)&&(changed_select.children('.placeholder').size()>0)){changed_select.children('.placeholder').remove();}
if(this.$('select .placeholder').size()==0&&this.session.get('state')==='rendered'){this.session.set({state:'ready'});}},clear:function(e){this.session.unbind('render',this.postRender);}});duo.ListenElementView=duo.SessionElementView.extend({events:{'keyup #word-input':'change','change #word-input':'change','click #big-speaker':'speakerClick','click .alert-message .close':'closeAlert','click .icon_speaker':'largeClick','click .slow-button':'slowClick'},template:duo.templates['listen-element'],initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.session.bind('render',this.postRender,this);this.session.bind('grade',this.graded_,this);this.session.bind('retry',this.retry,this);},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{need_flash:$.need_flash}),duo.templates));this.$('#word-input').vkeyboard({language:this.model.get('language'),placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:true});return this;},postRender:function(){ if(this.model.get('language')===duo.user.get('ui_language')){return;}
var self=this;this.session.trigger('loading_tts');this.$('#big-speaker').tts({absoluteURL:_ttsURL+this.model.get('language')+'/sentence/'+this.model.get('solution_key'),absolute_slow_URL:_ttsURL+this.model.get('language')+'/sentence/'+this.model.get('solution_key')+'_slow',template:duo.templates['speaker'],slowEnabled:true,onload:function(){self.session.trigger('loaded_tts');},beginner:duo.user.get('ab_options').beginner_slow_tts_experiment&&this.session.get('beginner')}); this.$('#word-input').focus();this.startTiming();},graded_:function(){var text=this.$('#word-input').val();this.$('#word-input').replaceWith("<div id='graded-word-input' class='one-line-input fake-input'></div>");this.$('#graded-word-input').text(text);var solution=this.session.get('session_element_solutions').last();var solution_data=solution.toJSON();if(solution_data.highlights!=undefined&&solution_data.highlights.length>0){solution_data.highlights=_.map(solution_data.highlights,function(x){return x[1];});if(solution_data.blame=='wrong_word'||solution_data.blame=='case_gender'||solution_data.blame=='gender'){var css_class_='line-through';}else{var css_class_='red-bold';}
this.$('#graded-word-input').highlight(css_class_,solution_data.highlights);}
solution_data.has_solutions=solution_data.correct_solutions&&solution_data.correct_solutions.length>0;this.$('#correct-solutions').html($.duostache(duo.templates['correct-solutions'],solution_data,duo.templates));this.showBlame();},speakerClick:function(){ this.$('#word-input').focus();},change:function(){if($.trim(this.$('#word-input').val()).length>0&&this.session.get('state')==='rendered'){this.session.set({state:'ready'});}else if($.trim(this.$('#word-input').val()).length===0&&this.session.get('state')==='ready'){this.session.set({state:'rendered'});}},submit:function(){var val=$.trim(this.$('#word-input').val());this.$('#word-input').attr('disabled','disabled').blur();var ses=null;if(this.ses){this.ses.set({value:val});ses=this.ses;}else{ses=new duo.SessionElementSolution({session_element:this.model,value:val});}
this.save(ses);},graded:function(session_element_solution,resp){if(session_element_solution.get('blame')==='wrong_language'){session_element_solution.set({try_again:true});this.session.set({state:'ready'});this.session.set({state:'rendered'});session_element_solution.unset('incorrect');session_element_solution.unset('wrong_language');session_element_solution.unset('try_again');return;}
return duo.SessionElementView.prototype.graded.call(this,session_element_solution,resp);},save:function(ses){if(this.session.get('state')==='submitted'||this.session.get('state')==='graded'){return;}
if(!this.ses){ if(this.session.get('state')!=='ready'){this.session.set({state:'ready'});}
ses.set({time_taken:this.stopTiming()});this.session.addSolution(ses);this.ses=ses;}
var self=this;this.session.set({state:'submitted'});ses.save(null,{success:this.graded,error:function(){ ses.set({correct:true});self.graded(ses,null);}});},skip:function(){this.$('#word-input').attr('disabled','disabled').blur();var ses=new duo.SessionElementSolution({session_element:this.model,value:''});this.save(ses);},retry:function(){this.$('#word-input').removeAttr('disabled').focus();},clear:function(){this.session.unbind('render',this.postRender);this.session.unbind('grade',this.graded_);this.session.unbind('retry',this.retry);},closeAlert:function(){this.$('.alert-message').remove();},largeClick:function(){},slowClick:function(){}});duo.TranslateElementView=duo.SessionElementView.extend({events:{'keyup #text-input':'change','change #text-input':'change','click .suggest-edit':'edit','click .cancel-edit':'cancelEdit','click .save-edit':'saveEdit','click .word-tooltip':'hideWordTooltip'},template:duo.templates['translate-element'],initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.model.set({hovered_words:[]});this.session.bind('render',this.postRender,this);this.session.bind('grade',this.graded_,this);this.submitted=false;this.other_translations_view=options.other_translations_view;this.explanations={};this.new_explanation_ids=[];var first_translate=this.session.get('first_translate');var model_explanations=this.model.get('explanations');if(model_explanations!=null)this.explanations=model_explanations;if(!first_translate){var model_new_explanation_ids=this.model.get('new_explanation_ids');if(model_new_explanation_ids!=null)this.new_explanation_ids=model_new_explanation_ids;}},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{need_flash:$.need_flash,multiple_new_words:!this.session.isTest()&&this.model.has('unknown_words')&&this.model.get('unknown_words').length>1,num_new_words:this.model.has('unknown_words')?this.model.get('unknown_words').length:0,relevant_words:_.map(this.model.get('relevant_words'),function(d,w){return{word:w,last_seen:d}})}),duo.templates));this.$input_field=this.$('#text-input');this.startPlugins();return this;},startPlugins:function(){var vkeyboard_language=this.model.get('target_language');var vkeyboard_shown=this.model.get('target_language')!=duo.user.get('ui_language');var vkeyboard_custom_keys='';if(!$.vkeyboard.hasKeyboard(this.model.get('target_language'))&&(this.model.get('has_accents')||this.model.get('unknown'))){ vkeyboard_language=this.model.get('source_language');vkeyboard_shown=false;vkeyboard_custom_keys=$.vkeyboard.getAccentedChars(this.model.get('sentence'),this.model.get('source_language'));}else if($.vkeyboard.hasKeyboard(this.model.get('target_language'))){ vkeyboard_custom_keys=$.vkeyboard.getAccentedChars(this.model.get('sentence'),this.model.get('target_language'));}
this.$input_field.vkeyboard({language:vkeyboard_language,placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:vkeyboard_shown,custom_keys:vkeyboard_custom_keys}); var show_tokens=[];var style_mapping={};var templates=null;var top=null;if(this.model.has('highlight')&&this.model.has('unknown_words')&&(this.model.get('unknown_words').length===1)){show_tokens=this.model.get('highlight').slice(0,1);}
_.each(this.model.get('unknown_words'),function(word){style_mapping[word]='highlighted-new-word';});_.each(this.model.get('relevant_words'),function(d,word){style_mapping[word]='relevant';});if(!this.session.isTest()){templates=duo.templates;}else{templates=_.extend({},duo.templates,{'hints-token':duo.templates['hints-token-test']});}
if(this.new_explanation_ids.length>0){var seen_explanations=this.session.get('seen_explanations');this.new_explanation_ids=_.difference(this.new_explanation_ids,seen_explanations);this.session.set({'seen_explanations':_.union(seen_explanations,this.new_explanation_ids)});}
var self=this;var renderCallback=function(){self.postHintRender();}
var hints_option={callback:this.hintHover,callback_context:this,templates:templates,source_language:this.model.get('source_language'),target_language:this.model.get('target_language'),show_tokens:show_tokens,style_mapping:style_mapping,render_callback:renderCallback,language_information:this.session.get('language_information'),reverse:this.model.get('target_language')===this.session.get('language'),highlight_verb_endings:this.model.get('known'),explanations:this.explanations,new_explanation_ids:this.new_explanation_ids};if(top){hints_option.top=top;}
this.$('.hints').hints(hints_option);this.$(".fbox").fancybox({'prevEffect':null,'nextEffect':null});},graded_:function(){if(this.other_translations_view){this.$('#other-translations').replaceWith(this.other_translations_view.render().el);this.$('.website-images').hide();}
var solution=this.session.get('session_element_solutions').last();var solution_data=solution.toJSON();if(solution.get('hover_trial')!=true){var text=this.getVal();this.setVal(this.getVal()); var fake_textarea_data=this.getFakeAreaData(text);this.$input_field.hide();$($.duostache(duo.templates['fake-textarea'],fake_textarea_data,duo.templates)).insertAfter(this.$input_field);if(solution_data.highlights!=undefined&&solution_data.highlights.length>0){var solution_highlights=_.map(solution_data.highlights,function(x){return x[1];});if(solution_data.blame=='wrong_word'||solution_data.blame=='case_gender'||solution_data.blame=='gender'){var css_class_='line-through';}else{var css_class_='red-bold';}
this.$('#graded-text-input').highlight(css_class_,solution_highlights);}
solution_data.has_solutions=solution_data.correct_solutions&&solution_data.correct_solutions.length>0;this.$('#correct-solutions').html($.duostache(duo.templates['correct-solutions'],solution_data,duo.templates));this.showBlame();}},hintHover:function(word,index,element,hint,not_hover){clearTimeout(this.hover_idle_timer);if(this.session.isTest()){return;}
var unknown_words=this.model.get('unknown_words');var known_words=this.model.get('known_words');var word_lower=word.toLowerCase();var is_new_word=unknown_words!=null&&_.indexOf(unknown_words,word_lower)>=0;var new_word_tooltip='#new-word';var is_new_concept=(this.new_explanation_ids!=null&&this.explanations[index]!=null&&_.indexOf(this.new_explanation_ids,this.explanations[index].id)!=-1);if(is_new_concept){is_new_word=true;new_word_tooltip='#new-concept';this.$('.word-tooltip').hide();}else if(!is_new_word){this.$('.word-tooltip').fadeOut(200);}else{this.$('#multiple-new-words').fadeOut(200);}
var $element=$(element);if(this.model.get('source_language')!==duo.user.get('ui_language')&&duo.user.shouldAutoPlay()){ if('tts'in $element.data()){$element.trigger('play');}else{var auto_play=!not_hover;var ttsURL=_ttsURL;ttsURL+=this.model.get('source_language')+'/token/';ttsURL+=encodeURIComponent(word_lower);$element.tts({absoluteURL:ttsURL,autoplay:auto_play,visible:false,play_trigger:'play'
});}}
if(!this.submitted){var $element=$(element);word=word_lower;this.model.get('hovered_words').push(word);if(is_new_word){var $tooltip=$element.find('.word-tooltip');if($tooltip.size()===0){$tooltip=$(new_word_tooltip).clone();$tooltip.attr('id','#new-word-'+index).appendTo($element.find('.token-wrapper')).anchor({type:'horizontal',anchor:$element});$element.css('position','relative');}
$tooltip.show();$element.mouseleave(function(){$tooltip.fadeOut(400);});this.session.trigger('hovered',word,hint,true); return is_new_concept;}else if(this.model.get('relevant_words')&&word in this.model.get('relevant_words')){var tip=$('#'+word+'-tooltip');tip.appendTo($element).anchor({type:'horizontal',anchor:$element}).show();$element.mouseleave(function(){tip.fadeOut(400);}).addClass('peeked-at');this.session.trigger('hovered',word,hint);}else if(known_words==null||_.indexOf(known_words,word_lower)>=0){var clone=$('#peek').clone();clone.find(".word-tooltip-strength").hide();clone.attr('id','#peek-'+index).appendTo($element).anchor({type:'horizontal',anchor:$element}).show();$element.mouseleave(function(){clone.fadeOut(400);}).addClass('peeked-at');this.session.trigger('hovered',word,hint);}}},hideWordTooltip:function(e){var tooltip=$(e.currentTarget);tooltip.fadeOut(400);},postRender:function(){this.$input_field.focus().autosize();if(this.model.get('source_language')===duo.user.get('ui_language')){ return;}
this.$('#big-speaker').tts(_.extend(this.model.toJSON(),{absoluteURL:_ttsURL+this.model.get('source_language')+'/sentence/'+this.model.get('solution_key'),template:duo.templates['speaker'],autoplay:duo.user.shouldAutoPlay(),sentenceType:this.session.get('type')=='sentence_translation'?'translation':'lesson'}));if(this.session.get('beginner')){this.hover_idle_timer=setTimeout(_.bind(this.showIdleMessage,this),5000);}
this.startTiming();},postHintRender:function(){ this.$('#multiple-new-words').appendTo(this.$('.hints-sentence').css('position','relative')).anchor({type:'horizontal',anchor:this.$('.hints-sentence')}).show();},showIdleMessage:function(){this.$('#idle-message').fadeIn();},change:function(e){if($.trim(this.$input_field.val()).length>0&&this.session.get('state')==='rendered'){this.session.set({state:'ready'});}else if($.trim(this.$input_field.val()).length===0&&this.session.get('state')==='ready'){this.session.set({state:'rendered'});}
if(e.which==13){e.preventDefault();}},getVal:function(){return this.$input_field.textInputVal();},setVal:function(str){this.$input_field.val(str);},disableTextInput:function(){this.$input_field.attr('disabled','disabled').blur();},enableTextInput:function(){this.$input_field.removeAttr('disabled');},submit:function(){this.submitted=true;this.disableTextInput();var val=$.trim(this.getVal());this.ses=new duo.SessionElementSolution({session_element:this.model,value:val});this.save(this.ses);},skip:function(){this.disableTextInput();this.setVal('');var ses=new duo.SessionElementSolution({session_element:this.model,value:''});this.save(ses);},edit:function(){this.$('#graded-text-input').hide();this.$('.save-edit, .cancel-edit').show();this.$input_field.show().focus();this.$input_field.data('orig-val',this.getVal());this.enableTextInput();this.$input_field.focus();return false;},cancelEdit:function(){this.$('#graded-text-input').show();this.$('.save-edit, .cancel-edit').hide();this.$input_field.hide();this.setVal(this.$input_field.data('orig-val'));return false;},saveEdit:function(){var val=this.getVal();var fake_textarea_data=this.getFakeAreaData(val);this.$input_field.hide();this.$('.fake-input-area').replaceWith($.duostache(duo.templates['fake-textarea'],fake_textarea_data,duo.templates));var ses=new duo.SessionElementSolution({session_element:this.model,value:val});this.session.addSolution(ses);ses.save();this.$('.suggest-edit').removeAttr('style');return false;},getFakeAreaData:function(val){return{text:val,unknown:this.model.get('unknown')};},clear:function(){this.session.unbind('render',this.postRender);this.session.unbind('grade',this.graded_);}});duo.FindElementView=duo.SessionElementView.extend({template:duo.templates['find-element']});duo.StackTranslateElementView=duo.TranslateElementView.extend({template:duo.templates['stack-translate-element'],render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));this.$input_field=this.$('#text-input');this.$('#text-input').vkeyboard({language:this.model.get('target_language'),placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:this.model.get('target_language')!=duo.user.get('ui_language')});this.$('.hints').hints({show_hints:1,templates:duo.templates,callback:this.hintHover,callback_context:this,source_language:this.model.get('source_language'),target_language:this.model.get('target_language'),manual_hints:this.model.has('manual_hints')?this.model.get('manual_hints'):null});return this;},hintHover:function(word,index,element){clearTimeout(this.hover_idle_timer);if(!this.submitted){this.session.trigger('hover',word);}},change:function(e){if($.trim(this.$('#text-input').val()).length>0&&this.session.get('state')==='rendered'){}else if($.trim(this.$('#text-input').val()).length===0&&this.session.get('state')==='ready'){}
duo.TranslateElementView.prototype.change.call(this,e);}});duo.ExtractElementView=duo.StackTranslateElementView.extend({initialize:function(options){duo.StackTranslateElementView.prototype.initialize.call(this,options); this.variable=this.model.get('sentence').match(/\$\$(.+)\$\$/);this.regexes=_.map(this.model.get('correct_translations'),function(sentence){return new RegExp('^'+sentence.replace('.','\\.?').replace(/\$\$(.+)\$\$|__(.+)__/g,'(.+?)')+'$','i');});},render:function(){var special_hints={};special_hints[this.variable[0]]={value:'«type in your '+this.variable[1]+'»',hint_table:{rows:[{cells:[{colspan:1,hint:'Put your '+this.variable[1]+' here'}]}]},class_name:'extract-token'};$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));this.$('#text-input').vkeyboard({language:this.model.get('target_language'),placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:this.model.get('target_language')!=duo.user.get('ui_language')});this.$('.hints').hints({show_hints:1,templates:duo.templates,specials:special_hints});return this;},postRender:function(){this.$('#text-input').focus();if(this.model.get('source_language')===duo.user.get('ui_language')){return;}
this.$('#big-speaker').tts(_.extend(this.model.toJSON(),{template:duo.templates['speaker'],text:this.model.get('sentence').replace(/\$\$(.+)\$\$/g,''),autoplay:duo.user.shouldAutoPlay(),language:this.model.get('source_language')}));this.startTiming();},tryExtraction:function(){var input=$.trim(this.$('#text-input').val());for(var i=0;i<this.regexes.length;i++){var match=this.regexes[i].exec(input);if(match){ return match[1];}}
return false;},change:function(){if($.trim(this.$('#text-input').val()).length>0&&this.session.get('state')==='rendered'){if(this.tryExtraction()){this.session.set({state:'ready'});}}else if(this.session.get('state')==='ready'){if(!this.tryExtraction()){this.session.set({state:'rendered'});}}},submit:function(){this.submitted=true;this.$('#text-input').attr('disabled','disabled').blur();var val=$.trim(this.$('#text-input').val());var greeting="";if(this.variable[1]==='name'){var name=this.tryExtraction();greeting='Hello '+name+', nice to meet you!';duo.user.set({fullname:name});}else if(this.variable[1]==='location'){var location=this.tryExtraction();greeting=this.tryExtraction()+' seems like a nice place!';duo.user.set({location:location});}
this.ses=new duo.SessionElementSolution({session_element:this.model,value:val,greeting:greeting});this.save(this.ses);}});duo.TitleElementView=duo.ExampleNameElementView.extend({render:function(){return this;}});duo.HoverElementView=duo.TranslateElementView.extend({template:duo.templates['hover-element'],initialize:function(options){duo.TranslateElementView.prototype.initialize.call(this,options);var sentence=this.model.get('text');var context_variables=this.session.get('context_variables');for(var field in context_variables){sentence=sentence.replace('\$\$'+field+'\$\$',context_variables[field]);}
this.model.set({'text':sentence});this.notHovered=true;},render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));var context_variables=this.session.get('context_variables');var manual_hints=null;if(this.model.has('manual_hints')){manual_hints=this.model.get('manual_hints');for(var i=0;i<manual_hints.length;i++){if(manual_hints[i].match){var variable_match=manual_hints[i].match(/\$\$(.+)\$\$/);if(variable_match){manual_hints[i]=[context_variables[variable_match[1]],context_variables[variable_match[1]]];}}}}
this.$('.hints').hints({show_hints:1,templates:duo.templates,callback:this.hintHover,callback_context:this,source_language:this.model.get('source_language'),target_language:this.model.get('target_language'),manual_hints:this.model.has('manual_hints')?this.model.get('manual_hints'):null});return this;},hintHover:function(word,index,element){var self=this;if(this.notHovered){_.defer(function(){self.notHovered=false;self.session.set({state:'ready'}); self.session.addSolution(new duo.SessionElementSolution({session_element:self.model,correct:true,hover_trial:true}));$("#bubble-hover").delay(1000).fadeIn();self.session.set({state:'submitted'});self.session.set({state:'graded'});self.session.trigger('hover',word);});};$('.owl-standing-big').removeClass("pointing");},postRender:function(){this.startTiming();}});duo.InfoElementView=duo.SessionElementView.extend({template:duo.templates['info-element'],events:{'keyup input[type="text"]':'change','change input[type="text"]':'change'},initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.session.bind('render',this.postRender,this);},render:function(){var fields=this.model.get('fields');var fieldnames=new Array(fields.length);for(var i=0;i<fields.length;i++){fieldnames[i]=translate_text(fields[i]);}
$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{variable_list:fieldnames.slice(0,-1).join(', ')+' '+translate_text('and')+' '+fieldnames[fields.length-1]}),duo.templates));return this;},postRender:function(){this.$('.welcome-info-label').inFieldLabels();this.startTiming();},change:function(){var ready=_.reduce(this.model.get('fields'),function(ready,field){return ready&&$.trim(this.$('#'+field+'-input').val()).length>0;},true,this);if(ready&&this.session.get('state')==='rendered'){this.session.set({state:'ready'});}else if(!ready&&this.session.get('state')==='ready'){this.session.set({state:'rendered'});}},submit:function(){var context_variables=_.reduce(this.model.get('fields'),function(variables,field){variables[field]=$.trim(this.$('#'+field+'-input').val());return variables;},{},this);var greeting='';if('name'in context_variables&&'hometown'in context_variables){greeting=translate_text('Hello {{name}} from {{hometown}}!');greeting=greeting.replace('{{name}}',context_variables.name);greeting=greeting.replace('{{hometown}}',context_variables.hometown);}
this.session.set({context_variables:context_variables});this.ses=new duo.SessionElementSolution({session_element:this.model,value:context_variables,greeting:greeting});this.save(this.ses); var new_attr={}
if('name'in context_variables){new_attr.fullname=context_variables.name;}
if('hometown'in context_variables){new_attr.location=context_variables.hometown;}
duo.user.save(new_attr);},skip:function(){var context_variables=_.reduce(this.model.get('fields'),function(variables,field){variables[field]='';return variables;},{},this);this.session.set({context_variables:context_variables});var ses=new duo.SessionElementSolution({session_element:this.model,value:context_variables,greeting:'You can always fill out your information in settings.'});this.save(ses);},clear:function(){this.session.unbind('render',this.postRender);}});duo.ContextTranslateElementView=duo.StackTranslateElementView.extend({initialize:function(options){duo.StackTranslateElementView.prototype.initialize.call(this,options);var sentence=this.model.get('text');var context_variables=this.session.get('context_variables');for(var field in context_variables){sentence=sentence.replace('\$\$'+field+'\$\$',context_variables[field]);}
this.sentence=sentence;this.regexes=_.map(this.model.get('correct_translations'),function(sentence){for(var field in context_variables){sentence=sentence.replace('.','\.?').replace('\$\$'+field+'\$\$',context_variables[field]);}
return new RegExp('^'+sentence+'$','i');});},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{sentence:this.sentence}),duo.templates));this.$('#text-input').vkeyboard({language:this.model.get('target_language'),placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:this.model.get('target_language')!=duo.user.get('ui_language')});var context_variables=this.session.get('context_variables');var manual_hints=null;if(this.model.has('manual_hints')){manual_hints=this.model.get('manual_hints');for(var i=0;i<manual_hints.length;i++){if(manual_hints[i].match){var variable_match=manual_hints[i].match(/\$\$(.+)\$\$/);if(variable_match){manual_hints[i]=[context_variables[variable_match[1]],context_variables[variable_match[1]]];}}}}
this.$('.hints').hints({show_hints:1,callback:this.hintHover,callback_context:this,manual_hints:manual_hints,templates:duo.templates,source_language:this.model.get('source_language'),target_language:this.model.get('target_language')});return this;},postRender:function(){this.$('#text-input').focus();if(this.model.get('source_language')===duo.user.get('ui_language')){return;}
this.$('#big-speaker').tts(_.extend(this.model.toJSON(),{template:duo.templates['speaker'],text:this.sentence,autoplay:duo.user.shouldAutoPlay(),language:this.model.get('source_language')}));this.startTiming();},tryMatch:function(){var input=$.trim(this.$('#text-input').val());for(var i=0;i<this.regexes.length;i++){var match=this.regexes[i].exec(input);if(match){return true;}}
return false;},submit:function(){this.$('#text-input').attr('disabled','disabled').blur();var val=$.trim(this.$('#text-input').val());this.ses=new duo.SessionElementSolution({session_element:this.model,value:val,context_variables:this.session.get('context_variables')});this.save(this.ses);}});duo.MicrophoneActivationElementView=duo.SpeakElementView.extend({template:duo.templates['microphone-activation-element'],events:{'click #no-mic-link':'turnMicOff'},initialize:function(options){duo.SessionElementView.prototype.initialize.call(this,options);this.ses=new duo.SessionElementSolution({session_element:this.model});this.session.addSolution(this.ses);this.session.bind('render',this.postRender,this);duo.flashSettingsClosed=_.bind(this.settingsClosed,this);},postRender:function(){swfobject.embedSWF('/swf/microphoneActivation.swf','activate-flash','215','138','10','/swf/expressInstall.swf',{},{allowscriptaccess:"always",allowScriptAccess:"always",bgcolor:'#ffffff',quality:'high',allowfullscreen:'true'},{id:'activate-flash',name:'activate-flash'});},turnMicOff:function(message){this.$('#no-mic-link').css('visibility','hidden');this.$('#speak-mic-off').show();$('#flash-help-1').fadeOut();$('#flash-help-2').fadeOut();$('#flash-help-3').fadeOut();$('.activate-flash').hide();$('.owl-standing-big').removeClass("pointing");duo.user.save({microphone:false}); var this_index=this.session.get('session_elements').indexOf(this.model);var speak_elements=this.session.get('session_elements').filter(function(element,index){return element.get('type')=='speak'&&index>this_index;});this.session.get('session_elements').remove(speak_elements);this.save(this.ses);},settingsClosed:function(){var self=this;$("#speak-instruction").delay(1000).fadeIn(400,function(){self.save(self.ses);});duo.user.save({activate_microphone:true});$("#flash-help-1").fadeOut();$("#flash-help-2").fadeOut();$("#flash-help-3").fadeOut();$("#no-mic-link").css('visibility','hidden');$('.activate-flash').hide();$('.owl-standing-big').removeClass("pointing");},keyCheck:function(e){},save:function(ses){this.session.set({state:'submitted'});this.session.set({state:'graded'});},clear:function(){this.session.unbind('render',this.postRender);duo.flashSettingsClosed=null;$(document).unbind('.speak');}});duo.GradeView=Backbone.View.extend({id:'grade',template:duo.templates['grade'],events:{},initialize:function(options){this.model.bind('grade',this.graded_,this);this.model.bind('retry',this.graded_,this);this.model.bind('continue',this.next,this);this.data={};this.points_per_correct=options.points;this.extra_time=options.extra_time;this.long_sentence_bonus=options.long_sentence_bonus;this.sentence={};},render:function(){if(this.data.judge===true){var sol=this.data.correct_solutions;this.data['formatted_judge']="\""+sol.slice(0,sol.length).join("\" and \"")+"\"";}
if(this.data.session_element){this.data['source_language_name']=this.getSourceName(this.data.session_element.get('source_language'));}
this.data['language_name']=this.getSourceName(this.data.learning_language);this.data['has_audio']=this.data.session_element?this.data.session_element.get('source_language')==this.data.learning_language:false;$(this.el).html($.duostache(this.template,_.extend(this.data,{}),duo.templates));this.hints_shown=false; if(this.data.session_element&&(this.data.session_element.get('target_language')===this.model.get('language')||this.data.session_element.get('language')===this.model.get('language'))){this.hints_shown=true;this.$('.translation_source').first().hints({templates:duo.templates,top:10,source_language:this.model.get('language'),target_language:duo.user.get('ui_language'),highlights:this.data.highlights,language_information:this.model.get('language_information')});}
this.$('.free-write-box').autosize({append:"\n"});this.$('#submit-problem').attr('disabled','disabled');this.$('label').inFieldLabels();return this;},highlight:function(){if(this.data.highlights!=undefined&&this.data.highlights.length>0&&!this.hints_shown){$('.translation_source').first().highlight('highlight',this.data.highlights);$('.highlight').css({'font-weight':'bold'});}},graded_:function(){var solution=this.model.get('session_element_solutions').last();var element=solution.get('session_element');var type=element.get('type');var user_solution=$.trim(solution.getDisplayText());this.data=solution.toJSON();this.data[type]=true;this.data.has_solutions=this.data.correct_solutions&&this.data.correct_solutions.length>0;this.data.user_solution=user_solution;if(this.data.highlights!=undefined){this.data.highlights=_.map(this.data.highlights,function(x){return x[0];});this.data.num_highlights=this.data.highlights.length;} 
this.data.points_per_correct=this.points_per_correct;if(element&&(element.get('type')=='translate'||element.get('type')=='listen')){var text=element.get('type')=='translate'?element.get('sentence'):element.get('text');this.data.extra_time=text.split(' ').length>6?this.extra_time+this.long_sentence_bonus:this.extra_time;}else{this.data.extra_time=this.extra_time;}
if('score'in this.data){var score=this.data.score;var brackets=[88,71,55,38,21,5,0];var style_mapping={88:100,71:85,55:65,38:50,21:35,5:15,0:0};this.data.score_bracket=style_mapping[_.find(brackets,function(bracket){return score>=bracket;})];}
this.data['session_'+this.model.get('type')]=true;this.data.has_discussion=type!=='name'&&type!=='select'; if(type==='judge'&&!solution.get('correct')){var correct_choices=solution.get('correct_choices');var choices=solution.get('choices');var marked_wrong=0;_.each(choices,function(choice,index){if(choice==='correct'&&correct_choices[index]==='correct'){ this.data.judge_one_correct=true;}else if(choice==='correct'&&correct_choices[index]==='incorrect'){ marked_wrong++;}},this);this.data.judge_one_wrong=marked_wrong==1;this.data.judge_more_wrong=marked_wrong>1;this.data.judge_missed=marked_wrong==0;}
this.render();if(this.data.highlights!=undefined){this.highlight();}},next:function(){this.data={};this.render();},getSourceName:function(abbr){var names={'en':'English','es':"Spanish",'pt':"Portuguese",'fr':"French",'de':'German','it':'Italian'};return names[abbr];}});duo.SlideSessionEndView=Backbone.View.extend({id:'app',template:duo.templates['slide-session-end'],events:{'click .carousel-dot':'moveCarousel','click .player-action .continue':'onContinue','click .player-action .end-continue':'onPractice'},initialize:function(){_.bindAll(this,'animateCoins');$(document).unbind('.session');setTimeout(_.bind(function(){$(document).bind('keyup.session',_.bind(this.keyCheck,this));},this),2000);},render:function(){ var data={}; if(this.model.has('points_data')){var points_data=this.model.get('points_data'); data.level_left_before=points_data.level_left+this.model.get('gained_skill_points'); var before_percent=(points_data.level_progress-this.model.get('gained_skill_points'))/points_data.level_points; data.level_before_bar_width=Math.max(0,before_percent*360);}
if(this.model.get('words_strengthened')!=null){_.each(this.model.get('words_strengthened'),function(word){_.extend(word,duo.wordStrengthData(word.strength));});data.num_strengthened=this.model.get('num_words_strengthened')||this.model.get('words_strengthened').length;data.more_strengthened=data.num_strengthened-this.model.get('words_strengthened').length;}else{data.num_strengthened=0;data.more_strengthened=0;}
data.learned=this.model.has('learned_skills')&&this.model.get('learned_skills').length;data.has_awesome_event=this.model.has('level_event')||data.mastered||data.learned;data.home=data.has_awesome_event||(!this.model.has('skill_id')&&!this.model.has('skill_name'));data.index=this.model.get('learned_skills').length>0?this.model.get('learned_skills')[0].index:null;data.num_learned=this.model.get('learned_skills').length;data.num_unlocked=this.model.get('unlocked_skills').length; data.has_hearts=this.model.has('hearts')&&!this.model.get('timed');data.practice=this.model.get('type')==='practice'||this.model.get('type')==='skill_practice'||this.model.get('type')==='words_practice';data.skill_practice=this.model.get('type')==='skill_practice';data.word_practice=this.model.get('type')==='words_practice';data['hearts-'+this.model.get('num_hearts')]=true;this.$el.html($.duostache(this.template,_.extend(this.model.toJSON(),data),duo.templates));this.$('#end-carousel').carousel({interval:4000});this.$('#end-carousel').bind('slide',_.bind(this.onSlide,this));_.defer(this.animateCoins);_.defer(function(){if(window.twttr&&twttr.widgets){twttr.widgets.load();}});return this;},animateCoins:function(){ var animation_delay=0;this.$('.animated-pieces').each(function(index,element){(function(){var $element=$(element);setTimeout(function(){$element.find('[data-style]').each(function(i,e){$(e).toggleClass('hidden '+$(e).data('style'));});},animation_delay);})();animation_delay+=500;});if(this.timer_view&&data.seconds_left){ animation_delay+=250;setTimeout(_.bind(function(){this.$('#timer-text').animate({seconds_left:data.seconds_left},{step:function(now,fx){$(this).text($.duostache('{{#format_seconds}}{{seconds_left}}{{/format_seconds}}',{seconds_left:now}));},duration:500});this.$('#timer-container').arc({stroke:'#5b9700',fill:'#7ec200',strokewidth:1,value:0,total:this.timer_view.original_total_time/1000,width:12}).arc({animate:true,duration:500,value:Math.min(this.timer_view.original_total_time/1000,data.seconds_left),total:this.timer_view.original_total_time/1000});},this),animation_delay);animation_delay+=500;}
setTimeout(_.bind(function(){var level_before_bar_width=this.$('.session-end-progress .bar').width();var level_left_before=this.model.get('points_data').level_left+this.model.get('gained_skill_points'); var level_bar_diff=this.model.get('points_data').level_percent*this.$('.session-end-progress').width()/100.0-level_before_bar_width;this.$('.session-end-progress .bar').animate({manualwidth:level_bar_diff,points:this.model.get('gained_skill_points')},{step:_.bind(function(now,fx){if(fx.prop==='points'){this.$('#left-in-level').text(parseInt(level_left_before-now));}else{this.$('.session-end-progress .bar').width(level_before_bar_width+now);}},this),duration:1000});},this),animation_delay);if(this.model.has('level_event')||(this.model.has('learned_skills')&&this.model.get('learned_skills').length>0)){Backbone.history.once('route',this.showAwesomeEvent,this);}},onSlide:function(e){var panel=$(e.relatedTarget);var slide=panel.data('slide');var num_dots=this.$('.carousel-dot').size();this.$('.carousel-dot').removeClass('active');var dot=this.$('.carousel-dot:eq('+slide+')');if(dot.next('.carousel-dot').size()===0&&!this.carousel_paused){_.defer(_.bind(function(){this.$('.carousel').carousel('pause');this.carousel_paused=true;},this));}
dot.addClass('active');},moveToSlide:function(slide){this.$('.carousel').carousel('pause');this.$('#end-carousel').carousel(slide);},moveCarousel:function(e){var dot=$(e.currentTarget);var slide=dot.data('slide');this.moveToSlide(slide);},keyCheck:function(e){if(e.which===13){this.$('.player-action .continue').click();}},onContinue:function(e){var button=$(e.currentTarget);if(this.$('#end-carousel .item:last').hasClass('active')||!button.hasClass('primary')){var href=button.data('href');var router=button.data('r');if(window.location.hash==='#'+href||window.location.hash==='#/'+href){this.reloadPage();}else{duo[router+'Router'].navigate(href,true);}}else{this.$('.carousel').carousel('next');}},onPractice:function(e){var button=$(e.currentTarget);var href=button.data('href');var router=button.data('r');window.location.reload(true);},showAwesomeEvent:function(){var awesome_view=new duo.SlideSessionAwesomeView({model:this.model});awesome_view.render();awesome_view.$el.appendTo('body').modal({keyboard:true,backdrop:true,show:true}).on('hidden',function(){awesome_view.remove();});$('#awesome-modal').modal('show');}});duo.SlideSessionAwesomeView=Backbone.View.extend({id:'awesome-modal',template:duo.templates['awesome-modal'],className:'hidden',events:{'click .continue':'hideModal','click #facebook-post-action:not(.shared)':'postFacebook','change #fb-auto-post':'changeAutoPost','keyup #fb-auto-post':'changeAutoPost'},initialize:function(options){if(options.skipToAwesome==true){this.skipToAwesome=true;}else{this.skipToAwesome=false;this.model.bind('change',this.render,this);}},render:function(){_.defer(function(){if(window.twttr&&twttr.widgets){twttr.widgets.load();}});var data={};if(this.skipToAwesome==false){var skills=duo.user.getSkills().skills;this.model.set({finished_tree:this.model.has('learned_skills')&&this.model.get('learned_skills').length&&skills.checkFinished()},{silent:true});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{num_unlocked:this.model.has('unlocked_skills')?this.model.get('unlocked_skills').length:null,learned:this.model.has('learned_skills')&&this.model.get('learned_skills').length,index:this.model.get('learned_skills')&&this.model.get('learned_skills').length>0?this.model.get('learned_skills')[0].index:null,auto_facebook_post:duo.user.get('auto_facebook_post')}),duo.templates));if(duo.user.get('auto_facebook_post')){ this.autoPostFacebook();}}else{this.model.set({finished_tree:true},{silent:true});$(this.el).html($.duostache(this.template,{finished_tree:true,ui_language:this.model.get('ui_language'),language:this.model.get('learning_language'),language_string:this.model.get('learning_language_string')}));}},hideModal:function(){this.$el.modal('hide');this.remove();},postFacebook:function(){if(!window.FB){return;}
var self=this;mixpanel.track('facebook share click');FB.login(function(login_response){if(login_response.authResponse){self.postToFacebook(login_response.authResponse); if(!duo.user.get('facebook_id')){var facebook_id=login_response.authResponse.userID;$.post('/facebook_connect',{facebook_id:facebook_id,facebook_friends:'[]',auto_follow:false});duo.user.set({facebook_id:facebook_id});}}},{scope:'publish_actions'});},autoPostFacebook:function(){ if(!window.FB){ return;}
var auth_response=FB.getAuthResponse();if(auth_response){mixpanel.track('facebook auto post');this.postToFacebook();}},postActionsToFacebook:function(){ var self=this;var og=duo.debug?'skill_debug':'skill';_.each(this.model.get('learned_skills'),function(skill){var options={skill:'http://duolingo.com/'+og+'/'+skill.id,'fb:explicitly_shared':true};duo.postFacebookAction(duo.fb_app,'learn',options);});},postToFacebook:function(){this.$('#facebook-post-action').addClass('shared').text('shared on facebook').attr('disabled','disabled'); if(this.model.get('finished_tree')){var og=duo.debug?'og_debug':'og';var options={language:'http://duolingo.com/'+og+'/'+this.model.get('language'),'fb:explicitly_shared':true};duo.postFacebookAction(duo.fb_app,'conquer',options);} 
else if(this.model.has('level_event')){var og=duo.debug?'og_debug':'og';var options={level:'http://duolingo.com/'+og+'/'+this.model.get('language')+'/'+this.model.get('level_event').new_level,'fb:explicitly_shared':true};duo.postFacebookAction(duo.fb_app,'reach',options);}
this.postActionsToFacebook();mixpanel.track('facebook shared');},changeAutoPost:function(){var new_value=this.$('#fb-auto-post').is(':checked');mixpanel.track('toggle auto post',{new_value:new_value});if(new_value){this.$('#facebook-post-action').click();}
duo.user.save({auto_facebook_post:new_value});}});duo.SessionEndView=Backbone.View.extend({id:'app',events:{'click #facebook-post-action:not(.shared)':'postFacebook','click .progress-tab':'progressTabChange','click #learning-button':'continueLearning','click .end-continue[data-r]':'continueRoute','click #dismiss-awesome':'dismissAwesome','click .player-action .btn':'disableButtons','focus .post-activity #text-input, .post-activity input':'onStreamPost','click .post-activity #stream-post-btn':'makeStreamPost','change #fb-auto-post':'changeAutoPost','keyup #fb-auto-post':'changeAutoPost','click .end-continue[data-reload]':'reloadPage'},template:duo.templates['session-end'],getEventClass:function(){return'.session';},initialize:function(subviews){this.progress_view=subviews.progress_view;this.hearts_view=subviews.hearts_view;this.timer_view=subviews.timer_view; this.model.bind('change',this.render,this);$(document).unbind('.session');var self=this;setTimeout(function(){$(document).bind('keyup.session',_.bind(self.keyCheck,self));},2000);},getResults:function(){var results={};results=this.model.get('session_element_solutions').reduce(function(result,solution){var session_element=solution.session_element||solution.get('session_element');if(solution.correct||solution.get('correct')||(solution.correct==undefined&&solution.get('correct')==undefined)){result.correct+=1;}
return result;},{correct:0});results.percentage_correct=Math.ceil(results.correct*100.0/this.model.get('session_element_solutions').length);if(this.model.has('end_event')){var end_event=this.model.get('end_event');results.points_gained=this.model.get('gained_skill_points');results.unlocked=this.model.get('unlocked_skills').length; if(end_event.skills.length>2){end_event.displayed_skills=end_event.skills.slice(0,1);end_event.hidden_skills=end_event.skills.slice(1);end_event.has_hidden_skills=true;}else{end_event.displayed_skills=end_event.skills;}}
if(this.model.has('learned_skills')){var learned=[];_.each(this.model.get('learned_skills'),function(skill){learned.push(skill.title);});results.learned=learned.length; if(learned.length===1){results.headline_learned=learned[0];}else if(learned.length<=3){results.headline_learned=learned.slice(0,-1).join(', ')+' '+translate_text('and')+' '+learned[learned.length-1];}} 
var num_hearts=parseInt(Math.ceil(this.model.get('num_hearts')));results['hearts-'+num_hearts]=true;if(results.points_gained&&(this.model.get('type')==='lesson'||this.model.get('type')==='practice'||this.model.get('type')==='skill_practice')){results.bonus=num_hearts;}
if(this.model.has('points_data')){var points_data=this.model.get('points_data');results.left_in_level=points_data.level_points-points_data.level_progress;results.next_level=points_data.level+1; results.level_left_before=points_data.level_left+this.model.get('gained_skill_points'); var before_percent=(points_data.level_progress-this.model.get('gained_skill_points'))/points_data.level_points
results.level_before_bar_width=before_percent*450;}
if(this.model.has('words_strengthened')){_.each(this.model.get('words_strengthened'),function(word){_.extend(word,duo.wordStrengthData(word.strength));});results.num_strengthened=this.model.get('words_strengthened').length;}else{results.num_strengthened=0;}
if(this.model.has('start_time')&&this.model.has('end_time')&&this.timer_view){var start_time=new Date(this.model.get('start_time'));var end_time=new Date(this.model.get('end_time'));results.seconds_left=Math.max(0,(this.timer_view.total_time-(end_time-start_time))/1000);}
if(this.model.has('point_accumulation')&&!results.seconds_left){results.challenge_count=true;}
return results;},getRenderingData:function(){var results=this.getResults();var data=_.extend(this.model.toJSON(),results,{to_skill:this.model.get('skill_id'),to_translation:this.model.get('document_id'),home:results.learned||results.mastered||((this.model.get('type')==='practice')&&!this.model.has('skill_id')&&!this.model.has('skill_name')),awesome:results.learned||results.mastered||this.model.has('level_event'),mastered_or_learned:results.learned||results.mastered,stream_post_column:this.model.get('type')=='lesson'&&results.num_new_words,auto_facebook_post:duo.user.get('auto_facebook_post'),is_lesson:this.model.get('type')==='lesson',is_timed:this.model.get('timed'),has_hearts:!!this.hearts_view,has_accumulation:this.model.has('point_accumulation')});return data;},render:function(){var data=this.getRenderingData();$(this.el).html($.duostache(this.template,data,duo.templates));this.renderSkills();setTimeout(this.showAwesomeOverlay,10); this.$('#search-box').wordLookup({templates:duo.templates,source_language:duo.user.get('ui_language'),target_language:duo.user.get('learning_language'),id:this.model.get('username'),callback:this.lookedupWord,callback_context:this}); this.$('#stream-post').vkeyboard({language:duo.user.get('learning_language'),placeholder:this.$('#vkeyboard-placeholder'),toggle_button:this.$('#toggle_vkeyboard'),shown:false,caps:false}); this.$('.translation-source').hints({templates:duo.templates,source_language:this.model.get('language'),target_language:duo.user.get('ui_language'),language_information:this.model.get('language_information'),reverse:false,top:15,highlight_verb_endings:false}); this.$('.lexeme-form').tokenHints({templates:duo.templates,source_language:this.model.get('language'),target_language:duo.user.get('ui_language'),word_only:true}).addClass('translation-source');var self=this;_.defer(function(){if(window.twttr&&twttr.widgets){twttr.widgets.load();}
self.$('.post-activity label').inFieldLabels(); var animation_delay=0;self.$('.animated-pieces').each(function(index,element){(function(){var $element=$(element);setTimeout(function(){$element.find('[data-style]').each(function(i,e){$(e).toggleClass('hidden '+$(e).data('style'));});},animation_delay);})();animation_delay+=500;});if(self.timer_view&&data.seconds_left){ animation_delay+=250;setTimeout(function(){self.$('#timer-text').animate({seconds_left:data.seconds_left},{step:function(now,fx){$(this).text($.duostache('{{#format_seconds}}{{seconds_left}}{{/format_seconds}}',{seconds_left:now}));},duration:500});self.$('#timer-container').arc({stroke:'#5b9700',fill:'#7ec200',strokewidth:1,value:0,total:self.timer_view.original_total_time/1000,width:12}).arc({animate:true,duration:500,value:Math.min(self.timer_view.original_total_time/1000,data.seconds_left),total:self.timer_view.original_total_time/1000});},animation_delay);animation_delay+=500;}
setTimeout(function(){var level_left_before=self.model.get('points_data').level_left+self.model.get('gained_skill_points'); var level_bar_diff=self.model.get('points_data').level_percent*self.$('.progress-bar-big').width()/100.0-data.level_before_bar_width;self.$('.progress-slice').animate({manualwidth:level_bar_diff,points:self.model.get('gained_skill_points')},{step:function(now,fx){if(fx.prop==='points'){self.$('#left-in-level').text(parseInt(level_left_before-now));}else{self.$('.progress-slice').width(data.level_before_bar_width+now);}},duration:1000});},animation_delay);});if(duo.user.get('auto_facebook_post')){ this.autoPostFacebook();}
return this;},showAwesomeOverlay:function(){var overlay=this.$('#awesome-overlay').removeClass('start');setTimeout(function(){overlay.addClass('two');},500);},renderSkills:function(){ var self=this;if(this.model.has('end_event')){_.each(this.model.get('end_event').skills,function(improvement){if(improvement.skill){var skill_view=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(self,improvement.skill)),improvement:improvement.improvement,el:this.$("#skill-"+improvement.skill.id)});skill_view.render();}},this);}},progressTabChange:function(e){var tab=$(e.target);var in_dropdown=tab.hasClass('in-dropdown');if(in_dropdown){ var hidden_li=tab.closest('.progress-tab');this.$('.progress-tab a:first').replaceWith(tab).addClass('in-dropdown').appendTo(hidden_li);tab.removeClass('in-dropdown');}else{this.$('.progress-tab').removeClass('active');tab.closest('.progress-tab').addClass('active');}
this.$('.progress-box').hide();this.$('#progress-box-'+tab.data('skill')).show();},postFacebook:function(){if(!window.FB){return;}
var self=this;mixpanel.track('facebook share click');FB.login(function(login_response){if(login_response.authResponse){self.postToFacebook(login_response.authResponse); if(!duo.user.get('facebook_id')){var facebook_id=login_response.authResponse.userID;$.post('/facebook_connect',{facebook_id:facebook_id,facebook_friends:'[]',auto_follow:false});duo.user.set({facebook_id:facebook_id});}}},{scope:'publish_actions'});},autoPostFacebook:function(){ if(!window.FB){ return}
var auth_response=FB.getAuthResponse();if(auth_response){mixpanel.track('facebook auto post');this.postToFacebook();}},postActionsToFacebook:function(){ var self=this;var og=duo.debug?'skill_debug':'skill';_.each(this.model.get('learned_skills'),function(skill){var options={skill:'http://duolingo.com/'+og+'/'+skill.id};duo.postFacebookAction(duo.fb_app,'learn',options);});},postToFacebook:function(){this.$('#facebook-post-action').addClass('shared').text('shared on facebook').attr('disabled','disabled'); if(this.model.has('level_event')){var og=duo.debug?'og_debug':'og';var options={level:'http://duolingo.com/'+og+'/'+this.model.get('language')+'/'+this.model.get('level_event').new_level};duo.postFacebookAction(duo.fb_app,'reach',options);}
this.postActionsToFacebook();mixpanel.track('facebook shared');},dismissAwesome:function(){this.$('#awesome-overlay').addClass("start");setTimeout(this.$('#awesome-overlay').remove(),1000);return false;},continueLearning:function(){if(this.model.has('from_skill')&&this.model.get('from_skill')){duo.skillRouter.navigate('/skill/'+this.model.get('from_skill'),true);}else{duo.homeRouter.navigate('',true);}},continueRoute:function(e){var button=$(e.currentTarget);var href=button.data('href');var router=button.data('r');if(window.location.hash==='#'+href||window.location.hash==='#/'+href){this.reloadPage();}else{duo[router+'Router'].navigate(href,true);}},reloadPage:function(e){mixpanel.track('practice again',{global_practice:this.model.get('global_practice'),bonus_round:this.model.has('path_node_index'),skill_name:this.model.get('skill_name')});window.location.reload(true);},disableButtons:function(){this.$('.btn').addClass('disabled').attr('disabled','disabled');},changeAutoPost:function(){var new_value=this.$('#fb-auto-post').is(':checked');mixpanel.track('toggle auto post',{new_value:new_value});if(new_value){this.$('#facebook-post-action').click();}
duo.user.save({auto_facebook_post:new_value});},keyCheck:function(e){if(e.which===13){if(this.$('#dismiss-awesome').length>0){this.$('#dismiss-awesome').click();return;}
if(this.$('.end-continue.btn.primary:visible').length>0){this.$('.end-continue.btn.primary:visible').click();}else{this.$('.end-continue.btn:visible').click();}
$(document).unbind(this.getEventClass());}},onStreamPost:function(){this.$('.post-activity .post-footer').show();this.$('.post-activity .post-footer').removeClass('wrong');this.$('.post-activity #wrong-language-box').hide();this.$('.post-activity #search-box').show();this.$('.post-activity .post').addClass('focus');return false;},makeStreamPost:function(){var text=$.trim(this.$('.post-activity .post').val());var post=new duo.StreamPost({for_user_id:duo.user.id,text:text});var self=this;post.save(null,{success:function(model,obj){if(obj.error==='wrong language'){self.showWrongLanguage.call(self);mixpanel.track('post_on_stream',{own_wall:self.current_user,wrong_language:true,from_session_end:true});}else{var dummy_collection=new duo.EventList([post]);var view=new duo.EventsView({collection:dummy_collection});self.$('.post-container').html(view.render().el);mixpanel.track('post_on_stream',{own_wall:self.current_user,from_session_end:true});}}});return false;},showWrongLanguage:function(){this.$('#wrong-language-box').show();this.$('#search-box').hide();this.$('.post-footer').addClass('wrong');}});duo.SessionFailedView=Backbone.View.extend({id:'app',events:{'click #retry-button':'retry','click #home-button':'goToHome','click .close-fail':'closeFail','click #show-report-options':'reportProblem','click #discussion-toggle':'displayDiscussion','click #submit-suggestion':'sendSuggestionMessage','click #cancel-report':'cancelSuggestion','click #submit-problem':'submitProblem','focus .free-write-box':'checkFreeWrite','click input[type=checkbox]':'checkSubmit'},template:duo.templates['session-failed'],initialize:function(subviews){this.appClasses=subviews.appClasses;this.progress_view=subviews.progress_view;this.hearts_view=subviews.hearts_view;this.explanation_view=subviews.explanation_view;this.grade_view=subviews.grade_view;this.elementView=subviews.elementView;this.loading_comments=false;$(document).unbind('.session').bind('keyup.session',_.bind(this.keyCheck,this));},render:function(){var language_vars={};language_vars['learning_'+this.model.get('language')]=true;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),language_vars),duo.templates)); this.$('#progress-bar').replaceWith(this.progress_view.el); if(this.hearts_view){this.$('#hearts').replaceWith(this.hearts_view.el);} 
if(this.explanation_view){this.$('#explanation').replaceWith(this.explanation_view.el);} 
this.$('#grade').replaceWith(this.grade_view.el);$(this.el).addClass(this.appClasses);return this;},goToHome:function(){duo.homeRouter.navigate('',true);},retry:function(){window.location.reload();},closeFail:function(){this.$('.session-end').hide();this.$('#session-element-container').replaceWith(this.elementView.el);$('#app').attr('class',this.appClasses);},keyCheck:function(e){if(e.which===13){if($('#report-options').is(':visible')||$('#discussion-modal').is(':visible'))
return true;$(document).unbind('.session');this.$('#retry-button').click();}},reportProblem:function(e){var target=$(e.target);if(target.closest('#report-options').size()){return true;}
if($('#report-options').is(':hidden')){$('#report-options').fadeIn();}else{var self=this;$('html, body').animate({scrollTop:0},'slow',function(){self.$('#report-options').fadeOut();});}
return false;},displayDiscussion:function(){if(this.$('#discussion-modal').size()>0){this.$('#discussion-modal').modal('show');return;}
if(this.loading_comments){return;}
this.loading_comments=true;var self=this;var sentence=new duo.Sentence({id:this.elementView.session.get('session_element_solutions').at(this.elementView.session.get('position')).get('session_element').get('solution_key')});sentence.fetch({data:{ui_language:this.model.get('ui_language'),learning_language:this.model.get('language')},success:function(data){var discussion_modal=new duo.CommentModalView({el:this.$('#discussion-modal-container'),correct:self.model.get('session_element_solutions').last().get('correct'),model:sentence,ui_language:self.model.get('ui_language'),learning_language:self.model.get('language')});mixpanel.track('show sentence comment');discussion_modal.render();self.loading_comments=false;}}); this.$('#discussion-modal').on('hidden',function(){return false;});},redoChallenge:function(){alert('redo');},sendSuggestionMessage:function(){this.submitSuggestion(this.$('.free-write-box').val(),this.$('#user-solution').val());},submitSuggestion:function(message,user_solution,report_types){ var solution=this.model.get('session_element_solutions').last();var data={referer:window.location.href,flashversion:FlashDetect.installed?FlashDetect.raw:"",session_element_solution:JSON.stringify(solution.toJSON()),user_solution:user_solution,message:message,correct_solutions:JSON.stringify(solution.get('correct_solutions')),language:this.model.get('language'),ui_language:this.model.get('ui_language'),report_types:report_types}
var self=this;mixpanel.track('submit suggestion/feedback',{language:this.model.get('language'),ui_language:this.model.get('ui_language'),direction:this.model.get('language')+' <- '+this.model.get('ui_language')});$.post('/diagnostics/language_feedback',data,function(){self.continueLearning();$('#solution-suggested').show().delay(4500).fadeOut(1000);});},cancelSuggestion:function(){var self=this;$('html, body').animate({scrollTop:0},'slow',function(){self.$('#report-options').fadeOut();});},continueLearning:function(){this.cancelSuggestion();this.$('.submit-solution-box').remove();},checkFreeWrite:function(){this.$('#report-options #free-write').prop('checked',true);this.checkSubmit();},submitProblem:function(){var problems='';var report_types=[];var self=this;this.$('#report-options input[type="checkbox"]:checked').each(function(){if($(this).attr('id')=='free-write'){problems+="User explanation: "+self.$('.free-write-box').val()+'.\n';self.$('.free-write-box').val('');}
else if($(this).attr('id')=='translate'){report_types.push("translation");problems+=$(this).val()+'\n';}
else{report_types.push($(this).attr('id'));problems+=$(this).val()+'\n';}
$(this).prop('checked',false);});report_types=JSON.stringify(report_types);if(problems!='')
{var solution=this.model.get('session_element_solutions').last();var user_solution=$.trim(solution.getDisplayText());this.submitSuggestion(problems,user_solution,report_types);$('html, body').animate({scrollTop:0},'slow',function(){self.$('#report-options').fadeOut();self.checkSubmit();});}
return false;},getSourceName:function(abbr){var names={'en':'English','es':"Spanish",'pt':"Portuguese",'fr':"French",'de':'German','it':'Italian'};return names[abbr];},checkSubmit:function(){var count=0;this.$('#report-options input[type="checkbox"]:checked').each(function(){count++;});if(count>0)
this.$('#submit-problem').removeAttr('disabled');else
this.$('#submit-problem').attr('disabled','disabled');}});duo.ProgressView=Backbone.View.extend({id:'progress-bar',template:duo.templates['progress-bar'],initialize:function(){this.model.bind('grade',this.graded,this);this.model.bind('continue',this.continued,this);this.model.get('session_elements').bind('remove',this.elementRemoved,this);},render:function(){var length=_.size(this.model.get('session_elements'));this.model.set({'elements':_.range(1,length+1)});$(this.el).html($.duostache(this.template,_.extend({},this.model.toJSON(),{elements:_.range(1,length+1)})));for(var i=0;i<this.model.get('position');i++){this.$('.nothing:first').removeClass('nothing').addClass('done');}
return this;},graded:function(){var element=this.model.currentElement();var solution=this.model.get('session_element_solutions').last();if(element&&(element.get('type')==='title'||(element.get('type')==='name'&&element.get('example')))){return;}
if(solution.isDone()){this.$('.nothing:first').removeClass('nothing').addClass('done');}},continued:function(){var position=this.model.get('position')-1;var element=this.model.get('session_elements').at(position);if(element.get('type')==='title'||(element.get('type')==='name'&&element.get('example'))){this.$('.nothing:first').removeClass('nothing').addClass('done');}},elementRemoved:function(element,collection){this.$('.nothing:last').remove();}});duo.HeartsView=Backbone.View.extend({id:'hearts',tagName:'li',template:duo.templates['session-hearts'],initialize:function(options){this.model.initializeHearts(options.num_hearts);this.model.bind('grade',this.graded,this);this.model.bind('hovered',this.onHover,this);},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{fraction_hearts:this.getFractionHearts()})));return this;},graded:function(){var element=this.model.currentElement();var solution=this.model.get('session_element_solutions').last();if(!solution.get('correct')&&!element.get('example')&&solution.isDone()&&element.get('type')!='microphoneActivation'){this.removeHeart(1);}},onHover:function(word,hint,new_word){if(duo.user.get('ab_options').hover_heart_experiment&&!new_word){this.removeHeart(0.25);}},removeHeart:function(amount){var before_hearts=this.model.get('num_hearts');var hearts_left=this.model.removeHeart(amount);if(hearts_left<0){ this.model.set({state:'failed'});}
var self=this;var hearts=null;if(duo.user.get('ab_options').hover_heart_experiment){hearts=_.map(_.range(hearts_left,before_hearts,0.25),function(heart_index){return'#heart-'+parseInt(4*heart_index);});}else{hearts=_.map(_.range(hearts_left,before_hearts,0.5),function(heart_index){return'#heart-'+parseInt(2*heart_index);});}
this.$(hearts.join(', ')).animate({top:'+=60px'},1000,function(){$(this).toggleClass('heart-unused heart-used').css('top','-=60px');$(this).animate({opacity:1.0},300,function(){self.render();});});},getFractionHearts:function(){var hearts=this.model.get('num_hearts');var whole_hearts=parseInt(Math.floor(hearts));var partial_hearts=hearts-whole_hearts;var fraction_hearts=whole_hearts;if(partial_hearts>0){fraction_hearts+=' ';switch(partial_hearts){case 0.25:fraction_hearts+='¼';break;case 0.5:fraction_hearts+='½';break;case 0.75:fraction_hearts+='¾';break;default:break;}}
return fraction_hearts;}});duo.ExplanationView=Backbone.View.extend({id:'explanation',tagName:'li',template:duo.templates['session-explanation'],events:{'click':'toggle','click .close':'close'},render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON()));var self=this;_.defer(function(){self.$('.popover').anchor({type:'below',margin:0,anchor:self.$('.inner'),container:$('#app')});});return this;},toggle:function(){this.$('.popover').toggle();},close:function(){this.$('.popover').hide();return false;}});duo.SessionView=Backbone.View.extend({id:'app',events:{'click #submit_button':'submit','click #continue_button':'next','click #skip_button':'skip','click #show-report-options':'reportProblem','click #discussion-toggle':'displayDiscussion','click #redo-challenge':'redoChallenge','click #submit-suggestion':'sendSuggestionMessage','click #cancel-report':'cancelSuggestion','click #continue-learning':'continueLearning','click #submit-problem':'submitProblem','focus .free-write-box':'checkFreeWrite','click input[type=checkbox]':'checkSubmit'},template:duo.templates['session'],reportProblem:function(e){var target=$(e.target);if(target.closest('#report-options').size()){return true;}
if($('#report-options').is(':hidden')){$('#report-options').fadeIn();}else{var self=this;$('html, body').animate({scrollTop:0},'slow',function(){self.$('#report-options').fadeOut();});}
return false;},displayDiscussion:function(){if(this.$('#discussion-modal').size()>0){this.$('#discussion-modal').modal('show');return;}
if(this.loading_comments){return;}
this.loading_comments=true;var self=this;var sentence=new duo.Sentence({id:this.model.currentElement().get('solution_key')});sentence.fetch({data:{ui_language:this.model.get('ui_language'),learning_language:this.model.get('language')},success:function(data){var discussion_modal=new duo.CommentModalView({el:this.$('#discussion-modal-container'),correct:self.model.get('session_element_solutions').last().get('correct'),model:sentence,ui_language:self.model.get('ui_language'),learning_language:self.model.get('language')});mixpanel.track('show sentence comment');discussion_modal.render();self.loading_comments=false;}}); this.$('#discussion-modal').on('hidden',function(){return false;});},redoChallenge:function(){alert('redo');},sendSuggestionMessage:function(){this.submitSuggestion(this.$('.free-write-box').val(),this.$('#user-solution').val());},submitSuggestion:function(message,user_solution,report_types){ var solution=this.model.get('session_element_solutions').last();var data={referer:window.location.href,flashversion:FlashDetect.installed?FlashDetect.raw:"",session_element_solution:JSON.stringify(solution.toJSON()),user_solution:user_solution,message:message,correct_solutions:JSON.stringify(solution.get('correct_solutions')),language:this.model.get('language'),ui_language:this.model.get('ui_language'),report_types:report_types}
var self=this;mixpanel.track('submit suggestion/feedback',{language:this.model.get('language'),ui_language:this.model.get('ui_language'),direction:this.model.get('language')+' <- '+this.model.get('ui_language')});$.post('/diagnostics/language_feedback',data,function(){self.continueLearning();$('#solution-suggested').show().delay(4500).fadeOut(1000);});},cancelSuggestion:function(){var self=this;$('html, body').animate({scrollTop:0},'slow',function(){self.$('#report-options').fadeOut();});},continueLearning:function(){this.cancelSuggestion();this.$('.submit-solution-box').remove();},checkFreeWrite:function(){this.$('#report-options #free-write').prop('checked',true);this.checkSubmit();},submitProblem:function(){var problems='';var report_types=[];var self=this;this.$('#report-options input[type="checkbox"]:checked').each(function(){if($(this).attr('id')=='free-write'){problems+="User explanation: "+self.$('.free-write-box').val()+'.\n';self.$('.free-write-box').val('');}
else if($(this).attr('id')=='translate'){report_types.push("translation");problems+=$(this).val()+'\n';}
else{report_types.push($(this).attr('id'));problems+=$(this).val()+'\n';}
$(this).prop('checked',false);});report_types=JSON.stringify(report_types);if(problems!='')
{var solution=this.model.get('session_element_solutions').last();var user_solution=$.trim(solution.getDisplayText());this.submitSuggestion(problems,user_solution,report_types);$('html, body').animate({scrollTop:0},'slow',function(){self.$('#report-options').fadeOut();self.checkSubmit();});}
return false;},getSourceName:function(abbr){var names={'en':'English','es':"Spanish",'pt':"Portuguese",'fr':"French",'de':'German','it':'Italian'};return names[abbr];},checkSubmit:function(){var count=0;this.$('#report-options input[type="checkbox"]:checked').each(function(){count++;});if(count>0)
this.$('#submit-problem').removeAttr('disabled');else
this.$('#submit-problem').attr('disabled','disabled');},bindEvents:function(check_sound){ _.bindAll(this,'keyCheck','preventKeys','keyUp','keyDown','keyPress','submit');$(document).unbind(this.getEventClass()).bind('keyup'+this.getEventClass(),this.keyUp).bind('keydown'+this.getEventClass(),this.keyDown).bind('keypress'+this.getEventClass(),this.keyPress); this.model.bind('input',this.ready,this);this.model.bind('clear',this.notReady,this);this.model.bind('grade',this.graded,this);this.model.bind('retry',this.graded,this);this.model.bind('render',this.rendered,this);this.model.bind('fail',this.failed,this);if(typeof check_sound==='undefined'||check_sound===true){this.checkSound();}
$('#box_feedback #activity_uuid').val(this.model.get('activity_uuid'));},keyUp:function(e){return this.keyCheck(e);},keyDown:function(e){return this.preventKeys(e);},keyPress:function(e){return this.preventKeys(e);},getEventClass:function(){return'.session';},initialize:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{notify_comment:duo.user.get('notify_comment')}),duo.templates));this.bindEvents();this.loading_comments=false;var tracking_properties={type:this.model.get('type'),lesson_number:this.model.get('lesson_number'),skill_name:this.model.get('skill_name'),skill_id:this.model.get('skill_id'),global_practice:this.model.get('global_practice'),from_email:this.model.get('from_email'),skill_tree_id:this.model.get('skill_tree_id')};if(this.model.get('type')==='lesson'){tracking_properties.lesson=this.model.get('skill_name')+'--'+this.model.get('lesson_number');}
mixpanel.track("session_start",tracking_properties);this.model.set({start_time:new Date()});this.initializeSubViews();swfobject.switchOffAutoHideShow();this.model.set({'seen_explanations':[]});},initializeSubViews:function(){ this.progress_view=new duo.ProgressView({model:this.model});this.$('#progress-bar').replaceWith(this.progress_view.render().el); var num_hearts=this.getNumHearts();this.hearts_view=new duo.HeartsView({model:this.model,num_hearts:num_hearts});this.$('#hearts').replaceWith(this.hearts_view.render().el); this.explanation_view=new duo.ExplanationView({model:this.model});this.$('#explanation').replaceWith(this.explanation_view.render().el); this.grade_view=new duo.GradeView({model:this.model});this.$('#grade').replaceWith(this.grade_view.render().el);this.model.incrementPosition();},getNumHearts:function(){var num_hearts=this.model.get('beginner')?4:3;if(duo.user.get('ab_options').hover_heart_experiment){num_hearts+=1;}
return num_hearts;},getViewName:function(element){return(element.get('example')?'Example':'')+element.get('type').toTitleCase()+'ElementView';},createNextView:function(){var element=this.model.currentElement();var name=this.getViewName(element);return new duo[name]({model:element,session:this.model});},renderNextView:function(){ var view=this.createNextView(); this.$('#session-element-container').replaceWith(view.render().el); this.$('#continue_button, #submit_button').attr('disabled','disabled').twipsy('hide');$('#app').removeClass('correct incorrect');this.$('#skip_button').show();return view;},render:function(){this.delegateEvents();this.model.set({state:'empty'}); this.element_view=this.renderNextView(); this.$('.pagination #element-'+(this.model.get('position'))).removeClass('active');this.$('.pagination #element-'+(this.model.get('position')+1)).addClass('active'); var m=this.model;_.defer(function(){m.set({state:'rendered'});}); if(this.element_view&&this.element_view.model.get('target_language')!=='en'){this.$('#speller_button').hide();}
return this;},rendered:function(){ if(this.model.get('type')!='welcome'){$('body').addClass('player');}
$('#app').addClass(this.model.get('type'));$('#app').addClass(this.model.currentElement().get('type'));if(this.model.currentElement().get('unknown')){$('#app').addClass('unknown').removeClass('known');}else{$('#app').addClass('known').removeClass('unknown');}
this.$('label').inFieldLabels();if(!(('ontouchstart'in window)||window.DocumentTouch&&document instanceof DocumentTouch)){$('#continue_button, #submit_button').twipsy({live:true,offset:15,animate:false,placement:function(tip,el){return $(el).data('placement')||'in above';}}).addClass('has-twipsy');}},renderEnd:function(){var self=this;$(document).unbind(this.getEventClass());var tracking_properties={failed:this.model.get('failed'),type:this.model.get('type'),num_hearts:this.model.get('num_hearts'),position:this.model.get('position'),times_up:this.model.get('times_up'),timed:this.model.get('timed'),lesson_number:this.model.get('lesson_number'),skill_name:this.model.get('skill_name'),skill_id:this.model.get('skill_id'),global_practice:this.model.get('global_practice'),from_email:this.model.get('from_email'),num_word_hints:this.getNumHoveredWords(this.model),skill_tree_id:this.model.get('skill_tree_id')};if(this.model.get('type')==='lesson'){tracking_properties.lesson=this.model.get('skill_name')+'--'+this.model.get('lesson_number');}
this.model.save({end_time:new Date()},{success:function(){var end_view=new duo.SlideSessionEndView({model:self.model});$(self.el).replaceWith(end_view.render().el);duo.user.fetch(); 
tracking_properties.gained_skill_points=self.model.get('gained_skill_points')||self.model.get('points');mixpanel.track('session_end',tracking_properties);}});$('#app').removeClass('leave-warning');window.onbeforeunload=null;return this;},keyCheck:function(e){if(e.which==13){if($('#feedback_form').is(':visible')||this.$('#report-options').is(':visible')||this.$('#discussion-modal').is(':visible')){return true;}
if($(e.target).is('#submit_button, #continue_button, #skip_button')){return true;}
if(this.model.get('state')=='ready'){this.submit();}else if(this.model.get('state')=='graded'){this.next();}}else if(e.which==32&&e.ctrlKey){ if(e.shiftKey){ this.$('#big-speaker .slow-button').click();}else{this.$('#big-speaker .icon_speaker').click();}
return false;}
return true;},preventKeys:function(e){if(e.which==8){ var $target=$(e.target);if($target.is('input[type="text"]')||$target.is('textarea')||$target.is('#text-input')||$target.is('.translation-textarea')){return true;}
return false;}else if(e.which==13&&!($('#feedback_form').is(':visible')||this.$('#report-options').is(':visible')||this.$('#discussion-modal').is(':visible'))){ var $target=$(e.target);if($target.is('input[type="text"]')||$target.is('textarea')||$target.is('#text-input')||$target.is('.translation-textarea')){return false;}}
return true;},skip:function(e){var solution=this.model.get('session_element_solutions').at(this.model.get('position'));if(true||!solution||!solution.isDone()){this.$('#submit_button').attr('disabled','disabled');this.$(':focus').blur();this.$('#skip_button').hide();this.element_view.skip();return false;}
return true;},next:function(e){var solution=this.model.get('session_element_solutions').last();if(!solution.isDone()){return;}
if(this.model.get('position')===this.model.get('session_elements').length-1){if(this.model.get('state')!=='ended'){this.model.set({state:'ended'});this.renderEnd();}}else{$('#app').removeClass(this.model.currentElement().get('type'));this.model.incrementPosition();this.render();}
this.cancelSuggestion();return false;},failed:function(){this.model.save({failed:true});$('#app').removeClass('leave-warning');window.onbeforeunload=null;var tracking_properties={failed:this.model.get('failed'),type:this.model.get('type'),num_hearts:this.model.get('num_hearts'),position:this.model.get('position'),times_up:this.model.get('times_up'),timed:this.model.get('timed'),lesson_number:this.model.get('lesson_number'),skill_name:this.model.get('skill_name'),skill_id:this.model.get('skill_id'),global_practice:this.model.get('global_practice'),from_email:this.model.get('from_email'),num_word_hints:this.getNumHoveredWords(this.model),skill_tree_id:this.model.get('skill_tree_id')};if(this.model.get('type')==='lesson'){tracking_properties.lesson=this.model.get('skill_name')+'--'+this.model.get('lesson_number');}
mixpanel.track('session_end',tracking_properties);var failed_view=new duo.SessionFailedView({model:this.model,appClasses:$('#app').attr("class"),hearts_view:this.hearts_view,explanation_view:this.explanation_view,progress_view:this.progress_view,grade_view:this.grade_view,elementView:this.element_view});$(this.el).replaceWith(failed_view.render().el);return this;},ready:function(){this.$('#submit_button, #speller_button').removeAttr('disabled');},notReady:function(){this.$('#submit_button, #speller_button').attr('disabled','disabled').twipsy('hide');},submit:function(){var submitted=this.element_view.submit();if(submitted!==false){this.$('#submit_button').attr('disabled','disabled').twipsy('hide');} 
if(this.model.get('type')!=='welcome'&&(this.model.get('skill_name')=='Basics-1'||this.model.get('skill_name')=='Basics'||this.model.get('position')===this.model.get('session_elements').length-1)){$('#app').addClass('leave-warning');window.onbeforeunload=function(){return translate_text('Are you sure you want to quit? All progress in this lesson will be lost.');};}
return false;},graded:function(data){var last_grade=this.model.get('session_element_solutions').last();if(last_grade.isDone()&&!last_grade.get('try_again')){this.$('#skip_button').hide();}
this.$('#submit_button').attr('disabled','disabled').twipsy('hide');console.debug(last_grade);if(last_grade.get('correct')){$('#app').removeClass('incorrect').addClass('correct');}
if(last_grade.get('incorrect')){$('#app').removeClass('correct').addClass('incorrect');}
if(!last_grade.get('try_again')||last_grade.get('correct')){this.$('#continue_button').removeAttr('disabled');}},speakActivationSetup:function(){var element=this.model.currentElement(); var self=this;if(element.get('type')==='microphoneActivation'){duo.blink_interval_id=window.setInterval('duo.blinky(".activate-flash", "rgb(179, 179, 179)", "rgb(255, 255, 255)")',800);this.$('#no-mic-link').show().click(function(){self.$('#speak-instruction').remove();self.$('#speak-mic-off').show();self.$('#speak-mic-arrow').hide();self.element_view.turnMicOff();$(this).hide();});duo.flashSettingsClosed=_.wrap(duo.flashSettingsClosed,function(func){func();self.welcomeLog({microphone_activation:true});});this.$('.intro').replaceWith($.duostache(duo.templates['intro-speak'],this.model.toJSON()));this.$('#skip_button').hide();}else{window.clearInterval(duo.blink_interval_id);this.$('#no-mic-link').hide();this.$('#skip_button').show();}}, getNumHoveredWords:function(model){return model.get('session_elements').reduce(function(sum,se){if(se.has('hovered_words')){return sum+se.get('hovered_words').length;}
return sum;},0);},checkSound:function(){try{if(soundManager){var foo=soundManager.createSound({id:'sm2TestSound',url:('http://static.duolingo.com/s3/quartersec.mp3')});if(!soundManager._disabled){foo.play();if(!soundManager._disabled){}else{this.showNoSound();}}else{this.showNoSound();}}else{this.showNoSound();}}catch(e){this.showNoSound();}},showNoSound:function(){try{if(duo.user.get('speaker')==true&&this.model.get('type')!='welcome'){var flash_version=FlashDetect.installed?FlashDetect.major:"";mixpanel.track('no sound',{user_agent:navigator.userAgent,flash_version:flash_version});var modal=this.$('#no-sound-modal');var modalView=new duo.NoSoundModal({el:modal.find('.modal-body'),version_too_low:flash_version<8});modalView.render();modal.removeClass('hidden');modal.modal('show');this.$('a').click(function(){modal.modal('hide');});}}catch(e){}}});duo.NoSoundModal=Backbone.View.extend({template:duo.templates['no-sound-modal'],initialize:function(options){this.version_too_low=options.version_too_low;},render:function(){$(this.el).html($.duostache(this.template,{version_too_low:this.version_too_low},duo.templates));return this.el;}});duo.TimingModule=Backbone.View.extend({template:duo.templates['timer'],initialize:function(options){_.bindAll(this,'render','stop');this.total_time=options.total_time*1000||this.getTotalTime();this.original_total_time=options.shown_max_time*1000||this.total_time;this.count_up=options.count_up;this.extra=options.extra_time;this.long_sentence_bonus=options.long_sentence_bonus;this.interval_id=setInterval(this.render,1000);this.model.bind('grade',this.graded,this);this.model.bind('retry',this.graded,this);this.model.bind('submit',this.pause,this);this.model.bind('end',this.stop);this.model.bind('fail',this.stop);this.model.bind('loading_tts',this.pause,this);this.model.bind('loaded_tts',this.resume,this);this.model.bind('loading_recorder',this.pause,this);this.model.bind('loaded_recorder',this.resume,this);duo.topbar.bind('navigate',this.stop); _.bindAll(this,'drawTimer');},render:function(){var seconds_left=this.getSecondsLeft();$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{seconds:seconds_left}),duo.templates));if(seconds_left<=0){this.model.set({times_up:true});}
if(!this.$arc_data){_.defer(this.drawTimer);}else{this.$('.counter').replaceWith(this.$counter);this.$counter.data(this.$arc_data).arc({animate:true,value:Math.min(this.original_total_time/1000,seconds_left),total:this.original_total_time/1000});}},drawTimer:function(){var $counter=this.$('.counter');$counter.arc({stroke:'#5b9700',fill:'#7ec200',strokewidth:1,value:this.total_time,total:this.original_total_time,width:5});this.$counter=$counter;this.$arc_data=$counter.data();},getTotalTime:function(){var seconds=0;var session_type=this.model.get('type');this.model.get('session_elements').each(function(element){ seconds+=5;});return seconds*1000;},getSecondsLeft:function(){if(!this.model.has('start_time')){if(!this.count_up){return this.total_time/1000;}else{return 0;}}
var now=this.paused||new Date();var ms_lapsed=now-this.model.get('start_time');var ms_left=this.count_up?ms_lapsed:this.total_time-ms_lapsed;return Math.max(0,ms_left/1000);},padNumber:function(n){if(n<10){return'0'+n;}
return n;},pause:function(){this.paused=new Date();},resume:function(){var now=new Date();this.model.get('start_time').setMilliseconds(this.model.get('start_time').getMilliseconds()+(now-this.paused));this.paused=null;},graded:function(){this.resume();var solution=this.model.get('session_element_solutions').last();var element=solution.get('session_element');if(this.extra&&solution.get('correct')){if(element&&(element.get('type')=='translate'||element.get('type')=='listen')){var text=element.get('type')=='translate'?element.get('sentence'):element.get('text');this.total_time+=text.split(' ').length>6?this.long_sentence_bonus*1000:0;}
this.total_time+=this.extra*1000;}},stop:function(){clearInterval(this.interval_id);this.model.unbind('grade',this.graded,this);this.model.unbind('submit',this.pause,this);this.model.unbind('end',this.stop);this.model.unbind('fail',this.stop);this.model.unbind('loading_tts',this.pause,this);this.model.unbind('loaded_tts',this.resume,this);duo.topbar.unbind('navigate',this.stop);}});duo.PointCountModule=Backbone.View.extend({template:duo.templates['point-count'],initialize:function(){this.model.bind('grade',this.render,this);},render:function(){var points=this.getNumberCorrects();$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{points:points}),duo.templates));},getNumberCorrects:function(){var points=this.model.get('session_element_solutions').filter(function(solution){return solution.get('correct');}).length;return points;}});duo.TimedSessionView=duo.SessionView.extend({events:_.extend({},duo.SessionView.prototype.events,{'click .ready-panel #start-button':'startSession','click .ready-panel #untimed-button':'startUntimedSession'}),bindEvents:function(){duo.SessionView.prototype.bindEvents.call(this,false);this.model.bind('change:times_up',this.timesUp,this);},initialize:function(options){this.die_on_time=!!options.die;this.points_per_correct=!!options.points;this.auto_timed=!!options.auto_timed;this.long_sentence_bonus=3;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{requires_ready:!this.auto_timed,points_per_correct:this.points_per_correct,allow_opt_out:this.die_on_time,timed:true}),duo.templates));this.bindEvents();this.initializeSubViews(options);},initializeSubViews:function(options){ this.progress_view=new duo.ProgressView({model:this.model});this.$('#progress-bar').replaceWith(this.progress_view.render().el);if(!options.points||(this.model.get('type')!=='practice'&&this.model.get('type')!=='skill_practice')){ var num_hearts=this.getNumHearts();this.hearts_view=new duo.HeartsView({model:this.model,num_hearts:num_hearts});this.$('#hearts').replaceWith(this.hearts_view.render().el); this.explanation_view=new duo.ExplanationView({model:this.model});this.$('#explanation').replaceWith(this.explanation_view.render().el);}else{var point_count_view=new duo.PointCountModule({model:this.model,el:this.$('#point-count')});point_count_view.render();} 
this.grade_view=new duo.GradeView({model:this.model,points:!!options.points,extra_time:options.extra,long_sentence_bonus:this.long_sentence_bonus});this.$('#grade').replaceWith(this.grade_view.render().el);this.model.incrementPosition();this.timer_view=new duo.TimingModule({model:this.model,el:this.$('#timer'),count_up:options.count==='up',extra_time:options.extra,total_time:options.total_time,shown_max_time:options.shown_max_time,long_sentence_bonus:this.long_sentence_bonus});this.timer_view.render();},renderNextView:function(){if(!this.ready_to_start){this.$('#session-element-container').html($.duostache(duo.templates['timed-session-intro'],this.model.toJSON())); var rand=Math.floor(Math.random()*4)+1;this.$("#st_"+rand).removeClass("hidden");return;}
return duo.SessionView.prototype.renderNextView.call(this);},render:function(){duo.SessionView.prototype.render.call(this);if(!this.ready_to_start&&this.auto_timed){this.startSession();}
return this;},rendered:function(){if(!this.ready_to_start){return;}
return duo.SessionView.prototype.rendered.call(this);},startSession:function(){this.ready_to_start=true;this.$('.ready-panel').remove();this.$('.action-panel').show();this.model.set({start_time:new Date(),timed:true});this.render();this.checkSound();var tracking_properties={type:this.model.get('type'),timed:true,lesson_number:this.model.get('lesson_number'),skill_name:this.model.get('skill_name'),skill_id:this.model.get('skill_id'),global_practice:this.model.get('global_practice'),from_email:this.model.get('from_email'),skill_tree_id:this.model.get('skill_tree_id')};if(this.model.get('type')==='lesson'){tracking_properties.lesson=this.model.get('skill_name')+'--'+this.model.get('lesson_number');}
if(this.model.get('type')==='practice'||this.model.get('type')==='skill_practice'){tracking_properties.bonus_round=this.model.has('path_node_index');}
mixpanel.track("session_start",tracking_properties);},startUntimedSession:function(){this.model.unbind('input');this.model.unbind('clear');this.model.unbind('grade');this.model.unbind('render');this.model.unbind('fail');this.model.unbind('continue');this.model.unbind('submit');this.model.unbind('end');this.timer_view.stop();this.model.set({untimed:true,position:-1});mixpanel.track('untimed mode',{global_practice:this.model.get('global_practice'),bonus_round:this.model.has('path_node_index'),skill_name:this.model.get('skill_name')});$(this.el).unbind();var replacement_view=new duo.SessionView({model:this.model,el:$(this.el)});replacement_view.render();},timesUp:function(){if(this.die_on_time){if(this.points_per_correct){ var any_correct=this.model.get('session_element_solutions').any(function(solution){return solution.get('correct');});if(!any_correct){this.model.set({none_correct:true});this.model.trigger('fail');}else{this.model.trigger('end');this.renderEnd();}}else{this.model.trigger('fail');}}},keyCheck:function(e){if(e.which==13){if(this.$('#start-button').is(':visible')){this.$('#start-button').click();return false;}}
return duo.SessionView.prototype.keyCheck.call(this,e);},renderEnd:function(){if(this.die_on_time&&this.points_per_correct){ var any_correct=this.model.get('session_element_solutions').any(function(solution){return solution.get('correct');});if(!any_correct){this.model.set({none_correct:true});this.model.trigger('fail');return;}}
duo.SessionView.prototype.renderEnd.call(this);}});duo.BigTestSessionView=duo.SessionView.extend({getNumHearts:function(){var num_hearts=this.model.get('more_lenient')?4:3;if(duo.user.get('ab_options').hover_heart_experiment){num_hearts+=1;}
return num_hearts;},failed:function(){this.model.save({failed:true},{success:function(){ duo.user.fetch();}});var failed_view=new duo.SessionFailedView({model:this.model,appClasses:$('#app').attr("class"),hearts_view:this.hearts_view,progress_view:this.progress_view,grade_view:this.grade_view,elementView:this.element_view});$(this.el).replaceWith(failed_view.render().el);return this;}});duo.VocabSessionView=duo.SessionView.extend({getNumHearts:function(){var num_hearts=3;if(this.model.get('session_elements').length<4){num_hearts=2;}
if(this.model.get('session_elements').length<3){num_hearts=1;}
if(duo.user.get('ab_options').hover_heart_experiment){num_hearts+=1;}
return num_hearts;}});duo.WelcomeLessonSessionView=duo.SessionView.extend({initialize:function(){duo.SessionView.prototype.initialize.call(this); this.backgrounds={hover:'intro-hover',translate:'hover-reminder'}; this.background_counts={translate:1,hover:1};this.model.set({'first_translate':true});},renderNextView:function(){var position=this.model.get('position');var element=this.model.currentElement();var view=duo.SessionView.prototype.renderNextView.call(this);var type=element.get('type');if(type in this.background_counts&&this.background_counts[type]>0){this.$('.intro').replaceWith($.duostache(duo.templates[this.backgrounds[type]],this.model.toJSON()));this.background_counts[type]--;this.$("#session-element-container").css('minHeight',280);this.$(".owl-standing-big").css('top',105);this.$(".owl-standing-big").removeClass('pointing');this.$(".intro .top").css('top',95);if(type=='translate'&&this.background_counts[type]==0){this.$("#bubble-hover-reminder").delay(1000).fadeIn();this.$('.owl-standing-big').delay(1000).removeClass("pointing");this.model.set({'first_translate':false});}else if(type=='hover'){this.$("#session-element-container").css('minHeight',250);this.$(".owl-standing-big").removeClass('pointing');this.$(".intro .top").css('top',40);this.$(".owl-standing-big").css('top',130);}}else{this.$('.intro').empty();}
return view;},ready:function(){duo.SessionView.prototype.ready.call(this);var element=this.model.currentElement();var type=element.get('type');if(type=='translate'&&this.background_counts[type]==1){this.$("#bubble-enter-reminder").fadeIn();}}});duo.blinky=function(selector,color1,color2){var my_el=$(selector);if(my_el.css('border-top-color')==color1){my_el.css('border-color',color2);}else{my_el.css('border-color',color1);}};duo.WelcomeSessionView=duo.SessionView.extend({id:'app',template:duo.templates['session'],events:{'click #submit_button':'submit','click #continue_button':'next','click #skip_button':'skip','change #learning-language':'pickedLanguage','keyup #learning-language':'pickedLanguage'},initialize:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{welcome:true}),duo.templates));this.bindEvents(); this.progress_view=new duo.WelcomeProgressView({model:this.model});this.$('#progress-bar').replaceWith(this.progress_view.render().el); this.grade_view=new duo.GradeView({model:this.model});this.$('#grade').replaceWith(this.grade_view.render().el);this.model.incrementPosition();this.model.bind('hover',this.hover,this);var self=this;$('#duolingo_menu_logo').bind('click.session',function(e){self.welcomeLog({duolingo_logo:true,activity_uuid:self.model.get('activity_uuid')});if(!duo.user.get('learning_language')){return false;}
$(document).unbind('.session');$('#duolingo_menu_logo').unbind('click.session');});mixpanel.track('welcome_start');this.backgrounds=['intro-1','intro-hover','intro-translate'];},renderNextView:function(){var position=this.model.get('position');var element=this.model.currentElement();mixpanel.track('welcome_'+position);if(position===0){element.set({hover_instruction:true});}
var view=duo.SessionView.prototype.renderNextView.call(this);if(this.backgrounds[position]){this.$('.intro').replaceWith($.duostache(duo.templates[this.backgrounds[position]],this.model.toJSON()));}
var self=this;if(element.get('type')==='speak'){this.$('#skip_button').show();duo.updateGrade=_.wrap(duo.updateGrade,function(func,score){func(score);self.speak(score);});}else{this.$('#skip_button').hide();} 
var firstContextTranslate=element.get('type')=='contextTranslate'&&this.model.previousElement().get('type')!='contextTranslate';if(position===0){this.startTour();}else if(position===1){this.showHeader();}
if(element.get('type')=='info'){ this.$('#continue_button').text(translate_text('Continue'));this.$('#continue_button').show();this.$('#submit_button').text(translate_text('Submit'));this.$('#submit_button').show();}else if(element.get('type')==='hover'){ this.$('#continue_button').text(translate_text('Continue'));this.$('#continue_button').show();this.$('#submit_button').hide();}else if(element.get('type')==='contextTranslate'&&firstContextTranslate){this.$('#continue_button').text(translate_text('Continue'));this.$('#continue_button').show();this.$('#submit_button').text(translate_text('Check'));this.$('#submit_button').show();}else if(element.get('type')==='contextTranslate'&&!firstContextTranslate){this.$('#continue_button').text(translate_text('Continue'));this.$('#continue_button').show();this.$('#submit_button').text(translate_text('Check'));this.$('#submit_button').show();this.showHoverReminder();}else if(element.get('type')==='translate'){this.$('#continue_button').text(translate_text('Continue'));this.$('#continue_button').show();this.$('#submit_button').text(translate_text('Check'));this.$('#submit_button').show();}else if(element.get('type')==='microphone_activation'){this.$("#no-mic-link").show();}
return view;},startTour:function(){this.$('#submit_button').hide();this.$('#progress-bar').hide();this.$('#continue_button').text(translate_text('Start tour'));this.$('#continue_button').addClass('primary').removeClass('success');this.$('.player-header').addClass('transparent');},showHeader:function(){this.$('.player-header').removeClass('transparent');this.$('#progress-bar').show();this.$('#continue_button').removeClass('primary').addClass('success');this.$('#continue_button').text(translate_text('Continue'));this.$('#submit_button').show();},showHoverReminder:function(){this.$("#bubble-hover-reminder").delay(1000).fadeIn();this.$('.owl-standing-big').delay(1000).removeClass("pointing");},getViewName:function(element){if(element.get('type')==='translate'){return'StackTranslateElementView';}else if(element.get('type')==='contextTranslate'){return'ContextTranslateElementView';}else if(element.get('type')==='microphoneActivation'){return'MicrophoneActivationElementView';}
return(element.get('example')?'Example':'')+element.get('type').toTitleCase()+'ElementView';},renderEnd:function(){var self=this;$(document).unbind('.session');this.model.save(null,{success:function(){var end_view=new duo.WelcomeSessionEndView({model:self.model,hearts_view:self.hearts_view,progress_view:self.progress_view});$(self.el).replaceWith(end_view.render().el);duo.user.fetch();}});return this;},ready:function(){duo.SessionView.prototype.ready.call(this);var element=this.model.currentElement();var firstContextTranslate=element.get('type')=='contextTranslate'&&this.model.previousElement().get('type')!='contextTranslate';if(element.get('type')==='contextTranslate'&&firstContextTranslate||element.get('type')=='translate'){$("#bubble-enter-reminder").fadeIn();}},next:function(){var position=this.model.get('position');var element=this.model.currentElement();this.welcomeLog({continued:position,type:element.get('type'),activity_uuid:this.model.get('activity_uuid')});if(position===0&&!duo.user.get('learning_language')){var self=this;var learning_language=this.$('#learning-language').val();var language_string=this.$('#learning-language option[value="'+learning_language+'"]').data('language');if(!language_string){ return false;}
if(learning_language.indexOf('-')>0){ var language_direction=learning_language.replace('-','_');$.ajax({url:'/users/'+duo.user.get('username'),data:JSON.stringify({language_direction:language_direction}),success:function(data){if(data.response=='ok'){window.location.reload(true);}else{ $('#continue_button').removeAttr('disabled');}},type:'PUT',dataType:'json',contentType:'application/json; charset=utf-8'});this.$('#continue_button').attr('disabled','disabled');return false;}
this.model.fetch({data:{learning_language:learning_language},success:function(model,obj){duo.SessionView.prototype.next.call(self);duo.user.switchLanguage(learning_language,true);Backbone.history.start({silent:true});duo.user.set({learning_language_string:language_string},{silent:true});duo.topbar.render();duo.topbar.hideTabs(true);mixpanel.register({learning_language:learning_language});}});}else{duo.SessionView.prototype.next.call(this);}
return false;},failed:function(){},graded:function(data){duo.SessionView.prototype.graded.call(this,data);var element=this.model.currentElement();if(this.model.get('position')===0&&!duo.user.get('learning_language')){this.$('#continue_button').attr('disabled','disabled');}},hover:function(word){this.welcomeLog({hover:word,activity_uuid:this.model.get('activity_uuid')});},speak:function(score){this.welcomeLog({speak:score,activity_uuid:this.model.get('activity_uuid')});},pickedLanguage:function(){this.$('#continue_button').removeAttr('disabled');},welcomeLog:function(data){data['activity_uuid']=this.model.get('activity_uuid');$.post('/welcome/log',data);}});duo.WelcomeProgressView=duo.ProgressView.extend({initialize:function(){duo.ProgressView.prototype.initialize.call(this);this.model.bind('change',this.render,this);},render:function(){var length=_.size(this.model.get('session_elements'));var show_facebook=!duo.user.get('facebook_id');var steps=length+2;$(this.el).html($.duostache(this.template,{'elements':_.range(1,steps)}));for(var i=0;i<this.model.get('position');i++){this.$('.nothing:first').removeClass('nothing').addClass('done');}
if(length>1){this.model.unbind('change',this.render,this);this.model.get('session_elements').unbind('remove',this.elementRemoved,this);this.model.get('session_elements').bind('remove',this.elementRemoved,this);}
return this;}});duo.WelcomeSessionEndView=duo.SessionEndView.extend({id:'app',template:duo.templates['welcome-session-end-fb'],events:{'click #facebook-connect':'loginFB','click .follow-button':'follow','click #skip-button':'skipFB','click #next-button':'skillsSummary','click #show-more-friends':'showMoreFriends','click .invite-friend':'inviteFriend'},initialize:function(subviews){this.progress_view=subviews.progress_view; this.model.bind('change',this.render,this);this.show_facebook=!duo.user.get('facebook_id');},render:function(){mixpanel.track('welcome_end');if(!this.show_facebook){ this.registered_with_facebook=true; var auth_response=FB.getAuthResponse();var args=_.toArray(arguments).slice(2)
if(auth_response){this.fetchFromFB(auth_response);}else{var self=this;FB.login(function(login_response){if(login_response.authResponse){self.fetchFromFB.call(self,login_response.authResponse);}},{scope:'publish_actions'});}
return this;}
$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{welcome:true}),duo.templates)); this.$('#progress-bar').replaceWith(this.progress_view.el);this.renderSkills();_.defer(function(){if(window.twttr&&twttr.widgets){twttr.widgets.load();}});return this;},renderFBFriends:function(){var num_friends=this.duo_friends.length;$(this.el).html($.duostache(duo.templates['welcome-fb-friends'],{show_friends:this.duo_friends,num_show_friends:Math.min(6,num_friends),num_more_friends:Math.max(0,num_friends-6),singular:num_friends===1,num_friends:num_friends,other_friends:_.values(this.other_friends).slice(0,6),registered_with_facebook:this.registered_with_facebook},duo.templates));this.$('.search').typeahead({source:_.keys(this.other_friends),render:this.renderSearch,lookup:this.typeaheadLookup,data:{friends:this.other_friends}});_.defer(function(){self.$("label").inFieldLabels();}); if(this.progress_view){this.$('#progress-bar').replaceWith(this.progress_view.el);}
mixpanel.track('welcome_end facebook_friends');},loginFB:function(){var self=this;mixpanel.track('welcome facebook connect click',{facebook_available:!!window.FB});if(!window.FB){return;}
FB.login(function(response){if(!response.authResponse){return;}
mixpanel.track('welcome facebook connected');self.fetchFromFB.call(self,response.authResponse);},{scope:'publish_actions'});},fetchFromFB:function(auth_response){var facebook_id=auth_response.userID;var access_token=auth_response.accessToken;var self=this;duo.user.set({facebook_id:facebook_id});duo.user.fetchAvatar('http://graph.facebook.com/'+facebook_id+'/picture?type=large');FB.api('/me/friends?access_token='+access_token+'&fields=picture,installed,name',function(friends_data){self.duo_friends=_.filter(friends_data.data,function(friend){return friend.installed;});self.other_friends={};_(friends_data.data).chain().filter(function(friend){return!friend.installed;}).each(function(friend){self.other_friends[friend.name]=friend;});$.post('/facebook_connect',{facebook_id:facebook_id,facebook_friends:JSON.stringify(self.duo_friends),auto_follow:!self.model.get('one_click')},function(data){for(var i=0;i<self.duo_friends.length;i++){if(data.friends[self.duo_friends[i].id]){data.friends[self.duo_friends[i].id].user_id=data.friends[self.duo_friends[i].id].id;}
_.extend(self.duo_friends[i],data.friends[self.duo_friends[i].id]);}
console.log(self.duo_friends);self.duo_friends=_(self.duo_friends).chain().filter(function(friend){return friend.user_id;}).map(function(friend,i){friend.not_shown=i>=6;return friend;}).value();self.renderFBFriends();duo.user.set(data.user_following.data);_.extend(duo.user.getSkills(),data.user_following.skill_rank_data);});});FB.api('/me?fields=name&access_token='+access_token,function(picture_data){duo.user.set({facebook_name:picture_data.name});}); if(!this.model.get('one_click')){ var og=duo.debug?'og_debug':'og';var options={language:'http://duolingo.com/'+og+'/'+this.model.get('language')};duo.postFacebookAction(duo.fb_app,'start_learning',options);}},follow:function(e){var button=$(e.target);var user_id=button.data('user');if(button.hasClass('success')){duo.user.unfollow(user_id);button.removeClass('success').text(translate_text('Follow'));}else{duo.user.follow(user_id);button.addClass('success').text(translate_text('Following'));}},skipFB:function(){this.skillsSummary();},skillsSummary:function(){mixpanel.track('welcome_end skills_summary');$(this.el).html($.duostache(duo.templates['welcome-session-end-skills'],_.extend(this.model.toJSON(),{fb_connected:duo.user.has('facebook_id')}),duo.templates)); if(this.show_facebook){this.progress_view.graded();this.$('#progress-bar').replaceWith(this.progress_view.el);}
this.renderSkills();_.defer(function(){if(window.twttr&&twttr.widgets){twttr.widgets.load();}});return this;},showMoreFriends:function(){this.$('#followed-friends li').show();this.$('.more-friends-on-duo').hide();},typeaheadLookup:function(event){this.query=this.$element.val()
if(!this.query){var other_friends=this.options.data.friends;$('#invite-friends').html($.duostache(duo.templates['other-fb-friends'],{other_friends:_.values(other_friends).slice(0,this.options.items)},duo.templates));return this;}
return this.search(this.query).hide()},renderSearch:function(friends){var other_friends=this.options.data.friends;var friends_data=_.map(friends,function(friend){return other_friends[friend];});$('#invite-friends').html($.duostache(duo.templates['other-fb-friends'],{other_friends:friends_data},duo.templates));return this;},inviteFriend:function(e){var button=$(e.currentTarget);var fb_id=button.data('user');mixpanel.track('facebook invite click');FB.ui({method:'send',link:'http://duolingo.com/#/register?ib='+duo.user.id,to:fb_id,name:translate_text("You're Invited to Join Duolingo!"),description:translate_text("With Duolingo you learn a language for free, while helping to translate the web."),picture:'http://static.duolingo.com/images/facebook/owl.png'},function(response){if(response){mixpanel.track('facebook invited');button.attr('disabled','disabled').text(translate_text('Invited'));}});},welcomeLog:function(data){$.post('/welcome/log',data);}});duo.WikiDocumentSentencePopoverView=Backbone.View.extend({id:undefined,template:duo.templates['wiki-document-sentence-popover'],events:{'click .show-comments':'showComments','click .cancel-edit':'cancelEdit','click .save-edit':'saveEdit','click .show-revisions':'showRevisions','keypress .wiki-textarea':'handleKeyPress','keyup .wiki-textarea':'handleTextChanged'},initialize:function(options){this.model.bind('change',this.render,this);this.parent_view=options.parent_view;this.popover_element=options.popover_element;var submodel_options={translation_id:this.model.get('translation_id'),document_sentence_id:this.model.get('document_sentence_id')};this.revisions_model=new duo.WikiDocumentSentenceRevisionHistory(submodel_options);this.revisions_view=new duo.WikiDocumentSentenceRevisionHistoryView({el:options.revisions_element,model:this.revisions_model,sentence_model:this.model});this.comments_model=new duo.WikiDocumentSentenceComments(submodel_options);this.comments_view=new duo.CommentModalView({el:options.comments_element,model:this.comments_model,document_sentence_discussion:true});this.highlighted_token_start_index=-1;this.highlighted_token_end_index=-1;var self=this;var innerFunc=function(e){if(e.target.id=='wrapper'||e.target.id=='app'){self.cancelEdit(null,true);}}
$('#wrapper').click(innerFunc);Backbone.history.once('route',function(){$('#wrapper').unbind('click',innerFunc);})},render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));if(typeof this.popover_element!=='undefined'){if(this.translationRevealed()==true){this.popover_element.show();}else{this.unhighlightTokens();this.popover_element.hide();}}
this.$('.wiki-textarea').toggleClass('error',this.model.get('rejected')==true);this.$('.error-flag').toggle(this.model.get('rejected')==true);this.updateElementVisibility();this.reposition();this.sizeTextarea();this.handleTextChanged(null,false);this.renderHighlighting();var self=this;_.defer(function(){self.$('label').inFieldLabels();});},clickToReveal:function(){return this.parent_view&&this.parent_view.click_to_reveal;},translationRevealed:function(){if(this.clickToReveal())
return this.model.get('translation_revealed')==true;else
return this.model.get('hovered')==true;},sizeTextarea:function(){var textarea=this.$('.wiki-textarea');if(textarea.size()==0)
return;var desired_height=textarea[0].scrollHeight-20;if(desired_height>textarea.height()){textarea.height(desired_height);this.reposition();}},updateElementVisibility:function(){if(this.model.get('editable')==true){this.$('.cur-translation').hide();this.$('.wiki-action').show();this.$('.wiki-textarea').show();this.$('.wiki-textarea-container').show();}else{this.$('.cur-translation').show();this.$('.wiki-textarea').hide();this.$('.wiki-action').hide();this.$('.wiki-textarea-container').hide();}},cancelEdit:function(e,save_user_input){var user_input=null;var rejected=this.model.get('rejected');if(save_user_input)
user_input=this.$('.wiki-textarea').val();else
rejected=false;this.model.set({editable:false,hovered:false,user_input:user_input,rejected:rejected});},saveEdit:function(){var revised_text=$.trim(this.$('.edit-text-input').val());if(revised_text==''||revised_text==this.model.get('cur_translation')){return;}
var self=this;this.model.addRevision(revised_text,null,function(rejected,num_points_awarded,level_event){if(rejected){self.model.set({'user_input':revised_text,'rejected':true});$(self.el).addClass('shake');_.delay(function(){$(self.el).removeClass('shake');},1000);return;}
self.model.set({'editable':false,'rejected':false,'user_input':null});self.parent_view.incrementCoinCount(num_points_awarded,level_event);if(!self.model.get('user_approved')){self.parent_view.incrementNumSentencesDone(1);}
self.model.set('user_approved',true);});},handleKeyPress:function(e){if(e.which==13){e.preventDefault();if(!this.$('.save-edit').attr('disabled')){this.saveEdit();}}},handleTextChanged:function(e,update_reject){var input=$.trim(this.$('.edit-text-input').val());var button=this.$('.save-edit');if(input==''||input==this.model.get('cur_translation')){button.attr('disabled','disabled');}else{button.removeAttr('disabled');if(update_reject!=false){this.$('.wiki-textarea').removeClass('error')
this.$('.error-flag').hide();}}
this.sizeTextarea();},showComments:function(){this.showCommentsOrRevisions(this.comments_model,this.comments_view);},showRevisions:function(){this.showCommentsOrRevisions(this.revisions_model,this.revisions_view);},showCommentsOrRevisions:function(model,view){var options={translation_id:this.model.get('translation_id'),document_sentence_id:this.model.get('document_sentence_id')};var self=this;model.fetch({data:options,success:function(result){view.render();$(view.el).modal('show');var scrollTop=$(window).scrollTop();$(view.el).css({top:scrollTop+25+'px'});}});},reposition:function(){if(typeof this.parent_view!=='undefined')
this.parent_view.positionPopover(this.model.get('index'));},getToken:function(index){return this.$('#sentence-'+this.model.get('index')+'-token-'+index);},highlightTokenRange:function(start_index,end_index){this.highlighted_token_start_index=start_index;this.highlighted_token_end_index=end_index;this.renderHighlighting();},unhighlightTokens:function(){this.highlighted_token_start_index=-1;this.highlighted_token_end_index=-1;this.renderHighlighting();},renderHighlighting:function(){for(var i=0;;i++){var token=this.getToken(i);if(token.size()==0) 
return;if(i>=this.highlighted_token_start_index&&i<this.highlighted_token_end_index)
token.addClass('part-of-alignment');else
token.removeClass('part-of-alignment');}}});duo.WikiDocumentSentenceRevisionHistoryView=Backbone.View.extend({id:undefined,template:duo.templates['wiki-sentence-revisions'],events:{'click .cancel':'cancel','click .revert':'revert','click #follow-revisions':'followRevisions','click #following-revisions':'unfollowRevisions','click .radio':'radioClick','mouseenter .revision-item':'hoverSentence','mouseleave .revision-item':'unhoverSentence'},initialize:function(options){this.sentence_model=options.sentence_model;},render:function(){var json=this.model.toJSON();$(this.el).html($.duostache(this.template,json,duo.templates));var hints_option={templates:duo.templates,source_language:this.sentence_model.get('source_language'),target_language:this.sentence_model.get('target_language'),top:10};this.$('.translation-source').hints(hints_option);if(this.model.get('following')){this.$('#follow-revisions').hide();this.$('#following-revisions').show();}else{this.$('#following-revisions').hide();this.$('#follow-revisions').show();}
var self=this;this.revision_models=new Array();_.each(json.revisions,function(revision){var model=new duo.WikiDocumentSentenceRevision(revision);var element=self.$('#revision-'+revision.index);var view=new duo.WikiDocumentSentenceRevisionView({model:model,el:element});view.render();self.revision_models.push(model);});return this;},hoverSentence:function(e){var index=$(e.currentTarget).data('index');var num_revisions=this.revision_models.length;for(var i=0;i<num_revisions;i++){var model=this.revision_models[i];if(i==index&&i+1<num_revisions||(i==index-1&&index==num_revisions-1))
model.set({show_diff_with_earlier:true,show_diff_with_later:false,no_diff:false});else if(i==index+1||(i>0&&i==index&&index==num_revisions-1))
model.set({show_diff_with_earlier:false,show_diff_with_later:true,no_diff:false});else
model.set({show_diff_with_earlier:false,show_diff_with_later:false,no_diff:true});}},unhoverSentence:function(e){for(var i=0;i<this.revision_models.length;i++){this.revision_models[i].set({show_diff_with_earlier:false,show_diff_with_later:false,no_diff:true});}},cancel:function(){$(this.el).modal('hide');},radioClick:function(){var first=this.$('input[type="radio"]:checked').data('first');if(first==true){this.$('.revert').attr('disabled','disabled');}else{this.$('.revert').removeAttr('disabled');}},revert:function(e){if(this.$('.revert').attr('disabled')=='disabled')
return false;var self=this;var revised_text=$.trim(this.$('input[type="radio"]:checked').val());this.sentence_model.addRevision(revised_text,null,function(){$(self.el).modal('hide');self.sentence_model.set('editable',false);});},followRevisions:function(e){var self=this;this.model.follow(function(success){if(success){self.$('#follow-revisions').hide();self.$('#following-revisions').show();}});},unfollowRevisions:function(e){this.model.unfollow(function(success){if(success){self.$('#following-revisions').hide();self.$('#follow-revisions').show();}});}});duo.WikiDocumentSentenceRevisionView=Backbone.View.extend({id:undefined,template:duo.templates['wiki-sentence-revision'],initialize:function(){this.model.bind('change',this.render,this);},render:function(){var json=this.model.toJSON();$(this.el).html($.duostache(this.template,json,duo.templates));}});})(window.jQuery);duo.TermsView=Backbone.View.extend({id:'app',template:duo.templates['terms'],render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this;}});duo.HelpView=Backbone.View.extend({id:'app',template:duo.templates['help'],render:function(){var data=duo.user.toJSON();data['learning_language_'+duo.user.get('learning_language')]=true;data['ui_language_'+duo.user.get('ui_language')]=true;$(this.el).html($.duostache(this.template,data,duo.templates));return this;}});duo.PrivacyView=Backbone.View.extend({id:'app',template:duo.templates['privacy'],render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this;}});duo.GuidelinesView=Backbone.View.extend({id:'app',template:duo.templates['guidelines'],render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this;}});duo.StudyView=Backbone.View.extend({id:'app',template:duo.templates['study'],render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this;}});duo.InfoView=Backbone.View.extend({id:'app',template:duo.templates['info'],events:{'click .tabs li':'onTabSwitch','click video':'onVideoSwitch'},initialize:function(){_.bindAll(this,'makeVideo');var _is_chrome=navigator.userAgent.indexOf('Chrome')>-1;var _is_safari=navigator.userAgent.indexOf("Safari")>-1;this._is_safari=_is_safari&&!_is_chrome;},render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);var video_lists={};var max_video_list_length=0; var videos=this.$("#construction-owl video");_.each(videos,function(video){var $video=$(video);var num_videos=$video.data('videos');var zone=$video.data('zone'); video_lists[zone]=_.shuffle(_.range(1,num_videos+1));max_video_list_length=Math.max(max_video_list_length,num_videos);},this); var delay=1000;for(var i=0;i<max_video_list_length;i++){ _.each(videos,function(video){var $video=$(video);var zone=$video.data('zone');if(i>=video_lists[zone].length){return;}
_.delay(this.makeVideo,delay,video_lists,$video,zone,i);delay+=1000;if(i>0){delay+=1000;}},this);}
return this;},onTabSwitch:function(e){var li=$(e.currentTarget);this.switchToTab(li.data('tab'));},switchToTab:function(tab){this.$('.panel').hide();this.$('#'+tab+'-panel').show();this.$('.tabs li').removeClass('active');this.$('.tabs li[data-tab="'+tab+'"]').addClass('active');},onVideoSwitch:function(e){var $video=$(e.currentTarget);var zone=$video.data('zone');var video=$video.data('video');var num_videos=this.$('video.zone_'+zone).size();var next_video=(video+1)%num_videos;var $next=this.$('#video-'+zone+'-'+next_video);$next[0].play();$video.hide();$next.css({opacity:100}).show();},setVideoSource:function($video,zone,index){var prefix='http://s3.amazonaws.com/duolingo-images/videos/about/'+zone+'/'+index;if($video.find('source[type="video/mp4"]').size()===0){$video.append('<source type="video/mp4" />');}
$video.find('source[type="video/mp4"]').attr('src',prefix+'.mp4');if($video.find('source[type="video/webm"]').size()===0){$video.append('<source type="video/webm" />');}
$video.find('source[type="video/webm"]').attr('src',prefix+'.webm');if(this._is_safari){prefix+='-safari';}
$video.attr('poster',prefix+'.jpg');},makeVideo:function(video_lists,$video,zone,index){ var this_$video=index>0?$video.clone():$video;var vindex=video_lists[zone][index];this.setVideoSource(this_$video,zone,vindex);this_$video.attr('id','video-'+zone+'-'+index).data('video',index);if(index>0){this_$video.hide().prop('autoplay',false).appendTo('#construction-owl');this_$video[0].load&&this_$video[0].load();}else{this_$video[0].load&&this_$video[0].load();this_$video.fadeIn();this_$video[0].play&&this_$video[0].play();}}});duo.MobileView=Backbone.View.extend({id:'app',template:duo.templates['mobile'],events:{'click #get-app-link':'getAppLink','keyup #email':'keyCheckEmail','click #app-link-modal .close':'closeModal'},initialize:function(){this.launch=new Date(2012,10,13);_.bindAll(this,'updateTimer');this.interval_id=setInterval(this.updateTimer,1000); duo.topbar.bind('navigate',this.stop);},render:function(){var now=new Date();var total_s=(this.launch-now)/1000;var seconds=parseInt(total_s%60);var minutes=parseInt(Math.floor(total_s/60))%60;var hours=parseInt(Math.floor(total_s/3600))%24;var days=parseInt(Math.floor(total_s/86400));$(this.el).html($.duostache(this.template,{seconds:this.padNumber(seconds),minutes:this.padNumber(minutes),hours:this.padNumber(hours),days:this.padNumber(days),with_counter:total_s>0,ui_language:duo.user?duo.user.get('ui_language'):duo.browser_language,email:duo.user?duo.user.get('email'):''},duo.templates));window.scrollTo(0,0);var self=this;_.defer(function(){self.$('label').inFieldLabels();});return this;},updateTimer:function(){var now=new Date();var total_s=(this.launch-now)/1000;var seconds=this.padNumber(parseInt(total_s%60));var minutes=this.padNumber(parseInt(Math.floor(total_s/60))%60);var hours=this.padNumber(parseInt(Math.floor(total_s/3600))%24);var days=this.padNumber(parseInt(Math.floor(total_s/86400)));if(seconds!=this.$('#seconds').text()){this.$('#seconds').text(seconds).parent().addClass('rotating');}else{this.$('#seconds').parent().removeClass('rotating');}
if(minutes!=this.$('#minutes').text()){this.$('#minutes').text(minutes).parent().addClass('rotating');}else{this.$('#minutes').parent().removeClass('rotating');}
if(hours!=this.$('#hours').text()){this.$('#hours').text(hours).parent().addClass('rotating');}else{this.$('#hours').parent().removeClass('rotating');}
if(days!=this.$('#days').text()){this.$('#days').text(days).parent().addClass('rotating');}else{this.$('#days').parent().removeClass('rotating');}
if(total_s<=0){this.stop();this.$('.with-counter').remove();this.$('.app-link').show();}},padNumber:function(n){if(n<10){return'0'+n;}
return n;},stop:function(){clearInterval(this.interval_id);duo.topbar.unbind('navigate',this.stop);},keyCheckEmail:function(e){if(e.which===13){this.getAppLink();}},getAppLink:function(){var email=$.trim(this.$('#email').val());var ui_language=duo.user?duo.user.get('ui_language'):duo.browser_language;var self=this;$.post('/app_link',{email:email,lang:ui_language},function(d){if(d.response==='ok'){self.$('#email').val('');self.$('.modal').modal('hide');}else{self.$('#message').fadeIn().delay(1000).fadeOut();}});},closeModal:function(){this.$('.modal').modal('hide');}});duo.StudyView=Backbone.View.extend({id:'app',template:duo.templates['study'],render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this;}});duo.JobsView=Backbone.View.extend({id:'app',template:duo.templates['jobs'],initialize:function(data){this.data=data;},render:function(name){var self=this;$(self.el).html($.duostache(self.template,this.data,duo.templates));self.$('#nav-'+name).addClass('active');window.scrollTo(0,0);return self;}});duo.User=Backbone.Model.extend({url:function(){return'/users/'+this.get('username');},toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);if(this.has('language_data')){json_data['learning_language_points']=this.getSkills().points;}
if(this.has('ab_options')){json_data['ab']={};_.each(this.get('ab_options'),function(value,exp){json_data['ab'][exp+'_'+value]=true;});} 
delete json_data['language_data'];return json_data;},parse:function(data){if(data.language_data){for(var language in data.language_data){data.language_data[language].skills=new duo.SkillList(duo.SkillList.prototype.parse(data.language_data[language].skills));}}
if(data.events){var p_view=data.events.p_view;var events=new duo.EventList();events.reset(data.events,{parse:true});events.user_id=this.id||data.id;events.before=data.before;events.more_events=data.more_events;events.p_view=p_view;events.error=data.events_error;data.events=events;}
return data;},getSkills:function(){return this.get('language_data')[this.get('learning_language')];},switchLanguage:function(learning_language,no_redirect,data_only){var self=this;var id=(duo.user&&this.id==duo.user.id&&!data_only)?undefined:this.id;if(!id){mixpanel.track('switch_language');}
$.post('/switch_language',{learning_language:learning_language,user_id:id},function(data){self.get('language_data')[learning_language]=data;self.get('language_data')[learning_language].skills=new duo.SkillList(duo.SkillList.prototype.parse(data.skills));var language_list=self.get('languages');for(var i=0;i<language_list.length;i++){if(language_list[i].language==learning_language){if(!no_redirect&&language_list[i].learning===false&&duo.user.get('auto_facebook_post')){ var auth_response=FB.getAuthResponse();if(auth_response){var og=duo.debug?'og_debug':'og';var options={language:'http://duolingo.com/'+og+'/'+learning_language};duo.postFacebookAction(duo.fb_app,'start_learning',options);}}
language_list[i].learning=true;language_list[i].current_learning=true;}else{language_list[i].current_learning=false;}}
self.set({learning_language:learning_language,learning_language_string:data.language_string},{silent:no_redirect});if(!id&&!no_redirect){duo.userRouter.navigate('',true);}
window.Zenbox.update({'dropboxID':duo.zendesk_ids[duo.user.get('ui_language')+'-'+data.language]});});},updateActivity:function(callback,options,profile_view){var self=this;$.ajax({url:'/activity/'+this.id,data:{p_view:profile_view},success:function(data){data.events=data.events||[];data.events.p_view=profile_view;self.set(self.parse(data),options);if(callback){callback();}},error:function(jqXHR,status,error_thrown){var data={events:[],events_error:error_thrown};self.set(self.parse(data),options);if(callback){callback();}}});},follow:function(user_id,silent){if(user_id===undefined){var self=this;$.post('/follow',{user_id:this.id},function(data){if(data.user_following){self.set(_.extend(data.followers,{'is_following':true}));_.extend(duo.user.getSkills(),data.user_following.skill_rank_data);duo.user.set(data.user_following.data,{silent:silent});}});}else{$.post('/follow',{user_id:user_id},function(data){if(data.user_following){_.extend(duo.user.getSkills(),data.user_following.skill_rank_data);duo.user.set(data.user_following.data,{silent:silent});}});}
mixpanel.track('follow');},unfollow:function(user_id,silent){if(user_id===undefined){var self=this;$.post('/unfollow',{user_id:this.id},function(data){if(data.user_following){self.set(_.extend(data.followers,{'is_following':false}));_.extend(duo.user.getSkills(),data.user_following.skill_rank_data);duo.user.set(data.user_following.data,{silent:silent});}});}else{$.post('/unfollow',{user_id:user_id},function(data){if(data.user_following){_.extend(duo.user.getSkills(),data.user_following.skill_rank_data);duo.user.set(data.user_following.data,{silent:silent});}});}
mixpanel.track('unfollow');},hasFriendshipsLoaded:function(){return(this.get('num_followers')==this.get('followers').length)&&(this.get('num_following')==this.get('following').length);},getFriendships:function(silent,callback,context){var self=this;$.getJSON('/friendships/'+this.id,function(data){self.set(data,{silent:silent});if(callback){context=context||this;callback.call(context,data);}});},fetchAvatar:function(url){if(!duo.debug){$.post('http://duolingo.com/avatars',{user_id:this.id,fetch:true,image:url},function(data){console.log('avatar fetched from ',url);});}},dismissNotification:function(message){$.post('/dismiss_notification',{message:message},function(data){if(data.response==='ok'){duo.user.getSkills()['notifications'][message]=false;}});},shouldAutoPlay:function(){return this.get('autoplay')&&this.get('speaker');}});duo.UserList=Backbone.Collection.extend({model:duo.User,parse:function(data){if('users'in data){this.more=data.more;this.page=data.page;return data.users;}
return data;},fetch:function(options){options=options||{};options.data=options.data||{};options.data.per_page=this.per_page;Backbone.Collection.prototype.fetch.call(this,options);},nextPage:function(){this.fetch({data:{page:this.page+1},update:true,remove:false});}});(function($){duo.UserTopbarView=Backbone.View.extend({id:'topbar',events:{'click .languages li':'switchLanguage','mouseenter .dropdown':'showMenu','mouseleave .dropdown':'hideMenu','click .dropdown .dropdown-menu':'hideMenu','keyup .search-input':'keycheckSearch','focus .search-input':'onFocusSearch','blur .search-input':'onBlurSearch'},template:duo.templates['menu'],initialize:function(){this.lazySearch=this.debounce(this._search,1500,true);},debounce:function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args);};if(immediate&&!timeout)func.apply(context,args);clearTimeout(timeout);timeout=setTimeout(later,wait);};},_search:function(){var q=$.trim(this.$('.search-input').val());if(q.length>0){this.$('.top-search .loading-indicator').show();$.get('/users/search',{q:q,per_page:7},function(data){data.q=q;$('.top-search .hybrid-modal').html($.duostache(duo.templates['menu-search-popup'],data,duo.templates)).show();$(document).unbind('.menu-search').bind('click.menu-search',function(e){var $target=$(e.target);if($target.closest('.top-search').size()>0){return;}
$('.top-search .hybrid-modal, .top-search .loading-indicator').hide();$(document).unbind('.menu-search');});$('.top-search .loading-indicator').hide();});}else{this.$('.top-search .hybrid-modal').hide();}},search:function(){this.lazySearch();},keycheckSearch:function(e){if(e.which===13){this.search();}},onFocusSearch:function(){var $label=this.$('.search-label');if(!$label.data('blurText')){$label.data('blurText',$label.text());}
$label.text($label.data('focusText'));},onBlurSearch:function(){var $label=this.$('.search-label');$label.text($label.data('blurText'));},start:function(){ duo.translationRouter.bind('route:translations',this.translationTab,this);duo.translationRouter.bind('route:translation',this.noTab,this);duo.commentRouter.bind('all',this.commentsTab,this);duo.homeRouter.bind('all',this.homeRoutes,this);duo.userRouter.bind('all',this.homeRoutes,this);duo.skillRouter.bind('all',this.skillRoutes,this);duo.settingsRouter.bind('all',this.noTab,this);duo.vocabRouter.bind('all',this.vocabTab,this);duo.adminRouter.bind('all',this.adminTab,this);this.model.bind('change:learning_language',this.changeLanguage,this);this.model.bind('change:username',this.render,this);this.model.bind('change:speaker',this.render,this);this.model.bind('change:microphone',this.render,this);},render:function(){var data=_.extend(this.model.toJSON(),this.model.getSkills());if(!data.language_string){data.language_string=this.model.get('learning_language_string');}
data.any_other_learning=_.any(this.model.get('languages'),function(language){return language.learning;});data.any_other_not_learning=_.any(this.model.get('languages'),function(language){return!language.learning;});$(this.el).html($.duostache(this.template,data,duo.templates));var self=this;_.defer(function(){self.$('label').inFieldLabels();});this.$('#global-loading-indicator').ajaxStart(function(){$(this).show();}).ajaxStop(function(){$(this).hide();});return this;},showMenu:function(e){var dropdown=$(e.currentTarget);dropdown.find('.dropdown-menu').show();},hideMenu:function(e){var dropdown=$(e.currentTarget);if(dropdown.is('.dropdown-menu')){dropdown.hide();}else{dropdown.find('.dropdown-menu').hide();}},switchLanguage:function(e){var language_li=$(e.currentTarget);if(language_li.data('value')==='more'){window.location='/#/settings/account';}else if(language_li.data('value')){mixpanel.track('switch_language');mixpanel.register({learning_language:language_li.data('value')});this.model.switchLanguage(language_li.data('value'));}},changeLanguage:function(){var nav=this.$('li.active').attr('id');this.render();this.$('#'+nav).addClass('active');},noTab:function(){$('body').removeClass('player');$('#app').removeClass('leave-warning');window.onbeforeunload=null;$(document).unbind('.session, .infinite_scroll');this.$('.nav li').removeClass('active').show();this.$('.speaker-micro-toggle').show();$('#box_feedback #activity_uuid').val('');this.$('.user-nav, .top-search').show();this.trigger('navigate');$.tts.cleanAll();this.$('.top-search .hybrid-modal').hide();this.$('.search-input').val('').blur();},homeTab:function(){this.noTab();this.$('#home-nav').addClass('active');},mobileTab:function(){this.noTab();this.$('#mobile-nav').addClass('active');},adminTab:function(){this.noTab();this.$('#admin-nav').addClass('active');},commentsTab:function(page){if(page.indexOf('route:')<0){return;}
mixpanel.track("Topbar Questions");this.noTab();this.$('#questions-nav').addClass('active');},vocabTab:function(page){if(page.indexOf('route:')<0){return;}
mixpanel.track("Topbar Vocabulary");this.noTab();this.$('#vocab-nav').addClass('active');},hideTabs:function(no_navigate){if(!no_navigate){this.noTab();}
this.$('.nav li').hide().removeClass('active');this.$('.user-nav, .top-search').hide();},profileTab:function(username){this.noTab();if(!username||username===duo.user.get('username')){this.$('#home-nav').addClass('active');}},friendsTab:function(){mixpanel.track("Topbar Follow");this.noTab();this.$('#friends-nav').addClass('active');},translationTab:function(){mixpanel.track("Topbar Translations");this.noTab();this.$('#translations-nav').addClass('active');},sessionStart:function(){this.noTab();this.$('.speaker-micro-toggle').hide();},homeRoutes:function(route,username){if(route==='route:home'){this.homeTab();}else if(route==='route:profile'){this.noTab();}else if(route==='route:welcome'){this.hideTabs();}else if(route==='route:mobile'){this.mobileTab();}else if(route==='route:findFriends'){this.friendsTab();}else if(route==='practiceLanguage'||route==='route:practice'||route==='practiceTimed'){this.sessionStart();this.$('#practice-nav').addClass('active');}else if(route==='bigTest'){this.sessionStart();}else if(route.indexOf('route:')===0){this.noTab();}},skillRoutes:function(route){if(route!=='route:skill'){this.sessionStart()}else{this.noTab();}}});duo.MenuSearchResults=Backbone.View.extend({template:duo.templates['user-search-results'],render:function(){$(this.el).html($.duostache(this.template,duo.user.toJSON(),duo.templates));return this;}})
duo.FriendFindView=Backbone.View.extend({id:'app',template:duo.templates['friend-find'],events:{'keyup .search-input':'keycheckSearch'},initialize:function(){this.lazySearch=this.debounce(this._search,1500,true);this.search_results=new duo.UserList();this.search_results.per_page=20;this.search_results.bind('sync',this.render,this);this.last_request_length=0;},debounce:function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args);};if(immediate&&!timeout)func.apply(context,args);clearTimeout(timeout);timeout=setTimeout(later,wait);};},render:function(){$(this.el).html($.duostache(this.template,{q:this.q,users:this.search_results.toJSON()},duo.templates));var self=this;_.defer(function(){self.$('label').inFieldLabels();});if(this.preload_q){this.setQuery(this.preload_q);this.preload_q=undefined;}
var self=this;_.defer(function(){$(document).unbind('.friend_find_scroll').bind('scroll.friend_find_scroll.infinite_scroll',function(e){var total_height=$(document).height();var view_height=total_height-$(document).scrollTop();var visible_height=$(window).height();if(view_height<1.5*visible_height&&self.search_results.length>self.last_request_length){self.$('#more-stream').hide();self.last_request_length=self.search_results.length;self.loadNextPage();}});});return this;},_search:function(){var q=$.trim(this.$('#search-learners').val());this.last_request_length=0;this.q=q;if(q.length>0){this.search_results.url='/users/search?q='+q;this.search_results.fetch();}else{this.search_results.reset();}},search:function(){this.lazySearch();},keycheckSearch:function(e){if(e.which===13){this.search();}},setQuery:function(q){this.$('#search-learners').val(q);this.search();},loadNextPage:function(){this.search_results.nextPage();}});duo.FriendsView=Backbone.View.extend({id:'app',template:duo.templates['friends'],events:{'click #find-fb-friends':'loginFB','click #search-button':'search','keyup #search-friends':'keycheckSearch','click #find-twttr-friends':'findTwttrFriends','click .tabs li':'switchTabs'},initialize:function(){this.suggested_friends=new duo.UserList();this.suggested_friends.url='/suggest_friends';this.suggested_view=new duo.FriendsListView({collection:this.suggested_friends,is_recommended_list:true});this.suggested_friends.fetch();this.search_friends=new duo.UserList();this.search_view=new duo.FriendsListView({collection:this.search_friends,is_search_list:true,id:'search-friends-list'});this.fb_friends=new duo.UserList();this.fb_view=new duo.FriendsListView({collection:this.fb_friends,is_friends_list:true,id:'fb-friends-list'});this.twttr_friends=new duo.UserList();this.twttr_view=new duo.FriendsListView({collection:this.twttr_friends,is_friends_list:true,id:'twttr-friends-list'});var self=this;if(window.twttr){twttr.anywhere(function(T){$('#twttr-connect').click(function(){T.signIn();});T.bind('authComplete',function(e,user){console.log(user);var twttr_id=user.idStr;self.twttrConnect(twttr_id,user.data('screen_name'));});});}
duo.user.bind('change:facebook_name',this.setFBName,this);duo.user.bind('change:twitter_name',this.setTwttrName,this);this.lazySearch=this.debounce(this._search,1500,true);},debounce:function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args);};if(immediate&&!timeout)func.apply(context,args);clearTimeout(timeout);timeout=setTimeout(later,wait);};},render:function(){$(this.el).html($.duostache(this.template,duo.user.toJSON(),duo.templates));this.$('#suggested-friends-list').replaceWith(this.suggested_view.render().el);this.$('#search-friends-list').replaceWith(this.search_view.render().el);this.$('#search-friends-list').hide();this.$('#fb-friends-list').replaceWith(this.fb_view.render().el);this.$('#twttr-friends-list').replaceWith(this.twttr_view.render().el);var self=this;_.defer(function(){self.$('label').inFieldLabels();});return this;},loginFB:function(){var self=this;if(!window.FB){return;}
var auth_response=FB.getAuthResponse();if(auth_response){this.getFBFriends(auth_response);}else{var self=this;FB.login(function(login_response){if(login_response.authResponse){self.getFBFriends(login_response.authResponse);}},{scope:'publish_actions'});}},getFBFriends:function(auth_response){var facebook_id=auth_response.userID;var access_token=auth_response.accessToken;duo.user.set({facebook_id:facebook_id});var self=this;this.access_token=access_token;FB.api('/me/friends?access_token='+access_token+'&fields=picture,installed,name',function(friends_data){var duo_friends=_.filter(friends_data.data,function(friend){return friend.installed;});$.post('/facebook_connect',{facebook_id:facebook_id,facebook_friends:JSON.stringify(duo_friends),auto_follow:false},function(data){duo_friends=_(duo_friends).chain().filter(function(friend){return friend.id in data.friends;}).map(function(friend,i){_.extend(friend,data.friends[friend.id]);friend.learning_language_name=friend.language_name;return friend;}).value();self.renderFBFriends(duo_friends);});});FB.api('/me?fields=name&access_token='+access_token,function(data){duo.user.set({facebook_name:data.name});});},renderFBFriends:function(duo_friends){this.fb_friends.reset(duo_friends);this.$('#twttr-panel ').hide();this.$('#fb-panel').show();},setFBName:function(){this.$('#facebook-profile-link').text(duo.user.get('facebook_name'));},setTwttrName:function(){this.render();this.$('.tabs li[data-tab="connect-panel"] a').click();},_search:function(){var q=$.trim(this.$('#search-friends').val());if(q.length>0){this.search_friends.url='/users/search?q='+q;this.search_friends.fetch();this.$('#search-friends-list').show();}else{this.search_friends.reset();this.$('#search-friends-list').hide();}},search:function(){this.lazySearch();},keycheckSearch:function(e){if(e.which===13){this.search();}},renderSearchFriends:function(search_friends){$(this.el).html($.duostache(this.template,_.extend(duo.user.toJSON(),{suggested_friends:search_friends}),duo.templates));return this;},twttrConnect:function(idStr,screen_name){var self=this;$.ajax('http://api.twitter.com/1/friends/ids.json',{data:{user_id:idStr},dataType:'jsonp',success:function(friends_data){var friends_ids=friends_data.ids;$.post('/twitter_connect',{twitter_id:idStr,twitter_friends:JSON.stringify(friends_ids),auto_follow:false},function(data){duo.user.set({twitter_id:idStr,twitter_name:screen_name});self.twttr_friends.reset(_.values(data));self.$('#fb-panel').hide();self.$('#twttr-panel').show();});}});},findTwttrFriends:function(){if(!window.twttr){return;}
twttr.anywhere(function(T){if(T.isConnected()){var current_user=T.currentUser;this.twttrConnect(current_user.idStr,current_user.data('screen_name'));}else{T.signIn();}});},switchTabs:function(e){var tab=$(e.currentTarget);this.$('.panel').hide();this.$('.tabs li').removeClass('active');tab.addClass('active');this.$('#'+tab.data('tab')).show();},changeLanguage:function(){window.location.reload(true);}});duo.FriendsListView=Backbone.View.extend({template:duo.templates['friends_list'],events:{'click .load-more':'loadMore','click .follow-button':'follow'},initialize:function(options){this.collection=options.collection;this.is_friends_list=options.is_friends_list;this.is_search_list=options.is_search_list;this.is_recommended_list=options.is_recommended_list;this.hide_empty=options.hide_empty;this.collection.bind('reset',this.render,this);this.collection.bind('add',this.render,this);this.collection.bind('change',this.render,this);},render:function(){$(this.el).html($.duostache(this.template,{friends:this.collection.toJSON(),more:this.collection.more,is_empty:this.collection.length===0,is_friends_list:this.is_friends_list,is_search_list:this.is_search_list,is_recommended_list:this.is_recommended_list},duo.templates));if(this.collection.length===0&&this.hide_empty){$(this.el).hide();}else if(this.hide_empty){$(this.el).show();}
return this;},loadMore:function(){this.collection.nextPage();},follow:function(e){var link=$(e.target);var user_id=link.data('user');if(!link.hasClass('success')){this.collection.get(user_id).set({is_following:true});}else{this.collection.get(user_id).set({is_following:false});}}});duo.LoggedOutMessage=Backbone.View.extend({template:duo.templates['logged-out-message'],events:{'click #join':'join'},initialize:function(options){this.width=options.width||980;this.language=options.language||undefined;},render:function(){var data={};if(this.model){data=this.model.toJSON();}
data.language=this.language;$(this.el).html($.duostache(this.template,data,duo.templates)).css({width:this.width});return this;},join:function(){mixpanel.track('join');}});})(window.jQuery);duo.HomeRoutes=duo.Router.extend({routes:{'login':'loggedIn','welcome':'welcome','practice/timed':'practiceTimed','practice/:language':'practiceLanguage','bigtest/:language/:test':'bigTest','debug/:language/:words':'debugWords','debug/:source_language/:target_language/:sentence':'debugSentence','debug/:source_language/:target_language/:sentence/:se_type':'debugSentence','practice(?from_email=:from_email)':'practice','notify_me?email=:email&ui_language=:ui_language':'notify_me','notify_me?email=:email':'notify_me','notify_me':'notify_me','reset_password?email=:email&token=:token':'reset_password','reset_password?email=:email%26token=:token':'reset_password','help':'help','translate':'translate','forgot_password':'loggedIn','register':'loggedIn','register?email=:email&invite=:invite':'loggedIn'},initialize:function(){duo.topbar=new duo.UserTopbarView({model:duo.user});$('#topbar').replaceWith(duo.topbar.render().el);},loggedIn:function(){this.navigate('',true);},welcome:function(){var self=this;var session=new duo.WelcomeSession();session.fetch({success:function(model,obj){try{if(obj.session_elements.length===0){ duo.homeRouter.navigate('/',true);return;}
document.title="Duolingo: "+translate_text('Welcome');var view=new duo.WelcomeSessionView({model:session});mixpanel.track('welcome');if(duo.user.get('ab_options').new_player_blame_experiment){self.switchView(view,"player");}else{self.switchView(view);}}catch(err){$.post('/welcome/log',{fetched:true,stack:err.stack,description:err.description,err:err.toString()});}}});},practice:function(from_email){if(from_email){mixpanel.track('email button click',{from_email:from_email});}
this.practiceLanguage(duo.user.get('learning_language'),false,from_email);},practiceTimed:function(){this.practiceLanguage(duo.user.get('learning_language'),true);},practiceLanguage:function(language,timed,from_email){var self=this;var session=new duo.GlobalPracticeSession({language:language,from_email:from_email});session.fetch({success:function(model,obj){if(obj.session_elements.length===0){alert(translate_text('You have practiced all of your words. Try doing some lessons or translations.'));duo.homeRouter.navigate('',true);return;}
if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
document.title='Duolingo: '+translate_text('Practice');var view=new duo.TimedSessionView({model:session,extra:7,die:true,total_time:30,points:true,shown_max_time:60,auto_timed:timed});if(duo.user.get('ab_options').new_player_blame_experiment){self.switchView(view,"player");}else{self.switchView(view);}}});},bigTest:function(language,test){var self=this;var session=new duo.BigTestSession();session.fetch({data:{language:language,big_test:test},success:function(model,obj){if(obj.session_elements.length===0){duo.homeRouter.navigate('/',true);return;}
if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
document.title='Duolingo: '+translate_text('Test');var view=new duo.BigTestSessionView({model:session});if(duo.user.get('ab_options').new_player_blame_experiment){self.switchView(view,"player");}else{self.switchView(view);}}});},debugWords:function(language,words){var session=new duo.DebugSession();session.fetch({data:{language:language,words:decodeURIComponent(words)},success:function(model,obj){if(obj.session_elements.length===0){duo.homeRouter.navigate('/',true);return;}
if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
document.title='Duolingo: Debug';var view=new duo.SessionView({model:session});$('#app').replaceWith(view.render().el);$('#app').removeClass(duo.view);}});},debugSentence:function(source_language,target_language,sentence,se_type){var session=new duo.DebugSession();session.fetch({data:{source_language:source_language,target_language:target_language,sentence:decodeURIComponent(sentence),se_type:se_type},success:function(model,obj){if(obj.session_elements.length===0){duo.homeRouter.navigate('/',true);return;}
if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
document.title='Duolingo: Debug';var view=new duo.SessionView({model:session});$('#app').replaceWith(view.render().el);$('#app').removeClass(duo.view);}});},reset_password:function(email,token){var resetView=new duo.ResetView({email:decodeURIComponent(email),token:token});this.switchView(resetView,'page-reset');},help:function(){document.title="Duolingo: "+translate_text('Help');var helpView=new duo.HelpView();this.switchView(helpView,'help');},translate:function(){document.title="Duolingo: Translate";var translateView=new duo.TranslateView();$('#app').replaceWith(translateView.render().el);$('#app').removeClass(duo.view);duo.view=null;},notify_me:function(email,ui_language){var notifyView=new duo.NotifyView();$('#app').replaceWith(notifyView.render(email).el);}});duo.LanguageSwitchEnabledView=Backbone.View.extend({toggleLanguages:function(){this.$('.change-language-dark .languages').toggle();return true;},switchUILanguage:function(e){}});duo.FormView=duo.LanguageSwitchEnabledView.extend({gatherInput:function(form){var fields=this.$(form+' :input');var args={}; $.each(fields,function(){var value=$(this).val(); if(this.type==='radio'||this.type==='checkbox'){if($(this).prop('checked')){ if(value==='true'||value==='false'){args[this.name]=(value==='true');}else{args[this.name]=value;}}}else{args[this.name]=value;}});return args;}});duo.RegisterView=duo.FormView.extend({id:'app',template:duo.templates['register'],events:{"click #register-button":"register","keydown #register-form":"registerKeyInput",'click .change-language-dark':'toggleLanguages','change #learning-language':'selectLanguage'},initialize:function(prefilled){this.prefilled=prefilled;},render:function(){this.delegateEvents();$(this.el).html($.duostache(this.template,_.extend({available_languages:duo.available_languages,ui_language:duo.browser_language,ui_language_name:duo.ui_language_name,ui_languages:duo.ui_languages},this.prefilled),duo.templates));var self=this;_.defer(function(){self.$("label").inFieldLabels({periodic:true});});if(this.prefilled.learning_language){this.$('#learning-language').val(this.prefilled.learning_language);}
mixpanel.track('register render');return this;},selectLanguage:function(e){var data=this.$('#learning-language').val().split('-');if(data.length>1){var url=unescape(window.location.toString());var position=url.indexOf('target_language=');if(position==-1){position=url.indexOf('ui_language=');}
if(position!=-1){url=url.substring(0,position-1);}
var param='target_language='+data[1]+'&ui_language='+data[0];if(url.match(/\/register$/)){param='?'+param;}else{param='&'+param;}
window.location=url+param;}},registerKeyInput:function(e){this.$('.error').removeClass("error");this.$('.error-flag').hide();if(e.which===13){this.register();return false;}},register:function(){var self=this;args=this.gatherInput('#register-form');if(mixpanel.get_property){args['mixpanel_id']=mixpanel.get_property("distinct_id");}
this.$('.error-flag').hide();this.$('.error').removeClass('error');$.post('/register',args,function(data){console.debug(data);if(data.response==='OK'){var callback=function(){$('#register-form').submit();};var t=window.setTimeout(callback,300);var cb=function(){ window.clearTimeout(t);callback();};var through='email';if('facebook_id'in args){through='facebook';}else if('twitter_id'in args){through='twitter';}
mixpanel.track("register",{learning_language:args["learning_language"],with_facebook:'facebook_id'in args,with_twitter:'twitter_id'in args,through:through,successful:true},cb);}else{_.each(data.failures,function(reason,field){this.$('#'+field).addClass('error');this.$('#'+reason+'-'+field+'-error').show();},self);mixpanel.track("register",{learning_language:args["learning_language"],successful:false,error:_.keys(data.failures).join(', ')});}},'json');return false;}});duo.SmallRegisterView=duo.RegisterView.extend({template:duo.templates['small-register'],id:"",events:{"click #register-button":"register","keydown #register-form":"registerKeyInput",'change #learning-language':'selectLanguage','click #email-link':'showEmailSignup','click .signup-facebook':'connectToFacebook','click .signup-twitter':'connectToTwitter','click #twitter-error .close':'closeTwitterError','click #back-email-link':'hideEmailSignup'},render:function(){this.delegateEvents();$(this.el).html($.duostache(this.template,_.extend({available_languages:duo.available_languages,ui_language:duo.browser_language,ui_language_name:duo.ui_language_name,ui_languages:duo.ui_languages},this.prefilled),duo.templates));var self=this;_.defer(function(){self.$("label").inFieldLabels({periodic:true});});this.$('#learning-language').val(this.prefilled.learning_language).change();mixpanel.track('register render');return this;},showEmailSignup:function(e,no_animate){if(no_animate){this.$('#signup-main').hide();this.$('#signup-email').show();return;}
var height=this.prefilled.facebook_id?460:430;this.$('#signup-main').fadeOut(function(){$('.signup').animate({height:height+'px'},500,function(){$('#signup-email').fadeIn();duo.scrollToElement($('#signup-email'));});});},hideEmailSignup:function(e){_.extend(this.prefilled,{facebook_id:null,profile_image:null,facebook_name:null,username:null,password:null,email:null})
this.render();this.showEmailSignup(null,true);},connectToFacebook:function(){window.open("/facebook/oauth","_BLANK","height=300,width=640");},connectToTwitter:function(){window.open("/twitter/oauth","_BLANK","height=400,width=800");},selectLanguage:function(e){var language_value=this.$('#learning-language').val();var data=language_value.split('-');if(data.length>1){var url=unescape(window.location.toString());var position=url.indexOf('target_language=');if(position==-1){position=url.indexOf('ui_language=');}
if(position!=-1){url=url.substring(0,position-1);}
var param='target_language='+data[1]+'&ui_language='+data[0];param='?'+param;if(url.indexOf('#')<0){param='#'+param;}
window.location=url+param;}},closeTwitterError:function(e){$("#twitter-error").hide();}});duo.LoginView=duo.FormView.extend({id:'app',className:'page-login',template:duo.templates['login'],events:{'click #login-button':'login','click .change-language-dark':'toggleLanguages'},login:function(){var self=this;args=this.gatherInput('#login-form');$.post('/login',args,function(data){if(data.response==='OK'){console.debug('logged in',window.location.hash);window.location.reload(true);self.$('input[type!=submit]').removeClass('error');}else{self.$('#message').text(translate_text("Wrong username or password"));self.$('#message').show();self.$('input[type!=submit]').addClass('error');}},'json');return false;},render:function(path){this.delegateEvents();$('#topbar-menu').hide();$(this.el).html($.duostache(this.template,{came_from:path,ui_language:duo.browser_language,ui_language_name:duo.ui_language_name,ui_languages:duo.ui_languages},duo.templates));var self=this;_.defer(function(){self.$("label").inFieldLabels({periodic:true});});return this;}});duo.ForgotView=duo.FormView.extend({id:'app',className:'page-forgot',template:duo.templates['forgot'],events:{"click input[type=submit]":"submit",'click .change-language-dark':'toggleLanguages'
},render:function(){this.delegateEvents();$(this.el).html($.duostache(this.template,{ui_language:duo.browser_language,ui_language_name:duo.ui_language_name,ui_languages:duo.ui_languages},duo.templates));var self=this;_.defer(function(){self.$("label").inFieldLabels();});return this;},submit:function(){var email=$("#email").val();var patt1=/^([a-zA-Z0-9_\+\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$$/;if(!patt1.test(email)||email.indexOf("@")==-1){$("#email").addClass("error");$("#form_txt_good").hide();}else{mixpanel.track("forgot password");$.post("/forgot",{"email":email},function(data){if(data.success){$("#form_txt_good").show();$("#email").removeClass("error");$("#forgot-form").hide();}else{$("#email").addClass("error");$("#form_txt_good").hide();}},"json");}
return false;}});duo.ResetView=Backbone.View.extend({id:'app',className:'page-reset',template:duo.templates['reset'],events:{"click input[type=submit]":"submit"},render:function(){this.delegateEvents();$(this.el).html($.duostache(this.template,{email:this.options.email,token:this.options.token}));var self=this;_.defer(function(){self.$("label").inFieldLabels();});return this;},submit:function(){var email=$("#email").val();var token=$("#token").val();var new_password=$("#new-password").val();var confirm_new_password=$("#confirm-new-password").val();var self=this;$.post("/reset",{"email":email,"token":token,"new_password":new_password,"confirm_new_password":confirm_new_password},function(data){if(data.response==='OK'){self.$('input[type=text]').removeClass('error');self.$('#reset-message').text('');$("#form_txt_good").show();$("#reset-form").hide();}else{self.$('#reset-message').text(translate_text(data.response));self.$('#reset-message').show();console.debug(data);if(data.fields){self.$('input[type=password]').addClass('error');}}},"json");return false;}});duo.SplashView=duo.LanguageSwitchEnabledView.extend({id:'app',template:duo.templates['splash'],events:{"click #subscribe-button":"subscribe","click #language-dropdown":"languageList","click .language-selector li":"hideLanguageList",'click #video-toggle':'showVideo'},initialize:function(){duo.loginRouter.bind('all',this.navigateAway,this);duo.commentRouter.bind('all',this.navigateAway,this);},render:function(){$(this.el).html($.duostache(this.template,{ui_language:duo.browser_language},duo.templates));this.signup_view=new duo.SmallRegisterView({el:this.$('.signup')});this.signup_view.render();var self=this;_.defer(function(){self.$("label").inFieldLabels({periodic:true});self.$("option[value="+duo.learning_language+"]").attr("selected",true);});return this;},languageList:function(){$(".language-selector").show();},hideLanguageList:function(){$(".language-selector").hide();},navigateAway:function(page){console.debug(page);if(page!='route:splash'){console.debug('navigating away');$('footer.main').removeClass('hidden');}},subscribe:function(){var email=$("#email").val();var learning_language=$("#learning_language").val();var patt1=/^([a-zA-Z0-9_\+\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$$/;if(!patt1.test(email)||email.indexOf("@")==-1){$("#email").addClass("error");$("#form_txt_good").hide();$("#form_txt_bad").hide();}else if(learning_language==''){$('#learning_language').addClass("error");$("#form_txt_good").hide();$("#form_txt_bad").hide();}else{$.post("/subscribe",{"email":email,"learning_language":learning_language},function(data){if(data=='1'){mixpanel.track("subscribe");$("#form_txt_good").show();}else{$("#form_txt_bad").show();}
$("#email").removeClass("error");$("#subscribe-form").hide();},"json");}
return false;},prefillWithTwitter:function(prefill){var no_animate=this.$('#signup-email').is(':visible');_.extend(this.signup_view.prefilled,prefill);this.signup_view.render();if(!prefill.twitter_error){ this.signup_view.showEmailSignup(null,no_animate);}},showVideo:function(){duo.showIntroVideo(duo.browser_language);return;}});duo.NotifyView=duo.SplashView.extend({id:'app',className:'page-notify',template:duo.templates['notify_me'],events:{"click #subscribe-button":"subscribe",'click .change-language-dark':'toggleLanguages'
},initialize:function(){},render:function(email){$(this.el).html($.duostache(this.template,{email:email,ui_language:duo.browser_language,ui_language_name:duo.ui_language_name,ui_languages:duo.ui_languages},duo.templates));_.defer(function(){self.$("label").inFieldLabels();});return this;}});duo.LoginTopbarView=duo.FormView.extend({id:'topbar',template:duo.templates['menu'],events:{"click #login-button":"login","click #sign-in-btn":"toggleLogin","click #site-language-btn":"toggleLanguages",'click #facebook-login':'facebookLogin','keyup #login-form input':'onInput'},start:function(){ duo.loginRouter.bind('all',this.navigate,this);duo.commentRouter.bind('all',this.navigate,this);},render:function(){$(this.el).html($.duostache(this.template,{ui_language_name:duo.ui_language_name,ui_languages_list:duo.ui_languages}));var self=this;_.defer(function(){self.$("label").inFieldLabels({periodic:true});});return this;},noTab:function(){this.$('.nav li').removeClass('active');},navigate:function(route){this.$('.nav li').removeClass('active');if(route.indexOf('route:register')===0||route==='route:fromTwitter'||route==='route:splash'){this.$('.hide-in-splash').hide();}else{this.$('.hide-in-splash').show();if(route==='route:mobile'){this.$('#mobile-nav').addClass('active');}else if(route==='route:listComments'){this.$('#questions-nav').addClass('active');}}
$(document).unbind('.session, .infinite_scroll');this.$('#login-modal').hide();},facebookLogin:function(){window.open("/facebook/oauth","_BLANK","height=300,width=640");},toggleLanguages:function(){this.$('#site-language-modal').toggle();_.defer(function(){$(document).unbind('click.topbar-languages').bind('click.topbar-languages',function(e){var $target=$(e.target);if($target.closest('.dropdown').size()>0){return;}
$('#site-language-modal').hide();});});},toggleLogin:function(){this.$('#login-modal').toggle();_.defer(function(){$(document).unbind('click.topbar').bind('click.topbar',function(e){var $target=$(e.target);if($target.closest('.sign-in').size()>0){return;}
$('#login-modal').hide();});});},login:function(){var self=this;args=this.gatherInput('#login-form');if(mixpanel.get_property){args['mixpanel_id']=mixpanel.get_property("distinct_id");}
$.post('/login',args,function(data){if(data.response==='OK'){if(window.location.hash.indexOf('#/register')==0){window.location.hash='#';}
if(window.location.pathname.substring(0,3)=='/en'||window.location.pathname.substring(0,3)=='/es'||window.location.pathname.substring(0,3)=='/pt'){window.location.href='/';return false;}
console.debug('logged in',window.location.hash);window.location.reload(true);self.$('input[type=text], input[type=password]').removeClass('error');}else{self.$('#message').text(translate_text("Wrong username or password"));self.$('#message').show();self.$('input[type=text], input[type=password]').addClass('error');}},'json');return false;},onInput:function(e){if(e.which===13){return;}
this.$('#message').hide();this.$('input[type=text], input[type=password]').removeClass('error');}});duo.GlobalLanguageChooser=duo.LanguageSwitchEnabledView.extend({template:duo.templates['ui-language-chooser'],events:{'click':'toggleLanguages'
},toggleLanguages:function(){this.$('.languages').toggle();return true;}});duo.LoginRouter=duo.Router.extend({routes:{'login':'login','register?email=:email&invite=:invite&ui_language=:ui_language':'register_ui','register?email=:email&invite=:invite&target_language=:target_language&ui_language=:ui_language':'register','register?email=:email&invite=:invite&target_language=:target_language':'register','register?email=:email&invite=:invite':'register','register?fbid=:fbid':'registerWithFB','register?twttrid=:twttrid':'registerWithTwttr','register?ib=:user_id':'registerWithInvite','register':'register','?target_language=:target_language&ui_language=:ui_language':'switchUILanguage','?target_language=:target_language':'switchUILanguage','?fb_verifier=:verifier':'fromFacebook','?twttr_token=:token&twttr_verifier=:verifier':'fromTwitter','notify_me?email=:email&ui_language=:ui_language':'notify_me','notify_me?email=:email':'notify_me','notify_me':'notify_me','forgot_password':'forgot_password','reset_password?email=:email&token=:token':'reset_password','reset_password?email=:email%26token=:token':'reset_password','?from_email=:from_email':'splash',':username':'profile','!/:username':'profile','':'splash','*path':'login'},initialize:function(){duo.topbar=new duo.LoginTopbarView({el:$('#topbar')});this.login_view=new duo.LoginView();duo.topbar.render();this.language_chooser=new duo.GlobalLanguageChooser({el:$('.change-language-dark')});},login:function(path){if(path==undefined){this.splash();}else{this.switchView(this.login_view,'page-login');$('.logged-out-message').empty();}},switchUILanguage:function(target_language,ui_language){if(ui_language!=null&&ui_language!=duo.browser_language){duo.browser_language=ui_language;duo.switchLanguage(ui_language);}else{if(duo.available_languages.length==0){duo.switchLanguage('en');}else{var prefilled={learning_language:target_language};this.showRegistration(prefilled,true);}}},register:function(email,invite,target_language,ui_language){console.debug('register:'+email+','+invite+','+ui_language+','+target_language);if(ui_language!=null&&ui_language!=duo.browser_language){duo.browser_language=ui_language;duo.switchLanguage(ui_language);}else{if(duo.available_languages.length==0){duo.switchLanguage('en');}else{var prefilled={email:email,invite:invite,learning_language:target_language};this.showRegistration(prefilled);mixpanel.track('present registration with invite',{invite_type:'code'});}}},registerWithFB:function(fbid){var self=this;if(!window.FB){this.register();return;}
FB.api('/me?fields=picture,email,username,name,locale',function(data){var prefilled={email:data.email,profile_image:data.picture,facebook_username:data.username,facebook_id:data.id};this.showRegistration(prefilled);});},registerWithTwttr:function(user){if(user.idStr){var prefilled={twitter_username:user.data('screen_name'),profile_image:user.data('profile_image_url'),twitter_id:user.idStr};this.showRegistration(prefilled);}else{this.register();}},registerWithInvite:function(user_id){var prefilled={invited_by:user_id};this.showRegistration(prefilled);mixpanel.track('present registration with invite',{invite_type:'invited_by'});},fromFacebook:function(verifier){var self=this;var data={oauth_verifier:verifier};if(mixpanel.get_property){data.mixpanel_id=mixpanel.get_property("distinct_id");}
$.post('/facebook/register',data,function(data){console.log(data);if(data.response==='OK'){console.debug('logged in',window.location.hash);window.location.reload(true);}else if(data.error){var prefilled={facebook_error:true};self.splashView.prefillWithTwitter(prefilled);}else{var prefilled={facebook_username:data.username,profile_image:data.profile_image_url,facebook_id:data.id,facebook_name:data.name,email:data.email};mixpanel.track('facebook sign up',{has_fullname:!!data.name,has_username:!!data.username});self.showRegistration(prefilled,true);}},'json');this.navigate('',false);},fromTwitter:function(token,verifier){var self=this;$.post('/twitter/register',{oauth_token:token,oauth_verifier:verifier},function(data){console.log(data);if(data.response==='OK'){console.debug('logged in',window.location.hash);window.location.reload(true);}else if(data.error){var prefilled={twitter_error:true};self.splashView.prefillWithTwitter(prefilled);}else{var prefilled={twitter_username:data.username,profile_image:data.profile_image_url,twitter_id:data.idStr};self.showRegistration(prefilled,true);}},'json');this.navigate('',false);},register_ui:function(email,invite,ui_language){console.debug('register_ui:'+ui_language);this.register(decodeURIComponent(email),invite,null,ui_language);},showRegistration:function(prefilled,force_splash){ if(!this.splashView){var view_class='splash-2013';this.splashView=new duo.SplashView();this.switchView(this.splashView,null,view_class);}
this.splashView.prefillWithTwitter(prefilled);},splash:function(from_email){if(window.location.href.indexOf('_escaped_fragment_')>0){return;}
if(from_email){mixpanel.track('email button click',{from_email:from_email});}
escape_paths=['/en','/es','/pt','/it','/fr','/en/learn-german-online','/en/learn-french-online','/en/learn-spanish-online','/en/learn-portuguese-online'];if(window.location.pathname.length>1&&$.inArray(window.location.pathname,escape_paths)==-1){this.login();return;}
$('.mobile-splash').show();$('.hidden-by-app').hide();var view_class='splash-2013';this.splashView=new duo.SplashView();this.switchView(this.splashView,null,view_class);},notify_me:function(email,ui_language){if(ui_language!=null&&ui_language!=duo.browser_language){duo.browser_language=ui_language;duo.switchLanguage(ui_language);}else{var notifyView=new duo.NotifyView();$('#app').replaceWith(notifyView.render(email).el);}},forgot_password:function(){var forgotView=new duo.ForgotView();this.switchView(forgotView,'page-forgot');$('#logged-out-message').hide();},reset_password:function(email,token){var resetView=new duo.ResetView({email:decodeURIComponent(email),token:token});this.switchView(resetView,'page-reset');},profileFromEmail:function(){var args=_.toArray(arguments);mixpanel.track('email button click',{from_email:args[args.length-1]});this.profile.apply(this,args.slice(0,args.length-1));},profile:function(username,tab){if(window.location.href.indexOf('#!')>0){mixpanel.track('profile search result');} 
if(tab!=='activity'){tab=null;}
var user=new duo.User({username:username});var self=this;user.fetch({success:function(model){if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
self.show(user,tab);},error:function(){self.login();}});},show:function(user,tab){document.title="Duolingo: "+user.get('username');var profile=new duo.SkillListView({model:user});profile.tab=tab;var logged_out_message=new duo.LoggedOutMessage({model:user,el:$('.logged-out-message')});this.switchView(profile,'home other-user',null,user.get('username')+" "+translate_text("is using Duolingo to learn languages for free while helping to translate the web."));logged_out_message.render();},upload:function(){var self=this;var translate_jobs=new duo.TranslateJobList();translate_jobs.fetch({success:function(){document.title='Duolingo: '+translate_text('Translate');var translate_jobs_view=new duo.TranslateView({collection:translate_jobs});self.switchView(translate_jobs_view,'upload-page');}});}});duo.SettingsRoutes=duo.Router.extend({routes:{'settings':'account','settings/account':'account','settings/profile':'profile','settings/password':'password','settings/notifications':'notifications','settings/deactivate':'deactivate_account'},initialize:function(){},toSettingsTab:function(tab){if(!this.settings){this.settings=new duo.SettingsView();}
if(duo.view!='settings'){ this.switchView(this.settings,'settings');} 
this.settings.tab(tab);},account:function(){document.title='Duolingo: '+translate_text('Account Settings');this.toSettingsTab('account');},profile:function(){document.title='Duolingo: '+translate_text('Profile Settings');this.toSettingsTab('profile');},password:function(){document.title='Duolingo: '+translate_text('Password Settings');this.toSettingsTab('password');},notifications:function(){document.title='Duolingo: '+translate_text('Notifications Settings');this.toSettingsTab('notifications');},deactivate_account:function(){document.title='Duolingo: '+translate_text('Deactivate Account');var view=new duo.DeactivateView();this.switchView(view,'deactivate');}});duo.SkillRoutes=duo.Router.extend({routes:{'skill/:language/:name?from_email=:from_email':'skill','skill/:language/:name':'skill','skill/:language/:name/practice':'practice','skill/:language/:name/practice/timed':'practiceTimed','skill/:language/:name/test':'test','skill/:language/:name/practice/:index':'practice','skill/:language/:name/translation/:index':'translation','skill/:language/:name/:lesson/:debug_type?:param':'lesson_debug','skill/:language/:name/:lesson?from_email=:from_email':'lesson','skill/:language/:name/:lesson':'lesson','skill/:language/:name/:lesson/:debug_type':'lesson_debug'},skill:function(language,name,from_email){var self=this;var skill=new duo.Skill({name:name,language:language});skill.fetch({success:function(model){if(model.get('js_version')!=duo.js_version){window.location.reload(true);return;}
document.title='Duolingo: '+translate_text(skill.get('title'));var user_skills=duo.user.getSkills().skills;var user_skill=user_skills.get(model.id);var recommended=false;if(user_skill){recommended=user_skill.get('recommended');}
mixpanel.track('skill',{id:model.id,language:skill.get('language'),title:skill.get('title'),name:skill.get('name'),recommended:recommended,from_email:from_email});var view=new duo.SkillView({model:skill});var view_class='skill skill-page-path';self.switchView(view,view_class);}});if(from_email){mixpanel.track('email button click',{from_email:from_email});}},practiceTimed:function(language,name,index){this.practice(language,name,index,true);},practice:function(language,name,index,timed){var self=this;var session=new duo.SkillPracticeSession({name:name,language:language,path_node_index:index});session.fetch({data:{name:decodeURIComponent(name),language:language},success:function(model,obj){if(obj.session_elements.length===0){duo.homeRouter.navigate('/',true);return;}
if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
document.title='Duolingo: '+translate_text('Refresh');var view=new duo.TimedSessionView({model:session,extra:7,die:true,total_time:30,points:true,shown_max_time:60,auto_timed:timed});if(duo.user.get('ab_options').new_player_blame_experiment){self.switchView(view,"player");}else{self.switchView(view);}}});},test:function(language,name){var self=this;var session=new duo.TestSession({name:name,language:language});session.fetch({data:{name:decodeURIComponent(name),language:language},success:function(model,obj){if(obj.session_elements.length===0){duo.homeRouter.navigate('/',true);return;}
if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
document.title='Duolingo: '+translate_text('Test');var view=new duo.SessionView({model:session});if(duo.user.get('ab_options').new_player_blame_experiment){self.switchView(view,"player");}else{self.switchView(view);}}});},lesson:function(language,name,lesson,from_email){var self=this;var session=new duo.LessonSession({name:name,lesson_number:lesson,language:language,from_email:from_email});session.fetch({data:{name:decodeURIComponent(name),language:language},success:function(model,obj){if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
if(obj.session_elements.length===0){duo.homeRouter.navigate('/',true);return;}
document.title='Duolingo: '+translate_text('Lesson');var view=null;if(session.get('first_lesson')){view=new duo.WelcomeLessonSessionView({model:session});}else{view=new duo.SessionView({model:session});}
if(duo.user.get('ab_options').new_player_blame_experiment){self.switchView(view,"player");}else{self.switchView(view);}}});if(from_email){mixpanel.track('email button click',{from_email:from_email});}},lesson_debug:function(language,name,lesson,debug_type,param){var self=this;var session=new duo.LessonSession({name:name,lesson_number:lesson,language:language});var options={debug_type:debug_type,name:decodeURIComponent(name),language:language};if(param){options[param]=true;}
console.log(options);session.fetch({success:function(model){if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
var view=new duo.SessionView({model:session});if(duo.user.get('ab_options').new_player_blame_experiment){self.switchView(view,"player");}else{self.switchView(view);}},data:options});},translation:function(language,name,index){$.getJSON('/skills/'+language+'/'+name+'/translation/'+index,function(data){if(data.id){duo.translationRouter.navigate('/translation/'+data.id+'?index='+data.start_index+'&skill='+data.skill_id,true);}});}});duo.TranslationRoutes=duo.Router.extend({routes:{'translations':'translations','translations/:category':'translations','translation/:id?r':'wikiTranslationFromReadingsTab','translation/:id?index=:index':'translationFromEmail','translation/:id':'translation'},translations:function(category){var self=this;var overview=new duo.TranslationsOverview();overview.fetch({data:{category:category},success:function(model){if(model.get('js_version')!==duo.js_version){window.location.reload(true);}
document.title="Duolingo: "+translate_text('Translations');var view=new duo.RedditTranslationsView({model:model});var view_class='translations reddit-translations';self.switchView(view,view_class);}});},translation:function(id){this.wikiTranslation(id,undefined,false);},translationFromEmail:function(id,index){this.wikiTranslation(id,index,false);},wikiTranslation:function(id,index,readings){var self=this;var translation=new duo.WikiTranslation({id:id});translation.fetch({data:{readings:readings==true},success:function(model){document.title="Duolingo: "+translation.get('title');var view=new duo.WikiTranslationView({model:translation});var view_class='wiki-translation';self.switchView(view,view_class,'static-background');if(index){view.openSentenceView(index);}},error:function(){window.location="http://duolingo.com/errors/404.html";}});},wikiTranslationFromReadingsTab:function(id){this.wikiTranslation(id,undefined,true);}});duo.LoggedOutTranslationRoutes=duo.Router.extend({routes:{'translated/:id':'translated'},translated:function(id){console.log('translated');var self=this;var translation=new duo.CurrentWikiTranslation({id:id});translation.fetch({data:{},success:function(model){document.title="Duolingo: "+translation.get('title');var view=new duo.CurrentWikiTranslationView({model:translation});var view_class='wiki-translated';self.switchView(view,view_class,'static-background');}});}});duo.SettingsTab=Backbone.View.extend({id:'tab-container',initialize:function(){this.model.bind('change',this.render,this);},render:function(){var ui_bool={};ui_bool['ui_'+this.model.get('ui_language')]=true;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),ui_bool),duo.templates));this.postRender();return this;},postRender:function(){},submit:function(success){ success(false);},success:function(){}});duo.AccountView=duo.SettingsTab.extend({template:duo.templates['account'],events:{"change #image-file":"imagePreview"},render:function(){var ui_bool={};ui_bool['ui_'+this.model.get('ui_language')]=true;var language_directions=[];_.each(duo.available_languages,function(data){var selected=duo.user.get('ui_language')==data.from_language&&duo.user.get('learning_language')==data.learning_language;var direction=data.from_language+"_"+data.learning_language;language_directions.push({value:direction,selected:selected,language:data.learning_language_name,i_want_to_learn:data.i_want_to_learn,from_info:data.from_info});});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),ui_bool,{language_directions:language_directions}),duo.templates));this.postRender();return this;},submit:function(succ){if(this.$('#image-file').val()){this.$('#avatar-upload').ajaxSubmit(function(){succ(true);});}else{succ(false);}},postRender:function(){src=this.$('.avatar-large .avatar').attr('src');var now=new Date();this.$('.avatar-large .avatar').attr('src',src+'?'+now.getTime());},imagePreview:function(){var input=this.$('#image-file')[0]; if(window.FileReader&&input.files&&input.files[0]){var reader=new FileReader();var self=this;reader.onload=function(e){self.$('.avatar-large .avatar').attr('src',e.target.result).css('width',60);}
reader.readAsDataURL(input.files[0]);}
this.$('#avatar-submit').prop('disabled',false);}});duo.SettingsProfileView=duo.SettingsTab.extend({template:duo.templates['settings_profile'],events:{'click #facebook-connect':'loginFB','click #facebook-disconnect':'disconnectFB','click #twitter-disconnect':'disconnectTwttr'},render:function(){var ui_bool={};ui_bool['ui_'+this.model.get('ui_language')]=true;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),ui_bool,{just_twitter_disconnected:this.just_twitter_disconnected}),duo.templates));this.postRender();return this;},postRender:function(){this.delegateEvents();this.$('#facebook_name').text(this.facebook_name);this.$('#bio-count').text(140-this.model.get('bio').length);this.$('textarea').characterLimit(140,this.$('#bio-count'));this.just_twitter_disconnected=false;var self=this;if(window.twttr){twttr.anywhere(function(T){$('#twitter-connect').click(function(){T.signIn();});T.bind('authComplete',function(e,user){var twttr_id=user.idStr;self.twttrConnect(twttr_id,user.data('screen_name'));});});}},loginFB:function(){var self=this;if(!window.FB){return;}
FB.login(function(response){var facebook_id=response.authResponse.userID;$.post('/facebook_connect',{facebook_id:facebook_id,facebook_friends:"[]"});FB.api('/me?access_token='+response.authResponse.accessToken+'&fields=picture,name',function(data){self.facebook_name=data.name;duo.user.set({facebook_id:facebook_id,facebook_name:data.name});});},{scope:'publish_actions'});},disconnectFB:function(){var self=this;if(!window.FB){return;}
FB.api('/me/permissions','delete',function(data){console.log(data);duo.user.set({facebook_id:null,facebook_name:null});});},twttrConnect:function(idStr,screen_name){$.post('/twitter_connect',{twitter_id:idStr,twitter_friends:'[]',auto_follow:false},function(data){duo.user.set({twitter_id:idStr,twitter_name:screen_name});});},disconnectTwttr:function(){$.post('/twitter_disconnect');this.just_twitter_disconnected=true;duo.user.set({twitter_id:null});}});duo.PasswordView=duo.SettingsTab.extend({template:duo.templates['password'],events:{},initialize:function(){this.model.bind('change',this.render,this);},success:function(){this.model.set({no_password:false});}});duo.NotificationsView=duo.SettingsTab.extend({template:duo.templates['notifications'],events:{'change #notify_practice':'togglePractice'},initialize:function(){this.model.bind('change',this.render,this);},render:function(){var data={};data['ui_'+this.model.get('ui_language')]=true;var languages_data=_.chain(this.model.get('languages')).filter(function(language){return language.learning;}).map(function(language){var settings=this.model.get('language_settings');if(settings){settings=settings[language.language];}
var data={language:language.language,language_string:language.language_string,notify_practice:settings?settings.notify_practice:null,notify_time:settings?settings.notify_time:null,practice_times:duo.generatePracticeTimes(settings?settings.notify_time:null)};return data;},this).value();data.languages_data=languages_data;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.model.getSkills(),data),duo.templates));this.postRender();return this;},success:function(){if(this.model.has('language_settings')){var settings=this.model.get('language_settings')[this.model.get('learning_language')];this.model.getSkills().notify_practice=settings.notify_practice;this.model.getSkills().notify_time=settings.notify_time;}},togglePractice:function(){this.$('.send-time').toggle(this.$('#notify_practice').prop('checked'));}});duo.DeactivateView=Backbone.View.extend({id:'app',events:{"click #submit_button":"deactivate","click #cancel_button":"cancel"},template:duo.templates['deactivate'],initialize:function(){},render:function(){this.delegateEvents();$(this.el).html($.duostache(this.template,{},duo.templates));return this;},deactivate:function(){},cancel:function(){window.location="#/settings"}})
duo.SettingsView=Backbone.View.extend({id:'app',events:{"click #submit_button":"submit","click #cancel_button":"cancel","keyup input, select, textarea":"inputChange","change input, select, textarea":"inputChange"},template:duo.templates['settings'],initialize:function(){this.model=duo.user;this.accountView=new duo.AccountView({model:this.model});this.profileView=new duo.SettingsProfileView({model:this.model});this.passwordView=new duo.PasswordView({model:this.model});this.notificationsView=new duo.NotificationsView({model:this.model});this.deactivateView=new duo.DeactivateView({model:this.model});_.bindAll(this,'update','getSettings');},render:function(){this.delegateEvents();$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));this.$('#submit_button, #cancel_button').prop('disabled',true);if(!this.model.has('has_password')){$.getJSON('/users/'+this.model.id+'/settings',function(data){duo.user.set(data);});}
return this;},getSettings:function(){var fields=this.$(':input');var settings={}; $.each(fields,function(){var value=$(this).val(); if(this.type==='checkbox'){value=$(this).prop('checked');}else if(this.type=='radio'){if($(this).prop('checked')){value=$(this).val()==='true';}else{return;}}
var s=settings;var names=this.name.split('.');for(var i=0;i<names.length-1;i++){if(!(names[i]in s)){s[names[i]]={};}
s=s[names[i]];}
s[names[names.length-1]]=value;});return settings;},inputChange:function(){this.$('#submit_button, #cancel_button').prop('disabled',false);},submit:function(){this[this.current_tab+'View'].submit(this.update);},update:function(reload){var settings=this.getSettings();var username=this.model.get('username');var self=this;var language_changed=settings['language_direction']!=undefined&&(settings['language_direction']!=this.model.get('ui_language')+"_"+this.model.get("learning_language"));$.ajax({url:'/users/'+username,data:JSON.stringify(settings),success:function(data){if(data.response=='ok'){self.$('#error-message').hide();self.$('#confirmation-message').show().delay(1000).fadeOut(1000);self.model.set(settings);self[self.current_tab+'View'].success();if(reload||language_changed){_.defer(function(){window.location.reload(true);});}}else{self.$('#error-message').text(data.message).show();}},type:'PUT',dataType:'json',contentType:'application/json; charset=utf-8'});this.$('#submit_button, #cancel_button').prop('disabled',true);},cancel:function(){this[new_tab+'View'].render();this.$('#submit_button, #cancel_button').prop('disabled',true);},tab:function(new_tab){this.$('#'+this.current_tab+"_tab").parent().removeClass('active');this.$('#'+new_tab+"_tab").parent().addClass('active');this.$('#tab-container').replaceWith(this[new_tab+'View'].render().el);this.current_tab=new_tab;this.$('#submit_button, #cancel_button').prop('disabled',true);},clear:function(){this.model.unbind('change',this.saved);}});duo.UserRoutes=duo.Router.extend({routes:{'':'home','?from_email=:from_email':'homeFromEmail','event/:id?from_email:from_email':'showEventFromEmail','event/:id':'showEvent','reset_password?email=:email&token=:token':'home','find_friends':'findFriends','find_friends?q=:q':'findFriends',':username?from_email=:from_email':'profileFromEmail',':username':'profile','!/:username':'profile',':username/:tab?from_email=:from_email':'profileFromEmail',':username/:tab':'profile'},initialize:function(){},ownProfile:function(tab){var username=duo.user.get('username');var path='/'+username;if(tab){path+='/'+tab;}
this.navigate(path,false);this.show(duo.user,tab);},profileFromEmail:function(){var args=_.toArray(arguments);mixpanel.track('email button click',{from_email:args[args.length-1]});this.profile.apply(this,args.slice(0,args.length-1));},homeFromEmail:function(){var args=_.toArray(arguments);mixpanel.track('email button click',{from_email:args[args.length-1]});this.home.apply(this,args.slice(0,args.length-1));},profile:function(username,tab){ if(tab!=='activity'){tab=null;}
if(!username||username==duo.user.get('username')){$.getJSON('/version',function(data){if(data.js_version!=duo.js_version){window.location.reload(true);}});this.ownProfile(tab);}else{var user=new duo.User({username:username});var self=this;user.fetch({success:function(model){if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
self.show(user,tab);}});}},show:function(user,tab){document.title="Duolingo: "+user.get('username');var profile=new duo.ProfileView({model:user});var view_class='profile';this.switchView(profile,view_class);},home:function(){$.getJSON('/version',function(data){if(data.js_version!=duo.js_version){window.location.reload(true);}});document.title="Duolingo: "+translate_text('Home');var profile=new duo.HomeView({model:duo.user});mixpanel.track("show home");this.switchView(profile,'home');},findFriends:function(q){document.title="Duolingo: "+translate_text('Follow people');var friends_view=new duo.FriendFindView();friends_view.preload_q=q;var view_class='search-results';this.switchView(friends_view,view_class);},showEvent:function(id){var ev=new duo.Event({id:id});var self=this;ev.fetch({success:function(model){if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
var view=new duo.StandaloneEventView({model:model});self.switchView(view,'standalone-event');}});},showEventFromEmail:function(id,from_email){mixpanel.track('email button click',{from_email:from_email});this.showEvent(id);}});(function($){duo.getFlashMovieObject=function(movieName){if(navigator.appName.indexOf("Microsoft")!=-1){return window[movieName];}else{return document[movieName];}};duo.switchLanguage=function(ui_language){$.post('/switch_ui_language',{language:ui_language},function(data){var url=window.location.toString();var position=url.indexOf('ui_language=');if(position!=-1){window.location=url.substring(0,position-1);}
window.location.reload();});};function toggle_feedback(){var title=window.document.title;var split_title=title.split('|');$('#box_feedback #feedback_title').html($.trim(split_title[0]));if($('#box_feedback #result').css('display')!='none'){$('#box_feedback #result').empty().hide();} 
$('#box_feedback input[id!="activity_uuid"], #box_feedback #got').val(''); $('#box_feedback #screenshot').replaceWith($('#box_feedback #screenshot').clone(true));$('#box_feedback #screenshot').val('');document.getElementById('referer').value=window.location;if(FlashDetect.installed){document.getElementById('flashversion').value=FlashDetect.raw;}
$('#feedback_ui_language').val(duo.browser_language);$('#box_feedback #feedback_form').show();$('#box_feedback').animate({left:'-10px'},500);$('#got').focus();}
function close_feedback(){$('#box_feedback').animate({left:'-420px'},500);$('#box_feedback #feedback_form').hide();}
var _is_chrome=navigator.userAgent.indexOf('Chrome')>-1;var _is_safari=navigator.userAgent.indexOf("Safari")>-1;if(_is_safari&&!_is_chrome){$('html').addClass('safari');}
$(document).ready(function(){timing.start('duolingo.js ready');if(!('user'in duo)){duo.loginRouter=new duo.LoginRouter();}else{duo.userRouter=new duo.UserRoutes();duo.homeRouter=new duo.HomeRoutes();duo.vocabRouter=new duo.VocabRoutes();duo.skillRouter=new duo.SkillRoutes();duo.translationRouter=new duo.TranslationRoutes();duo.settingsRouter=new duo.SettingsRoutes();duo.databaseRouter=new duo.DatabaseRoutes();duo.adminRouter=new duo.AdminRoutes();timing.mark('conf loggedin routes');duo.view='home';$.tts.setupSoundManager();timing.mark('set up SM');if(duo.user.get('timezone')===null){duo.user.save({timezone:$.getTimezone()});}} 
duo.commentRouter=new duo.CommentRoutes();duo.staticRouter=new duo.StaticRoutes();duo.loggedOutTranslationRouter=new duo.LoggedOutTranslationRoutes();duo.topbar.start();if(duo.user&&!duo.user.get('learning_language')){ duo.homeRouter.navigate('/welcome',true);}else{Backbone.history.start();}
if($.browser.mobile){$('html').addClass('mobile');}
$('.has-twipsy').twipsy({live:true,offset:10,animate:false,placement:function(tip,el){return $(el).data('placement')||'in above';}});timing.stop('duolingo.js ready');_.delay(function(){var data={traces:timing.timings,absolute_start:timing.absolute_start,splits:timing.splits,href:window.location.href};if(window.performance){data['performance']=window.performance.timing;}
$.ajax({url:'/diagnostics/frontend_timing',type:'POST',data:JSON.stringify(data),contentType:'application/json; charset=utf-8',dataType:'json'});},10000);});var _going_back=false;function _checkNavigation(){ return _going_back||!$('#app').hasClass('leave-warning')||window.confirm(translate_text('Are you sure you want to quit? By clicking OK all progress in this lesson will be lost.'));}
var oldLoad=Backbone.History.prototype.loadUrl;Backbone.History.prototype.loadUrl=function(){if(_checkNavigation()){return oldLoad.apply(this,arguments);}else{ _going_back=true;history.back();_going_back=false;return true;}}})(window.jQuery);duo.AdminDashboard=Backbone.Model.extend({url:'/admin_tools',parse:function(data){var banned_users=data.banned_users;this.moderation_log=new duo.ModerationLog();if(data.log_type=='deletes'){this.moderation_log.reset(duo.ModerationLog.prototype.parse.call(this.moderation_log,data));data.moderation_log=this.moderation_log;}
else if(data.log_type=='comments'){this.comment_log.reset(duo.ModerationLog.prototype.parse.call(this.comment_log,data));data.comment_log=this.comment_log;}
data.banned_users=banned_users;return data;},getComments:function(){this.comment_log=new duo.ModerationLog();var self=this;this.fetch({data:{page:0,log_type:'comments'},success:function(data){var comment_log_view=new duo.ModerationLogView({el:this.$('#comment-log'),collection:self.get('comment_log'),model:self,type:'comments'});comment_log_view.render();}});},getShadowBannedUsers:function(){var self=this;$.post('/admin_tools/shadow_banned',function(data){self.set(duo.AdminDashboard.prototype.parse.call(self,data));return data;});},addShadowBannedUser:function(username){var self=this;$.post('/admin_tools/shadow_banned/add',{username:username},function(data){if(data['error']=='user not found'){alert("username not found");return;}
self.set(duo.AdminDashboard.prototype.parse.call(self,data));return data;});},removeShadowBannedUser:function(user_id){var self=this;$.post('/admin_tools/shadow_banned/remove',{user_id:user_id},function(data){if(data['error']){alert("username not found");return;}
self.set(duo.AdminDashboard.prototype.parse.call(self,data));return data;});}});duo.ModerationLog=Backbone.Collection.extend({model:duo.Event,url:function(){return'/admin_tools';},fetch:function(options){options=options||{};options.data=options.data||{};options.data.page=options.data.page;options.data.log_type=options.data.log_type;Backbone.Collection.prototype.fetch.call(this,options);},parse:function(data){this.more=data.more;return data.mod_log;}})
duo.Database=Backbone.Model.extend({url:'/db',parse:function(data){var datarows=new duo.DataRowList();datarows.reset(data,{parse:true});data.datarows=datarows;if(data.statistics){_.each(data['statistics'],function(stats){stats['ratio']=(stats['total_reports']/stats['total_ends']*100).toFixed(2);stats['uppercase_from']=stats['from_lang'].toUpperCase();stats['uppercase_to']=stats['to_lang'].toUpperCase();});}
return data;},getStatistics:function(){var self=this;$.post('/db/statistics',function(data){self.set(duo.Database.prototype.parse.call(self,data));return data;});}});duo.DataRow=Backbone.Model.extend({urlRoot:'/db/datarow',parse:function(data){var merged_suggestions=[];var accepted_formatted=[];if(data['suggested']){_.each(data['suggested'],function(suggestion){var formatted=suggestion.toString().toLowerCase().replace(/\.$/,'').replace(/\s{2,}/g,' ');var stored=_.indexOf(accepted_formatted,formatted)
if(stored<0){var ind=accepted_formatted.push(formatted);merged_suggestions.push({'text':suggestion,'num':1,'index':ind-1});}
else{merged_suggestions[stored].num+=1}});data['suggested']=merged_suggestions.sort(function(a,b){return b.num-a.num});}
return data;},acceptTranslation:function(suggestion,from_language,to_language){var self=this;$.post('/db/accept/'+this.id,{suggestion:suggestion,sentence_text:this.get('text'),from_language:from_language,to_language:to_language},function(data){console.log(data);self.set(duo.DataRow.prototype.parse.call(self,data),{silent:true});});},rejectTranslation:function(suggestion,from_language,to_language){var self=this;$.post('/db/reject/'+this.id,{suggestion:suggestion,sentence_text:this.get('text'),from_language:from_language,to_language:to_language},function(data){console.log(data);self.set(duo.DataRow.prototype.parse.call(self,data),{silent:true});});},resetReports:function(from_language,to_language){var self=this;$.post('/db/reset/'+this.id,{from_language:from_language,to_language:to_language},function(data){console.log(data);self.set(duo.DataRow.prototype.parse.call(self,data));});},deleteSentence:function(directions){$.post('/db/delete',{sent_language:this.get('language'),sent_text:this.get('text'),directions:JSON.stringify(directions)},function(data){console.log(data);});},updateOriginalAndTranslations:function(new_text,display_translations,accepted_translations,callback){var self=this;$.post('/db/update/all',{sent_language:this.get('language'),trans_language:this.get('translation_language'),old_text:this.get('text'),new_text:new_text,display_translations:JSON.stringify(display_translations),accepted_translations:JSON.stringify(accepted_translations)},function(data){self.set(duo.DataRow.prototype.parse.call(self,data));if(data['error']=='too many accepted translations'){alert("Error: This sentence has too many accepted translations: ("+data['num']+"");return;}
callback();});},updateOriginal:function(new_text){$.post('/db/update/original',{old_text:this.get('text'),new_text:new_text,sent_language:this.get('language'),trans_language:this.get('translation_language')},function(data){console.log(data);});},updateTranslations:function(display_translations,accepted_translations,callback){var self=this;$.post('/db/update/translations',{sentence_text:this.get('text'),from_language:this.get('language'),to_language:this.get('translation_language'),display_translations:JSON.stringify(display_translations),accepted_translations:JSON.stringify(accepted_translations)},function(data){self.set(duo.DataRow.prototype.parse.call(self,data));if(data['error']=='too many accepted translations'){alert("Error: This sentence has too many accepted translations ("+data['num']+")");return;}
callback();});}});duo.DataRowList=Backbone.Collection.extend({model:duo.DataRow,url:'/db',initialize:function(){this.on("change:num_reports",this.updateRow,this);},comparator:function(item){return-item.get('num_reports');},parse:function(data){this.more=data.more;var map=_.map(data.sentences,function(datarow){return duo.DataRow.prototype.parse(datarow);});return map;},updateRow:function(model){if(model.get('num_reports')==0){this.remove(model);}}});duo.DataSearchList=duo.DataRowList.extend({initialize:function(options){this.from_language=options.from_language;this.to_language=options.to_language;this.page=0;this.actual_matches=0;this.search=true;},fetch:function(options){var self=this;options=options||{};options.data=options.data||{};options.data=_.extend({wt:'json',q:this.q,fq:this.fq,start:this.length,rows:20,group:true},options.data);options.data['group.field']='sentence_id';if($.trim(options.data.q).length===0){this.reset([]);return;}
$.ajax({url:'http://'+duo.search_host+'/sentences_solr/select',data:options.data,success:function(data){var items=data.grouped.sentence_id.groups;self.num_results=data.grouped.sentence_id.matches-1;if(!items.length){if(!options.data.start){self.reset([]);}
return;}
var opt={search:true,search_sentence_ids:JSON.stringify(_.pluck(items,'groupValue')),from_language:self.from_language,to_language:self.to_language,page:self.page};_.each(items,function(group){self.actual_matches+=group.doclist.numFound;});$.getJSON('/db',opt,function(data){var map=_.map(data.sentences,function(datarow){return duo.DataRow.prototype.parse(datarow);});self.more=(self.num_results+1)-self.actual_matches;if(!options.data.start){self.reset(map);}else{self.add(map);}});},dataType:'jsonp',jsonp:'json.wrf'});}});duo.Document=Backbone.Model.extend({urlRoot:'/documents'});duo.Sentence=Backbone.Model.extend({urlRoot:'sentence',toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);return json_data;},parse:function(data){if('comment'in data){var comment=new duo.Comment();comment.set(comment.parse(data.comment));data.comment=comment;}
return data;},addComment:function(message,ui_language,learning_language){var self=this;var model;$.post('/sentences/comment',{message:message,sentence_id:this.id,ui_language:ui_language,learning_language:learning_language},function(data){mixpanel.track("Questions reply");var formatted_data={comment:data};self.set(self.parse(formatted_data));});},replaceURLs:function(text){var url_regex=/\b(?:(?:https?|ftp):\/\/|www\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gi;return text.replace(url_regex,function(url){return'<a href="'+url+'" class="underline grayDark" target="_blank">'+url+'</a>';});},reportSentence:function(type){$.post('/sentences/report',{sentence_id:this.id,type:type},function(data){mixpanel.track("Sentence report");console.log(data);});}});duo.TranslateJob=Backbone.Model.extend({urlRoot:'/translate_jobs',parse:function(data){return data;},cancel:function(){var self=this;$.post(this.urlRoot+"/"+this.get('id')+"/cancel",function(data){self.set(data);});},approve:function(){var self=this;$.post(this.urlRoot+"/"+this.get('id')+"/approve",function(data){self.set(data);});},reject:function(reason){var self=this;$.post(this.urlRoot+"/"+this.get('id')+"/reject",{reason:reason},function(data){self.set(data);});},save_revision:function(data){var self=this;$.post(this.urlRoot+"/"+this.get('id')+"/revision",{data:data},function(data){self.set(data);});},export_text:function(){window.location=this.urlRoot+"/"+this.get('id')+"/export";},send_email:function(button){$.post(this.urlRoot+"/"+this.get('id')+"/send",{},function(data){if(data.sent){button.html('Done!');console.debug('Message sent to: '+data.recipients);}else{button.html('ERROR: '+data.error);}});}});duo.TranslateJobList=Backbone.Collection.extend({model:duo.TranslateJob,url:'/translate_jobs',fetch:function(options){options=options||{};options.data=options.data||{};options.data.sort_by=this.sort_by;options.data.filter=this.filter_option;Backbone.Collection.prototype.fetch.call(this,options);},parse:function(data){this.page=data.page;this.more=data.more;this.categories=data.categories;this.directions=data.directions;this.account=data.account;return _.map(data.translate_jobs,function(translate_job){return duo.TranslateJob.prototype.parse(translate_job);});},getMore:function(){this.fetch({data:{page:this.page+1},update:true,remove:false});}});duo.AdminRoutes=duo.Router.extend({routes:{'admin_tools':'admin'},admin:function(){var dashboard=new duo.AdminDashboard();document.title="Duolingo: Admin Dashboard";var self=this;dashboard.fetch({data:{page:0,log_type:'deletes'},success:function(data){if(data.get('response')=='access denied')
{window.location="http://duolingo.com/errors/404.html";return false;}
var view=new duo.AdminDashboardView({model:dashboard});var view_class='admin';self.switchView(view,view_class);}});}});duo.CommentRoutes=duo.Router.extend({routes:{'comment/:id?unfollow':'showCommentUnfollow','comment/:id?from_email=:from_email':'showCommentFromEmail','comment/:id?from_skill=:from_skill':'showComment','comment/:id':'showComment','discussion':'listComments','discussion/:sort':'listComments','topic/:id':'showTopic','topic/:id/:sort_by':'showTopic','!/comment/:id':'showComment'},showComment:function(id,from_skill,unfollow){var self=this;var comment=new duo.Comment({id:id,from_skill:from_skill});mixpanel.track('show_comment',{id:id});comment.fetch({data:{ ui_language:duo.user?undefined:duo.browser_language},success:function(){if(window.location.href.indexOf('#!')>0){mixpanel.track('question search result',{sentence_comment:comment.get('sentence_comment')==true,url:window.location.href});}
document.title='Duolingo: '+comment.get('title');var view=new duo.CommentView({model:comment});var view_class='comment better-comment';view_class+=' community-topic';self.switchView(view,view_class,null,comment.get('message'));if(!duo.user){data={el:$('.logged-out-message'),width:902};if(comment.get('sentence_comment')){data['language']=comment.get('root').name;}
var logged_out_message=new duo.LoggedOutMessage(data);logged_out_message.render();}
if(unfollow){comment.unwatch();}}});},showCommentFromEmail:function(id,from_email){mixpanel.track('email button click',{from_email:from_email});this.showComment(id);},showCommentUnfollow:function(id){this.showComment(id,undefined,true);},listComments:function(sort_by){this.showTopic(undefined,sort_by);},showTopic:function(id,sort_by){var self=this;var topic=new duo.Topic({id:id});mixpanel.track('Show Topic');topic.fetch({data:{ ui_language:duo.user?undefined:duo.browser_language},success:function(){if(topic.get('js_version')!=duo.js_version){window.location.reload(true);}
document.title='Duolingo: '+translate_text('Questions and Insights');var topic_view=new duo.TopicView({model:topic});var view_class='comment better-comment';self.switchView(topic_view,view_class);if(!duo.user){var logged_out_message=new duo.LoggedOutMessage({el:$('.logged-out-message'),width:902});logged_out_message.render();}
if(!sort_by)
sort_by='hot';topic_view.changeSort(sort_by);}});}});duo.DatabaseRoutes=duo.Router.extend({routes:{'db/:from_language/:to_language':'database','db/:from_language/:to_language/:skill':'database'},database:function(from_language,to_language,skill){var database=new duo.Database();document.title="Duolingo: Database";var self=this;skill_id=skill?skill:undefined
database.fetch({data:{skill_id:skill_id,from_language:from_language,to_language:to_language,page:0},success:function(data){if(data.get('response')=='access denied')
{window.location="http://duolingo.com/errors/404.html";return false;}
var view=new duo.DatabaseView({model:database});var view_class='database'
self.switchView(view,view_class);}});}});duo.StaticRoutes=duo.Router.extend({routes:{'terms':'terms','effectiveness-study':'study','!/effectiveness-study':'study','info':'info','contact':'contact','resources':'resources','mobile':'mobile','!/mobile':'mobile','privacy':'privacy','jobs':'jobs','guidelines':'guidelines'},terms:function(){document.title="Duolingo: "+translate_text('Terms');var termsView=new duo.TermsView();this.switchView(termsView,'terms');},help:function(){document.title="Duolingo: "+translate_text('Help');var helpView=new duo.HelpView();this.switchView(helpView,'help');},guidelines:function(){document.title="Duolingo: "+translate_text('Guidelines');var guidelinesView=new duo.GuidelinesView();this.switchView(guidelinesView,'guidelines');},about:function(tab){var infoView=new duo.InfoView();this.switchView(infoView,'about','about-page');infoView.switchToTab(tab);},info:function(){document.title="Duolingo: "+translate_text('Info');this.about('info');},contact:function(){document.title="Duolingo: "+translate_text('Contact');this.about('contacts');},resources:function(){document.title="Duolingo: "+translate_text('Resources');this.about('resources');},study:function(){document.title="How effective is Duolingo?";var studyView=new duo.StudyView();this.switchView(studyView,'study');},mobile:function(){document.title=translate_text('Duolingo on the go');var mobileView=new duo.MobileView();this.switchView(mobileView,'mobile');},privacy:function(){document.title="Duolingo: "+translate_text('Privacy');var view=new duo.PrivacyView();this.switchView(view,'privacy');},jobs:function(name){var self=this;$.get('/jobs_list',function(data){document.title="Duolingo: "+translate_text('Jobs');var jobsView=new duo.JobsView(data);self.switchView(jobsView,"jobs");},'json');}});duo.VocabRoutes=duo.Router.extend({routes:{'vocab':'overview','vocab/:skill_id':'overview','vocab/:skill_id/:lesson':'overview','word_practice/:language/:lemma/:pos':'practiceWord','skill_practice/:skill_id':'practiceSkill','skill_practice/:skill_id/:lesson':'practiceSkill','word/:language/:lemma/(:pos)':'wordPage'},overview:function(skill_id,lesson){var vocab=new duo.Vocab();var self=this;mixpanel.track('vocab overview');vocab.fetch({data:{skill_id:skill_id,lesson:lesson},success:function(model,obj){if(model.get('js_version')!==duo.js_version){window.location.reload(true);}
document.title="Duolingo: "+translate_text('Vocabulary');var view_class='vocab-page';var view=new duo.VocabOverview({model:model});mixpanel.track('vocab_page',{narrow_skill:!!skill_id,narrow_lesson:!!lesson});self.switchView(view,view_class);}});},wordPage:function(language,lemma,pos){var word=new duo.Word({surface_form:lemma,pos:pos,language:language});var self=this;word.fetch({success:function(model,obj){if(model.get('js_version')!==duo.js_version){window.location.reload(true);}
document.title="Duolingo: "+translate_text('Vocabulary');var view_class='vocab-page';var view=new duo.WordView({model:model});mixpanel.track('word page');self.switchView(view,view_class);}});},practiceWord:function(language,lemma,pos){var self=this;var session=new duo.WordsPracticeSession({from_word:lemma,pos:pos});session.fetch({data:{language:language,lemma:decodeURIComponent(lemma),pos_string:pos},success:function(model,obj){if(obj.session_elements.length===0){duo.homeRouter.navigate('/',true);return;}
if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
document.title='Duolingo: '+translate_text('Practice');var view=new duo.VocabSessionView({model:session});mixpanel.track('word practice');if(duo.user.get('ab_options').new_player_blame_experiment){self.switchView(view,"player");}else{self.switchView(view);}}});},practiceSkill:function(skill_id,lesson){var self=this;var session=new duo.SkillPracticeSession({from_skill_vocab:skill_id,lesson:lesson});session.fetch({data:{skill_id:skill_id,lesson:lesson},success:function(model,obj){ model.set({untimed:true,position:-1});if(obj.session_elements.length===0){duo.homeRouter.navigate('/',true);return;}
if(model.get('js_version')!=duo.js_version){window.location.reload(true);}
document.title='Duolingo: '+translate_text('Practice');var view=new duo.VocabSessionView({model:session});mixpanel.track('skill practice');if(duo.user.get('ab_options').new_player_blame_experiment){self.switchView(view,"player");}else{self.switchView(view);}}});}});var timing=(function(){var my={};my.timings={};my.splits=[]
my.absolute_start=new Date().getTime();my.start=function(event_name){var now=new Date().getTime();var split=now-my.absolute_start;my.timings[event_name]={start:now,start_split:now-my.absolute_start};my.splits.push([split,event_name+' STARTED']);};my.stop=function(event_name){var now=new Date().getTime();var diff=now-my.timings[event_name].start;var split=now-my.absolute_start;my.timings[event_name].stop=now;my.timings[event_name].duration=diff;my.splits.push([split,event_name+' ENDED']);return diff;}
my.mark=function(event_name){var now=new Date().getTime();var split=now-my.absolute_start;my.timings[event_name]={timestamp:now,since_load:now-my.absolute_start};my.splits.push([split,event_name]);}
return my;}());duo.AdminDashboardView=Backbone.View.extend({id:'app',template:duo.templates['admin-dashboard'],events:{'click .show-comments':'seeCommentLog','click .show-deletes':'seeDeleteLog','click .show-bans':'showShadowBanned','click .get-summary':'showUserSearch','keyup #search-user':'getSummary'},initialize:function(){this.banned=undefined;},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{}),duo.templates));var moderation_log_view=new duo.ModerationLogView({el:this.$('#moderation-log'),collection:this.model.get('moderation_log'),model:this.model,type:'deletes'});moderation_log_view.render();this.$('.search-input-box').hide();var self=this;_.defer(function(){self.$("label").inFieldLabels();});return this;},seeCommentLog:function(){if(this.model.comment_log==undefined)
this.model.getComments();this.$('.show-comments').addClass('active');this.$('.show-deletes').removeClass('active');this.$('#moderation-log').hide();this.$('#comment-log').show();},seeDeleteLog:function(){this.$('.show-comments').removeClass('active');this.$('.show-deletes').addClass('active');this.$('#comment-log').hide();this.$('#moderation-log').show();},showShadowBanned:function(){this.model.getShadowBannedUsers();var self=this;if(this.banned===undefined){this.banned=new duo.ShadowBannedModalView({el:this.$('#banned-modal'),model:this.model});this.$('#banned-modal').modal({keyboard:true,backdrop:true,show:false}).delegate('.username','click',function(e){self.$('#banned-modal').modal('hide');});}
this.banned.render();this.$('#banned-modal').modal('show');},showUserSearch:function(){this.$('.search-input-box').fadeToggle(400);},getSummary:function(e){if(e.which===13){var username=this.$('input[id=search-user]').val();window.location="/diagnostics/user/summary?username="+username;}}});duo.ModerationLogView=Backbone.View.extend({template:duo.templates['moderation-log'],events:{'click .load-more':'loadMore','click .undelete':'undelete'},initialize:function(options){this.collection=options.collection;this.page=0;this.more=true;this.collection.bind('all',this.render,this);this.collection.bind('remove',this.render,this);this.log_type=options.type;},render:function(){var events=this.collection.toJSON();_.each(events,function(element,index,list){element.index=index;});$(this.el).html($.duostache(this.template,_.extend(this.collection,{events:events,delete_log:this.log_type=='deletes',comment_log:this.log_type=='comments',more:this.collection.more}),duo.templates));return this;},loadMore:function(){this.page+=1;var self=this;this.collection.fetch({data:{page:self.page,log_type:self.log_type},update:true,remove:false});},undelete:function(e){var comment_id=$(e.currentTarget).data('id');var index=$(e.currentTarget).data('index');var self=this;$.post('/comments/'+comment_id+'/undelete',function(){var undeleted_model=self.collection.at(index);self.collection.remove(undeleted_model);});}});duo.ShadowBannedModalView=Backbone.View.extend({template:duo.templates['shadow-banned'],events:{'click .add-banned':'addBannedUser','click .unban-user':'removeBannedUser','keypress .add-username-input':'checkKeyup'},initialize:function(options){this.model.bind('change',this.render,this);this.banned_users=options.banned_users;},render:function(){var data={};$(this.el).html($.duostache(this.template,_.extend(data,{users:this.model.get('banned_users')}),duo.templates));var self=this;_.defer(function(){self.$("label").inFieldLabels();});return this;},checkKeyup:function(e){if(e.which===13){e.preventDefault();this.addBannedUser();}},addBannedUser:function(){var username=this.$('input[id=add-username]').val();if(username.length>0)
this.model.addShadowBannedUser(username);},removeBannedUser:function(e){var $ele=$(e.currentTarget);var user_id=$ele.data('userid');this.model.removeShadowBannedUser(user_id);}});duo.DatabaseView=Backbone.View.extend({id:'app',template:duo.templates['database-dashboard'],events:{'click #dropdown-language-button':'showLanguageDropdown','click #dropdown-skill-button':'showSkillDropdown','click .skill-option':'changeSkill','click .language-option':'changeLanguage','keyup #search-sentences':'checkClearButton','click .clear-button':'clearSearchResults'},initialize:function(){this.statsview=undefined;},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{curr_from_language:this.model.get('from_language').abbr.toUpperCase(),curr_to_language:this.model.get('to_language').abbr.toUpperCase()}),duo.templates));var datalist_view=new duo.DataRowListView({el:this.$('#data-list'),collection:this.model.get('datarows'),model:this.model});datalist_view.render();var self=this;_.defer(function(){self.$("label").inFieldLabels();});this.showStatistics();return this;},showLanguageDropdown:function(e){this.$('#dropdown-menu-languages').show();var self=this;$(document).one('click',function(e){self.$('#dropdown-menu-languages').hide();});e.stopPropagation();},showSkillDropdown:function(e){this.$('#dropdown-menu-skills').show();var self=this;$(document).one('click',function(e){self.$('#dropdown-menu-skills').hide();});e.stopPropagation();},changeSkill:function(e){var $ele=$(e.target);var skill_id=$ele.get(0).id;if(skill_id){this.$('#dropdown-menu-skills').hide();duo.databaseRouter.navigate('#/db/'+this.model.get('from_language').abbr+'/'+this.model.get('to_language').abbr+'/'+skill_id,true);}
else{duo.databaseRouter.navigate('#/db/'+this.model.get('from_language').abbr+'/'+this.model.get('to_language').abbr,true);}},changeLanguage:function(e){var $ele=$(e.target);var direction=$ele.data('direction');if(direction){this.$('#dropdown-menu-language').hide();duo.databaseRouter.navigate('#/db/'+direction,true);}},checkClearButton:function(e){if(this.$('#search-sentences').val()==''){this.$('.clear-button').hide();this.clearSearchResults();}
else
this.$('.clear-button').show();if(e.which==13){e.preventDefault();var from=this.model.get('from_language').abbr;var to=this.model.get('to_language').abbr;if(!this.search_results){this.search_results=new duo.DataSearchList({from_language:from,to_language:to});}
this.search_results.q=$.trim(this.$('#search-sentences').val());this.search_results.fq='((to_langs: '+from+' AND from_lang: '+to+') OR (to_langs: '+to+' AND from_lang: '+from+'))';if(!this.search_view){this.search_view=new duo.DataSearchResultsView({collection:this.search_results,el:this.$('#search-results'),model:this.model});}
this.search_results.reset([]);this.search_results.actual_matches=0;this.search_results.fetch();this.$('#search-results').fadeIn();this.$('#data-list').fadeOut();}},clearSearchResults:function(){this.$('#search-sentences').val('');this.$('#data-list').fadeIn();this.$('#search-results').fadeOut();},showStatistics:function(){this.model.getStatistics();if(this.statsview==undefined){this.statsview=new duo.StatisticsView({el:this.$('#stats-view'),language_stats:this.model.get('stats'),model:this.model});}
this.statsview.render();this.$('#stats-view').show();}});duo.DataRowListView=Backbone.View.extend({template:duo.templates['data-list'],events:{'click .sentence-toggle':'toggleSentence','click .done-btn':'resetReports','click .cancel-btn':'closeExpanded','click .load-more':'onClickLoad','click .show-delete':'showDelete','click .cancel-delete':'cancelDelete','click .delete-sentence':'deleteSentence'
},initialize:function(options){this.collection=options.collection;this.collection.bind('add',this.render,this);this.page=0;this.more=true;this.subviews={};},render:function(){$(this.el).html($.duostache(this.template,{datarows:this.collection.toJSON(),more:this.collection.more,skill:this.skill},duo.templates));return this;},toggleSentence:function(e){var $ele=$(e.currentTarget);var sent_id=$ele.data('sentence');var sent=this.collection.get(sent_id); if(this.$('#expanded-'+sent_id).html()!=''){this.openExpanded(sent_id);return;}
var self=this;sent.fetch({data:{from_language:this.model.get('from_language').abbr,to_language:this.model.get('to_language').abbr},success:function(data){var datarow_view=new duo.DataRowView({model:sent,el:self.$('#expanded-'+sent_id),from_language:self.model.get('from_language'),to_language:self.model.get('to_language')});datarow_view.render();self.subviews[sent_id]=datarow_view;self.openExpanded(sent_id);}});return;},openExpanded:function(sent_id){this.$('#expanded-'+sent_id+' .animate-me').css({'display':'none'});this.$('#compact-'+sent_id).hide();this.$('#expanded-'+sent_id).fadeIn();this.$('#expanded-footer-'+sent_id).fadeIn();this.$('.animate-me').slideDown('slow');},resetReports:function(e){if($(e.currentTarget).hasClass('disabled'))
return;var $ele=$(e.currentTarget).closest('tr');var sent_id=$ele.data('sentence');var row=this.collection.get(sent_id);var subview=this.subviews[sent_id];if(row===undefined){this.closeExpanded(e);return;};var original_sentence=row.get('text');if(subview.checkSubmission()==false){var cb=_.bind(function(){ row.resetReports(this.model.get('from_language').abbr,this.model.get('to_language').abbr);if(!this.model.has('current_skill')&&!this.collection.search){this.collection.remove(row);}
else{this.fadeRow(sent_id);}
this.closeExpanded(e);},this);if((original_sentence!=subview.new_original)&&subview.needs_update){row.updateOriginalAndTranslations(subview.new_original,subview.display_translations,subview.new_translations,cb);}
else if(original_sentence!=subview.new_original){row.updateOriginal(subview.new_original);original_sentence=subview.new_original;cb();}
else if(subview.needs_update){if(subview.new_translations.length+subview.display_translations.length>0){row.updateTranslations(subview.display_translations,subview.new_translations,cb);}}
else{if(!this.model.has('current_skill')&&!this.collection.search)
this.collection.remove(row);else if(row.get('num_reports')>0){this.fadeRow(sent_id);}
row.resetReports(this.model.get('from_language').abbr,this.model.get('to_language').abbr);this.closeExpanded(e);}}},closeExpanded:function(e){var $ele=$(e.currentTarget).closest('tr');var sent_id=$ele.data('sentence');var row=this.collection.get(sent_id);this.$('#expanded-footer-'+sent_id).hide();this.$('#expanded-'+sent_id+' .animate-me').slideUp('slow');var self=this;$('.animate-me').promise().done(function(){self.$('#compact-'+sent_id).show();self.$('#expanded-'+sent_id).hide();if(row===undefined||row.has('reports_removed')){if(row){row.set('reports_removed',undefined);}
else{self.collection.sort();self.render();}}});this.$('#delete-pop-'+sent_id).hide();},onClickLoad:function(){this.loadMoreReports();},loadMoreReports:function(){if(this.skill){return;}
this.page+=1;this.collection.fetch({data:{skill_id:this.model.has('current_skill')?this.model.get('current_skill').id:undefined,from_language:this.model.get('from_language').abbr,to_language:this.model.get('to_language').abbr,page:this.page},update:true,remove:false});},showDelete:function(e){var $ele=$(e.currentTarget).closest('tr');var sent_id=$ele.data('sentence');var row=this.collection.get(sent_id);this.$('#delete-pop-'+sent_id).show();},cancelDelete:function(e){var $ele=$(e.currentTarget).closest('tr');var sent_id=$ele.data('sentence');var row=this.collection.get(sent_id);this.$('#delete-pop-'+sent_id).hide();},deleteSentence:function(e){var $ele=$(e.currentTarget).closest('tr');var sent_id=$ele.data('sentence');var row=this.collection.get(sent_id);var directions=[];this.$('#delete-pop-'+sent_id+' input[type="checkbox"]:checked').each(function(){directions.push([$(this).data('to'),$(this).data('from')]);})
row.deleteSentence(directions);this.$('#delete-pop-'+sent_id).hide();this.closeExpanded(e);this.fadeRow(sent_id);},fadeRow:function(sent_id){var row=this.collection.get(sent_id);row.faded=true;this.$('#expanded-'+sent_id).css('opacity',.4);this.$('#compact-'+sent_id).css('opacity',.4);this.$('#expanded-footer-'+sent_id).css('opacity',.4);}});duo.DataSearchResultsView=duo.DataRowListView.extend({template:duo.templates['data-list'],initialize:function(options){this.collection=options.collection;this.collection.bind('add',this.render,this);this.collection.bind('reset',this.onReset,this);this.page=0;this.more=true;this.subviews={};},render:function(){$(this.el).html($.duostache(this.template,{datarows:this.collection.toJSON(),more:this.collection.more,skill:this.skill,search:true,search_query:this.collection.q},duo.templates));return this;},loadMoreReports:function(){this.collection.fetch();},onReset:function(){this.render();}});duo.DataRowView=Backbone.View.extend({tagName:'tr',className:'expanded-cell',template:duo.templates['data-row'],events:{'click .accept-btn':'acceptTranslation','click .reject-btn':'rejectTranslation','keyup .comment-box':'enableSubmit','click .star-display':'toggleStar','click .add-accepted':'addAcceptedTranslation','click .remove-translation':'removeAcceptedTranslation','click .editable':'makeEditable','blur .editable':'makeNotEditable','input .base-sentence':'clearHintTable'},initialize:function(options){this.model.bind('change:num_reports',this.render,this);this.from_language=options.from_language;this.to_language=options.to_language;this.new_original=this.model.get('text');this.need_new_hints=false;this.new_translations=[];this.display_translations=[];this.needs_update=false;this.highlights={};_.each(this.model.get('highlights'),function(value){this.highlights[value]='relevant';},this);},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{orig_sentence:this.model.get('all_reports')?parseInt(this.model.get('all_reports')['original'])+parseInt(this.model.get('all_reports')['hints']):0}),duo.templates));var translation_language=this.model.get('language')==this.from_language.abbr?this.to_language.abbr:this.from_language.abbr;this.highlightAcceptedTranslations();this.$('.base-sentence').hints({templates:duo.templates,source_language:this.model.get('language'),target_language:translation_language,style_mapping:this.highlights,top:15});var self=this;_.defer(function(){self.$('.icon_speaker').tts({template:duo.templates['speaker'],language:self.model.get('language'),visible:false,text:self.model.get('text'),autoplay:false,click:true});self.$('label').inFieldLabels();});this.$('.lang-checkbox').each(function(){if(($(this).data('to')==self.to_language.abbr)&&($(this).data('from')==self.from_language.abbr))
$(this).prop('checked',true);});return this;},showRejectComment:function(e){$('.reject-box').hide();var $ele=$(e.target).closest('li');var sent_id=$ele.data('sentence');var index=$ele.data('index');$ele.find('#reject-box-'+sent_id+'-'+index).fadeIn();this.$('#reject-comment-box-'+sent_id+'-'+index).focus();this.$('#reject-comment-box-'+sent_id+'-'+index).autosize({append:"\n"});e.stopPropagation();return false;},cancelRejectComment:function(e){this.$('.reject-box').fadeOut();return false;},acceptTranslation:function(e){var $ele=$(e.currentTarget).closest('li');this.model.acceptTranslation($ele.data('text'),this.from_language.abbr,this.to_language.abbr);$ele.remove();},rejectTranslation:function(e){var $ele=$(e.currentTarget).closest('li');this.model.rejectTranslation($ele.data('text'),this.from_language.abbr,this.to_language.abbr);$ele.remove();},rejectTranslationWithEmail:function(e){var $ele=$(e.target).closest('li');var sent_id=$ele.data('sentence');var index=$ele.data('index');var message=$.trim($ele.find('#reject-comment-box-'+sent_id+'-'+index).val());if(message.length>0){$ele.find('.reject-box').fadeOut();this.rejectTranslation($ele.data('text'),message)}
return false;},rejectTranslationNoEmail:function(e){var $ele=$(e.currentTarget).closest('li');$ele.find('.reject-box').fadeOut();this.rejectTranslation($ele.data('text'))
return false;},enableSubmit:function(e){var $ele=$(e.currentTarget).closest('li');$ele.find('.send-reject').removeAttr('disabled');},toggleStar:function(e){var $ele=$(e.currentTarget);if($ele.hasClass('star-active')){$ele.removeClass('star-active');$ele.addClass('star-inactive');}else{$ele.removeClass('star-inactive');$ele.addClass('star-active');}},makeEditable:function(e){var $ele=$(e.currentTarget);$ele.closest('li').addClass('focused-li');if($ele.hasClass('base-sentence')){this.clearHintTable();this.need_new_hints=true;}
if($ele.hasClass('accepted-translation')){$ele.find('span').removeClass('relevant');}},clearHintTable:function(){if(this.$('.hint-table').length>0){this.$('.hint-sentence').remove();this.$('.hint-table').remove();this.need_new_hints=true;this.$('.base-sentence .token.relevant').removeClass('relevant');}
},makeNotEditable:function(e){var $ele=$(e.currentTarget);$ele.closest('li').removeClass('focused-li');if($ele.hasClass('base-sentence')&&this.need_new_hints){this.new_original=$ele.text().replace(/\s+/g,' ');var translation_language=this.model.get('language')==this.from_language.abbr?this.to_language.abbr:this.from_language.abbr;var replaced=this.$('.base-sentence').html().replace(/\s+/g,' ').replace(/&nbsp;/g,' ');this.$('.base-sentence').html(replaced);this.$('.base-sentence').hints({templates:duo.templates,source_language:this.model.get('language'),target_language:translation_language,style_mapping:this.highlights,top:15});this.need_new_hints=false;}
if($ele.hasClass('accepted-translation')){this.highlightAcceptedTranslations();}},checkAcceptedTranslation:function(element){var regex=/\[\w*\]/;var new_translation=element.text();var orig_sentence=this.new_original; if(regex.test(new_translation)){this.poorlyFormed(element,"single item bracket");return false;} 
var check=0;if(new_translation.match(/^([^[\]]*(\[[^\]\[]+\])*)*[^[\]]*$/)===null){this.poorlyFormed(element,"brackets do not match");return false;} 
if((orig_sentence.charAt(orig_sentence.length-1)=='.')!=(new_translation.charAt(new_translation.length-1)=='.')){this.poorlyFormed(element,"unmatched periods");return false;} 
if(new_translation.length<=0){this.poorlyFormed(element,"empty row");return false;}
return true;},poorlyFormed:function(e,error){console.log("error: ",error);e.closest('li').css("background-color","#FFE0E0");return false;},checkSubmission:function(){ var self=this;var display_set=false;var problem=false;this.needs_update=false;this.new_translations=[];this.display_translations=[];this.$('.accepted-translations li').each(function(i,translation){var $ele=$(translation).find('.accepted-translation'); var accepted=self.checkAcceptedTranslation($ele);if(accepted){$ele.closest('li').css("background-color",'');}
else{console.log("Error with accepted translation found");problem=true;}
var display=$ele.closest('li').find('span').hasClass('star-active'); if(display){display_set=true;self.display_translations.push($ele.text().replace(/\s+/g,' '));}
else
self.new_translations.push($ele.text().replace(/\s+/g,' '));if(($ele.data('text')!=$ele.text())||!$ele.data('text')){self.needs_update=true;}}); if(display_set==false){this.$('.star-display').css("background-color",'#FFE0E0');console.log("No display translation chosen");problem=true;}
else
this.$('.star-display').css("background-color",'');if((this.new_translations.length+this.display_translations.length)!=this.model.get('correct_translations').length)
this.needs_update=true;return problem;},addAcceptedTranslation:function(){console.log(this)
var $row=$('<li class="editable-cell"/>').html(this.$('.additional-row').html());this.$('.accepted-translations').append($row);},removeAcceptedTranslation:function(e){var $ele=$(e.currentTarget).closest('li');$ele.remove();},highlightAcceptedTranslations:function(){if(this.model.get('highlights').length>0){ var regex=new RegExp('\\b'+this.model.get('highlights').join('\\b|\\b')+'\\b','ig');$.each(this.$('.accepted-translation'),function(index,value){$(value).html($(value).text().replace(regex,function(content){return'<span class=relevant>'+content+'</span>';}));});}}});duo.StatisticsView=Backbone.View.extend({template:duo.templates['dashboard-statistics'],initialize:function(options){this.model.bind('change',this.render,this);this.language_stats=options.language_stats;},render:function(){var data={};$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{language_stats:this.language_stats}),duo.templates));}});duo.Vocab=Backbone.Model.extend({url:'/vocabularies',parse:function(data){data.vocab=new duo.WordList(data.vocab);data.vocab.page=1;data.vocab.more=data.vocab_count>data.vocab.length;data.vocab.skill_id=data.skill_id;data.vocab.lesson=data.lesson;data.vocab.sort_by=data.sort_by;data.vocab.desc=data.desc;return data;},toJSON:function(){var data=Backbone.Model.prototype.toJSON.call(this);data.vocab=this.get('vocab').toJSON();return data;}});duo.Word=Backbone.Model.extend({url:function(){ var pos=(this.get('pos')?this.get('pos'):'');return'/words/'+this.get('language')+'/'+encodeURIComponent(this.get('surface_form'))+'/'+pos;},toJSON:function(){var json_data=Backbone.Model.prototype.toJSON.call(this);json_data.is_verb=json_data.pos_string==='Verb';if(json_data.forms_data&&json_data.forms_data.length){json_data.forms_data[0].first=true;json_data.forms_data[0].num_forms=json_data.forms_data.length;json_data.forms_data[0].lemma_surface_form=json_data.surface_form;json_data.forms_data[0].lemma_value=json_data.lemma_value;json_data.forms_data[0].language=json_data.language;}
if(json_data.pos_string){json_data.pos_string=json_data.pos_string.toLowerCase();}
_.extend(json_data,duo.wordStrengthData(json_data.strength));_.each(json_data.lexemes_data||json_data.forms_data,function(form){_.extend(form,duo.wordStrengthData(form.strength));});return json_data;}});duo.WordList=Backbone.Collection.extend({model:duo.Word,url:'/words',fetch:function(options){options=options||{};options.data=options.data||{};options.data.sort_by=options.data.sort_by||this.sort_by;if(!('desc'in options.data)){options.data.desc=this.desc;}
options.data.skill_id=options.data.skill_id||this.skill_id;options.data.lesson=options.data.lesson||this.lesson;Backbone.Collection.prototype.fetch.call(this,options);},parse:function(data){this.page=data.page;this.more=data.more;this.sort_by=data.sort_by;this.desc=data.desc;return data.vocab}});(function($){duo.VocabOverview=Backbone.View.extend({id:'app',template:duo.templates['vocab-overview'],events:{'click .sortable':'sortBy','click #practice-button':'practice','click #show-more-counts':'moreSkillsCounts'},initialize:function(){this.model.bind('change',this.render,this);this.last_request_length=0;this.model.get('vocab').bind('add',this.addOne,this);this.model.get('vocab').bind('reset',this.render,this); duo.topbar.bind('navigate',this.cleanup,this);},render:function(){var list_count=this.model.get('skills_lemma_count')||this.model.get('lessons_lemma_count');_.each(list_count,function(lemma_count,i){if(i>9){lemma_count.hidden=true;}});this.show_skills_counts=this.show_skills_counts||list_count.length<10;$(this.el).html($.duostache(this.template,_.extend({},this.model.toJSON(),{show_all:this.show_skills_counts,has_vocab:this.model.get('vocab_count')>this.model.get('vocab').length}),duo.templates));this.renderSkills();var desc=this.model.get('vocab').desc;this.$('.sortable[data-sort="'+this.model.get('vocab').sort_by+'"]').addClass(desc?'sort-desc':'sort-asc');if(this.show_skills_counts){this.moreSkillsCounts();}
var self=this;_.defer(function(){self.$("label").inFieldLabels();});$(document).unbind('.vocab.infinite_scroll').bind('scroll.vocab.infinite_scroll',function(e){var total_height=$(document).height();var view_height=total_height-$(document).scrollTop();var visible_height=$(window).height();if(view_height<1.5*visible_height&&self.model.get('vocab').length>self.last_request_length){self.last_request_length=self.model.get('vocab').length;self.loadMore();}});this.$('.lexeme-form').tokenHints({templates:duo.templates,source_language:this.model.get('language'),target_language:duo.user.get('ui_language'),word_only:true}).addClass('translation-source');return this;},addOne:function(word){var self=this;this.$('.vocabulary > tbody').append($.duostache(duo.templates['lemma-row'],word.toJSON(),duo.templates));_.each(word.get('forms_data'),function(form_data){var skill_view=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(self,form_data.skill)),size:'xsmall',current_user:true,el:this.$('#'+form_data.lexeme_id+'-skill'),disable_hover:true});skill_view.render();},this);},renderSkills:function(){var self=this;this.model.get('vocab').each(function(word){_.each(word.get('forms_data'),function(form_data){var skill_view=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(self,form_data.skill)),size:'xsmall',current_user:true,el:this.$('#'+form_data.lexeme_id+'-skill'),disable_hover:true});skill_view.render();},this);},this);},renderGraph:function(){var data=[this.model.get('graph').learn,this.model.get('graph').cap];var options={xaxis:{mode:'time'},yaxis:{position:'right'},series:{lines:{show:true,lineWidth:1,fill:1}},grid:{axisMargin:100,minBorderMargin:0,labelMargin:5,borderWidth:1,borderColor:'#ddd',color:'#999'},colors:["#71b50c","#548609"]};$.plot(this.$('#vocab-graph'),data,options);},loadMore:function(data){var self=this;data=data||{};data=_.extend(data,{page:this.model.get('vocab').page+1});this.model.get('vocab').fetch({data:data,update:true,remove:false,success:function(){self.$('.lexeme-form').not('.translation-source').tokenHints({templates:duo.templates,source_language:self.model.get('language'),target_language:duo.user.get('ui_language'),word_only:true}).addClass('translation-source');if(self.model.get('vocab_count')==self.model.get('vocab').length){self.$('#vocab-spinner').remove();}}});},sortBy:function(e){var link=$(e.currentTarget);var sort_by=link.data('sort');var desc=link.hasClass('sort-asc');var data={page:1,sort_by:sort_by,desc:desc};this.model.get('vocab').fetch({data:data});this.last_request_length=0;},practice:function(){if(this.model.has('lesson')){ duo.vocabRouter.navigate('/skill_practice/'+this.model.get('skill_id')+'/'+this.model.get('lesson'),true);}else if(this.model.has('skill_id')){ duo.vocabRouter.navigate('/skill_practice/'+this.model.get('skill_id'),true);}else{duo.homeRouter.navigate('/practice',true);}},moreSkillsCounts:function(){this.$('#skills-counts li').show();this.show_skills_counts=true;this.$('#show-more-counts').remove();},cleanup:function(){duo.topbar.unbind('navigate',this.cleanUp,this);$(document).unbind('.vocab');}});duo.MiniVocabOverview=duo.VocabOverview.extend({id:'',template:duo.templates['mini-vocab-overview'],render:function(){var any_new_word=false;this.model.get('vocab').each(function(word){var new_form=_.each(word.get('forms_data'),function(form){any_new_word=any_new_word||form.new_form;});});var data={has_vocab:this.model.get('vocab_count')>0,any_new_word:any_new_word};var avg_strength=this.model.get('skill_average_strength');var strength_data=duo.wordStrengthData(avg_strength);data.avg_strength_s=strength_data.strength_s;data.avg_strength_m=strength_data.strength_m;data.avg_strength_l=strength_data.strength_l;$(this.el).html($.duostache(this.template,_.extend({more_vocab:this.model.get('vocab_count')>this.model.get('vocab').length},this.model.toJSON(),data),duo.templates));var desc=this.model.get('vocab').desc;this.$('.sortable[data-sort="'+this.model.get('vocab').sort_by+'"]').addClass(desc?'sort-desc':'sort-asc');this.$('.lexeme-form').tokenHints({templates:duo.templates,source_language:this.model.get('language'),target_language:duo.user.get('ui_language'),word_only:true}).addClass('translation-source');return this;},addOne:function(word){this.$('.vocabulary > tbody').append($.duostache(duo.templates['mini-lemma-row'],word.toJSON(),duo.templates));}});duo.WordView=Backbone.View.extend({id:'app',template:duo.templates['vocab-word'],events:{'click #cap-word':'capWord','click #verb-table .tabs li':'verbTableTab'},initialize:function(){this.model.bind('change',this.render,this);},render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));this.$('#verb-table').verbTable({source_language:this.model.get('language'),language_information:this.model.get('language_information'),infinitive:this.model.get('surface_form'),templates:duo.templates});var self=this;var ttsURL=_ttsURL;ttsURL+=self.model.get('language')+'/token/';ttsURL+=encodeURIComponent(self.model.get('surface_form')).toLowerCase();_.defer(function(){self.$('.listen-button-small').tts({absoluteURL:ttsURL,template:duo.templates['speaker'],visible:false,autoplay:false,click:true});});return this;},capWord:function(){var self=this;$.post('/words/'+this.model.id+'/'+this.model.get('pos')+'/cap',function(data){if(data.response==='ok'){_.each(self.model.get('lexemes_data'),function(lexeme_data){lexeme_data.strength_s=true;lexeme_data.strength_m=true;lexeme_data.strength_l=true;});self.model.set({strength_s:true,strength_m:true,strength_l:true});}});},verbTableTab:function(){window.scrollTo(0,document.body.scrollHeight);}});})(window.jQuery);